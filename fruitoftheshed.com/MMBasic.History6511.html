

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed&Revision=7 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:51:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Page History - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/History.aspx?NS=MMBasic&amp;Page=MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed&amp;Revision=7" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEzMjI3OTE2NTkPZBYCZg9kFgICAQ9kFgICCQ9kFggCAQ8WAh4EVGV4dAU/UGFnZSBIaXN0b3J5OiBNb2RidXMgQ1JDIHVzZXMgdGhlIHRhYmxlIGxvb2t1cCBtZXRob2QgZm9yIHNwZWVkZAIFDxBkEBUIATcBNgE1ATQBMwEyATEBMBUIATcBNgE1ATQBMwEyATEBMBQrAwhnZ2dnZ2dnZ2RkAgcPEGQQFQkHQ3VycmVudAE3ATYBNQE0ATMBMgExATAVCQdDdXJyZW50ATcBNgE1ATQBMwEyATEBMBQrAwlnZ2dnZ2dnZ2dkZAILDxYCHwAF2CI8dGFibGUgY2xhc3M9ImJveCIgY2VsbHBhZGRpbmc9IjAiIGNlbGxzcGFjaW5nPSIwIj48dHI+PHRkPjxwIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Ij48Yj48YSBocmVmPSJNTUJhc2ljLkhpc3RvcnkuYXNweD9QYWdlPU1NQmFzaWMuTW9kYnVzLUNSQy11c2VzLXRoZS10YWJsZS1sb29rdXAtbWV0aG9kLWZvci1zcGVlZCZhbXA7UmV2aXNpb249MDAwMDYiPiZsYXF1bzsgT2xkZXIgUmV2aXNpb248L2E+IC0gPGEgaHJlZj0iTU1CYXNpYy5IaXN0b3J5LmFzcHg/UGFnZT1NTUJhc2ljLk1vZGJ1cy1DUkMtdXNlcy10aGUtdGFibGUtbG9va3VwLW1ldGhvZC1mb3Itc3BlZWQiPkJhY2sgdG8gUGFnZSBIaXN0b3J5PC9hPiAtIDxhIGhyZWY9Ik1NQmFzaWMuTW9kYnVzLUNSQy11c2VzLXRoZS10YWJsZS1sb29rdXAtbWV0aG9kLWZvci1zcGVlZC5hc2h4Ij5DdXJyZW50IFJldmlzaW9uPC9hPjwvYj48L3A+PC90ZD48L3RyPjwvdGFibGU+PGJyIC8+PGgzIGNsYXNzPSJzZXBhcmF0b3IiPlBhZ2UgUmV2aXNpb246IDIwMTgvMTIvMTMgMDY6MDU8L2gzPjxiciAvPjxiPkludHJvZHVjdGlvbjo8L2I+PGJyIC8+VGhpcyBDUkMgKEN5Y2xpYyBSZWR1bmRhbmN5IENoZWNrKSBpcyBmb3IgdGhlIE1vZGJ1cyBSVFUgcHJvdG9jb2wgYXMgdXNlZCBpbiBSUzIzMiBhbmQgUlM0ODUgY29tbXVuaWNhdGlvbnMuIFRoZSBDUkMgaXMgYSAxNiBiaXQgd29yZCB0aGF0IGlzIGNhbGN1bGF0ZWQgZnJvbSBhbGwgb2YgdGhlIGRhdGEgaW4gYSBtZXNzYWdlLiBJdCBjYW5ub3QgY29ycmVjdCBhbnkgZGF0YSBjb3JydXB0aW9uIGJ1dCBpdCB3aWxsIGluZGljYXRlIGlmIGEgbWVzc2FnZSBoYXMgYmVlbiBjb3JydXB0ZWQgaW4gc29tZSB3YXkuIFRoaXMgcHJvZ3JhbSB1c2VzIHRoZSB0YWJsZSBsb29rdXAgbWV0aG9kIGZvciBzcGVlZC4gSXQgcHJvY2Vzc2VzIHRoZSBtZXNzYWdlIGJ5dGUtYnktYnl0ZSByYXRoZXIgdGhhbiB0aGUgYml0LWJ5LWJpdCBtZXRob2Qgd2hpY2ggaXMgbW9yZSB1c3VhbC4gVGhpcyBwcm9ncmFtIGdlbmVyYXRlcyB0aGUgbG9va3VwIHRhYmxlIGluIHNvZnR3YXJlIHJhdGhlciB0aGFuIGVudGVyaW5nIHRoZSBkYXRhIGludG8gdGhlIHRhYmxlIHZpYSBhIHNlcmllcyBvZiBSRUFEL0RBVEEgc3RhdGVtZW50cy4gSXQgcmVxdWlyZXMgYW4gaW50ZWdlciB0YWJsZSBvZiAyNTYgd29yZHMuPGJyIC8+PGJyIC8+PGI+UExFQVNFIE5PVEU6PC9iPjxiciAvPkFsdGhvdWdoIHRoaXMgaXMgYSBNb2RidXMgQ1JDIGl0IGlzIGluIG5vIHdheSByZXN0cmljdGVkIHRvIGJlIG9ubHkgdXNlZCBmb3IgdGhlIE1vZGJ1cyBwcm90b2NvbC4gQW55IG1lc3NhZ2Ugc3RydWN0dXJlIGNvbnNpc3Rpbmcgb2YgYSBzdHJlYW0gb2YgOC1iaXQgZGF0YSBieXRlcyBjYW4gdXRpbGlzZSBpdC4gRm9yIGV4YW1wbGU6PGJyIC8+TXNnJCA9IOKAnFRoZSBxdWljayBicm93biBmb3gganVtcHMgb3ZlciB0aGUgbGF6eSBkb2figJ08YnIgLz48YnIgLz5CaWxsIE1jS2lubGV5PGJyIC8+PGJyIC8+QW4gZXhhbXBsZSBhIE1vZGJ1cyBtZXNzYWdlIChpbiBIZXgpIGNvdWxkIGxvb2sgbGlrZTo8YnIgLz48cHJlPg0KU2xhdmUgQWRkcmVzcyAgICAgICAgICAgICAxOA0KRnVuY3Rpb24gQ29kZSAgICAgICAgICAgICAwMw0KU3RhcnQgQWRkcmVzcyAoSGkpICAgICAgICAwQg0KU3RhcnQgQWRkcmVzcyAoTG8pICAgICAgICBCOQ0KTnVtYmVyIG9mIHBvaW50cyAoSGkpICAgICAwMA0KTnVtYmVyIG9mIHBvaW50cyAoTG8pICAgICAwMQ0KQ1JDIChMbykgICAgICAgICAgICAgICAgICA1NQ0KQ1JDIChIaSkgICAgICAgICAgICAgICAgICBDMg0KPC9wcmU+PGJyIC8+Tm90ZSB0aGF0IHRoZSBIaWdoL0xvdyBvcmRlciBvZiBieXRlcyBpbiB0aGUgQ1JDIGlzIHRoZSByZXZlcnNlIG9mIHRoYXQgdXNlZCBmb3IgdGhlIGRhdGEuIEkgZG9u4oCZdCBrbm93IHdoeS48YnIgLz48YnIgLz5JbiBNTUJhc2ljIHdpdGhvdXQgdGhlIENSQywgdGhhdCBtZXNzYWdlIHdvdWxkIGxvb2sgbGlrZTo8YnIgLz48YnIgLz48cHJlPlR4TXNnJCA9IENIUiQoJmFtcDtIMTgpK0NIUiQoJmFtcDtIMDMpK0NIUiQoJmFtcDtIMEIpK0NIUiQoJmFtcDtIQjkpK0NIUiQoJmFtcDtIMDApK0NIUiQoJmFtcDtIMDEpPC9wcmU+PGJyIC8+QWRkIHRoZSBDUkMgdG8gdGhlIG1lc3NhZ2UgYnk6PGJyIC8+PGJyIC8+PHByZT5UeE1zZyQgPSBUeE1zZyQgKyBDUkMxNiQoVHhNc2ckKTwvcHJlPjxiciAvPlBlcmZvcm1pbmcgYSBDUkMgY2hlY2sgb24gYSBtZXNzYWdlIHRoYXQgYWxyZWFkeSBpbmNsdWRlcyBhIHZhbGlkIENSQyB3aWxsIHByb2R1Y2UgYSAnQ1JDJyBvZiAmaDAwMCBzbzo8YnIgLz5DaGVjayB0aGUgcmVjZWl2ZWQgbWVzc2FnZSAoZWcgUnhNc2cpIGJ5OjxiciAvPjxiciAvPjxwcmU+SUYgQ1JDMTYkKFJ4TXNnJCkgPSBDSFIkKDApICsgQ0hSJCgwKSBUSEVOICcgQ1JDIGlzIE9LDQonIFByb2Nlc3MgdGhlIHJlc3BvbnNlDQpFTFNFDQonIEJhZCBDUkMgLSBETyBub3RoaW5nIC0gZG9uJ3QgcmVzcG9uZA0KRU5EIElGPC9wcmU+PGJyIC8+VG8gdXNlIHRoZSBwcm9ncmFtLCBpbnNlcnQgdGhlIGNvZGUgYmVsb3cgaW50byB5b3VyIHByb2dyYW0uIFRoZSBzdWJyb3V0aW5lIGFuZCBmdW5jdGlvbiBjYW4gYmUgcGxhY2VkIGFueXdoZXJlLCBwcmVmZXJhYmx5IGFmdGVyIHRoZSBtYWluIGJvZHkgb2YgdGhlIHByb2dyYW0uIFRoZSB0YWJsZSBESU0gc3RhdGVtZW50IHNob3VsZCBiZSBuZWFyIHRoZSB0b3Agb2YgdGhlIHByb2dyYW0gYW5kIHRoZSAnZ2VuQ1JDdGFibGUnIHN1YnJvdXRpbmUgc2hvdWxkIGJlIG9uZSBvZiB0aGUgZmlyc3QgaW5zdHJ1Y3Rpb25zIGFzIHBhcnQgb2YgYW55IGluaXRpYWxpc2F0aW9uLjxiciAvPjxiciAvPjxiPkFzc3VtcHRpb25zOjwvYj48YnIgLz5UaGF0IHRoZSBkZWZhdWx0OiA8Yj5PUFRJT04gQkFTRSAwPC9iPiBpcyBpbiBmb3JjZS4gSWYgPGI+T1BUSU9OIEJBU0UgMTwvYj4gaXMgdXNlZCB0aGVuIHNvbWUgY2hhbmdlcyB3aWxsIGJlIG5lZWRlZC48YnIgLz48YnIgLz48Yj5UaGUgUHJvZ3JhbTo8L2I+PGJyIC8+PHByZT4NCkRJTSBJTlRFR0VSIGNyY190YWJsZSgyNTUpICcgbG9va3VwIHRhYmxlIGZvciBDUkMgZ2VuZXJhdGlvbg0KDQpnZW5DUkN0YWJsZSAnIGdlbmVyYXRlIHRoZSBsb29rdXAgdGFibGUNCg0KDQonJiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7DQonZ2VuZXJhdGVzIGEgbG9va3VwIHRhYmxlIGZvciBmYXN0IGNyYyBjYWxjdWxhdGlvbg0KU1VCIGdlbkNSQ3RhYmxlJiMxMjM7JiMxMjM7DQpMT0NBTCBpJSwgaiUsIGslLCBjcmNfY29uc3QlID0gJmFtcDtIQTAwMQ0KRk9SIGklID0gMCBUTyAyNTUNCiAgayUgPSBpJSYjMTI1OyYjMTI1Ow0KICBGT1IgaiUgPSAxIFRPIDgNCiAgICBJRiBrJSBBTkQgMSBUSEVODQogICAgICBrJSA9IGslICZndDsmZ3Q7IDENCiAgICAgIGslID0gayUgWE9SIGNyY19jb25zdCUNCiAgICBFTFNFDQogICAgICBrJSA9IGslICZndDsmZ3Q7IDENCiAgICBFTkQgSUYNCiAgTkVYVCBqJQ0KIGNyY190YWJsZShpJSk9ayUNCk5FWFQgaSUNCkVORCBTVUINCicNCicgcmV0dXJucyB0aGUgQ1JDIGFzIGEgc3RyaW5nDQpGVU5DVElPTiBDUkMxNiQoYSQpDQogIExPQ0FMIENSQyUgPSAmYW1wO0hGRkZGLCBuJQ0KICBGT1IgbiUgPSAxIFRPIExFTihhJCkNCiAgICBDUkMlID0gKENSQyUgJmd0OyZndDsgOCkgWE9SIGNyY190YWJsZShDUkMlIFhPUiBBU0MoTUlEJChhJCwgbiUsIDEpKSBBTkQgJmFtcDtIRkYpDQogIE5FWFQgbiUNCiAgQ1JDMTYkID0gQ0hSJChDUkMlIEFORCAmYW1wO0hGRikgKyBDSFIkKChDUkMlJmd0OyZndDs4KSBBTkQgJmFtcDtIRkYpDQpFTkQgRlVOQ1RJT04NCicmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTstDQo8L3ByZT5kZOv1EIUFJ3ucLthD9kZBONDACH1v" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="2068001F" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWEwLln7qEDQK7z/TSAwK4z/TSAwK5z/TSAwK+z/TSAwK/z/TSAwK8z/TSAwK9z/TSAwKiz/TSAwK3j57gBwLE5ta/BQLH5ta/BQLG5ta/BQLB5ta/BQLA5ta/BQLD5ta/BQLC5ta/BQLd5ta/BQL9yYWiCaWpumGmHjtSbQSi0Rj4ukSQFiQ8" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login05f7.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fHistory.aspx%3fNS%3dMMBasic%26Page%3dMMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed%26Revision%3d7" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <h1 class="pagetitlesystem">Page History: Modbus CRC uses the table lookup method for speed</h1>
    <p>Compare Page Revisions</p> 
    <select name="ctl00$CphMaster$lstRev1" id="ctl00_CphMaster_lstRev1">
	<option value="7">7</option>
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <select name="ctl00$CphMaster$lstRev2" id="ctl00_CphMaster_lstRev2">
	<option value="Current">Current</option>
	<option value="7">7</option>
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <input type="submit" name="ctl00$CphMaster$btnCompare" value="Compare" id="ctl00_CphMaster_btnCompare" />
    <br /><br />
    
    <table class="box" cellpadding="0" cellspacing="0"><tr><td><p style="text-align: center;"><b><a href="MMBasic.Historybd04.html?Page=MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed&amp;Revision=00006">&laquo; Older Revision</a> - <a href="MMBasic.History3695.html?Page=MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed">Back to Page History</a> - <a href="MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed.html">Current Revision</a></b></p></td></tr></table><br /><h3 class="separator">Page Revision: 2018/12/13 06:05</h3><br /><b>Introduction:</b><br />This CRC (Cyclic Redundancy Check) is for the Modbus RTU protocol as used in RS232 and RS485 communications. The CRC is a 16 bit word that is calculated from all of the data in a message. It cannot correct any data corruption but it will indicate if a message has been corrupted in some way. This program uses the table lookup method for speed. It processes the message byte-by-byte rather than the bit-by-bit method which is more usual. This program generates the lookup table in software rather than entering the data into the table via a series of READ/DATA statements. It requires an integer table of 256 words.<br /><br /><b>PLEASE NOTE:</b><br />Although this is a Modbus CRC it is in no way restricted to be only used for the Modbus protocol. Any message structure consisting of a stream of 8-bit data bytes can utilise it. For example:<br />Msg$ = “The quick brown fox jumps over the lazy dog”<br /><br />Bill McKinley<br /><br />An example a Modbus message (in Hex) could look like:<br /><pre>
Slave Address             18
Function Code             03
Start Address (Hi)        0B
Start Address (Lo)        B9
Number of points (Hi)     00
Number of points (Lo)     01
CRC (Lo)                  55
CRC (Hi)                  C2
</pre><br />Note that the High/Low order of bytes in the CRC is the reverse of that used for the data. I don’t know why.<br /><br />In MMBasic without the CRC, that message would look like:<br /><br /><pre>TxMsg$ = CHR$(&amp;H18)+CHR$(&amp;H03)+CHR$(&amp;H0B)+CHR$(&amp;HB9)+CHR$(&amp;H00)+CHR$(&amp;H01)</pre><br />Add the CRC to the message by:<br /><br /><pre>TxMsg$ = TxMsg$ + CRC16$(TxMsg$)</pre><br />Performing a CRC check on a message that already includes a valid CRC will produce a 'CRC' of &h000 so:<br />Check the received message (eg RxMsg) by:<br /><br /><pre>IF CRC16$(RxMsg$) = CHR$(0) + CHR$(0) THEN ' CRC is OK
' Process the response
ELSE
' Bad CRC - DO nothing - don't respond
END IF</pre><br />To use the program, insert the code below into your program. The subroutine and function can be placed anywhere, preferably after the main body of the program. The table DIM statement should be near the top of the program and the 'genCRCtable' subroutine should be one of the first instructions as part of any initialisation.<br /><br /><b>Assumptions:</b><br />That the default: <b>OPTION BASE 0</b> is in force. If <b>OPTION BASE 1</b> is used then some changes will be needed.<br /><br /><b>The Program:</b><br /><pre>
DIM INTEGER crc_table(255) ' lookup table for CRC generation

genCRCtable ' generate the lookup table


'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;
'generates a lookup table for fast crc calculation
SUB genCRCtable&#123;&#123;
LOCAL i%, j%, k%, crc_const% = &amp;HA001
FOR i% = 0 TO 255
  k% = i%&#125;&#125;
  FOR j% = 1 TO 8
    IF k% AND 1 THEN
      k% = k% &gt;&gt; 1
      k% = k% XOR crc_const%
    ELSE
      k% = k% &gt;&gt; 1
    END IF
  NEXT j%
 crc_table(i%)=k%
NEXT i%
END SUB
'
' returns the CRC as a string
FUNCTION CRC16$(a$)
  LOCAL CRC% = &amp;HFFFF, n%
  FOR n% = 1 TO LEN(a$)
    CRC% = (CRC% &gt;&gt; 8) XOR crc_table(CRC% XOR ASC(MID$(a$, n%, 1)) AND &amp;HFF)
  NEXT n%
  CRC16$ = CHR$(CRC% AND &amp;HFF) + CHR$((CRC%&gt;&gt;8) AND &amp;HFF)
END FUNCTION
'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
</pre>
    
    


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.Modbus-CRC-uses-the-table-lookup-method-for-speed&Revision=7 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:51:40 GMT -->
</html>
