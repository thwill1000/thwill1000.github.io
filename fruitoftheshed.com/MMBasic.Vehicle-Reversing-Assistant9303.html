

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.Vehicle-Reversing-Assistant.ashx?HL=mmbasic by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 14:29:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Vehicle Reversing Assistant - Fruit Of The Shed
</title><meta name="keywords" content="ultrasonic, distance, reversing, reverse" /><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=Vehicle-Reversing-Assistant&amp;NS=MMBasic&amp;HL=mmbasic" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPDxYCHgdWaXNpYmxlaGQWAmYPFgIeC18hSXRlbUNvdW50ZmRkL9X+pH8J+jB1IIJZx71WjgOrjyw=" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login46bb.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dVehicle-Reversing-Assistant%26NS%3dMMBasic%26HL%3dmmbasic" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBa925f7376d16452eba58fcd259b58efc() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBa925f7376d16452eba58fcd259b58efc').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBa925f7376d16452eba58fcd259b58efc" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBa925f7376d16452eba58fcd259b58efc(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBa925f7376d16452eba58fcd259b58efc(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.Vehicle-Reversing-Assistant266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.History0dfe.html?Page=MMBasic.Vehicle-Reversing-Assistant">History</a>
			
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			Vehicle Reversing Assistant
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Print0dfe.html?Page=MMBasic.Vehicle-Reversing-Assistant" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2020/12/24 08:21
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.Userb2ec.html?Username=hendy">CaptainBoing</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPagese076.html?Cat=MMBasic.Control" title="Control">Control</a>, <a href="MMBasic.AllPages5ce5.html?Cat=MMBasic.Electronics" title="Electronics">Electronics</a>, <a href="MMBasic.AllPagesbcca.html?Cat=MMBasic.Environment" title="Environment">Environment</a>, <a href="MMBasic.AllPages9386.html?Cat=MMBasic.Hardware" title="Hardware">Hardware</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="f5b106ceb-6f85-4277-bf11-e294c7091364" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f5b106ceb-6f85-4277-bf11-e294c7091364');"></div><div id="f86670a60-d23b-4db3-9278-fbc171e1b11c" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f86670a60-d23b-4db3-9278-fbc171e1b11c');"></div><div id="fb5941bf9-03a5-4565-ae9c-b97bed6eb546" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fb5941bf9-03a5-4565-ae9c-b97bed6eb546');"><a href="MMBasic.MMUNIX-UNIX-like-commands-cat-dir-grep-more.html" title="MMUNIX - UNIX-like commands: cat dir grep more">MMUNIX - UNIX-like commands: cat dir grep more</a><a href="MMBasic.IsDate-and-IsTime-functions-VB-Work-A-Like.html" title="IsDate and IsTime functions (VB Work-A-Like)">IsDate and IsTime functions (VB Work-A-Like)</a></div><div id="s1284ba2b-302e-4f0e-9f0e-bcfcf0e346c0" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s1284ba2b-302e-4f0e-9f0e-bcfcf0e346c0');"></div><div id="s7423e02e-babe-4101-812a-098f2db44141" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s7423e02e-babe-4101-812a-098f2db44141');"></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.SHIFT-or-ROTATE-an-array-of-integers.html" title="SHIFT or ROTATE an array of integers (MMBasic)">SHIFT or ROTATE an array of integers (MMBasic)</a> &raquo; <a href="MMBasic.REVERSE-BAS-part-of-the-original-MMBasic-library.html" title="REVERSE.BAS (MMBasic)">REVERSE.BAS (MMBasic)</a> &raquo; <b><a href="MMBasic.Vehicle-Reversing-Assistant.html" title="Vehicle Reversing Assistant (MMBasic)">Vehicle Reversing Assistant (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="MMBasic.DigiClock-part-of-the-original-MMBasic-library.html" title="DCF77 DigiClock (MMBasic)">DCF77 DigiClock (MMBasic)</a> &raquo; <a href="MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library.html" title="Battery Capacity Test (MMBasic)">Battery Capacity Test (MMBasic)</a> &raquo; <a href="MMBasic.CSV-format-parsing-part-of-the-original-MMBasic-library.html" title="CSV format parsing (MMBasic)">CSV format parsing (MMBasic)</a> &raquo; <a href="MMBasic.Regular-Expression-Function.html" title="Regular Expression Function (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'fb5941bf9-03a5-4565-ae9c-b97bed6eb546', this);" id="lnkfb5941bf9-03a5-4565-ae9c-b97bed6eb546" onmouseout="javascript:return __HideDropDown('fb5941bf9-03a5-4565-ae9c-b97bed6eb546');">Regular Expression Function (MMBasic)</a> &raquo; <a href="MMBasic.CHECKER-BAS-part-of-the-original-MMBasic-library.html" title="CHECKER.BAS (MMBasic)">CHECKER.BAS (MMBasic)</a> &raquo; <a href="MMBasic.BMPSHOW-BAS-part-of-the-original-MMBasic-library.html" title="BMPSHOW.BAS (MMBasic)">BMPSHOW.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Deeply-Recursive-Ackermann-Function-with-Memoization.html" title="Deeply Recursive Ackermann Function with Memoization (MMBasic)">Deeply Recursive Ackermann Function with Memoization (MMBasic)</a> &raquo; <a href="MMBasic.SHIFT-or-ROTATE-an-array-of-integers.html" title="SHIFT or ROTATE an array of integers (MMBasic)">SHIFT or ROTATE an array of integers (MMBasic)</a> &raquo; <a href="MMBasic.REVERSE-BAS-part-of-the-original-MMBasic-library.html" title="REVERSE.BAS (MMBasic)">REVERSE.BAS (MMBasic)</a> &raquo; <b><a href="MMBasic.Vehicle-Reversing-Assistant.html" title="Vehicle Reversing Assistant (MMBasic)">Vehicle Reversing Assistant (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		The following is a tiny trinket to retro-fit your vehicle with reversing sensors (or fix a crappy Chinese kit) using waterproof 40KHz ultra-sound sensor modules available off eBay etc. for about £5. <br /><br />Be careful with buying these modules - there are two versions that I can find. One has a trigger and output pin so you can get a reading when you want it, the other type has a serial output and is free-running. The code below works with the former. I have found it very difficult to identify which is which before hand.<br /><br />The free-running type presents a problem because despite claims of anti-jamming, all these modules suffer from  picking up ultrasound pulses from neighbouring modules and will provide false readings. To illustrate, consider that you are some distance from an object and a pulse is initiated. A neighbouring module also sends a pulse shortly after but it "hears" the return from the first module - it can't tell this is not the reflection of its own pulse and now calculates a much shorter distance than reality. OK this is fail safe but it makes for a lot of false readings and generally results in a useless system - you have to be able to control when the pulses are sent and wait for any return. If the modules are free-running, it's chaos. If you want/have to use free-running ones, you are going to have to switch their power with a FET and give them time to die between readings or find the reset pin of the microcontroller and hold them in reset when not in use (and give them time to wake up after) - Do-able but a pain.<br /><br />There is a way to tell these modules apart, but you need them in front of you; if you apply power and the LED flickers constantly, it is free-running. These are fine for solitary use and give a serial output with the direct reading of the distance. If the LED gives a single flash, it is waiting to be triggered and these are the ones you can use in groups. Here are pictures of the two types - note there is a difference in the built-in microcontroller. You will have to source the appropriate modules. The pictures below might help you to find the right ones first time.<br /><br /><b>Triggered:</b><br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="40hkzImage103f3.png?File=/MMBasic/40hkzImage1.png" alt="Image" /><br /><br /><b>Free-running:</b><br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="40khzImage2eae5.png?File=/MMBasic/40khzImage2.png" alt="Image" /><br /><br />Confusingly the silk screen marks the pins on both types as Rx/Tx <i>and</i> Trig/Echo so no help there  :o(<br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="40KHzpinsa59b.jpg?File=/MMBasic/40KHzpins.jpg" alt="Image" /><br /><br />My particular situation has three sensors. The trigger and outputs of each sensor need to be connected to appropriate pins of your MicroMite.<br /><br />The code works by measuring all three sensors and then choosing the shortest distance. This is then compared to the timer and if the timer is greater then a beep is issued and the timer set to zero. The closer the object, the faster the beeps. There is a lock-up zone of 400mm - any closer than this and the sounder emits a continuous tone. This has the nice effect that the value for the timer changes in real time and any changes are reflected by the rapidity of the beeps fairly quickly. Also, because the time between beeps is the same number of milliseconds as millimeters from the nearest obstacle, you become accustomed to judging distance  - 1000mm means the beeps are a second apart. I have become quite good at judging distance with this.<br /><br />You need a 12V to 3.3V PSU and if you connect this to the supply to the reversing lights of your vehicle, the circuit starts beeping as you need it.<br /><br />Beeps are emitted via PWM1A but you can change this if you need. You will need to provide a suitable audio device - a piezo sounder with a FET driver at 12V is good.<br /><br /><b>Dependencies</b><br />Distance() CFunction - This is in the embedded modules section of the MMBasic distribution.<br /><br /><pre>
	CPU 48 'need to be fairly quick
	Option Base 0
	Option Baudrate 9600 'debug output is available to the console
	Option AutoRun On

	Const Ver=1.3
	Const LockDist=500'safe distance in mm
	Const Beeper=18

	'pins for trigger and return on the three distance sensors
	Dim Integer n,m,SP(5)=(14,15,16,17,21,22),SR(2)'SP is the pins for the Distance function for 28pin MM
	Dim Float x

	'Pin 18 is the beeper @5v OC output
	Setpin Beeper,DOUT,OC 'we are going to sink current from the beeper ~10mA
	'some beeps at start
	For n=1 to 2
		Pin(Beeper)=0&#58;Pause 50&#58;Pin(Beeper)=1&#58;Pause 50
	Next

	Pause 200

	Do
		WatchDog 2000
		
		Print "Sensor readings..."
		For n=0 To 5 Step 2'three pairs of pins
		
			x=Distance(SP(n),SP(n+1)) 

			Select Case x
				Case (0-2)
					m=-2'sensor failure (-2) - beep out the sensor number as long beep, then up to 3 short beeps
					Pin(Beeper)=0&#58;Pause 500&#58;Pin(Beeper)=1
					pause 500
					for m=1 To (n/2)+1
						Pin(Beeper)=0&#58;Pause 250&#58;Pin(Beeper)=1
						Pause 250
					Next
				Case (0-1)
					m=3000 'no obstruction so default to 3m
				Case Else
					m=10&#42;Distance(SP(n),SP(n+1)) 'mm
			End Select
			Print x;m,
			SR(n\2)=m					
			
		Next
		n=Min(SR(0),SR(1),SR(2))'choose closest reading will beep constantly if a sensor failure (-2)
		Print "min=";n;"mm"


		If n&lt;LockDist Then'&lt; safe distance then lockup
			if n&gt;0 then Pin(Beeper)=0'constant tone but not if an error exists
		ElseIf Timer&gt;=Max(n-LockDist,0) Then'otherwise beep
			Pin(Beeper)=0&#58;Pause 250&#58;Pin(Beeper)=1'fixed length beeps
			Timer=0
		EndIf
		Pause 90
	Loop

	Print "Broken out of main thread, Forcing watchdog restart."
	Do&#58;loop

	CFunction DISTANCE(integer, integer) float
		0000002D 27BDFFF8 AFBF0004 00852023 03E42021 ACC40000 8FBF0004 03E00008
		27BD0008 27BDFFE0 AFBF001C 00002021 3C059D00 24A50040 27A60010 0411FFF1
		00000000 8FA30010 3C029D00 8C4200BC 3C049D00 24840310 0040F809 00832021
		8FBF001C 03E00008 27BD0020 000410C0 00041A00 00621823 00031180 00431823
		00641821 00031980 3C029D00 8C420000 3C047735 34849400 8C420000 0082001B
		004001F4 00002012 0064001B 008001F4 03E00008 00001012
		27BDFFD8 AFBF0024 AFB40020 AFB3001C AFB20018 AFB10014 AFB00010 00809021
		3C029D00 8C420000 8C430000 3C020098 34429680 0062102B 10400003 00A08821
		0411FFCA 00000000 8E220000 14400003 3C109D00 8E420000 AE220000 8E020010
		8E240000 24050002 0040F809 2406000E 8E02001C 8E440000 0040F809 24050005
		8E020010 8E440000 24050008 0040F809 00003021 8E02001C 8E440000 0040F809
		24050006 8E020004 0040F809 24040014 8E02001C 8E440000 0040F809 24050005
		8E020004 0040F809 24040032 8E020010 8E240000 24050002 0040F809 2406000E
		8E020004 0040F809 24040032 0411FFB1 24040005 00409821 0000A021 40944800
		00008021 10000005 3C129D00 40104800 0270102B 1440001E 24050002 8E420020
		0040F809 8E240000 1440FFF8 24040064 10000025 00000000 40104800 0270102B
		14400013 24050002 8E420020 0040F809 8E240000 1040FFF8 24040020 1000001F
		00000000 40104800 0270102B 14400008 24050001 8E420020 0040F809 8E240000
		1440FFF8 00000000 1000001A 3C119D00 00052823 3C029D00 8C420080 00A02021
		0040F809 00052FC3 8FBF0024 8FB40020 8FB3001C 8FB20018 8FB10014 8FB00010
		03E00008 27BD0028 0411FF7A 00000000 00409821 1000FFDC 3C129D00 0411FF75
		00000000 00409821 40944800 1000FFE1 3C129D00 8E320064 8E220000 3C037735
		34639400 8C420000 0062001B 004001F4 00001012 72028002 24021696 0202001B
		004001F4 00002012 8E220080 0040F809 00002821 00408021 8E220080 2404000A
		0040F809 00002821 02002021 0240F809 00402821 1000FFD5 8FBF0024
		20555043 65657073 6F742064 6F6C206F 000A0D77
	End CFunction
</pre><br />
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		
    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Vehicle-Reversing-Assistant.ashx?HL=mmbasic by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 14:29:49 GMT -->
</html>
