

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.ZPad-pad-a-number-with-leading-zeroes by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:25:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	ZPad$() - pad a number with leading zeroes - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.ZPad-pad-a-number-with-leading-zeroes" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFgBk8aDEgY2xhc3M9InBhZ2V0aXRsZSI+WlBhZCQoKSAtIHBhZCBhIG51bWJlciB3aXRoIGxlYWRpbmcgemVyb2VzPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAyMS8xMS8yOCAxMDowMiBieSBBZG1pbmlzdHJhdG9yICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IFByaW50ZXJzIGFuZCBQcmludGluZywgU3RyaW5nczwvc21hbGw+PGJyIC8+PGJyIC8+U29tZSB0aW1lIGl0IGlzIG5pY2UgdG8gaGF2ZSBsZWFkaW5nIHplcm9lcyBvbiBhIG51bWJlci4gTU1CYXNpYyBoZWxwZnVsbHkgcmVtb3ZlcyB0aGVzZSBmb3IgeW91IHdoaWNoIG1lYW5zIHRvIGhhdmUgdGhlbSwgdGhlIG51bWJlciBtdXN0IGJlIHJldHVybmVkIGFzIGEgc3RyaW5nLjxiciAvPjxiciAvPlN0ciQgaW4gTU1CYXNpYyBpcyBkZWNlcHRpdmVseSBwb3dlcmZ1bCBhbmQgZ29lcyBzb21lIHdheSB0byByZXBsYWNpbmcgdGhlIG1pc3NpbmcgKG9uIE1pY3JvbWl0ZXMgYXQgbGVhc3QpIEZPUk1BVCQgYW5kIFVTSU5HLiBJdCBjYW4gYmUgdHJpY2t5IHRvIGdldCB5b3VyIGhlYWQgcm91bmQgdGhlIGZ1bmN0aW9uYWxpdHkgc28gdGhpbmsgb2YgdGhpcyBmdW5jdGlvbiBhcyBhIHdyYXBwZXIgZm9yIGEgc3BlY2lmaWMgZm9ybS48YnIgLz48YnIgLz5UaGlzIHRpZGRseSBGdW5jdGlvbiByZXR1cm5zIGEgc3RyaW5nIG9mIHRoZSBpbnRlZ2VyIHZhbHVlIHgsIHBhZGRlZCB0byAoYXQgbGVhc3QpIGxlbmd0aCB5IHdpdGggbGVhZGluZyB6ZXJvZXMuIEkgc2F5IGF0IGxlYXN0IGJlY2F1c2UgaWYgeCBhbHJlYWR5IGV4Y2VlZHMgeSB0aGVuIG5vdGhpbmcgaXMgYWRkZWQuPGJyIC8+PGJyIC8+VGhpcyBpcyBhIG5ld2VyIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjsgaXQgaXMgYmV0dGVyIGFzIGl0IHVzZXMgaW5idWlsdCAicHJpbWl0aXZlIiBmdW5jdGlvbmFsaXR5IHRvIGRvIHRoZSBwYWRkaW5nIHJhdGhlciB0aGFuICJyZS1pbnZlbnRpbmcgdGhlIHdoZWVsIiBieSBzdHJpbmcgc2xpY2luZy4gQ29uc2VxdWVudGx5IGl0IGlzIHZlcnkgbWFyZ2luYWxseSBmYXN0ZXIgLSByb3VnaCB0ZXN0cyBzZWVtIHRvIGluZGljYXRlIGEgMTYlIGltcHJvdmVtZW50IGluIHNwZWVkLiBJdCBhbHNvIGVsaW1pbmF0ZXMgdGhlIHBvdGVudGlhbCByZXN0cmljdGlvbiBvZiAxMjcgY2hhcmFjdGVycyBvbiB0aGUgZGVzaXJlZCBzdHJpbmcuPGJyIC8+PGJyIC8+SWYgdGhlIHN0cmluZyB2ZXJzaW9uIG9mIHRoZSBhcmd1bWVudCBhbHJlYWR5IGV4Y2VlZHMgdGhlIGRlc2lyZWQgbGVuZ3RoLCB0aGUgb3JpZ2luYWwgbnVtYmVyIGlzIHJldHVybmVkIC0gZS5nLiBpZiB5b3UgYXNrIGZvciAxMDAwIHRvIGJlIHBhZGRlZCB0byAzIGRpZ2l0cy48YnIgLz48YnIgLz48Yj5TeW50YXg8L2I+OjxiciAvPj1aUGFkJChudW1iZXIsdG90YWxOdW1EaWdpdHMpPGJyIC8+PGJyIC8+PGI+RXhhbXBsZTwvYj46PGJyIC8+UHJpbnQgWlBhZCQoNywzKScgcmV0dXJucyAiMDA3IjxiciAvPjxiciAvPjxiPkNvZGU8L2I+OjxiciAvPjxwcmU+DQogIEZ1bmN0aW9uIFpQYWQkKHggQXMgSW50ZWdlcix5IEFzIEludGVnZXIpDQogICAgWlBhZCQ9U3RyJCh4LHksMCwiMCIpDQogIEVuZCBGdW5jdGlvbg0KPC9wcmU+PGJyIC8+PGI+U2VlIEFsc288L2I+PGJyIC8+PGEgY2xhc3M9InBhZ2VsaW5rIiBocmVmPSJNTUJhc2ljLnVGb3JtYXQtYW5kLVN0ckUtcHJvdmlkZS1mbGV4aWJsZS1mb3JtYXR0aW5nLW9mLW51bWVyaWMtdmFsdWVzLmFzaHgiIHRpdGxlPSJ1Rm9ybWF0JCgpIGFuZCBTdHJFJCgpIHByb3ZpZGUgZmxleGlibGUgZm9ybWF0dGluZyBvZiBudW1lcmljIHZhbHVlcyI+dUZvcm1hdCQoKSBhbmQgU3RyRSQoKSBwcm92aWRlIGZsZXhpYmxlIGZvcm1hdHRpbmcgb2YgbnVtZXJpYyB2YWx1ZXM8L2E+PGJyIC8+PGJyIC8+PGI+SG9sZCB5b3VyIGhvcnNlcyEgQSBOb3RlIG9uIFN0ciQoKTo8L2I+IFlvdSBzaG91bGQgcHJvYmFibHkgdXNlIFN0ciQgYXMgYSBzdGFuZC1hbG9uZSBhbmQgbm90IFpQYWQkKCkgd2hlcmUtZXZlciBuZWVkZWQgaW4geW91ciBwcm9ncmFtLiBTdHIkIGNhbiBiZSBhIGJpdCBkaWZmaWN1bHQgdG8gZ2V0IHRvIGdyaXBzIHdpdGgsIGJ1dCBsZWFybmluZyB0byB1c2UgaXQgcHJvcGVybHkgaXMgYSBtdWNoIGJldHRlciB3YXkgYW5kIGJldHRlciB1bmRlcnN0YW5kaW5nIGxlYWRzIHRvIGJldHRlciBwcm9ncmFtcy4gWlBhZCQoKSBhc3N1bWVzIHlvdSBvbmx5IHdhbnQgdG8gcGFkIHdpdGggemVyb2VzLiBUaGUgb3ZlcmhlYWQgb2YgY2FsbGluZyB0aGlzIGFzIGEgZnVuY3Rpb24gaXMgYWxzbyB1bmRlc2lyYWJsZSAtIGEgbG9vcCBvZiAxMDAwIGl0ZXJhdGlvbnMgYXQgNDhNSHogdGFrZXMgNDkybVMgdXNpbmcgWlBhZCQoKSwgdGhlIHNhbWUgdXNpbmcgU3RyJCBleHBsaWNpdGx5IHRha2VzIDE3N21TIC0gdHdvLWFuZC1hLWhhbGYgdGltZXMgcXVpY2tlciB3aXRoIGEgc21hbGxlciBjb2RlIGZvb3RwcmludC48YnIgLz48YnIgLz5UaGF0IHNhaWQsIFN0ciQgbWFrZXMgKHJlYXNvbmFibGUpIGFzc3VtcHRpb25zIHRvby4gU3VwcG9zZSBvbmUgd2hlcmUgdHJ5aW5nIHRvIHBhZCB0aGUgcmlnaHQgb2YgYSBzdHJpbmcuIENvbnNpZGVyIHRoZSBmb2xsb3dpbmc6PGJyIC8+PHByZT5QcmludCBTdHIkKDUzLDQsNCwiJiM0MjsiKTwvcHJlPjxiciAvPnlvdSBtaWdodCBleHBlY3QgdGhlIHN0cmluZzxiciAvPjxjb2RlPioqNTMuKioqKjwvY29kZT48YnIgLz5idXQgdGhlIHBhZCBjaGFyYWN0ZXIgKCopIGlzIGlnbm9yZWQgZm9yIHRoZSB0aGlyZCBhcmd1bWVudCAoZGlnaXRzIGFmdGVyIHRoZSBkZWNpbWFsIHBvaW50KSBhbmQgemVybyBpcyBtYW5kYXRlZC48YnIgLz48Y29kZT4qKjUzLjAwMDA8L2NvZGU+PGJyIC8+PGJyIC8+SWYgeW91IHdlcmUgdHJ5aW5nIHRvIGVtdWxhdGUgdGhlIGFjdGlvbiBvZiB0aGUgb2xkIExTZXQgYW5kIFJTZXQgc3RhdGVtZW50cyBvZiBNaWNyb1NvZnQgQmFzaWNzIChpZ25vcmluZyB0aGF0IFN0ciQgb25seSB3b3JrcyB3aXRoIGZsb2F0cyBhbmQgaW50ZWdlcnMpLCB5b3UnZCBzdGlsbCBuZWVkIHRvIHdyaXRlIGEgZnVuY3Rpb24gc2ltaWxhciB0byB0aGUgb2xkIHZlcnNpb24gb2YgWlBhZCQoKSB0byBnZXQgTFNldC4gU3RyJCBjYW4gZG8gUlNldCBvbiBpdCdzIG93biBidXQgbm90IExTZXQgZHVlIHRvIHRoZSBhYm92ZSBtYW5kYXRvcnkgMCBwYWRkaW5nLmRkcZvgAkdlx+f33Fru3K9hmcj+pQQ=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">ZPad$() - pad a number with leading zeroes</h1><small>Modified on 2021/11/28 10:02 by Administrator &mdash; Categorized as: Printers and Printing, Strings</small><br /><br />Some time it is nice to have leading zeroes on a number. MMBasic helpfully removes these for you which means to have them, the number must be returned as a string.<br /><br />Str$ in MMBasic is deceptively powerful and goes some way to replacing the missing (on Micromites at least) FORMAT$ and USING. It can be tricky to get your head round the functionality so think of this function as a wrapper for a specific form.<br /><br />This tiddly Function returns a string of the integer value x, padded to (at least) length y with leading zeroes. I say at least because if x already exceeds y then nothing is added.<br /><br />This is a newer version of this function; it is better as it uses inbuilt "primitive" functionality to do the padding rather than "re-inventing the wheel" by string slicing. Consequently it is very marginally faster - rough tests seem to indicate a 16% improvement in speed. It also eliminates the potential restriction of 127 characters on the desired string.<br /><br />If the string version of the argument already exceeds the desired length, the original number is returned - e.g. if you ask for 1000 to be padded to 3 digits.<br /><br /><b>Syntax</b>:<br />=ZPad$(number,totalNumDigits)<br /><br /><b>Example</b>:<br />Print ZPad$(7,3)' returns "007"<br /><br /><b>Code</b>:<br /><pre>
  Function ZPad$(x As Integer,y As Integer)
    ZPad$=Str$(x,y,0,"0")
  End Function
</pre><br /><b>See Also</b><br /><a class="pagelink" href="MMBasic.uFormat-and-StrE-provide-flexible-formatting-of-numeric-values.html" title="uFormat$() and StrE$() provide flexible formatting of numeric values">uFormat$() and StrE$() provide flexible formatting of numeric values</a><br /><br /><b>Hold your horses! A Note on Str$():</b> You should probably use Str$ as a stand-alone and not ZPad$() where-ever needed in your program. Str$ can be a bit difficult to get to grips with, but learning to use it properly is a much better way and better understanding leads to better programs. ZPad$() assumes you only want to pad with zeroes. The overhead of calling this as a function is also undesirable - a loop of 1000 iterations at 48MHz takes 492mS using ZPad$(), the same using Str$ explicitly takes 177mS - two-and-a-half times quicker with a smaller code footprint.<br /><br />That said, Str$ makes (reasonable) assumptions too. Suppose one where trying to pad the right of a string. Consider the following:<br /><pre>Print Str$(53,4,4,"&#42;")</pre><br />you might expect the string<br /><code>**53.****</code><br />but the pad character (*) is ignored for the third argument (digits after the decimal point) and zero is mandated.<br /><code>**53.0000</code><br /><br />If you were trying to emulate the action of the old LSet and RSet statements of MicroSoft Basics (ignoring that Str$ only works with floats and integers), you'd still need to write a function similar to the old version of ZPad$() to get LSet. Str$ can do RSet on it's own but not LSet due to the above mandatory 0 padding.
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.ZPad-pad-a-number-with-leading-zeroes by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:25:52 GMT -->
</html>
