

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.RENUM-BAS-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	RENUM.BAS - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.RENUM-BAS-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF0lw8aDEgY2xhc3M9InBhZ2V0aXRsZSI+UkVOVU0uQkFTPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxNi8xMi8yMyAyMzozNyBieSBBZG1pbmlzdHJhdG9yICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEFycmF5cywgUHJvZ3JhbSBGbG93LCBQcm9ncmFtIE1hbmFnZW1lbnQsIFN0cmluZ3MsIF9MSUIgT3JpZ2luYWwgTU1CYXNpYzwvc21hbGw+PGJyIC8+PGJyIC8+PGgyIGNsYXNzPSJzZXBhcmF0b3IiPlRoaXMgbW9kdWxlIGlzIHBhcnQgb2YgdGhlIG9yaWdpbmFsIE1NQmFzaWMgbGlicmFyeS4gSXQgaXMgcmVwcm9kdWNlZCBoZXJlIHdpdGgga2luZCBwZXJtaXNzaW9uIG9mIEh1Z2ggQnVja2xlIGFuZCBHZW9mZiBHcmFoYW0uIEJlIGF3YXJlIGl0IG1heSByZWZlcmVuY2UgZnVuY3Rpb25hbGl0eSB3aGljaCBoYXMgY2hhbmdlZCBvciBpcyBkZXByZWNhdGVkIGluIHRoZSBsYXRlc3QgdmVyc2lvbnMgb2YgTU1CYXNpYy48YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiBocmVmPSIjVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMj48Yj5Ob3RlPC9iPjogQW55IHJlcXVpcmVkIGZpbGUocykgYXJlIGF2YWlsYWJsZSBpbiB0aGUgYXR0YWNobWVudHMgdGFiICh0b3AgcmlnaHQpLjxiciAvPjxiciAvPlJFTlVNLkJBUzxiciAvPjxiciAvPlJFTlVNLkJBUyBpcyB3cml0dGVuIGluIE1NQmFzaWMgYW5kIHJlcXVpcmVzIGF0IGxlYXN0IHZlcnNpb24gNC4zYS48YnIgLz48YnIgLz5SZW51bS5iYXMgcmVudW1iZXJzIGJhc2ljIGZpbGVzLCB0aGUgc2FtZSB3YXkgdGhlIFJFTlVNQkVSIGNvbW1hbmQgdXNlZCB0byB3b3JrIGluIHZlcnNpb24gb2YgTU1CYXNpYyBwcmlvciB0byBWZXJzaW9uIDQuM2EsIGFuZCB0aGUgUkVOVU1CRVIuQkFTIGZpbGUgaW4gdGhlIGxpYnJhcnkgdXNlZCB0byB3b3JrLiBUaGUgUkVOVU1CRVIgY29tbWFuZCBoYXMgYmVlbiByZW1vdmVkIGZyb20gTU1CYXNpYyBhbmQgdGhlIG9sZCBwcm9ncmFtIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgbGlicmFyeS48YnIgLz48YnIgLz5CZWNhdXNlIG9mIHRoZSBsZW5ndGggb2YgdGhlIHByb2dyYW0gKGFyb3VuZCAxOTAwIGxpbmVzKSBpdCBpcyBtb2R1bGFyaXNlZCAoPGI+TW9kdWxlcyBhcmUgaW4gdGhlIGF0dGFjaG1lbnRzIHRhYiwgdG9wIHJpZ2h0PC9iPikgYW5kIHVzZXMgdGhlIENoYWluIGNvbW1hbmQgdGhhdCB3YXMgaW50cm9kdWNlZCBpbiBNTUJhc2ljIDQuMy4gQ09ORklHLkJBUywgdGhlIHNlY29uZCBtb2R1bGUsIGNoYWlucyBiYWNrIHRvIHRoZSBwcm9ncmFtIGhlbGQgaW4gdmFyaWFibGUgTWFzdGVyRmlsZSQuIElmIHlvdSB1c2UgQ09ORklHLkJBUyBmb3IgeW91ciBvd24gcHJvZ3JhbXMgcmVtZW1iZXIgdG8gc2V0IHRoaXMgdmFyaWFibGUgLSBvciBjaGFuZ2UgdGhlIGNvZGUgdG8gc3VpdCB5b3VyIG5lZWRzLjxiciAvPjxiciAvPlRoZSBwcm9ncmFtIGhhcyBzb21lIGVuaGFuY2VtZW50cyBjb21wYXJlZCB3aXRoIHRoZSBvbGRlciB2ZXJzaW9ucy48YnIgLz4tIGEgbGluZSBvdXQtb2Ytb3JkZXIgY2hlY2suIEEgcHJpb3JpdHksIGJlY2F1c2Ugb3V0LW9mLW9yZGVyIGxpbmVzIGNhdXNlZCBhbiBlbWJhcmFzc2luZyBidWcgZm9yIG1lIGEgd2hpbGUgYmFjazs8YnIgLz4tIGl0IGlnbm9yZXMgcG90ZW50aWFsIGxhYmVscyBhbmQgbGluZSBudW1iZXJzIGlmIHRoZXkgYXJlIHdpdGhpbiByZW1hcmtzIG9yIHByaW50IHN0YXRlbWVudHM7PGJyIC8+LSBpdCBhdHRlbXB0cyB0byBpbmRlbnQgYmFzZWQgb24gdGhlIGxlbmd0aCBvZiB0aGUgbG9uZ2VzdCBsaW5lIG51bWJlciAoYnV0IHNlZSBwcm9ibGVtcyBiZWxvdyk7PGJyIC8+LSBpdCBoYXMgb3B0aW9ucyB0byBpbmNyZW1lbnQgdGhlIGxpbmUgbnVtYmVycywgZXZlbiBpZiB0aGUgbGluZSBudW1iZXIgaXMgYmxhbmssIGFuZCB0byBhZGQgbGluZSBudW1iZXJzIHRvIGJsYW5rIGxpbmVzOzxiciAvPi0gaXQgaGFzIHNvbWUgZXh0cmEgdmFsaWRhdGlvbiBjaGVja3M7PGJyIC8+LSBpdCBzdG9yZXMgeW91ciBwcmVmZXJyZWQgdmFsdWVzIGluIGEgY29uZmlndXJhdGlvbiBmaWxlLjxiciAvPjxiciAvPkl0IGFsc28gaGFzIHByb2JsZW1zLjxiciAvPi0gSXQgaGFzIG1lYW5pbmdmdWwgY29tbWVudHMgaW4gdGhlIGNvZGUsIHNvIGl0J3MgYmlnLjxiciAvPi0gaXQgY2FuJ3QgcHJvcGVybHkgZm9ybWF0IHByb2dyYW1zIHRoYXQgc3RhcnQgb2ZmIHdpdGggYmFkIGZvcm1hdHRpbmcsIGVzcGVjaWFsbHkgaWYgdGhlcmUncyBhIG1peCBvZiBjb2RlIHdpdGggYW5kIHdpdGhvdXQgbGluZSBudW1iZXJzLjxiciAvPi0gaXQgdXNlcyBhIGxvdCBvZiBtZW1vcnkuIFRvIGNvdW50ZXIgdGhpcyB0aGVyZSBpcyBhIGNoZWNrIGF0IHRoZSBiZWdpbm5pbmcgb2YgUkVOVU0uQkFTIHRvIHN3aXRjaCBjb2xvdXIgTU1zIHRvIE1vZGUgMSB0byBjb25zZXJ2ZSBtZW1vcnkuIFRoZSBjb2RlIGFsc28gcmVsZWFzZXMgbWVtb3J5IGFmdGVyIHVzZSB3aGVyZSBwb3NzaWJsZS48YnIgLz4tIHRoZXJlIGlzIGEgbG90IG9mIGRlYnVnIGNvZGUgc3RpbGwgaW4gdGhlIHByb2dyYW0uIFRoZXJlJ3MgYW4gZW50cnkgaW4gdGhlIHJlbnVtLmNmZyBmaWxlIHRoYXQgdHVybnMgaXQgb24gYW5kIG9mZi4gSWYgeW91IGZpbmQgbGluZSBudW1iZXJzIGluIHlvdXIgY29kZSAoaWUsIG5vdCB0aG9zZSBvbmVzIGF0IHRoZSBzdGFydCBvZiB0aGUgbGluZSkgd2l0aCBsZWFkaW5nIGFzdHJpc2tzLCB5b3UgaGF2ZSBkZWJ1ZyBlbmFibGVkLiBFZGl0IHRoZSBjb25maWcgZmlsZSBhbmQgc2V0IGJEZWJ1ZyB0byBGQUxTRS4gSSdsbCByZW1vdmUgdGhlIGRlYnVnIGNvZGUgb25jZSBJIGtub3cgdGhlIHByb2dyYW0gd29ya3Mgd2VsbCBpbiB0aGUgJ3JlYWwgd29ybGQnLjxiciAvPi0gVGhlIGlucHV0IGFuZCBvdXRwdXQgZmlsZW5hbWVzIG11c3QgYmUgZGlmZmVyZW50LiBPbmNlIEkga25vdyB0aGUgcHJvZ3JhbSB3b3JrcyByZWxpYWJseSBJJ2xsIGFkZCB0aGUgMyBvciA0IGxpbmVzIG5lZWRlZCB0byBjbG9zZSB0aGUgaW5wdXQgZmlsZSwgcmVuYW1lIHRoZSBvcmlnaW5hbCB0byBhIC5iYWsgZmlsZSwgdGhlbiByZW5hbWUgdGhlIG91dHB1dCBmaWxlIHRvIHRoZSBvcmlnaW5hbCBmaWxlbmFtZS48YnIgLz48YnIgLz5IT1cgVE8gUlVOIFRIRSBQUk9HUkFNPGJyIC8+WW91IGNhbiBydW4gUkVOVU1CRVIuQkFTIGZyb20gdGhlIE1NQmFzaWMgcHJvbXB0IHdpdGggbm8gcGFyYW1ldGVycy48YnIgLz5JdCBwcm9tcHRzIGZvcjo8YnIgLz4xKSBUaGUgbmFtZSBvZiB0aGUgcHJvZ3JhbSB0byBiZSByZW51bWJlcmVkLiBUaGUgLmJhcyBleHRlbnNpb24gaXMgb3B0aW9uYWwuPGJyIC8+MikgVGhlIG5hbWUgb2YgdGhlIG91dHB1dCBmaWxlLiBBZ2FpbiwgLmJhcyBpcyBvcHRpb25hbC4gSXQgY2Fubm90IGJlIHRoZSBzYW1lIGFzIHRoZSBpbnB1dCBmaWxlLjxiciAvPjMpIFRoZSBzdGFydCBsaW5lIG51bWJlciBpbiB0aGUgYmFzaWMgcHJvZ3JhbSB3aGVyZSB5b3Ugd2FudCB0byBzdGFydCByZW51bWJlcmluZy48YnIgLz40KSBUaGUgZmlyc3QgbGluZSBudW1iZXIgaW4gdGhlIG91dHB1dCBmaWxlLjxiciAvPjUpIFRoZSBpbmNyZW1lbnQgeW91IHdhbnQgYmV0d2VlbiBsaW5lIG51bWJlcnMuPGJyIC8+PGJyIC8+SXQgdGhlbiBwcm9tcHRzIGZvciB3aGV0aGVyIHlvdSB3YW50IHRvIHB1dCBsaW5lIG51bWJlcnMgb24gdGhvc2UgbGluZXMgdGhhdCBkbyBub3QgaGF2ZSB0aGVtLCBvciwgaWYgeW91IGRvbid0IHdhbnQgdG8gZG8gdGhhdCwgd2hldGhlciB5b3Ugd2FudCB0byBpbmNyZW1lbnQgdGhlIGxpbmUgbnVtYmVyIGNvdW50ZXIgb3ZlciB0aG9zZSBsaW5lcyB3aXRob3V0IGxpbmUgbnVtYmVycy48YnIgLz48YnIgLz5Gb3IgZXhhbXBsZSwgY29uc2lkZXIgYSBmaWxlIHdpdGggYSBtaXggb2YgbGluZXMgd2l0aCBhbmQgd2l0aG91dCBsaW5lIG51bWJlcnM6PGJyIC8+MTAgbGluZSAxPGJyIC8+MjAgbGluZSAyPGJyIC8+ICBsaW5lIDMgd2l0aCBubyBsaW5lIG51bWJlcjxiciAvPiAgbGluZSA0IHdpdGggbm8gbGluZSBudW1iZXI8YnIgLz4xMjAgRU5EPGJyIC8+PGJyIC8+SWYgeW91IGNob29zZSB0byBwdXQgbGluZSBudW1iZXJzIG9uIHRob3NlIHdpdGhvdXQgdGhlbSwgeW91IHdpbGwgZ2V0PGJyIC8+MTAgbGluZSAxPGJyIC8+MjAgbGluZSAyPGJyIC8+MzAgbGluZSAzIHdpdGggbm8gbGluZSBudW1iZXI8YnIgLz40MCBsaW5lIDQgd2l0aCBubyBsaW5lIG51bWJlcjxiciAvPjUwIEVORDxiciAvPjxiciAvPklmIHlvdSBhbnN3ZXIgIk4iIHRvIHRoZSBvcHRpb24gYWJvdmUsIHlvdSBhcmUgcHJvbXB0ZWQgYXMgdG8gd2hldGhlciB0aGUgbGluZSBudW1iZXJpbmcgc2hvdWxkIGluY3JlbWVudCB3aGVuIHRoZSBwcm9ncmFtIGZpbmRzIGEgbGluZXMgd2l0aG91dCBsaW5lIG51bWJlcnMuIElmIHlvdSBhbnN3ZXIgIlkiIHlvdSBnZXQ8YnIgLz4xMCBsaW5lIDE8YnIgLz4yMCBsaW5lIDI8YnIgLz4gIGxpbmUgMyB3aXRoIG5vIGxpbmUgbnVtYmVyPGJyIC8+ICBsaW5lIDQgd2l0aCBubyBsaW5lIG51bWJlcjxiciAvPjUwIEVORDxiciAvPjxiciAvPklmIHlvdSBhbnN3ZXIgIk4iLCB5b3UgZ2V0PGJyIC8+MTAgbGluZSAxPGJyIC8+MjAgbGluZSAyPGJyIC8+ICBsaW5lIDMgd2l0aCBubyBsaW5lIG51bWJlcjxiciAvPiAgbGluZSA0IHdpdGggbm8gbGluZSBudW1iZXI8YnIgLz4zMCBFTkQ8YnIgLz48YnIgLz5GaW5hbGx5LCBpdCBwcm9tcHRzIHdoZXRoZXIgeW91IHdhbnQgdG8gdXNlIHRoZSBGT1JNQVQuQkFTIHByb2dyYW0uIElmIHlvdSBkbywgaXQgcHJvbXB0cyBmb3I6PGJyIC8+MSkgdGhlIGluZGVudCAoYWNjZXB0cyAxIHRvIDYsIHdpdGggYSBkZWZhdWx0IG9mIDIpLjxiciAvPjIpIHdoZXRoZXIgdGhlIGZvcm1hdCBzaG91bGQgZGlzcGxheSB0aGUgZm9ybWF0dGVkIHByb2dyYW0gb24gdGhlIHNjcmVlbiwgYSBzY3JlZW4gYXQgYSB0aW1lLCBhcyBpdCBpcyBwcm9jZXNzZWQuPGJyIC8+PGJyIC8+WW91ciBhbnN3ZXJzIGFyZSBzYXZlZCBpbnRvIGEgY29uZmlndXJhdGlvbiBmaWxlIGNhbGxlZCByZW51bWJlci5jZmcuIFRoZSBwcm9ncmFtIGluaXRpYWxseSBhc2tzIGlmIHlvdSB3YW50IHRvIHVzZSB0aGUgc2FtZSBhbnN3ZXJzIGFzIHRoZSBsYXN0IHRpbWUgdGhlIHByb2dyYW0gd2FzIHJ1bi4gSWYgeW91IGFuc3dlciAieSIgdGhlIHZhbHVlcyBhcmUgbG9hZGVkIGZyb20gdGhlIGNvbmZpZ3VyYXRpb24gZmlsZS48YnIgLz48YnIgLz5UaGUgcmVudW1iZXJlZCBwcm9ncmFtIGlzIHdyaXR0ZW4gdG8gdGhlIG91dHB1dCBmaWxlLjxiciAvPjxiciAvPllvdSBjYW4gYWxzbyBwYXNzIHBhcmFtZXRlcnMgb24gdGhlIGNvbW1hbmQgbGluZSBpZiB5b3UgdXNlIHRoZSBNTUJhc2ljIEltcGxpZWQgUnVuIGZvcm1hdC4gVHlwZSBSRU5VTUJFUiAvPyBmb3IgYSBsaXN0IG9mIHRoZSBvcHRpb25zLjxiciAvPk5vdGU6IGlmIHlvdSB1c2UgdGhlIE1NQmFzaWMgSW1wbGllZCBSdW4gZm9ybWF0LCB5b3UgY2FuIHVzZSB0aGUgdW5kb2N1bWVudGVkIC9EIHBhcmFtZXRlciB0byB0b2dnbGUgZGVidWcgbW9kZS48YnIgLz48YnIgLz5QUk9HUkFNTUlORyBERUNJU0lPTlM8YnIgLz5JIHBsYW5uZWQgdG8gb2ZmZXIgYW4gb3B0aW9uIHRvIGFsaWduIHRoZSBzdGFydCBvZiBsaW5lcyB3aXRoIHRoZSBlbmQgb2YgdGhlIGxvbmdlc3QgbGFiZWwgKGFzIGl0IGN1cnJlbnRseSBkb2VzIHdpdGggbGluZSBudW1iZXJzKSwgYnV0IGRlY2lkZWQgbm90IHRvIGJlY2F1c2UgbWFueSBwcm9ncmFtbWVycyBoYXZlIHRoZSBsYWJlbCBvbiBhIHNlcGFyYXRlIGxpbmUgd2l0aCBubyBjb2RlIGZvbGxvd2luZywgYW5kIGFsaWduaW5nIHRvIHRob3NlIGxhYmVscyB3b3VsZCBub3QgYWRkIG11Y2ggdG8gdGhlIGNvZGUgbGF5b3V0LCBidXQgd291bGQgd2FzdGUgdmFsdWFibGUgc3BhY2Ugb24gdGhlIExIUyBvZiB0aGUgc2NyZWVuLjxiciAvPjxiciAvPkkgd2FzIHRyeWluZyB0byBnZXQgbGluZSBmb3JtYXR0aW5nIHBlcmZlY3QgYnV0IHRoYXQgd291bGQgaGF2ZSBuZWVkZWQgY29kZSBhbmFseXNpcyB0byBnZXQgdGhlIGluZGVudCByaWdodC4gSSBoYWQgdHJpZWQgdG8gcmVwbGljYXRlIHRoZSBpbmRlbnRpbmcgaW4gdGhlIG9yaWdpbmFsIGNvZGUsIGJ1dCBpdCB3YXMgdG9vIGNvbXBsZXggLSBlc3BlY2lhbGx5IGlmIGxpbmVkIGFuZCB1bmxpbmVkIGNvZGUgd2VyZSBtaXhlZCBhbmQgc3RhcnRlZCBpbiBkaWZmZXJlbnQgY29sdW1ucy4gSSdsbCBsZWF2ZSB0aGF0IHVwIHRvIEh1Z2gncyBGT1JNQVQgcHJvZ3JhbS48YnIgLz48YnIgLz5JIGRlY2lkZWQgbm90IHRvIGNvZGUgYW4gb3B0aW9uIHRvIHN0cmlwIG91dCBhbGwgbGluZW51bWJlcnMgdGhhdCB3ZXJlbid0IGEgdGFyZ2V0IChlZyBHT1RPIHRhcmdldCkuIElmIGFueW9uZSBkZWNpZGVzIHRvIGltcGxlbWVudCBpdCwgSSBtYWRlIHRoZSAnbGluZXMnIGFycmF5IDMgZGltZW5zaW9uYWwgYW5kIHRhZ2dlZCBhbnkgbGluZXMgdGhhdCB3ZXJlIHRhcmdldHMgKGllIGZvbGxvdyBhIEdPVE8sIEdPU1VCIGV0Yy4pIGluIHBhc3MgMi4gWW91IHdvdWxkIGhhdmUgdG8gbW92ZSB0aGlzIGNoZWNrIHRvIHBhc3MgMSAobm90IHRyaXZpYWwpIG9yIG1ha2UgYSB0aGlyZCBwYXNzIGFuZCByZXByb2Nlc3MgdGhlIGlucHV0IGZpbGUgb25jZSB0aGUgc2Vjb25kIHBhc3MgaGFkIGlkZW50aWZpZWQgdGhlIHRhcmdldHMuIFByb2JhYmx5IHRoZSBlYXNpZXN0IHdheSB3b3VsZCBiZSB0byBzY2FuIHRoZSBhcnJheSBhbmQgcmVwbGFjZSBhbGwgbGluZSBudW1iZXJzIGluIGRpbWVuc2lvbiAyIG9mIHRoZSBhcnJheSB3aXRoIDAgaWYgdGhleSB3ZXJlbid0IGEgdGFyZ2V0LjxiciAvPmllLCBpZiBsaW5lcyhsaW5lbnVtLDMpID0gMCB0aGVuIGxpbmVzKGxpbmVudW0sMikgPSAwLjxiciAvPlRoZW4gdXNlIHRoZSBhcnJheSB2YWx1ZSB3aGVuIGFkZGluZyB0aGUgbmV3IGxpbmVudW1iZXIgdG8gdGhlIGxpbmUgb2YgY29kZS4gVGhvc2Ugd2l0aCAwIHdpbGwgaGF2ZSBzcGFjZXMgaW5zdGVhZCBvZiBhIGxpbmUgbnVtYmVyLjxiciAvPjxiciAvPjxiciAvPjxiciAvPlVTRUZVTCBST1VUSU5FUzxiciAvPlRoaXMgcHJvZ3JhbSBjYWxscyBDT05GSUcuQkFTLiBJIHRyaWVkIHRvIG1ha2UgQ09ORklHLkJBUyBhcyBzdGFuZC1hbG9uZSBhcyBwb3NzaWJsZS4gQWxsIHRoZSBjb2RlIHRoYXQgaGFzIHRvIGJlIGN1c3RvbWlzZWQgZm9yIHlvdXIgcHJvZ3JhbSBpcyBpbiB0aGUgbGFzdCB0d28gZnVuY3Rpb25zLiBBbmQgdG8gbWFrZSBpdCBSRUFMTFkgRUFTWSwgSSB3cm90ZSBhIHByb2dyYW0gY2FsbGVkIENPTkNPREVSLkJBUyB0byBjcmVhdGUgYWxsIHRoZSBjb2RlIGZvciB0aG9zZSB0d28gZnVuY3Rpb25zLiBTZXQgdXAgeW91ciBjb25maWcgZmlsZSAoSSdkIHN1Z2dlc3QgY29weWluZyBmcm9tIGFuIG9sZCBvbmUgYW5kIGVkaXRpbmcgaXQgd2l0aCBhIHRleHQgZWRpdG9yKSwgYW5kIHJ1biBDT05DT0RFUi4gSXQgd2lsbCBwcm9tcHQgeW91IGZvciB0aGUgbmFtZSBvZiB0aGUgY29uZmlnIGZpbGUgYW5kIHRoZSBmaWxlIHlvdSB3YW50IHRvIGhhdmUgdGhlIG91dHB1dCB3cml0dGVuIHRvLjxiciAvPjxiciAvPkhlcmUncyBhbiBleGFtcGxlIG9mIHRoZSBjb250ZW50cyBvZiBhIENvbmZpZyBmaWxlOjxiciAvPicgVGhpcyBpcyB0aGUgY29uZmlnIGZpbGUgZm9yIEVYQU1QTEUuQkFTIChjb21tZW50cyBhcmUgaWdub3JlZCBieSB0aGUgY29uZmlnIHByb2Nlc3NvcikuPGJyIC8+Q0lUWT1CYW5na29rPGJyIC8+Q09VTlRSWT1UaGFpbGFuZDxiciAvPkxpbmVDb3VudD0yMjxiciAvPkxhc3RGaWxlT3BlbmVkPUFCQ0QuVFhUPGJyIC8+Q29tcGxldGVkU3VjY2Vzc2Z1bGx5PVRSVUU8YnIgLz48YnIgLz5Ob3RlIHRoYXQ6PGJyIC8+Q29tbWVudHMgYXJlIGlnbm9yZWQgYnkgdGhlIHByb2Nlc3Nvci48YnIgLz5BbGwgZW50cmllcyBzdGFydCBhdCB0aGUgZmlyc3QgY29sdW1uLjxiciAvPlRoZXJlIGFyZSBubyBzcGFjZXMgYmV0d2VlbiB0aGUgY29uZmlnIHRhZyBhbmQgdGhlID0sIGFuZCB0aGUgPSBhbmQgdGhlIHZhbHVlLjxiciAvPkNvbmZpZyB0YWdzIGZvciBzdHJpbmdzIGRvIG5vdCBoYXZlIGEgJCBvbiB0aGUgZW5kLjxiciAvPlRoZXJlIGFyZSBubyBxdW90ZXMgYXJvdW5kIHN0cmluZyB2YWx1ZXMuPGJyIC8+WW91IGNhbiB1c2UgYm9vbGVhbiAobG9naWNhbCkgdmFsdWVzLiBUcnVlIGFuZCBGYWxzZSBhcmUgZGVmaW5lZCBhdCB0aGUgdG9wIG9mIENPTkZJRy5CQVMgYW5kIGJhZCB0aGluZ3Mgd2lsbCBoYXBwZW4gaWYgeW91IHJlbW92ZSB0aGUgZGVmaW5pdGlvbiA6KTxiciAvPllvdSBjYW4gdXNlIG90aGVyIHR5cGVzIG9mIHZhbHVlLCBidXQgeW91J2xsIGhhdmUgdG8gd3JpdGUgdGhlIGNvZGUgdG8gc3VwcG9ydCB0aGVtLjxiciAvPjxiciAvPlRoZSBjb25jZXB0IGlzIHByZXR0eSBzaW1wbGUuIFZhbHVlcyBhcmUgcmVhZCBmcm9tIHRoZSBjb25maWcgZmlsZSBhbmQgYWxsb2NhdGVkIHRvIGdsb2JhbCB2YXJpYWJsZXMuIFRoZSBtYWluIHByb2dyYW0gbWF5IGNoYW5nZSB0aGVzZSB2YWx1ZXMuIEF0IHRoZSBlbmQgb2YgdGhlIG1haW4gcHJvZ3JhbSB5b3UgY2FsbCB0aGUgY29uZmlnIHByb2dyYW0gYWdhaW4gdG8gc3RvcmUgdGhlIGdsb2JhbCB2YWx1ZXMgYmFjayBpbnRvIHRoZSBjb25maWcgZmlsZS4gVGhlIHR3byBjdXN0b21pc2VkIGZ1bmN0aW9ucyBhdCB0aGUgZW5kIGFyZSByZXNwb25zaWJsZSBmb3IgY29udmVydGluZyB0aGUgY29uZmlnIHRhZ3MgaW50byBnbG9iYWwgdmFyaWFibGUgbmFtZXMgYW5kIGJhY2sgYWdhaW4sIGFuZCBoYXMgY29kZSB0byBjb252ZXJ0IHRoZSB2YWx1ZXMgaW50byBzb21ldGhpbmcgdGhhdCBjYW4gYmUgc3RvcmVkIGFuZCByZXRyaWV2ZWQgZnJvbSB0aGUgY29uZmlnIGZpbGUuPGJyIC8+PGJyIC8+QmVmb3JlIHlvdSBjYWxsIGNvbmZpZy5iYXMsIHNldCBhIHZhcmlhYmxlIGNhbGxlZCBiUmVhZENvbmZpZyB0byBUUlVFLiBUaGlzIHdpbGwgbWFrZSBpdCBjYWxsIHRoZSBjb2RlIHRvIHJlYWQgdGhlIGNvbmZpZyBmaWxlLiBBdCB0aGUgZW5kIG9mIHlvdXIgcHJvZ3JhbSBzZXQgYlJlYWRDb25maWcgdG8gRkFMU0UgYW5kIHJ1biBjb25maWcuYmFzIGFnYWluLiBUaGlzIHdpbGwgbWFrZSBpdCBjYWxsIHRoZSBjb2RlIHRvIHdyaXRlIHRoZSB2YWx1ZXMgYmFjayB0byB0aGUgY29uZmlnIGZpbGUuIFRoZSBwcm9ncmFtIGNoYWlucyB0byB0aGUgcHJvZ3JhbSBoZWxkIGluIHZhcmlhYmxlIE1hc3RlckZpbGUkLCBzbyBzZXQgdGhhdCB1cCB0b28uPGJyIC8+PGJyIC8+Q29uQ29kZXIgd2lsbCByZWFkIGVhY2ggbGluZSBmcm9tIHRoZSBjb25maWcgZmlsZSBhbmQgcHJvbXB0IHlvdSBmb3IgdGhlICJ0eXBlIiBvZiB0aGUgY29uZmlnIGl0ZW0uIEN1cnJlbnRseSBpdCBhY2NlcHRzIGIgKGJvb2xlYW4pLCBuIChudW1lcmljKSwgcyAoc3RyaW5nKSBhbmQgbyAob3RoZXIpLiBJdCBhbHNvIGFza3Mgd2hldGhlciB0aGUgdGFnIGlzIGV4YWN0bHkgdGhlIHNhbWUgYXMgdGhlIGdsb2JhbCB2YXJpYWJsZSBuYW1lIHRoYXQgdGhlIHZhbHVlIHdpbGwgYmUgYXNzaWduZWQgdG8uIEl0IHdvbid0IGJlIGZvciBzdHJpbmdzIGJlY2F1c2UgdGhlcmUncyBubyAkIG9uIHRoZSBlbmQgb2YgdGhlIHRhZy4gWW91IG1heSBhbHNvIGRlY2lkZSB0byB1c2UgZ2xvYmFsIHZhcmlhYmxlIG5hbWVzIHRoYXQgYXJlIGRpZmZlcmVudCB0byB0aGUgdGFnIGZvciBvdGhlciByZWFzb25zLiBBbnl3YXksIHlvdSBjYW4gc3BlY2lmeSBhIGRpZmZlcmVudCBuYW1lIGlmIHlvdSB3YW50IHRvLiBDb25Db2RlciB3aWxsIGNyZWF0ZSB0aGUgY29kZSB0byByZWFkIHRoZSBkYXRhIGZyb20gdGhlIGNvbmZpZyBmaWxlIGFuZCB3cml0ZSBpdCBiYWNrIGFnYWluLjxiciAvPjxiciAvPklmIHlvdSBzcGVjaWZ5IHRoZSB0eXBlIGFzICJvdGhlciIgeW91IHdpbGwgaGF2ZSB0byB3cml0ZSB0aGUgY29kZSB0byBzdXBwb3J0IGl0LiBJJ3ZlIGxlZnQgYSBnYXAgaW4gdGhlIGZ1bmN0aW9ucyBmb3IgeW91IHRvIGluc2VydCBpdCwgYW5kIGFuIEVORCBzdGF0ZW1lbnQgdG8gc3RvcCB0aGUgcHJvZ3JhbSBpZiB5b3UgZG9uJ3QuPGJyIC8+PGJyIC8+T25jZSBDb25Db2RlciBoYXMgcnVuLCBzZWxlY3QgYWxsIHRoZSB0ZXh0IGZyb20gdGhlIG91dHB1dCBmaWxlIGFuZCBvdmVyd3JpdGUgdGhlIHR3byBmdW5jdGlvbnMgYXQgdGhlIGJvdHRvbSBvZiBDT05GSUcuQkFTLjxiciAvPjxiciAvPklmIHlvdSBrZWVwIGFsbCB5b3VyIE1NQmFzaWMgcHJvZ3JhbXMgaW4gb25lIGZvbGRlciB5b3Ugd2lsbCBoYXZlIHRvIGhhdmUgYSBzZXBhcmF0ZSBDT05GSUcuQkFTIGZvciBlYWNoIHByb2dyYW0sIHNvIHRoZXkgd2lsbCBhbGwgaGF2ZSB0byBoYXZlIGRpZmZlcmVudCBuYW1lcy4gSSBzdXBwb3NlIHlvdSBjb3VsZCBoYXZlIG9uZSBjb25maWcuYmFzIHRoYXQgbWFuYWdlZCBhbGwgY29uZmlnIGZpbGVzLCBidXQgSSBkaWRuJ3Qgd3JpdGUgaXQgZm9yIHRoYXQgc2l0dWF0aW9uIGFuZCBpdCBjb3VsZCBuZWVkIGEgYml0IG9mIHJlY29kaW5nLiBJdCB3b3VsZCBhbHNvIGNyZWF0ZSB1bm5lZWRlZCBnbG9iYWwgdmFyaWFibGVzIGluIHlvdXIgcHJvZ3JhbXMuPGJyIC8+PGJyIC8+WW91IGNvdWxkIHNldCB1cCBkaWZmZXJlbnQgY29uZmlnIGZpbGVzIHRvIHN1aXQgZGlmZmVyZW50IHRlc3Qgc2l0dWF0aW9ucyBhbmQgc2F2ZSBoYXZpbmcgdG8gdHlwZSBpbiB0aGUgdmFsdWVzIGVhY2ggdGltZS4gSnVzdCBjaGFuZ2UgdGhlIG5hbWUgb2YgdGhlIGNvbmZpZyBmaWxlIGJlaW5nIHVzZWQuPGJyIC8+PGJyIC8+QW5vdGhlciBwb3NzaWJseSB1c2VmdWwgcm91dGluZSBpcyBmaWxlRXhpc3RzLiBJdCBjaGVja3MgZm9yIHRoZSBleGlzdGVuY2Ugb2YgYSBmaWxlIGluIGJvdGggdGhlIERPUyBhbmQgbm9ybWFsIHZlcnNpb25zIG9mIE1NQmFzaWMuIEl0IGhhcyBhIHJvdXRpbmUgdG8gY29udmVydCBmaWxlIGVycm9yIG51bWJlcnMgaW50byB0aGVpciB0ZXh0IGRlc2NyaXB0aW9ucy48YnIgLz48YnIgLz5JZiB5b3UgaGF2ZSBhbnkgcXVlc3Rpb25zIG9yIHN1Z2dlc3Rpb25zIGNvbnRhY3QgbWUgYXQgamRlYWtpbnNAcGN1Zy5vcmcuYXUuIEp1c3QgbWFrZSBzdXJlIGl0IGhhcyBhIHJlYXNvbmFibGUgc3ViamVjdCBoZWFkaW5nIHNvIEkgZG9uJ3QgZGVsZXRlIGl0IHdpdGggdGhlIGRhaWx5IGZsb29kIG9mIHNwYW0uIEFsdGVybmF0ZWx5LCBQTSBtZSBhdCBUaGUgQmFja3NoZWQgRm9ydW0gYXMgSmFtZXNfRnJvbV9DYW5iLjxiciAvPjxiciAvPkphbWVzIERlYWtpbnM8YnIgLz5NYXJjaC9BcHJpbCAyMDEzLmRk7FMDKe741TU09g/J0jPjF7Pb9k8=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">RENUM.BAS</h1><small>Modified on 2016/12/23 23:37 by Administrator &mdash; Categorized as: Arrays, Program Flow, Program Management, Strings, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br />RENUM.BAS<br /><br />RENUM.BAS is written in MMBasic and requires at least version 4.3a.<br /><br />Renum.bas renumbers basic files, the same way the RENUMBER command used to work in version of MMBasic prior to Version 4.3a, and the RENUMBER.BAS file in the library used to work. The RENUMBER command has been removed from MMBasic and the old program has been removed from the library.<br /><br />Because of the length of the program (around 1900 lines) it is modularised (<b>Modules are in the attachments tab, top right</b>) and uses the Chain command that was introduced in MMBasic 4.3. CONFIG.BAS, the second module, chains back to the program held in variable MasterFile$. If you use CONFIG.BAS for your own programs remember to set this variable - or change the code to suit your needs.<br /><br />The program has some enhancements compared with the older versions.<br />- a line out-of-order check. A priority, because out-of-order lines caused an embarassing bug for me a while back;<br />- it ignores potential labels and line numbers if they are within remarks or print statements;<br />- it attempts to indent based on the length of the longest line number (but see problems below);<br />- it has options to increment the line numbers, even if the line number is blank, and to add line numbers to blank lines;<br />- it has some extra validation checks;<br />- it stores your preferred values in a configuration file.<br /><br />It also has problems.<br />- It has meaningful comments in the code, so it's big.<br />- it can't properly format programs that start off with bad formatting, especially if there's a mix of code with and without line numbers.<br />- it uses a lot of memory. To counter this there is a check at the beginning of RENUM.BAS to switch colour MMs to Mode 1 to conserve memory. The code also releases memory after use where possible.<br />- there is a lot of debug code still in the program. There's an entry in the renum.cfg file that turns it on and off. If you find line numbers in your code (ie, not those ones at the start of the line) with leading astrisks, you have debug enabled. Edit the config file and set bDebug to FALSE. I'll remove the debug code once I know the program works well in the 'real world'.<br />- The input and output filenames must be different. Once I know the program works reliably I'll add the 3 or 4 lines needed to close the input file, rename the original to a .bak file, then rename the output file to the original filename.<br /><br />HOW TO RUN THE PROGRAM<br />You can run RENUMBER.BAS from the MMBasic prompt with no parameters.<br />It prompts for:<br />1) The name of the program to be renumbered. The .bas extension is optional.<br />2) The name of the output file. Again, .bas is optional. It cannot be the same as the input file.<br />3) The start line number in the basic program where you want to start renumbering.<br />4) The first line number in the output file.<br />5) The increment you want between line numbers.<br /><br />It then prompts for whether you want to put line numbers on those lines that do not have them, or, if you don't want to do that, whether you want to increment the line number counter over those lines without line numbers.<br /><br />For example, consider a file with a mix of lines with and without line numbers:<br />10 line 1<br />20 line 2<br />  line 3 with no line number<br />  line 4 with no line number<br />120 END<br /><br />If you choose to put line numbers on those without them, you will get<br />10 line 1<br />20 line 2<br />30 line 3 with no line number<br />40 line 4 with no line number<br />50 END<br /><br />If you answer "N" to the option above, you are prompted as to whether the line numbering should increment when the program finds a lines without line numbers. If you answer "Y" you get<br />10 line 1<br />20 line 2<br />  line 3 with no line number<br />  line 4 with no line number<br />50 END<br /><br />If you answer "N", you get<br />10 line 1<br />20 line 2<br />  line 3 with no line number<br />  line 4 with no line number<br />30 END<br /><br />Finally, it prompts whether you want to use the FORMAT.BAS program. If you do, it prompts for:<br />1) the indent (accepts 1 to 6, with a default of 2).<br />2) whether the format should display the formatted program on the screen, a screen at a time, as it is processed.<br /><br />Your answers are saved into a configuration file called renumber.cfg. The program initially asks if you want to use the same answers as the last time the program was run. If you answer "y" the values are loaded from the configuration file.<br /><br />The renumbered program is written to the output file.<br /><br />You can also pass parameters on the command line if you use the MMBasic Implied Run format. Type RENUMBER /? for a list of the options.<br />Note: if you use the MMBasic Implied Run format, you can use the undocumented /D parameter to toggle debug mode.<br /><br />PROGRAMMING DECISIONS<br />I planned to offer an option to align the start of lines with the end of the longest label (as it currently does with line numbers), but decided not to because many programmers have the label on a separate line with no code following, and aligning to those labels would not add much to the code layout, but would waste valuable space on the LHS of the screen.<br /><br />I was trying to get line formatting perfect but that would have needed code analysis to get the indent right. I had tried to replicate the indenting in the original code, but it was too complex - especially if lined and unlined code were mixed and started in different columns. I'll leave that up to Hugh's FORMAT program.<br /><br />I decided not to code an option to strip out all linenumbers that weren't a target (eg GOTO target). If anyone decides to implement it, I made the 'lines' array 3 dimensional and tagged any lines that were targets (ie follow a GOTO, GOSUB etc.) in pass 2. You would have to move this check to pass 1 (not trivial) or make a third pass and reprocess the input file once the second pass had identified the targets. Probably the easiest way would be to scan the array and replace all line numbers in dimension 2 of the array with 0 if they weren't a target.<br />ie, if lines(linenum,3) = 0 then lines(linenum,2) = 0.<br />Then use the array value when adding the new linenumber to the line of code. Those with 0 will have spaces instead of a line number.<br /><br /><br /><br />USEFUL ROUTINES<br />This program calls CONFIG.BAS. I tried to make CONFIG.BAS as stand-alone as possible. All the code that has to be customised for your program is in the last two functions. And to make it REALLY EASY, I wrote a program called CONCODER.BAS to create all the code for those two functions. Set up your config file (I'd suggest copying from an old one and editing it with a text editor), and run CONCODER. It will prompt you for the name of the config file and the file you want to have the output written to.<br /><br />Here's an example of the contents of a Config file:<br />' This is the config file for EXAMPLE.BAS (comments are ignored by the config processor).<br />CITY=Bangkok<br />COUNTRY=Thailand<br />LineCount=22<br />LastFileOpened=ABCD.TXT<br />CompletedSuccessfully=TRUE<br /><br />Note that:<br />Comments are ignored by the processor.<br />All entries start at the first column.<br />There are no spaces between the config tag and the =, and the = and the value.<br />Config tags for strings do not have a $ on the end.<br />There are no quotes around string values.<br />You can use boolean (logical) values. True and False are defined at the top of CONFIG.BAS and bad things will happen if you remove the definition :)<br />You can use other types of value, but you'll have to write the code to support them.<br /><br />The concept is pretty simple. Values are read from the config file and allocated to global variables. The main program may change these values. At the end of the main program you call the config program again to store the global values back into the config file. The two customised functions at the end are responsible for converting the config tags into global variable names and back again, and has code to convert the values into something that can be stored and retrieved from the config file.<br /><br />Before you call config.bas, set a variable called bReadConfig to TRUE. This will make it call the code to read the config file. At the end of your program set bReadConfig to FALSE and run config.bas again. This will make it call the code to write the values back to the config file. The program chains to the program held in variable MasterFile$, so set that up too.<br /><br />ConCoder will read each line from the config file and prompt you for the "type" of the config item. Currently it accepts b (boolean), n (numeric), s (string) and o (other). It also asks whether the tag is exactly the same as the global variable name that the value will be assigned to. It won't be for strings because there's no $ on the end of the tag. You may also decide to use global variable names that are different to the tag for other reasons. Anyway, you can specify a different name if you want to. ConCoder will create the code to read the data from the config file and write it back again.<br /><br />If you specify the type as "other" you will have to write the code to support it. I've left a gap in the functions for you to insert it, and an END statement to stop the program if you don't.<br /><br />Once ConCoder has run, select all the text from the output file and overwrite the two functions at the bottom of CONFIG.BAS.<br /><br />If you keep all your MMBasic programs in one folder you will have to have a separate CONFIG.BAS for each program, so they will all have to have different names. I suppose you could have one config.bas that managed all config files, but I didn't write it for that situation and it could need a bit of recoding. It would also create unneeded global variables in your programs.<br /><br />You could set up different config files to suit different test situations and save having to type in the values each time. Just change the name of the config file being used.<br /><br />Another possibly useful routine is fileExists. It checks for the existence of a file in both the DOS and normal versions of MMBasic. It has a routine to convert file error numbers into their text descriptions.<br /><br />If you have any questions or suggestions contact me at jdeakins@pcug.org.au. Just make sure it has a reasonable subject heading so I don't delete it with the daily flood of spam. Alternately, PM me at The Backshed Forum as James_From_Canb.<br /><br />James Deakins<br />March/April 2013.
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.RENUM-BAS-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:14 GMT -->
</html>
