

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Parsing-GPS-NMEA-strings-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Parsing GPS NMEA strings - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Parsing-GPS-NMEA-strings-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFnh88aDEgY2xhc3M9InBhZ2V0aXRsZSI+UGFyc2luZyBHUFMgTk1FQSBzdHJpbmdzPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxNi8xMi8yMyAyMzozOCBieSBBZG1pbmlzdHJhdG9yICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEVuY29kZSBhbmQgRGVjb2RlLCBHUFMsIF9MSUIgT3JpZ2luYWwgTU1CYXNpYzwvc21hbGw+PGJyIC8+PGJyIC8+PGgyIGNsYXNzPSJzZXBhcmF0b3IiPlRoaXMgbW9kdWxlIGlzIHBhcnQgb2YgdGhlIG9yaWdpbmFsIE1NQmFzaWMgbGlicmFyeS4gSXQgaXMgcmVwcm9kdWNlZCBoZXJlIHdpdGgga2luZCBwZXJtaXNzaW9uIG9mIEh1Z2ggQnVja2xlIGFuZCBHZW9mZiBHcmFoYW0uIEJlIGF3YXJlIGl0IG1heSByZWZlcmVuY2UgZnVuY3Rpb25hbGl0eSB3aGljaCBoYXMgY2hhbmdlZCBvciBpcyBkZXByZWNhdGVkIGluIHRoZSBsYXRlc3QgdmVyc2lvbnMgb2YgTU1CYXNpYy48YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiBocmVmPSIjVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMj48Yj5Ob3RlPC9iPjogQW55IHJlcXVpcmVkIGZpbGUocykgYXJlIGF2YWlsYWJsZSBpbiB0aGUgYXR0YWNobWVudHMgdGFiICh0b3AgcmlnaHQpLjxiciAvPjxiciAvPjxiciAvPjxiPkdQUy5CQVM8L2I+PGJyIC8+PHByZT4NCiYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KJyBEZW1vbnN0cmF0aW9uIG9mIHBhcnNpbmcgdGhlIE5NRUEgc3RyaW5nIHByb2R1Y2VkIGJ5IGEgR1BTIG1vZHVsZQ0KJyBHZW9mZiBHcmFoYW0gLSBKdWx5IDIwMTMNCicNCicgQWxsIEdQUyBtb2R1bGVzIGFyZSBndWFyYW50ZWVkIHRvIHByb2R1Y2UgdGhlIEdQUk1DIHN0cmluZw0KJyBTZWUgaHR0cCYjNTg7Ly9ob21lLm1pcmEubmV0L35nbmIvZ3BzL25tZWEuaHRtbCBmb3IgZGV0YWlscyBvZiB0aGUgc3RyaW5nDQomIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCicNCm1heCA9IDIwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgbWF4aW11bSBuYnIgb2YgcGFyYW1zDQpESU0gYXJnJChtYXgpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHVzZWQgdG8gaG9sZCB0aGUgZGF0YSBmaWVsZHMNCg0KT1BFTiAiQ09NMSYjNTg7NDgwMCIgQVMgJiMzNTsxDQoNCkRPICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgbG9vcCBmb3JldmVyDQogIEdldEdQU0RhdGEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGdldCB0aGUgbmV4dCBsaW5lDQogIElGIGFyZyQoMCkgPSAiR1BSTUMiIFRIRU4gICAgICAgICAgICAgICAnIEdQUk1DIGNvbnRhaW5zIGxhdC9sb25nDQogICAgSUYgYXJnJCgyKSA9ICJBIiBUSEVOICAgICAgICAgICAgICAgICAnICJBIiBtZWFucyBsb2NrZWQgb24gdG8gc2F0ZWxsaXRlcw0KICAgICAgUFJJTlQgIkxhdGl0dWRlID0gIjsgIExFRlQkKGFyZyQoMyksIDIpOyAiICI7IE1JRCQoYXJnJCgzKSwgMyk7DQogICAgICBQUklOVCAiICI7IGFyZyQoNCk7DQogICAgICBQUklOVCAiICAgTG9uZ2l0dWRlID0gIjsgTEVGVCQoYXJnJCg1KSwgMyk7ICIgIjsgTUlEJChhcmckKDUpLCA0KTsNCiAgICAgIFBSSU5UICIgIjsgYXJnJCg2KQ0KICAgIEVMU0UNCiAgICAgIFBSSU5UICJHUFMgc2VhcmNoaW5nLi4uIg0KICAgIEVORElGDQogIEVORElGDQpMT09QDQoNCg0KJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KJyBzdWJyb3V0aW5lIHRvIGxvYWQgdGhlIEdQUyBkYXRhIGZpZWxkcyBpbnRvIHRoZSBhcnJheSBhcmckKCkNCicgcmV0dXJucyB3aXRoIHRoZSBhcnJheSBwb3B1bGF0ZWQNClNVQiBHZXRHUFNEYXRhDQogIERPDQogICAgRE8gV0hJTEUgSU5QVVQkKDEsICYjMzU7MSkgJmx0OyZndDsgIiQiICYjNTg7IExPT1AgICcgd2FpdCBmb3IgdGhlIHN0YXJ0DQogICAgRk9SIGkgPSAwIFRPIG1heA0KICAgICAgYXJnJChpKSA9ICIiICAgICAgICAgICAgICAgICAgICAgICAgJyBjbGVhciByZWFkeSBmb3IgZGF0YQ0KICAgICAgRE8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBsb29wcyB1bnRpbCBhIHNwZWNpZmljIGV4aXQNCiAgICAgICAgeCQgPSBJTlBVVCQoMSwgJiMzNTsxKSAgICAgICAgICAgICAgICAnIGdldCB0aGUgY2hhcmFjdGVyDQogICAgICAgIElGIHgkID0gIiwiIFRIRU4gRVhJVCAgICAgICAgICAgICAnIG5ldyBkYXRhIGl0ZW0sIGluY3JlbWVudCBpDQogICAgICAgIElGIHgkID0gIiYjNDI7IiBUSEVOIEVYSVQgU1VCICAgICAgICAgJyB3ZSBoYXZlIGFsbCB0aGUgZGF0YSBzbyBleGl0DQogICAgICAgIGFyZyQoaSkgPSBhcmckKGkpICsgeCQgICAgICAgICAgICAnIGFkZCB0byB0aGUgZGF0YQ0KICAgICAgTE9PUCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBrZWVwIGdvaW5nDQogICAgTkVYVCBpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGluY3JlbWVudCBpDQogIExPT1ANCkVORCBTVUINCjwvcHJlPmRkVRE4VHdRTlX5+KpPd71NqQxIsMM=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Parsing GPS NMEA strings</h1><small>Modified on 2016/12/23 23:38 by Administrator &mdash; Categorized as: Encode and Decode, GPS, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><br /><b>GPS.BAS</b><br /><pre>
&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
' Demonstration of parsing the NMEA string produced by a GPS module
' Geoff Graham - July 2013
'
' All GPS modules are guaranteed to produce the GPRMC string
' See http&#58;//home.mira.net/~gnb/gps/nmea.html for details of the string
&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
'
max = 20                                  ' maximum nbr of params
DIM arg$(max)                             ' used to hold the data fields

OPEN "COM1&#58;4800" AS &#35;1

DO                                        ' loop forever
  GetGPSData                              ' get the next line
  IF arg$(0) = "GPRMC" THEN               ' GPRMC contains lat/long
    IF arg$(2) = "A" THEN                 ' "A" means locked on to satellites
      PRINT "Latitude = ";  LEFT$(arg$(3), 2); " "; MID$(arg$(3), 3);
      PRINT " "; arg$(4);
      PRINT "   Longitude = "; LEFT$(arg$(5), 3); " "; MID$(arg$(5), 4);
      PRINT " "; arg$(6)
    ELSE
      PRINT "GPS searching..."
    ENDIF
  ENDIF
LOOP


&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
' subroutine to load the GPS data fields into the array arg$()
' returns with the array populated
SUB GetGPSData
  DO
    DO WHILE INPUT$(1, &#35;1) &lt;&gt; "$" &#58; LOOP  ' wait for the start
    FOR i = 0 TO max
      arg$(i) = ""                        ' clear ready for data
      DO                                  ' loops until a specific exit
        x$ = INPUT$(1, &#35;1)                ' get the character
        IF x$ = "," THEN EXIT             ' new data item, increment i
        IF x$ = "&#42;" THEN EXIT SUB         ' we have all the data so exit
        arg$(i) = arg$(i) + x$            ' add to the data
      LOOP                                ' keep going
    NEXT i                                ' increment i
  LOOP
END SUB
</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Parsing-GPS-NMEA-strings-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:13 GMT -->
</html>
