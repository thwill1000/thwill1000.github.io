

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Shell-Sort by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Shell Sort - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Shell-Sort" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF7ws8aDEgY2xhc3M9InBhZ2V0aXRsZSI+U2hlbGwgU29ydDwvaDE+PHNtYWxsPk1vZGlmaWVkIG9uIDIwMTcvMDgvMTEgMjE6MzcgYnkgQ2FwdGFpbkJvaW5nICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEFycmF5cywgTWF0aHMsIFNvcnQsIFN0cmluZ3M8L3NtYWxsPjxiciAvPjxiciAvPkZvciBjb21wbGV0ZW5lc3MsIGJlbG93IGlzIGFuIE1NQmFzaWMgdmVyc2lvbiBvZiBhIFNoZWxsIHNvcnQgLSBpdCBpcyBhYm91dCBmb3VyIHRvIGZpdmUgdGltZXMgZmFzdGVyIHRoYW4gYSBidWJibGUgc29ydCBidXQgZG9lcyBoYXZlIGEgc2VyaW91cyBjYXZlYXQgaW4gdGhhdCBpdCBjYW4gZmFpbCBpZiB0aGUgZGF0YSBpcyBpbiBhbiB1bmZvcnR1bmF0ZSBvcmRlciAtIHRoaXMgaXMganVzdCBhIGZhY3Qgb2YgbGlmZSBmb3IgU2hlbGwgc29ydC4gVGhhdCBzYWlkLCBpdCBpcyB2ZXJ5IHVubGlrZWx5IHRvIGhhcHBlbiBidXQgYmUgd2FybmVkLjxiciAvPjxiciAvPkJlZm9yZSBjaG9vc2luZyBhIHNvcnQgYWxnb3JpdGhtLCByZWFkIDxhIGNsYXNzPSJwYWdlbGluayIgaHJlZj0iTU1CYXNpYy5Tb3J0LWFsZ29yaXRobXMtQS1jb21wYXJpc29uLmFzaHgiIHRpdGxlPSJTb3J0IGFsZ29yaXRobXMgLSBBIGNvbXBhcmlzb24iPnRoaXMgYXJ0aWNsZTwvYT4uPGJyIC8+PGJyIC8+PGJyIC8+PGI+RXhhbXBsZTwvYj46PGJyIC8+PGJyIC8+PGNvZGU+PGJyIC8+ICAgIE9wdGlvbiBCYXNlIDA8YnIgLz48YnIgLz4gICAgRGltIHh4IEFzIEludGVnZXI8YnIgLz4gICAgeHg9bXlfYXJyYXlzaXplICAgICAnbGFjayBvZiBVQk9VTkQoKSBtZWFucyB3ZSBoYXZlIHRvIG1hbnVhbGx5IHRyYWNrIHRoZSBhcnJheSBzaXplPGJyIC8+ICAgIERpbSBTUCQoeHgpPGJyIC8+ICAgIDxiciAvPiAgICBTaGVsbFNvcnQgeHg8YnIgLz48YnIgLz48L2NvZGU+PGJyIC8+PGJyIC8+PGJyIC8+PGI+U2hlbGxTb3J0PC9iPjo8YnIgLz48cHJlPg0KDQogIFNVQiBTaGVsbFNvcnQoU1BUb3ApDQogICAgTE9DQUwgSU5URUdFUiBpLGoNCiAgICBMT0NBTCBGTE9BVCBrDQogICAgTE9DQUwgU1RSSU5HIGEkDQogICAgayA9IElOVChTUFRvcCAvIDIpDQogICAgV0hJTEUgayAmZ3Q7IDANCiAgICAgICAgRk9SIGkgPSAxIHRvIFNQVG9wDQogICAgICAgICAgICBqID0gaQ0KICAgICAgICAgICAgYSQgPSBTUCQoaSkNCiAgICAgICAgICAgIFdISUxFIChqICZndDs9IGsrMSBBTkQgU1AkKEFCUyhqLWspKSAmZ3Q7IGEkKQ0KICAgICAgICAgICAgICAgIFNQJChqKSA9IFNQJChqLWspDQogICAgICAgICAgICAgICAgaiA9IGogLSBrDQogICAgICAgICAgICBXRU5EDQogICAgICAgICAgICBzcCQoaikgPSBhJA0KICAgICAgICBORVhUIA0KICAgICAgICBJRiBrID0gMiBUSEVODQogICAgICAgICAgayA9IDENCiAgICAgICAgRUxTRQ0KICAgICAgICAgIGsgPSBJTlQoayAmIzQyOyAwLjQ1NDU0NSkgICcgNS8xMSBzb3J0IGJhbGFuY2luZyB2YWx1ZQ0KICAgICAgICBFTkQgSUYNCiAgICBXRU5EDQogIEVORCBTVUINCg0KPC9wcmU+ZGSJiNdXGSibrwBmeYc2Vicu9MBWLw==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Shell Sort</h1><small>Modified on 2017/08/11 21:37 by CaptainBoing &mdash; Categorized as: Arrays, Maths, Sort, Strings</small><br /><br />For completeness, below is an MMBasic version of a Shell sort - it is about four to five times faster than a bubble sort but does have a serious caveat in that it can fail if the data is in an unfortunate order - this is just a fact of life for Shell sort. That said, it is very unlikely to happen but be warned.<br /><br />Before choosing a sort algorithm, read <a class="pagelink" href="MMBasic.Sort-algorithms-A-comparison.html" title="Sort algorithms - A comparison">this article</a>.<br /><br /><br /><b>Example</b>:<br /><br /><code><br />    Option Base 0<br /><br />    Dim xx As Integer<br />    xx=my_arraysize     'lack of UBOUND() means we have to manually track the array size<br />    Dim SP$(xx)<br />    <br />    ShellSort xx<br /><br /></code><br /><br /><br /><b>ShellSort</b>:<br /><pre>

  SUB ShellSort(SPTop)
    LOCAL INTEGER i,j
    LOCAL FLOAT k
    LOCAL STRING a$
    k = INT(SPTop / 2)
    WHILE k &gt; 0
        FOR i = 1 to SPTop
            j = i
            a$ = SP$(i)
            WHILE (j &gt;= k+1 AND SP$(ABS(j-k)) &gt; a$)
                SP$(j) = SP$(j-k)
                j = j - k
            WEND
            sp$(j) = a$
        NEXT 
        IF k = 2 THEN
          k = 1
        ELSE
          k = INT(k &#42; 0.454545)  ' 5/11 sort balancing value
        END IF
    WEND
  END SUB

</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Shell-Sort by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:34 GMT -->
</html>
