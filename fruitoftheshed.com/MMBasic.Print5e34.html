

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Simple-Encryption by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Simple Encryption - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Simple-Encryption" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF1iQ8aDEgY2xhc3M9InBhZ2V0aXRsZSI+U2ltcGxlIEVuY3J5cHRpb248L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDIxLzExLzEyIDE4OjQ3IGJ5IENhcHRhaW5Cb2luZyAmbWRhc2g7IENhdGVnb3JpemVkIGFzOiBDb21tdW5pY2F0aW9ucywgTWF0aHMsIE5ldHdvcmssIE5ldHdvcmsgKEdTTSksIFJhZGlvLCBTdHJpbmdzPC9zbWFsbD48YnIgLz48YnIgLz5BbGwgY29tbXVuaWNhdGlvbnMgaW4gcHVibGljIHNwYWNlIHNob3VsZCByZWFsbHkgYmUgZW5jcnlwdGVkLiA8YnIgLz48YnIgLz5WYXJpb3VzIGZvcm1zIG9mIGVuY3J5cHRpb24gZXhpc3QgYW5kIGF0IHRoZWlyIHNpbXBsZXN0IHRoZXkgdXNlZCBhICJzaGFyZWQgc2VjcmV0IiAtIGEga2V5IHN0cmluZyB0aGF0IGlzIHVzZWQgdG8gZW5jcnlwdCBhbmQgZGVjcnlwdCBhIG1lc3NhZ2UgdXNpbmcgbWF0aGVtYXRpY2FsIHByb2dyZXNzaW9uLiBTdWNoIGVuY3J5cHRpb24gaXMgdGVybWVkICJzeW1tZXRyaWNhbCIgYXMgdGhlIHNhbWUga2V5IGlzIHVzZWQgdG8gYm90aCBlbmNyeXB0IGFuZCBkZWNyeXB0LiBJdCBpcyBjcnVjaWFsIHRoYXQgdGhlIGtleSByZW1haW4gc2VjcmV0IGZvciBvYnZpb3VzIHJlYXNvbnMuPGJyIC8+PGJyIC8+U3Ryb25nZXIsIGFzeW1tZXRyaWNhbCwgZW5jcnlwdGlvbiB1c2VzIHR3byBzZXBhcmF0ZSBrZXlzIC0gYSBwdWJsaWMga2V5IHVzZWQgdG8gZW5jcnlwdCB0aGUgZGF0YSBhbmQgYSBwcml2YXRlIGtleSBmb3IgZGVjcnlwdGluZy4gVGhlIHB1YmxpYyBrZXkgY2Fubm90IGJlIHVzZWQgdG8gZGVjcnlwdCB0aGUgbWVzc2FnZSBhbmQgc28gaXQgZG9lcyBub3QgbWF0dGVyIHRoYXQgaXQgYmVjb21lcyBvcGVubHkga25vd24gb3Igc2hhcmVkIChpbiBmYWN0IHRoaXMgaXMgZW5jb3VyYWdlZCBvciBldmVuIG5lY2Vzc2FyeSkuIFRoZSBwcml2YXRlIGtleSBtdXN0IHJlbWFpbiBzZWNyZXQgaW4gdGhlIHNhbWUgc2Vuc2UgYXMgdGhhdCBmb3Igc3ltbWV0cmljYWwgZW5jcnlwdGlvbi48YnIgLz48YnIgLz5FbmNyeXB0aW9uIGlzIGZ1cnRoZXIgZW5oYW5jZWQgYnkgYWRkaW5nIGEgIlNBTFQiIHRvIHRoZSBrZXkgc3VjaCB0aGF0IGl0IGlzIGRpZmZlcmVudCBlYWNoIHRpbWUgYnV0IHRoZSBTQUxUIG11c3QgYmUgY29tbXVuaWNhdGVkIHNvbWVob3cgc28gdGhhdCB0aGUgZGVjcnlwdGluZyBkZXZpY2UgaXMgd29ya2luZyB3aXRoIGEgdmFsaWQga2V5LiBGdXJ0aGVyLCB0aGUgU0FMVCBzaG91bGQgbm90IGJlIGVhc2lseSBndWVzc2FibGUgKHN1Y2ggYXMgdGhlIHRpbWUpIG9yIGV2ZW4gdXNlZCBtb3JlIHRoYW4gb25jZS4gVGhpcyByZW1haW5zIGEgY2hhbGxlbmdlIG9uIHNtYWxsIGRldmljZXMgd2l0aCBjdXN0b20gb3Igbm8gT3BlcmF0aW5nIFN5c3RlbS4gVGhlIHJvdXRpbmVzIGJlbG93IGRvIG5vdCB1c2UgYSBTQUxUIGJ1dCB5b3UgY291bGQgZWFzaWx5IGFkYXB0IHRoZW0gdG8gZG8gc28uPGJyIC8+PGJyIC8+VGhlIDxhIGNsYXNzPSJwYWdlbGluayIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Ik1NQmFzaWMuUkM0LUVuY3J5cHRpb24tYW5kLURlY3J5cHRpb24tRnVuY3Rpb25zLmFzaHgiIHRpdGxlPSJSQzQgRW5jcnlwdGlvbiBhbmQgRGVjcnlwdGlvbiBGdW5jdGlvbnMiPlJDNCBFbmNyeXB0aW9uIGFuZCBEZWNyeXB0aW9uIEZ1bmN0aW9uczwvYT4gZm91bmQgZWxzZXdoZXJlIGluIHRoaXMgbGlicmFyeSBwcm92aWRlIGEgc3RhbmRhcmQgZm9ybSBvZiBzeW1tZXRyaWNhbCBlbmNyeXB0aW9uIGFuZCBhbHRob3VnaCBSQzQgaXMgZGVwcmVjYXRlZCBpdCBzdGlsbCBwcm92aWRlcyBhIGdvb2QgbGV2ZWwgb2Ygc2VjcmVjeSB3aXRoIGEgc3VmZmljaWVudGx5IGNvbXBsZXgga2V5IG9mIGF0IGxlYXN0IDMyIGNoYXJhY3RlcnMgKDI1NiBiaXRzKS48YnIgLz48YnIgLz5FbmNyeXB0aW9uIHN1aXRlcyBzdWNoIGFzIFJDNCBhcmUgbWF0aGVtYXRpY2FsbHkgaW50ZW5zaXZlIGFuZCBzbWFsbGVyIG1pY3JvLWNvbnRyb2xsZXJzLCBlc3BlY2lhbGx5IHJ1bm5pbmcgYXQgbG93ZXIgY2xvY2sgc3BlZWRzLCBjYW4gc3RydWdnbGUgdG8gbWFpbnRhaW4gdGltaW5ncyBpbiB0aWdodCBzcGFjZXMgcHVyZWx5IGJlY2F1c2UgaXQgY2FuIHRha2UgYSBnb29kIGRlYWwgb2YgdGltZSB0byBnZW5lcmF0ZSB0aGUgZW5jcnlwdGVkIHN0cmluZyBvciByZWdlbmVyYXRlIHRoZSBvcmlnaW5hbC4gRG91Ymx5IHNvIHdoZXJlIGFuIGVuY3J5cHRlZCByZXBseSBpcyByZXF1aXJlZC48YnIgLz48YnIgLz5JZiBvbmx5IHNpbXBsZSBvYmZ1c2NhdGlvbiBpcyByZXF1aXJlZCwgeW91IG1pZ2h0IGNvbnNpZGVyIDxhIGNsYXNzPSJwYWdlbGluayIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Ik1NQmFzaWMuQmFzZTY0LU1pbWUtRW5jb2RlLWFuZC1EZWNvZGUtRnVuY3Rpb25zLmFzaHgiIHRpdGxlPSJCYXNlNjQgTWltZSBFbmNvZGUgYW5kIERlY29kZSBGdW5jdGlvbnMiPkJhc2U2NDwvYT4sIGJ1dCBub3RlIHRoYXQgaXMgdmVyeSBlYXNpbHkgInVuLWRvbmUiLiA8YnIgLz48YnIgLz5UaGUgYmVsb3cgZnVuY3Rpb25zIHVzZSBhIHNpbXBsZSByb3RhdGluZyBYT1Igb2YgYSBzaGFyZWQgc2VjcmV0IGtleSBhbmQgaGF2ZSB0aGUgYWR2YW50YWdlIG9mIG5vdCBiZWluZyB3ZWFrbHktb2J2aW91cyBub3IgY29tcHV0YXRpb25hbGx5IGludGVuc2l2ZSwgcmVzdWx0aW5nIGluIGZhc3QgZXhlY3V0aW9uIGFuZCByZWFzb25hYmxlIGN1c3RvbSBlbmNyeXB0aW9uIC0gbm90IHRvIHRoZSBsZXZlbCBvZiBoZWF2eXdlaWdodCwgc3RhbmRhcmRzIGJ1dCBjZXJ0YWlubHkgZW5vdWdoIHRvIHByZXZlbnQgY2xlYXItdGV4dCBzbm9vcGluZy1vbi10cmFmZmljLXdpdGgtZWFzeS1yZXZlYWwuIDxiciAvPjxiciAvPkEgbWFqb3IgZmxhdyB3aXRoIHRoZSBiZWxvdyBpcyB0aGF0IGlzIHRoYXQgdGhlIGVuY3J5cHRpb24gc2hvd3MgdHJhaXRzIGZvciBzaW1pbGFyIG1lc3NhZ2VzIHRoYXQgY2FuIHByb3ZpZGUgY2x1ZXMgdG8gYSByZWFzb25hYmx5IGNvbXBldGVudCBoYWNrZXIgKHJhcmUgYW5kIG5vdCBsaWtlbHkgbGlzdGVuaW5nIHRvIHRoZSBjaGF0dGVyIGZyb20geW91ciBhaXItY29uIGNvbnRyb2xsZXIpLiBDb25zaWRlciB0aGUgZm9sbG93aW5nOjxiciAvPjxiciAvPjxjb2RlPjxiciAvPlRIRSBRVUlDSyBCUk9XTiBGT1g8YnIgLz42QTdDNjQxMTI5NjEzODcwMzExNDY5NjU2QTYzMzUxOTc5N0EwNDxiciAvPmp8ZClhOHAxaWVqYzV5ejxiciAvPjxiciAvPnRoZSBxdWljayBicm93biBmb3g8YnIgLz40QTVDNDQxMTA5NDExODUwMTExNDQ5NDU0QTQzMTUxOTU5NUEyNDxiciAvPkpcRCAgICAgQVBJRUpDWVokPGJyIC8+PC9jb2RlPjxiciAvPkV2ZW4gdG8gdGhlIHVudHJhaW5lZCBleWUsIGl0IGlzIG9idmlvdXMgdGhlIHR3byBvdXRwdXRzIGJlYXIgYSBzaW1pbGFyaXR5LCBlc3BlY2lhbGx5IHRoYXQgY2FzZSBzZWVtcyB0byB0cmFjayB0aGUgb3Bwb3NpdGUgb2YgdGhlIGlucHV0LiBUaGlzIGlzIG5vdCBlbnRpcmVseSB3aHkgcGFzc3dvcmRzIG9uIGdvb2QgY29tcHV0ZXIgc3lzdGVtcyBpbnNpc3Qgb2YgYSBtaXh0dXJlIG9mIGJvdGggdXBwZXIgYW5kIGxvd2VyIGNhc2UgY2hhcmFjdGVycywgYnV0IGl0IHNlcnZlcyB0byBpbGx1c3RyYXRlIHRoZSBwb2ludC4gSWYgc2ltcGxlIG9iZnVzY2F0aW9uIGlzIHJlcXVpcmVkIHRvIHN0b3AgdGhlIGNhc3VhbCwgdW5za2lsbGVkIHNub29wZXIsIHRoZXNlIHR3byBmdW5jdGlvbnMgd2lsbCBwcm9iYWJseSBiZSBnb29kIGVub3VnaCBidXQgRE8gTk9UIHVzZSB0aGVtIHdoZXJlIGdvb2Qgc2VjdXJpdHkgaXMgcmVxdWlyZWQuPGJyIC8+PGJyIC8+PGI+RXhhbXBsZXM8L2I+PGJyIC8+eiQ9RW5jcnlwdCQoIm1hcnkgaGFkIGEgbGl0dGxlIGxhbWIiKTxiciAvPnokPURlY3J5cHQkKG15bWVzc2FnZSQpPGJyIC8+PGJyIC8+PGI+VGhlIENvZGU8L2I+PGJyIC8+PHByZT4JJ29wdGltaXplZCB2ZXJzaW9uIDEyTk9WMjAyMQ0KCSdjaGFuZ2UgdGhlIGtleSB0byB3aGF0ZXZlciB5b3Ugd2FudCBidXQgdGhlIGxvbmdlciB0aGUgYmV0dGVyDQoJQ29uc3Qga2V5JD0iJmd0OzQhIitjaHIkKDIwMikrIjF4K2NociQoMTg4KSs0K2NociQoMjQwKSszejQrNyU0JiMxMjM7OT81XDMrY2hyJCgyMjIpK14rY2hyJCgyMjEpKzUkOT02QDF+NiwrY2hyJCgxOTMpK3wxKTcmIzU4OzgmbHQ7MyYjNDI7OFM5STlsN1oxZVQwcjEiDQoNCglGdW5jdGlvbiBFbmNyeXB0JChhJCkNCgkJTG9jYWwgSW50ZWdlciBuLHAsdA0KCQlMb2NhbCBiJA0KCQlwPTEmIzU4O3Q9TGVuKGtleSQpDQoJCUZvciBuPTEgVG8gTGVuKGEkKQ0KCQkJYiQ9YiQrSGV4JChQZWVrKFZhciBhJCxuKSBYb3IgUGVlayhWYXIga2V5JCxwKSwyKQ0KCQkJcD1wKzEmIzU4O0lmIHAmZ3Q7dCBUaGVuIHA9MQ0KCQlOZXh0DQoJCUVuY3J5cHQkPWIkDQoJRW5kIEZ1bmN0aW9uDQoNCglGdW5jdGlvbiBEZWNyeXB0JChhJCkNCgkJTG9jYWwgSW50ZWdlciBuLHAsdA0KCQlMb2NhbCBiJA0KCQlwPTEmIzU4O3Q9TGVuKGtleSQpDQoJCUZvciBuPTEgVG8gTGVuKGEkKSBTdGVwIDINCgkJCWIkPWIkK0NociQoVmFsKCImYW1wO2giK01pZCQoYSQsbiwyKSkgWG9yIFBlZWsoVmFyIGtleSQscCkpDQoJCQlwPXArMSYjNTg7SWYgcCZndDt0IFRoZW4gcD0xDQoJCU5leHQNCgkJRGVjcnlwdCQ9YiQNCglFbmQgRnVuY3Rpb24NCjwvcHJlPmRkQ4A/yH3t7UslEc7e+ZmhEd0TriA=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Simple Encryption</h1><small>Modified on 2021/11/12 18:47 by CaptainBoing &mdash; Categorized as: Communications, Maths, Network, Network (GSM), Radio, Strings</small><br /><br />All communications in public space should really be encrypted. <br /><br />Various forms of encryption exist and at their simplest they used a "shared secret" - a key string that is used to encrypt and decrypt a message using mathematical progression. Such encryption is termed "symmetrical" as the same key is used to both encrypt and decrypt. It is crucial that the key remain secret for obvious reasons.<br /><br />Stronger, asymmetrical, encryption uses two separate keys - a public key used to encrypt the data and a private key for decrypting. The public key cannot be used to decrypt the message and so it does not matter that it becomes openly known or shared (in fact this is encouraged or even necessary). The private key must remain secret in the same sense as that for symmetrical encryption.<br /><br />Encryption is further enhanced by adding a "SALT" to the key such that it is different each time but the SALT must be communicated somehow so that the decrypting device is working with a valid key. Further, the SALT should not be easily guessable (such as the time) or even used more than once. This remains a challenge on small devices with custom or no Operating System. The routines below do not use a SALT but you could easily adapt them to do so.<br /><br />The <a class="pagelink" target="_blank" href="MMBasic.RC4-Encryption-and-Decryption-Functions.html" title="RC4 Encryption and Decryption Functions">RC4 Encryption and Decryption Functions</a> found elsewhere in this library provide a standard form of symmetrical encryption and although RC4 is deprecated it still provides a good level of secrecy with a sufficiently complex key of at least 32 characters (256 bits).<br /><br />Encryption suites such as RC4 are mathematically intensive and smaller micro-controllers, especially running at lower clock speeds, can struggle to maintain timings in tight spaces purely because it can take a good deal of time to generate the encrypted string or regenerate the original. Doubly so where an encrypted reply is required.<br /><br />If only simple obfuscation is required, you might consider <a class="pagelink" target="_blank" href="MMBasic.Base64-Mime-Encode-and-Decode-Functions.html" title="Base64 Mime Encode and Decode Functions">Base64</a>, but note that is very easily "un-done". <br /><br />The below functions use a simple rotating XOR of a shared secret key and have the advantage of not being weakly-obvious nor computationally intensive, resulting in fast execution and reasonable custom encryption - not to the level of heavyweight, standards but certainly enough to prevent clear-text snooping-on-traffic-with-easy-reveal. <br /><br />A major flaw with the below is that is that the encryption shows traits for similar messages that can provide clues to a reasonably competent hacker (rare and not likely listening to the chatter from your air-con controller). Consider the following:<br /><br /><code><br />THE QUICK BROWN FOX<br />6A7C641129613870311469656A633519797A04<br />j|d)a8p1iejc5yz<br /><br />the quick brown fox<br />4A5C441109411850111449454A431519595A24<br />J\D     APIEJCYZ$<br /></code><br />Even to the untrained eye, it is obvious the two outputs bear a similarity, especially that case seems to track the opposite of the input. This is not entirely why passwords on good computer systems insist of a mixture of both upper and lower case characters, but it serves to illustrate the point. If simple obfuscation is required to stop the casual, unskilled snooper, these two functions will probably be good enough but DO NOT use them where good security is required.<br /><br /><b>Examples</b><br />z$=Encrypt$("mary had a little lamb")<br />z$=Decrypt$(mymessage$)<br /><br /><b>The Code</b><br /><pre>	'optimized version 12NOV2021
	'change the key to whatever you want but the longer the better
	Const key$="&gt;4!"+chr$(202)+"1x+chr$(188)+4+chr$(240)+3z4+7%4&#123;9?5\3+chr$(222)+^+chr$(221)+5$9=6@1~6,+chr$(193)+|1)7&#58;8&lt;3&#42;8S9I9l7Z1eT0r1"

	Function Encrypt$(a$)
		Local Integer n,p,t
		Local b$
		p=1&#58;t=Len(key$)
		For n=1 To Len(a$)
			b$=b$+Hex$(Peek(Var a$,n) Xor Peek(Var key$,p),2)
			p=p+1&#58;If p&gt;t Then p=1
		Next
		Encrypt$=b$
	End Function

	Function Decrypt$(a$)
		Local Integer n,p,t
		Local b$
		p=1&#58;t=Len(key$)
		For n=1 To Len(a$) Step 2
			b$=b$+Chr$(Val("&amp;h"+Mid$(a$,n,2)) Xor Peek(Var key$,p))
			p=p+1&#58;If p&gt;t Then p=1
		Next
		Decrypt$=b$
	End Function
</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Simple-Encryption by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:48 GMT -->
</html>
