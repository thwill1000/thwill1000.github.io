

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.Quick-and-Dirty-Daylight-Indicator&Revision=0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:52:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Page History - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/History.aspx?NS=MMBasic&amp;Page=MMBasic.Quick-and-Dirty-Daylight-Indicator&amp;Revision=0" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEzMjI3OTE2NTkPZBYCZg9kFgICAQ9kFgICCQ9kFggCAQ8WAh4EVGV4dAUwUGFnZSBIaXN0b3J5OiBRdWljayBhbmQgRGlydHkgRGF5bGlnaHQgSW5kaWNhdG9yZAIFDxBkEBUHATYBNQE0ATMBMgExATAVBwE2ATUBNAEzATIBMQEwFCsDB2dnZ2dnZ2dkZAIHDxBkEBUIB0N1cnJlbnQBNgE1ATQBMwEyATEBMBUIB0N1cnJlbnQBNgE1ATQBMwEyATEBMBQrAwhnZ2dnZ2dnZ2RkAgsPFgIfAAXbGDx0YWJsZSBjbGFzcz0iYm94IiBjZWxscGFkZGluZz0iMCIgY2VsbHNwYWNpbmc9IjAiPjx0cj48dGQ+PHAgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsiPjxiPiZsYXF1bzsgT2xkZXIgUmV2aXNpb24gLSA8YSBocmVmPSJNTUJhc2ljLkhpc3RvcnkuYXNweD9QYWdlPU1NQmFzaWMuUXVpY2stYW5kLURpcnR5LURheWxpZ2h0LUluZGljYXRvciI+QmFjayB0byBQYWdlIEhpc3Rvcnk8L2E+IC0gPGEgaHJlZj0iTU1CYXNpYy5IaXN0b3J5LmFzcHg/UGFnZT1NTUJhc2ljLlF1aWNrLWFuZC1EaXJ0eS1EYXlsaWdodC1JbmRpY2F0b3ImYW1wO1JldmlzaW9uPTAwMDAxIj5OZXdlciBSZXZpc2lvbiAmcmFxdW87PC9hPjwvYj48L3A+PC90ZD48L3RyPjwvdGFibGU+PGJyIC8+PGgzIGNsYXNzPSJzZXBhcmF0b3IiPlBhZ2UgUmV2aXNpb246IDIwMTcvMDkvMjIgMTM6MjE8L2gzPjxiciAvPlRoZSBmb2xsb3dpbmcgaXMgYSBmdW5jdGlvbiB0byBwcm92aWRlIGEgQm9vbGVhbiBpbmRpY2F0b3Igb2Ygd2hldGhlciB0aGUgZ2l2ZW4gTW9udGgsIEhvdXIgJiBtaW51dGUgb2NjdXIgZHVyaW5nICJDaXZpbCBEYXlsaWdodCIgaS5lLiB0aGlzIGlzIHRoZSB0aW1lIGNvbnNpZGVyZWQgYmV0d2VlbiBzdW5yaXNlIGFuZCBzdW5zZXQgbm90IGluY2x1ZGluZyBhbnkgdHdpbGlnaHQuIEl0IHdhcyB3cml0dGVuIHRvIHByb3ZpZGUgc29tZSBpbnRlbGxpZ2VuY2UgdG8gZXh0ZXJpb3IgbGlnaHRpbmcgc28gdGhhdCBpdCBpcyBvbmx5IGFjdGl2YXRlZCBhcm91bmQgdGhlIGhvdXJzIG9mIGRhcmtuZXNzLjxiciAvPjxiciAvPkl0IGlzIHZlcnkgcm91Z2ggYW5kIHJlYWR5IGFuZCB0aGUgdXNlIG9mIGRheWxpZ2h0IG1lYW5zIGl0IGNvdmVycyBkYXduICYgZHVzayAoZXNwZWNpYWxseSBkdXJpbmcgdGhlIGVxdWlub3ggem9uZXMpLiBUaGlzIG1lYW5zIHRoYXQgYWx0aG91Z2ggdGhlIGRheWxpZ2h0IGhvdXJzIGNoYW5nZSBjb25zaWRlcmFibHkgYmV0d2VlbiB0aGUgc3RhcnQgYW5kIGZpbmlzaCBvZiBzYXksIE1hcmNoLCBUaGUgdXNlIG9mIGRheWxpZ2h0IHdpbGwgY292ZXIgdGhlIHR3aWxpZ2h0IHBlcmlvZHMgYW5kIHNvIGEgZGVncmVlIG9mICJvdmVyLWNvbXBlbnNhdGlvbiIgaXMgc2Vlbi4gIEl0IGFsc28gbWVhbnMgdGhhdCB3ZSBvbmx5IG5lZWQgdG8gYmUgY29uY2VybmVkIHdpdGggd2hvbGUgbW9udGhzIHJhdGhlciB0aGFuIHNwZWNpZmljIGRhdGVzIHdoaWNoIG1ha2VzIHRoZSBmdW5jdGlvbiBtdWNoIHNtYWxsZXIgYW5kIGxlc3MgY29tcGxleC48YnIgLz48YnIgLz5UaGUgdGltZXMgaW4gdGhlIGRhdGEgc3RhdGVtZW50cyBhcmUgVVRDIChpLmUuIG5vIGRheWxpZ2h0IHNhdmluZyB0aW1lKSBpbiAxMiBncm91cHMgYW5kIGFyZSBoYXJkLWNvZGVkIGZvciBMb25kb24sIFVLIC0geW91ICB3aWxsIG5lZWQgdG8gY2hhbmdlIHRoZXNlIGZvciB5b3VyIG93biBsb2NhdGlvbiBhbmQgdGltZSBmb3JtYXQgaWYgbmVjZXNzYXJ5LiBUaGUgc3RhcnQgYW5kIGZpbmlzaCBhcmUgc3BlY2lmaWVkIGFzIG1pbnV0ZXMgZnJvbSBtaWRuaWdodC4gQSBkYXkgY29udGFpbnMgMTQ0MCBtaW51dGVzIGFuZCBzbyBkYXlsaWdodCBtYXkgc3RhcnQgYXQgdGhlIDQwNXRoIG1pbnV0ZSBhbmQgY29udGludWUgdW50aWwgdGhlIDEwNjB0aCBtaW51dGUgKHNvIGZ1bGwgZGF5bGlnaHQgc3RhcnRzIGF0IDA2OjQ1IGFuZCBlbmRzIGF0IDE3OjQwKS4gIFRoaXMgIHN1bnJpc2Uvc2V0IGxvb2t1cCB0b29sIDxhIGNsYXNzPSJleHRlcm5hbGxpbmsiIGhyZWY9Imh0dHBzOi8vd3d3LnRpbWVhbmRkYXRlLmNvbS9zdW4vIiB0aXRsZT0ib25saW5lIHRvb2wiIHRhcmdldD0iX2JsYW5rIj5vbmxpbmUgdG9vbDwvYT4gd2FzIHVzZWQgdG8gb2J0YWluIHRoZSBkYXlsaWdodCB0aW1lcyAoYXMgSG91cnMgKjYwICsgTWludXRlcykuPGJyIC8+PGJyIC8+PGJyIC8+PGI+U3ludGF4PC9iPjo8YnIgLz54PURheWxpZ2h0KE1vbnRoLEhvdXIsTWludXRlKTxiciAvPjxiciAvPjxiPkV4YW1wbGUgVXNlczwvYj46PGJyIC8+RGF5bGlnaHRBdWc1YW09RGF5bGlnaHQoOCw1LDApPGJyIC8+PGJyIC8+SWYgRGF5bGlnaHQoVmFsKE1pZCQoREFURSQsNCwyKSksVmFsKExlZnQkKFRJTUUkLDIpKSxWYWwoTWlkJChUSU1FJCw0LDIpKSkgVGhlbiBMaWdodHNPZmYgRWxzZSBMaWdodHNPbjxiciAvPjxiciAvPjxiciAvPjxiPkNvZGU8L2I+PGJyIC8+PHByZT4NCglGdW5jdGlvbiBEYXlMaWdodChtbSBhcyBpbnRlZ2VyLGggYXMgaW50ZWdlcixtIGFzIGludGVnZXIpIGFzIGludGVnZXINCgkJbG9jYWwgaW50ZWdlciBtbixzdCxmbg0KDQoJCXNlbGVjdCBjYXNlIG1tDQoJCQlDYXNlIDEmIzU4O3N0PTQ4MCYjNTg7Zm49OTYwIAknMDhoMDAtMTZoMDAgc3RhcnQvZW5kIG9mIGZ1bGwgZGF5bGlnaHQgR01ULCBMb25kb24gVUsgLSBwcm9iYWJseSBPSyBmb3IgYWxsIG9mIFVLDQoJCQlDYXNlIDImIzU4O3N0PTQ2MCYjNTg7Zm49MTAxMAknMDdoNDAtMTZoNTAgeW91IG1heSBuZWVkIHRvIHR3ZWFrIHRoZXNlIGZvciB5b3VyIGxvY2F0aW9uDQoJCQlDYXNlIDMmIzU4O3N0PTQwNSYjNTg7Zm49MTA2MAknMDZoNDUtMTdoNDANCgkJCUNhc2UgNCYjNTg7c3Q9MzM1JiM1ODtmbj0xMTE1CScwNWgzNS0xOGgzNQ0KCQkJQ2FzZSA1JiM1ODtzdD0yNzAmIzU4O2ZuPTExNjUJJzA0aDMwLTE5aDI1DQoJCQlDYXNlIDYmIzU4O3N0PTIzMCYjNTg7Zm49MTIxMAknMDNoNTAtMjBoMTANCgkJCUNhc2UgNyYjNTg7c3Q9MjMwJiM1ODtmbj0xMjIwCScwM2g1MC0yMGgyMA0KCQkJQ2FzZSA4JiM1ODtzdD0yNjUmIzU4O2ZuPTExOTAJJzA0aDI1LTE5aDUwDQoJCQlDYXNlIDkmIzU4O3N0PTMxNSYjNTg7Zm49MTEyNQknMDVoMTUtMThoNDUNCgkJCUNhc2UgMTAmIzU4O3N0PTM2MCYjNTg7Zm49MTA2MAknMDZoMDAtMTdoNDANCgkJCUNhc2UgMTEmIzU4O3N0PTQxMCYjNTg7Zm49OTkwCScwNmg1MC0xNmgzMA0KCQkJQ2FzZSAxMiYjNTg7c3Q9NDY1JiM1ODtmbjk1NQknMDdoNDUtMTVoNTUNCgkJZW5kIHNlbGVjdA0KDQoJCW1uPWgmIzQyOzYwK20gJyBtaW5zIG9mIGRheQ0KCQlpZiBtbiZndDtzdCBhbmQgbW4mbHQ7Zm4gdGhlbg0KCQkJRGF5TGlnaHQ9MQ0KCQllbHNlDQoJCQlEYXlMaWdodD0wDQoJCWVuZGlmDQoJZW5kIGZ1bmN0aW9uDQo8L3ByZT5kZHWYZMT0vc0tPSBhkQSSMYQmnjlp" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="2068001F" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWEQK6v/WsDwK4z/TSAwK5z/TSAwK+z/TSAwK/z/TSAwK8z/TSAwK9z/TSAwKiz/TSAwK3j57gBwLH5ta/BQLG5ta/BQLB5ta/BQLA5ta/BQLD5ta/BQLC5ta/BQLd5ta/BQL9yYWiCX5Xkrrbu8Xman19X25J4xzwMiP2" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Logind57c.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fHistory.aspx%3fNS%3dMMBasic%26Page%3dMMBasic.Quick-and-Dirty-Daylight-Indicator%26Revision%3d0" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <h1 class="pagetitlesystem">Page History: Quick and Dirty Daylight Indicator</h1>
    <p>Compare Page Revisions</p> 
    <select name="ctl00$CphMaster$lstRev1" id="ctl00_CphMaster_lstRev1">
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <select name="ctl00$CphMaster$lstRev2" id="ctl00_CphMaster_lstRev2">
	<option value="Current">Current</option>
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <input type="submit" name="ctl00$CphMaster$btnCompare" value="Compare" id="ctl00_CphMaster_btnCompare" />
    <br /><br />
    
    <table class="box" cellpadding="0" cellspacing="0"><tr><td><p style="text-align: center;"><b>&laquo; Older Revision - <a href="MMBasic.Historycc78.html?Page=MMBasic.Quick-and-Dirty-Daylight-Indicator">Back to Page History</a> - <a href="MMBasic.Historyab4e.html?Page=MMBasic.Quick-and-Dirty-Daylight-Indicator&amp;Revision=00001">Newer Revision &raquo;</a></b></p></td></tr></table><br /><h3 class="separator">Page Revision: 2017/09/22 13:21</h3><br />The following is a function to provide a Boolean indicator of whether the given Month, Hour & minute occur during "Civil Daylight" i.e. this is the time considered between sunrise and sunset not including any twilight. It was written to provide some intelligence to exterior lighting so that it is only activated around the hours of darkness.<br /><br />It is very rough and ready and the use of daylight means it covers dawn & dusk (especially during the equinox zones). This means that although the daylight hours change considerably between the start and finish of say, March, The use of daylight will cover the twilight periods and so a degree of "over-compensation" is seen.  It also means that we only need to be concerned with whole months rather than specific dates which makes the function much smaller and less complex.<br /><br />The times in the data statements are UTC (i.e. no daylight saving time) in 12 groups and are hard-coded for London, UK - you  will need to change these for your own location and time format if necessary. The start and finish are specified as minutes from midnight. A day contains 1440 minutes and so daylight may start at the 405th minute and continue until the 1060th minute (so full daylight starts at 06:45 and ends at 17:40).  This  sunrise/set lookup tool <a class="externallink" href="https://www.timeanddate.com/sun/" title="online tool" target="_blank">online tool</a> was used to obtain the daylight times (as Hours *60 + Minutes).<br /><br /><br /><b>Syntax</b>:<br />x=Daylight(Month,Hour,Minute)<br /><br /><b>Example Uses</b>:<br />DaylightAug5am=Daylight(8,5,0)<br /><br />If Daylight(Val(Mid$(DATE$,4,2)),Val(Left$(TIME$,2)),Val(Mid$(TIME$,4,2))) Then LightsOff Else LightsOn<br /><br /><br /><b>Code</b><br /><pre>
	Function DayLight(mm as integer,h as integer,m as integer) as integer
		local integer mn,st,fn

		select case mm
			Case 1&#58;st=480&#58;fn=960 	'08h00-16h00 start/end of full daylight GMT, London UK - probably OK for all of UK
			Case 2&#58;st=460&#58;fn=1010	'07h40-16h50 you may need to tweak these for your location
			Case 3&#58;st=405&#58;fn=1060	'06h45-17h40
			Case 4&#58;st=335&#58;fn=1115	'05h35-18h35
			Case 5&#58;st=270&#58;fn=1165	'04h30-19h25
			Case 6&#58;st=230&#58;fn=1210	'03h50-20h10
			Case 7&#58;st=230&#58;fn=1220	'03h50-20h20
			Case 8&#58;st=265&#58;fn=1190	'04h25-19h50
			Case 9&#58;st=315&#58;fn=1125	'05h15-18h45
			Case 10&#58;st=360&#58;fn=1060	'06h00-17h40
			Case 11&#58;st=410&#58;fn=990	'06h50-16h30
			Case 12&#58;st=465&#58;fn955	'07h45-15h55
		end select

		mn=h&#42;60+m ' mins of day
		if mn&gt;st and mn&lt;fn then
			DayLight=1
		else
			DayLight=0
		endif
	end function
</pre>
    
    


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.Quick-and-Dirty-Daylight-Indicator&Revision=0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:52:36 GMT -->
</html>
