

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Random-File-Access-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Random File Access - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Random-File-Access-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFuRA8aDEgY2xhc3M9InBhZ2V0aXRsZSI+UmFuZG9tIEZpbGUgQWNjZXNzPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxNi8xMi8yMyAyMzozOCBieSBBZG1pbmlzdHJhdG9yICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEZpbGVzeXN0ZW0sIF9MSUIgT3JpZ2luYWwgTU1CYXNpYzwvc21hbGw+PGJyIC8+PGJyIC8+PGgyIGNsYXNzPSJzZXBhcmF0b3IiPlRoaXMgbW9kdWxlIGlzIHBhcnQgb2YgdGhlIG9yaWdpbmFsIE1NQmFzaWMgbGlicmFyeS4gSXQgaXMgcmVwcm9kdWNlZCBoZXJlIHdpdGgga2luZCBwZXJtaXNzaW9uIG9mIEh1Z2ggQnVja2xlIGFuZCBHZW9mZiBHcmFoYW0uIEJlIGF3YXJlIGl0IG1heSByZWZlcmVuY2UgZnVuY3Rpb25hbGl0eSB3aGljaCBoYXMgY2hhbmdlZCBvciBpcyBkZXByZWNhdGVkIGluIHRoZSBsYXRlc3QgdmVyc2lvbnMgb2YgTU1CYXNpYy48YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiBocmVmPSIjVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMj48Yj5Ob3RlPC9iPjogQW55IHJlcXVpcmVkIGZpbGUocykgYXJlIGF2YWlsYWJsZSBpbiB0aGUgYXR0YWNobWVudHMgdGFiICh0b3AgcmlnaHQpLjxiciAvPjxiciAvPjxiPlJBTkRPTS5CQVM8L2I+PGJyIC8+PHByZT4NCicgRGVtb25zdHJhdGlvbiBvZiByYW5kb20gZmlsZSBhY2Nlc3MuDQonIEdlb2ZmIEdyYWhhbSAgIEp1bHkgMjAxMw0KJw0KJyBVc2luZyB0aGlzIHByb2dyYW0geW91IGNhbiBhcHBlbmQgdG8gYSBmaWxlICh0byBhZGQgc29tZSBkYXRhIGluIHRoZSBmaXJzdCBwbGFjZSkNCicgdGhlbiByZWFkL3dyaXRlIHJlY29yZHMgdXNpbmcgcmFuZG9tIHJlY29yZCBudW1iZXJzLiAgVGhlIGZpcnN0IHJlY29yZCBpbg0KJyB0aGUgZmlsZSBpcyByZWNvcmQgbnVtYmVyIDEsIHRoZSBzZWNvbmQgaXMgMiwgZXRjLg0KDQpSZWNMZW4gPSA2NA0KT1BFTiAidGVzdC5kYXQiIEZPUiBSQU5ET00gQVMgJiMzNTsxDQpETw0KCWFib3J0JiM1ODsgUFJJTlQNCglQUklOVCAiTnVtYmVyIG9mIHJlY29yZHMgaW4gdGhlIGZpbGUgPSIgTE9GKCYjMzU7MSkvUmVjTGVuDQoJSU5QVVQgIkNvbW1hbmQgKHIgPSByZWFkLHcgPSB3cml0ZSwgYSA9IGFwcGVuZCwgcSA9IHF1aXQpJiM1ODsgIiwgY21kJA0KCUlGIGNtZCQgPSAicSIgVEhFTiBDTE9TRSAmIzM1OzEgJiM1ODsgRU5EDQoJSUYgY21kJCA9ICJhIiBUSEVODQoJCVNFRUsgJiMzNTsxLCBMT0YoJiMzNTsxKSArIDENCglFTFNFDQoJCUlOUFVUICJSZWNvcmQgTnVtYmVyJiM1ODsgIiwgbmJyDQoJCUlGIG5iciAmbHQ7IDEgb3IgbmJyICZndDsgTE9GKCYjMzU7MSkvUmVjTGVuIFRIRU4gUFJJTlQgIkludmFsaWQgcmVjb3JkIiAmIzU4OyBHT1RPIGFib3J0DQoJCVNFRUsgJiMzNTsxLCBSZWNMZW4gJiM0MjsgKG5iciAtIDEpICsgMQ0KCUVORElGDQoJSUYgY21kJCA9ICJyIiBUSEVODQoJCVBSSU5UICJUaGUgcmVjb3JkID0gIiBJTlBVVCQoUmVjTGVuLCAmIzM1OzEpDQoJRUxTRQ0KCQlMSU5FIElOUFVUICJFbnRlciB0aGUgZGF0YSB0byBiZSB3cml0dGVuJiM1ODsgIiwgZGF0JA0KCQlQUklOVCAmIzM1OzEsZGF0JCArIFNQQUNFJChSZWNMZW4gLSBMRU4oZGF0JCkpOw0KCUVORElGDQpMT09QDQoNCjwvcHJlPmRkWdhsx4rLF+fJkicfKZV9nK+0Y1g=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Random File Access</h1><small>Modified on 2016/12/23 23:38 by Administrator &mdash; Categorized as: Filesystem, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><b>RANDOM.BAS</b><br /><pre>
' Demonstration of random file access.
' Geoff Graham   July 2013
'
' Using this program you can append to a file (to add some data in the first place)
' then read/write records using random record numbers.  The first record in
' the file is record number 1, the second is 2, etc.

RecLen = 64
OPEN "test.dat" FOR RANDOM AS &#35;1
DO
	abort&#58; PRINT
	PRINT "Number of records in the file =" LOF(&#35;1)/RecLen
	INPUT "Command (r = read,w = write, a = append, q = quit)&#58; ", cmd$
	IF cmd$ = "q" THEN CLOSE &#35;1 &#58; END
	IF cmd$ = "a" THEN
		SEEK &#35;1, LOF(&#35;1) + 1
	ELSE
		INPUT "Record Number&#58; ", nbr
		IF nbr &lt; 1 or nbr &gt; LOF(&#35;1)/RecLen THEN PRINT "Invalid record" &#58; GOTO abort
		SEEK &#35;1, RecLen &#42; (nbr - 1) + 1
	ENDIF
	IF cmd$ = "r" THEN
		PRINT "The record = " INPUT$(RecLen, &#35;1)
	ELSE
		LINE INPUT "Enter the data to be written&#58; ", dat$
		PRINT &#35;1,dat$ + SPACE$(RecLen - LEN(dat$));
	ENDIF
LOOP

</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Random-File-Access-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:57 GMT -->
</html>
