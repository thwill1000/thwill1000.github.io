

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.VB%20Work-a-like%20SPLIT%20Function by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:24:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	SPLIT Function (VB work-a-like) - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.VB+Work-a-like+SPLIT+Function" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFmhY8aDEgY2xhc3M9InBhZ2V0aXRsZSI+U1BMSVQgRnVuY3Rpb24gKFZCIHdvcmstYS1saWtlKTwvaDE+PHNtYWxsPk1vZGlmaWVkIG9uIDIwMjEvMTAvMjcgMDc6MzIgYnkgQ2FwdGFpbkJvaW5nICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEFycmF5cywgU3RyaW5nczwvc21hbGw+PGJyIC8+PGJyIC8+VGhlIFNwbGl0IGZ1bmN0aW9uIGJyZWFrcyBhIHN0cmluZyBpbnRvIGFuIGFycmF5IGFuZCByZXR1cm5zIHRoZSBoaWdoZXN0IGRpbWVuc2lvbiBvZiB0aGUgYXJyYXkuIFRoZSBlbGVtZW50cyBvZiB0aGUgYXJyYXkgYXJlIHRoZSBkZWxpbWl0ZWQgc3ViLXN0cmluZ3Mgb2YgdGhlIGlucHV0IHN0cmluZy4gPGJyIC8+PGJyIC8+VGhlIHN1Yi1zdHJpbmdzIGFyZSBhbHdheXMgcmV0dXJuZWQgaW4gdGhlIGFycmF5IFNQJCwgMSBpcyB0aGUgZmlyc3Qgc3ViLXN0cmluZy4gPGJyIC8+PGJyIC8+U3BsaXQoKSB0cmFzaGVzIHRoZSBwYXNzZWQgaW4gc3RyaW5nIC0gaWYgdGhpcyBpcyBhIHByb2JsZW0gY29uc2lkZXIgPGEgY2xhc3M9InBhZ2VsaW5rIiB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iTU1CYXNpYy5CeVJFRi1CeVZBTC1WQi13b3JrLWEtbGlrZS5hc2h4IiB0aXRsZT0iQnlSRUYgJiBCeVZBTCAtIChWQiB3b3JrLWEtbGlrZSkiPnRoaXMgbWV0aG9kPC9hPi48YnIgLz48YnIgLz5Db21tb25seSwgYWZ0ZXIgYSBTcGxpdCgpLCBvbmUgdXNlcyB0aGUgVUJvdW5kKCkgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSBudW1iZXIgb2Ygc3Vic3RyaW5ncy4gTU1iYXNpYyBkb2VzIG5vdCBoYXZlIFVCb3VuZCBidXQgdGhlIFNwbGl0IGZ1bmN0aW9uIHJlcG9ydHMgdGhlIG51bWJlciBvZiBlbGVtZW50cy4gSWYgbm8gZGVsaW1pdGVyIGlzIGZvdW5kLCBpdCByZXBvcnRzIDEgZWxlbWVudCAtIHdpdGggU1AoMSkgYXMgdGhlIGVudGlyZSBzdHJpbmcuIDxiciAvPjxiciAvPlN1YnN0cmluZ3MgYXJlIG5vdCB0cmltbWVkLjxiciAvPjxiciAvPlRoZSBkZWxpbWl0ZXIgY2FuIGJlIGFueSBsZW5ndGg+MC48YnIgLz48YnIgLz5Db21wYXRpYmxlIHdpdGggYWxsIHZlcnNpb25zIG9mIE1NQmFzaWMuPGJyIC8+PGJyIC8+PGI+U3ludGF4PC9iPjo8YnIgLz4gICAgTnVtT2ZFbGVtZW50cz1TcGxpdChTdHJpbmdUb1NwbGl0LCBkZWxpbWV0ZXIpPGJyIC8+PGJyIC8+PGI+RXhhbXBsZSB1c2FnZTwvYj46PGJyIC8+CXo9U3BsaXQoVGltZSQsIjoiKTxiciAvPiAgICAgICAgRk9SIG49MSBUTyB6PGJyIC8+ICAgICAgICAgICAgUFJJTlQgbixTUCQobik8YnIgLz4gICAgICAgIE5FWFQ8YnIgLz48YnIgLz48Yj5Db2RlPC9iPjo8YnIgLz48cHJlPiBGVU5DVElPTiBTcGxpdChhJCxiJCkgQXMgSW50ZWdlcicgcmV0dXJucyB0aGUgbnVtYmVyIG9mIGRpbWVuc2lvbnMgaW4gU1AkIGFsd2F5cyBzdGFydHMgZnJvbSAxIHJlZ2FyZGxlc3Mgb2YgT1BUSU9OIEJBU0UNCiAgICBMT0NBTCBJTlRFR0VSIHosbixtDQogICAgSUYgYiQ9IiIgdGhlbiBTcGxpdD0wJiM1ODtFWElUIEZVTkNUSU9OICcgY2FuJ3Qgc3BsaXQgd2l0aCBhbiBlbXB0eSBkZWxpbWl0ZXINCg0KICAgICcgaWYgU1AkIGRvZXNuJ3QgZXhpc3QsIHRoZSBFUkFTRSB3aWxsIGNhdXNlIGFuIGVycm9yLCBjaG9vc2Ugd2hpY2ggT04gRVJST1IgU0tJUCB5b3UgbmVlZCANCg0KJ01NLlZlciAmbHQ7NS4wNA0KICAgIE9OIEVSUk9SIFNLSVAgICAgDQonTU0uVmVyICZndDs9NS4wNA0KICAgIE9OIEVSUk9SIFNLSVAgMQ0KDQogICAgRVJBU0UgU1AkDQogICAgej0xJiM1ODtuPTANCiAgICBETyAnY291bnQgaW5zdGFuY2VzIG9mIGRlbGltaXRlciBmb3IgRElNIFNQJCgpDQogICAgICB6PUlOU1RSKHosYSQsYiQpDQogICAgICBJRiB6PTAgVEhFTg0KICAgICAgICBJRiBuPTAgVEhFTiAnIG5vIGRlbGltZXRlcnMNCiAgICAgICAgICBESU0gU1AkKDEpJiM1ODtTUCQoMSk9YSQmIzU4O1NwbGl0PTEmIzU4O0VYSVQgRlVOQ1RJT04gJyBvbmx5IG9uZSBzdWJzdHJpbmcNCiAgICAgICAgRUxTRSAgICAgICAgICANCiAgICAgICAgICBFWElUIERPDQogICAgICAgIEVORCBJRg0KICAgICAgRUxTRQ0KICAgICAgICBuPW4rMSYjNTg7ej16K0xFTihiJCkNCiAgICAgIEVORCBJRg0KICAgIExPT1ANCg0KICAgIG09bisxJiM1ODtuPTENCiAgICBESU0gU1AkKG0pDQogICAgRE8gDQogICAgICB6PUlOU1RSKDEsYSQsYiQpDQogICAgICBJRiB6PTAgVEhFTiANCiAgICAgICAgU1AkKG0pPWEkJiM1ODtFWElUIERPDQogICAgICBFTFNFDQogICAgICAgIFNQJChuKT1MRUZUJChhJCx6LTEpJiM1ODthJD1NSUQkKGEkLHorTEVOKGIkKSkmIzU4O249bisxDQogICAgICBFTkQgSUYNCiAgICBMT09QDQogICAgU3BsaXQ9bQ0KICBFTkQgRlVOQ1RJT048L3ByZT48YnIgLz4gIDxiciAvPjxiciAvPjxiPlNlZSBhbHNvPC9iPjxiciAvPlRoZSA8YSBjbGFzcz0icGFnZWxpbmsiIGhyZWY9Ik1NQmFzaWMuRmllbGQtRnVuY3Rpb24tY0ZpZWxkLmFzaHgiIHRpdGxlPSJGaWVsZCBGdW5jdGlvbiBjRmllbGQkIj5jRmllbGQkPC9hPiBDRnVuY3Rpb24gZXh0cmFjdHMgaW5kaXZpZHVhbCBmaWVsZHMgZnJvbSBhIHN0cmluZyBpbiByZWFsLXRpbWUgcmF0aGVyIHRoYW4gc3BsaXR0aW5nIGFuZCB5b3UgbWlnaHQgY29uc2lkZXIgdGhpcyBhcyBpdCBvZmZlcnMgYWR2YW50YWdlcyBvZiBzcGVlZCBhbmQgbWVtb3J5IG92ZXIgU3BsaXQoKSBidXQgaGFzIHNvbWUgbGltaXRhdGlvbnMgaW4gdGhhdCBhbiBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQgaWYgdGhlIGRlbGltaXRlciBpcyBub3QgZm91bmQgYW5kIHRoZXJlIGlzIG5vIHdheSBvZiB0ZWxsaW5nIHRoZSBudW1iZXIgb2Ygc3Vic3RyaW5ncy4gPGJyIC8+ZGTaZgHd5ElxK4Lc0/+263h4jkFxEg==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">SPLIT Function (VB work-a-like)</h1><small>Modified on 2021/10/27 07:32 by CaptainBoing &mdash; Categorized as: Arrays, Strings</small><br /><br />The Split function breaks a string into an array and returns the highest dimension of the array. The elements of the array are the delimited sub-strings of the input string. <br /><br />The sub-strings are always returned in the array SP$, 1 is the first sub-string. <br /><br />Split() trashes the passed in string - if this is a problem consider <a class="pagelink" target="_blank" href="MMBasic.ByREF-ByVAL-VB-work-a-like.html" title="ByREF & ByVAL - (VB work-a-like)">this method</a>.<br /><br />Commonly, after a Split(), one uses the UBound() function to determine the number of substrings. MMbasic does not have UBound but the Split function reports the number of elements. If no delimiter is found, it reports 1 element - with SP(1) as the entire string. <br /><br />Substrings are not trimmed.<br /><br />The delimiter can be any length>0.<br /><br />Compatible with all versions of MMBasic.<br /><br /><b>Syntax</b>:<br />    NumOfElements=Split(StringToSplit, delimeter)<br /><br /><b>Example usage</b>:<br />	z=Split(Time$,":")<br />        FOR n=1 TO z<br />            PRINT n,SP$(n)<br />        NEXT<br /><br /><b>Code</b>:<br /><pre> FUNCTION Split(a$,b$) As Integer' returns the number of dimensions in SP$ always starts from 1 regardless of OPTION BASE
    LOCAL INTEGER z,n,m
    IF b$="" then Split=0&#58;EXIT FUNCTION ' can't split with an empty delimiter

    ' if SP$ doesn't exist, the ERASE will cause an error, choose which ON ERROR SKIP you need 

'MM.Ver &lt;5.04
    ON ERROR SKIP    
'MM.Ver &gt;=5.04
    ON ERROR SKIP 1

    ERASE SP$
    z=1&#58;n=0
    DO 'count instances of delimiter for DIM SP$()
      z=INSTR(z,a$,b$)
      IF z=0 THEN
        IF n=0 THEN ' no delimeters
          DIM SP$(1)&#58;SP$(1)=a$&#58;Split=1&#58;EXIT FUNCTION ' only one substring
        ELSE          
          EXIT DO
        END IF
      ELSE
        n=n+1&#58;z=z+LEN(b$)
      END IF
    LOOP

    m=n+1&#58;n=1
    DIM SP$(m)
    DO 
      z=INSTR(1,a$,b$)
      IF z=0 THEN 
        SP$(m)=a$&#58;EXIT DO
      ELSE
        SP$(n)=LEFT$(a$,z-1)&#58;a$=MID$(a$,z+LEN(b$))&#58;n=n+1
      END IF
    LOOP
    Split=m
  END FUNCTION</pre><br />  <br /><br /><b>See also</b><br />The <a class="pagelink" href="MMBasic.Field-Function-cField.html" title="Field Function cField$">cField$</a> CFunction extracts individual fields from a string in real-time rather than splitting and you might consider this as it offers advantages of speed and memory over Split() but has some limitations in that an empty string is returned if the delimiter is not found and there is no way of telling the number of substrings. <br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.VB%20Work-a-like%20SPLIT%20Function by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:24:25 GMT -->
</html>
