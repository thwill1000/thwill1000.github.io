

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Potentiometer-test-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Potentiometer test - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Potentiometer-test-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFnxc8aDEgY2xhc3M9InBhZ2V0aXRsZSI+UG90ZW50aW9tZXRlciB0ZXN0PC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxNi8xMi8yMyAyMzo0MyBieSBBZG1pbmlzdHJhdG9yICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IEVsZWN0cm9uaWNzLCBfTElCIE9yaWdpbmFsIE1NQmFzaWM8L3NtYWxsPjxiciAvPjxiciAvPjxoMiBjbGFzcz0ic2VwYXJhdG9yIj5UaGlzIG1vZHVsZSBpcyBwYXJ0IG9mIHRoZSBvcmlnaW5hbCBNTUJhc2ljIGxpYnJhcnkuIEl0IGlzIHJlcHJvZHVjZWQgaGVyZSB3aXRoIGtpbmQgcGVybWlzc2lvbiBvZiBIdWdoIEJ1Y2tsZSBhbmQgR2VvZmYgR3JhaGFtLiBCZSBhd2FyZSBpdCBtYXkgcmVmZXJlbmNlIGZ1bmN0aW9uYWxpdHkgd2hpY2ggaGFzIGNoYW5nZWQgb3IgaXMgZGVwcmVjYXRlZCBpbiB0aGUgbGF0ZXN0IHZlcnNpb25zIG9mIE1NQmFzaWMuPGEgY2xhc3M9ImhlYWRlcmFuY2hvciIgaWQ9IlRoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgaHJlZj0iI1RoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgdGl0bGU9IkxpbmsgdG8gdGhpcyBTZWN0aW9uIj4mIzAxODI7PC9hPjwvaDI+PGI+Tm90ZTwvYj46IEFueSByZXF1aXJlZCBmaWxlKHMpIGFyZSBhdmFpbGFibGUgaW4gdGhlIGF0dGFjaG1lbnRzIHRhYiAodG9wIHJpZ2h0KS48YnIgLz48YnIgLz48YnIgLz48Yj5Qb3RUZXN0LmJhczwvYj48YnIgLz48cHJlPg0KJyBQb3RlbnRpb21ldGVyIHRlc3QNCicgJiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTstDQonIEF1dGhvciYjNTg7IEdyYWVtZSBBbmRlcnNvbg0KJyBEYXRlJiM1ODsgICBPY3QtMjAxMg0KJyAmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1Oy0NCg0KJyBHTkQgYW5kIHBpbiAxMCBhcmUgdGhlIDEwayByZXNpc3RhbmNlICAmIzQ1OyYjNDU7LS9cL1wvXC9cL1wmIzQ1OyYjNDU7LQ0KJyBwaW4gOCBpcyB0aGUgd2lwZXIgICAgICAgICAgICAgICAgICAgICAgICAmIzQ1OyYjNDU7JiM0NTsmIzQ1O14NCg0KICBTZXRQaW4gOCwxICcgYW5hbG9nIGlucHV0DQogIFNldFBpbiAxMCw4ICcgZGlnaXRhbCBvdXRwdXQgKHVzZWQgYXMgdispDQogICcgSSB1c2UgcGluIDEwIGFzIHYrIGFzIHRoZSB3aXJpbmcgb2YgbXkgcHJvamVjdCBpcyBuZWF0ZXINCiAgJyBhbmQgSSBjYW4gZGVhY3RpdmF0ZSB0aGUgcG90IGJ5IHNldHRpaW5nIHBpbiAxMCBsb3cuDQoNCiAgJyBSZWFkIHZhbHVlIGZyb20gcGluIDggdG8gY2hlY2sgZm9yIGFueSBjaGFuZ2UgYXMgcGluIDEwIGlzIHNldCBmcm9tIGxvdyB0bw0KICAnIGhpZ2guIElmIGEgY2hhbmdlIGlzIGRldGVjdGVkIHRoZSB0aGUgcG90ZW50aW9tZXRlciBpcyBjb25uZWN0ZWQuDQogICcgU2V0IHRoZSB3aXBlciB0byBhYm91dCBtaWR3YXkgdG8gZW5zdXJlIHRoYXQgdGhlIHByb2dyYW0gZGV0ZWN0cyB0aGUgcG90DQogIFBpbigxMCk9MCAnIGluaXRpYWwgbG93DQogIEZvciBpID0gMSBUbyAxMA0KICAgIHZWYWx1ZSA9IFBpbig4KSAnIGluaXRpYWwgdm9sdGFnZSB2YWx1ZQ0KICBOZXh0DQogIFBpbigxMCk9MSAnIHNldCBoaWdoICgzLjN2KQ0KDQogIElmIEFicyhQaW4oOCkgLSB2VmFsdWUpJmd0OzEgVGhlbiAnIHBvdCBpcyBjb25uZWN0ZWQgKHRoaXMgaXMgbm90IGZvb2xwcm9vZiEpDQogICAgJyBjYWxicmF0aW9uDQogICAgJyB0aGUgdmFsdWUgcmVhZCBjYW4gcmVwcmVzZW50IGFueXRoaW5nOyBteSBwcm9qZWN0IHRyZWF0cyBpdCBhcyBtaWxsaXNlY29uZHMNCiAgICBQcmludCAiUm90YXRlIHRoZSBwb3RlbnRpb21ldGVyIHRvIG9uZSBleHRyZW1lIGFuZCAiOw0KICAgIElucHV0ICJlbnRlciB0aGUgbWluaW11bSBkZWxheSAobXMpIjtkTWluDQogICAgdk1pbiA9UGluKDgpDQogICAgUHJpbnQgIlJvdGF0ZSB0aGUgcG90ZW50aW9tZXRlciB0byB0aGUgb3RoZXIgZXh0cmVtZSBhbmQgIjsNCiAgICBJbnB1dCAiZW50ZXIgdGhlIG1heGltdW0gZGVsYXkgKG1zKSI7ZE1heA0KICAgIHZNYXg9UGluKDgpDQoNCiAgICBDbHMNCiAgICBQcmludCBAKDUwLCA4MCkgIkRlbGF5ID0gIjsNCg0KICAgIERvDQogICAgICB2VmFsdWUgPVBpbig4KQ0KICAgICAgZFZhbHVlPUNpbnQoZE1pbitBYnMoKGRtYXgtZG1pbikvKHZtYXgtdm1pbikpJiM0Mjt2VmFsdWUpDQoNCiAgICAgIElmIGR2YWx1ZSAmbHQ7Jmd0OyBkUHJldiBUaGVuDQogICAgICAgIFByaW50IEAoOTAsIDgwKSBkdmFsdWU7IiBtcyAgIg0KICAgICAgICBQcmludCBTdHJpbmckKENpbnQoZFZhbHVlJiM0Mjs3MC9kTWF4KSwiJiMzNTsiKTtTcGFjZSQoNzApDQogICAgICBFbmRJZg0KICAgICAgZFByZXYgPSBkVmFsdWUNCiAgICBMb29wDQogIEVsc2UNCiAgICBQcmludCAiUG90ZW50aW9tZXRlciB3YXMgbm90IGRldGVjdGVkIg0KICBFbmRJZg0KDQoNCjwvcHJlPmRk89knNx23txmH6IKurG3JNI6/YtY=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Potentiometer test</h1><small>Modified on 2016/12/23 23:43 by Administrator &mdash; Categorized as: Electronics, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><br /><b>PotTest.bas</b><br /><pre>
' Potentiometer test
' &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
' Author&#58; Graeme Anderson
' Date&#58;   Oct-2012
' &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-

' GND and pin 10 are the 10k resistance  &#45;&#45;-/\/\/\/\/\&#45;&#45;-
' pin 8 is the wiper                        &#45;&#45;&#45;&#45;^

  SetPin 8,1 ' analog input
  SetPin 10,8 ' digital output (used as v+)
  ' I use pin 10 as v+ as the wiring of my project is neater
  ' and I can deactivate the pot by settiing pin 10 low.

  ' Read value from pin 8 to check for any change as pin 10 is set from low to
  ' high. If a change is detected the the potentiometer is connected.
  ' Set the wiper to about midway to ensure that the program detects the pot
  Pin(10)=0 ' initial low
  For i = 1 To 10
    vValue = Pin(8) ' initial voltage value
  Next
  Pin(10)=1 ' set high (3.3v)

  If Abs(Pin(8) - vValue)&gt;1 Then ' pot is connected (this is not foolproof!)
    ' calbration
    ' the value read can represent anything; my project treats it as milliseconds
    Print "Rotate the potentiometer to one extreme and ";
    Input "enter the minimum delay (ms)";dMin
    vMin =Pin(8)
    Print "Rotate the potentiometer to the other extreme and ";
    Input "enter the maximum delay (ms)";dMax
    vMax=Pin(8)

    Cls
    Print @(50, 80) "Delay = ";

    Do
      vValue =Pin(8)
      dValue=Cint(dMin+Abs((dmax-dmin)/(vmax-vmin))&#42;vValue)

      If dvalue &lt;&gt; dPrev Then
        Print @(90, 80) dvalue;" ms  "
        Print String$(Cint(dValue&#42;70/dMax),"&#35;");Space$(70)
      EndIf
      dPrev = dValue
    Loop
  Else
    Print "Potentiometer was not detected"
  EndIf


</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Potentiometer-test-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:26 GMT -->
</html>
