

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:42:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Battery Capacity Test - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=Battery-Capacity-Test-part-of-the-original-MMBasic-library&amp;NS=MMBasic&amp;NoRedirect=1" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPZBYCZg8WAh4LXyFJdGVtQ291bnQCAhYEAgEPZBYCZg8VBMoBR2V0RmlsZS5hc3B4P0ZpbGU9QmF0dGVyeS5naWYmYW1wO0FzU3RyZWFtQXR0YWNobWVudD0xJmFtcDtQcm92aWRlcj1TY3Jld1R1cm4uV2lraS5GaWxlc1N0b3JhZ2VQcm92aWRlciZhbXA7SXNQYWdlQXR0YWNobWVudD0xJmFtcDtQYWdlPU1NQmFzaWMuQmF0dGVyeS1DYXBhY2l0eS1UZXN0LXBhcnQtb2YtdGhlLW9yaWdpbmFsLU1NQmFzaWMtbGlicmFyeQhEb3dubG9hZAtCYXR0ZXJ5LmdpZggyNy41MSBLQmQCAg9kFgJmDxUEywFHZXRGaWxlLmFzcHg/RmlsZT1CQVRURVJZMi5wZGYmYW1wO0FzU3RyZWFtQXR0YWNobWVudD0xJmFtcDtQcm92aWRlcj1TY3Jld1R1cm4uV2lraS5GaWxlc1N0b3JhZ2VQcm92aWRlciZhbXA7SXNQYWdlQXR0YWNobWVudD0xJmFtcDtQYWdlPU1NQmFzaWMuQmF0dGVyeS1DYXBhY2l0eS1UZXN0LXBhcnQtb2YtdGhlLW9yaWdpbmFsLU1NQmFzaWMtbGlicmFyeQhEb3dubG9hZAxCQVRURVJZMi5wZGYJMTk3LjYzIEtCZGTPY//umzPxreMkrANzu/k37y3v7w==" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Logine6ec.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dBattery-Capacity-Test-part-of-the-original-MMBasic-library%26NS%3dMMBasic%26NoRedirect%3d1" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.History9889.html?Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library">History</a>
			<a id="PageAttachmentsLink" title="Attachments" href="#" onclick="javascript:return __ToggleAttachmentsMenu(event.clientX, event.clientY);">Attachments</a>
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			Battery Capacity Test
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Print9889.html?Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2016/12/23 23:19
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.User6a4a.html?Username=admin">Administrator</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPagese076.html?Cat=MMBasic.Control" title="Control">Control</a>, <a href="MMBasic.AllPages5ce5.html?Cat=MMBasic.Electronics" title="Electronics">Electronics</a>, <a href="MMBasic.AllPagesbcca.html?Cat=MMBasic.Environment" title="Environment">Environment</a>, <a href="MMBasic.AllPages0f85.html?Cat=MMBasic._LIB%20Original%20MMBasic" title="_LIB Original MMBasic">_LIB Original MMBasic</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="f1920d51b-d90b-4c5a-8665-ec41cda49410" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f1920d51b-d90b-4c5a-8665-ec41cda49410');"></div><div id="f1f18ae70-7fbf-407b-afe3-1bcc165a5cfb" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f1f18ae70-7fbf-407b-afe3-1bcc165a5cfb');"></div><div id="f14833b2b-3051-43a8-96cb-3ddf86efb0b2" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f14833b2b-3051-43a8-96cb-3ddf86efb0b2');"></div><div id="s7d3bd839-3cd5-425d-bfde-8690774ee021" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s7d3bd839-3cd5-425d-bfde-8690774ee021');"></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.Backpack-Tracker-curve-tracer.html" title="Backpack Tracker curve tracer (MMBasic)">Backpack Tracker curve tracer (MMBasic)</a> &raquo; <a href="MMBasic.Base64-Mime-Encode-and-Decode-Functions.html" title="Base64 Mime Encode and Decode Functions (MMBasic)">Base64 Mime Encode and Decode Functions (MMBasic)</a> &raquo; <b><a href="MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library.html" title="Battery Capacity Test (MMBasic)">Battery Capacity Test (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.MainPage.html" title="Main Page (MicroMite ArmMite and MMX Hardware)">Main Page (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.Armmite-F4-Hardware.html" title="Armmite F4 Hardware (MicroMite ArmMite and MMX Hardware)">Armmite F4 Hardware (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.37-Sensor-45-sensor-kits.html" title="37 Sensor, 45 sensor kits (MicroMite ArmMite and MMX Hardware)">37 Sensor, 45 sensor kits (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MMBasic.ARMMite-Pin-Aliases.html" title="ARMMite H7 Pin Aliases (MMBasic)">ARMMite H7 Pin Aliases (MMBasic)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.PicoMite.html" title="PicoMite (MicroMite ArmMite and MMX Hardware)">PicoMite (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MMBasic.Astrofix-part-of-the-original-MMBasic-library.html" title="Astrofix (MMBasic)">Astrofix (MMBasic)</a> &raquo; <a href="MMBasic.Automatic-LogFile-Naming-part-of-the-original-MMBasic-library.html" title="Automatic LogFile Naming (MMBasic)">Automatic LogFile Naming (MMBasic)</a> &raquo; <a href="MMBasic.Backpack-Tracker-curve-tracer.html" title="Backpack Tracker curve tracer (MMBasic)">Backpack Tracker curve tracer (MMBasic)</a> &raquo; <a href="MMBasic.Base64-Mime-Encode-and-Decode-Functions.html" title="Base64 Mime Encode and Decode Functions (MMBasic)">Base64 Mime Encode and Decode Functions (MMBasic)</a> &raquo; <b><a href="MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library.html" title="Battery Capacity Test (MMBasic)">Battery Capacity Test (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		<h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><br /><b>BATTERY.BAS </b><br /><pre>
100 ' BATTERY.BAS
105 ' Program to test the capacity of a battery
110 ' See Silicon Chip May 2011 for circuit details
115 ' V1.0
120 '
125 '
130 ' Measured resistance of the four load resistors
135 ' These are constant values determined by measuring the actual resistance
140 ' with a digital multimeter.  They must be in descending order of values
145 R1 = 56.00
150 R2 = 22.00
155 R3 =  8.20
160 R4 =  3.33
165 '
170 ' Measured value of the 3.3 volt supply
175 Vdd = 3.29
180 '
185 '
190 ' Default terminating voltage level and test current
195 TerminatingVolts = 1.0
200 TestCurrent = 120
205 '
210 '
215 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
220 ' Configure the input and output pins
225 PIN(11) = 1 &#58; PIN(12) = 1 &#58; PIN(13) = 1 &#58; PIN(14) = 1
230 SETPIN 11, 9 &#58; SETPIN 12, 9 &#58; SETPIN 13, 9 &#58; SETPIN 14, 9
235 SETPIN 1,1
240 '
245 '
250 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
255 ' Get the operating parameters from the user
260 ' check each response to make sure that it is within acceptable range
265 '
270 CLS &#58; PRINT "Battery test V1.0" &#58; PRINT
275 DO
280   INPUT "Enter the approx test current in mA (600 to 25)&#58; ", TestCurrent
285 LOOP WHILE TestCurrent &lt; 25 OR TestCurrent &gt; 600
290 '
295 DO
300   PRINT "Enter the terminating voltage ";
305   PRINT "(default "; FORMAT$(TerminatingVolts, "%4.2f"); ")&#58; ";
310   INPUT "", TerminatingVolts
315 LOOP WHILE TerminatingVolts &lt; 0.5 OR TerminatingVolts &gt; 2
320 '
325 PRINT
330 IF PIN(1) / 3.3 &#42; Vdd &lt; TerminatingVolts THEN
335   PRINT "To start the test place the charged battery in the holder";
340   DO &#58; LOOP WHILE PIN(1) / 3.3 &#42; Vdd &lt; TerminatingVolts
345   PRINT &#58; PRINT
350 ENDIF
355 '
360 '
365 '
370 TIME$ = "0&#58;0&#58;0"
375 LASTTIME$ = TIME$
380 PRINT "TIME    ", "VOLTS   ", "CURRENT", "     ACCUMULATED"
385 PRINT "&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;="
390 '
395 '
400 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
405 ' Main test loop
410 DO
415   BattV = PIN(1) / 3.3 &#42; Vdd              ' measure the battery voltage
420   '
425   ' Calculate the setting required to draw the test current
430   PrevTC = BattV/R1 &#42; 1000
435   FOR i = 2 TO 15
440     TC = 0
445     IF i AND &amp;b0001 THEN TC = TC + BattV/R1
450     IF i AND &amp;b0010 THEN TC = TC + BattV/R2
455     IF i AND &amp;b0100 THEN TC = TC + BattV/R3
460     IF i AND &amp;b1000 THEN TC = TC + BattV/R4
465     TC = TC &#42; 1000
470     IF PrevTC + (TC - PrevTC) / 2 &gt; TestCurrent THEN EXIT FOR
475     PrevTC = TC
480   NEXT i
485   i = i - 1
490   '
495   ' Set the reed relays to draw the test current
500   PIN(11) = NOT(i AND &amp;b0001)
505   PIN(12) = NOT(i AND &amp;b0010)
510   PIN(13) = NOT(i AND &amp;b0100)
515   PIN(14) = NOT(i AND &amp;b1000)
520   '
525   mAhours = mAhours + PrevTC/3600        ' accumulate the mAH reading
530   '
535   IF RIGHT$(TIME$, 2) = "00" THEN
540     PRINT TIME$,FORMAT$(BattV, "%5.3fV  "),FORMAT$(PrevTC, "%5.1fmA  "),; 
545     PRINT FORMAT$(mAhours, "%5.0fmAH")
550   ENDIF
555   '
560   ' wait for the next second
565   DO WHILE TIME$ = LASTTIME$ &#58; LOOP
570   LASTTIME$ = TIME$
575   '
580 LOOP WHILE BattV &gt; TerminatingVolts
585 '
590 PIN(11) = 1 &#58; PIN(12) = 1 &#58; PIN(13) = 1 &#58; PIN(14) = 1
595 '
600 '
605 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
610 ' print the summary
615 PRINT &#58; PRINT "Test complete.  ";
620 PRINT "Battery capacity is "; FORMAT$(mAhours, "%5.0fmAH")
625 PRINT &#58; PRINT

</pre><br /><br /><br /><b>BATTERY2.BAS </b><br /><pre>
100 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
110 ' BATTERY.BAS
120 ' Program to test the capacity of a battery
130 ' V2.0   Geoff Graham   Jan 2011
140 '
150 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
160 '
170 ' This is an extended version of the battery test program described in
180 ' the May 2011 issue of Silicon Chip.  Additional features include&#58;
190 '  - Will draw a graph of the battery voltage on the video output
200 '  - Choice of a constant current, power or resistance type of load
210 '  - Ability to save the data in an Excel compatible file
220 '  - Optional ability to use 5 relays for a finer level of load control
230 '
240 ' See the Silicon Chip article or the accompanying PDF for circuit details
250 '
260 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
270 '
280 ' Measured resistance of the five load resistors
290 ' These are constant values determined by measuring the actual resistance
300 ' with a digital multimeter.  They must be in descending order of values
310 ' if you only have 4 relays set the value of R5 to a very low value (eg, 0.0001)
320 '
330 R1 = 59.228
340 R2 = 29.789
350 R3 = 14.944
360 R4 =  7.516
370 R5 =  3.789
380 '
390 ' Correction for any error in measuring voltage (ie. actual V / Maximite V)
400 VCorrect = 1.019
410 '
420 ' default settings
430 DefaultType$ = "C"               ' constant current
440 DefaultBLoad = 200               ' load of 200 mA or mW
445 DefaultRLoad = 25                ' resistive load 25 ohms
450 DefaultThreshold = 0.9           ' cutout voltage to stop the test
460 '
470 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
480 MaxHist = 100 &#42; 60        ' maximum history to be saved (in minutes)
490 Dim Hist(MaxHist)         ' array for holding the history data
500 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
510 ' Program Start
520 ' The program returns to here when the test has finished
530 '
540 ' Configure the input and output pins
550 Pin(11) = 1 &#58; Pin(12) = 1 &#58; Pin(13) = 1 &#58; Pin(14) = 1 &#58; Pin(15) = 1
560 SetPin 11, 9 &#58; SetPin 12, 9 &#58; SetPin 13, 9 &#58; SetPin 14, 9 &#58; SetPin 15, 9
570 SetPin 1,1
580 '
590 HScale = 2
595 mAhours = 0
600 '
610 Pin(0) = 1 &#58; Print &#58; Print &#58; Cls
620 '
630 ' Get the test parameters from the user
640 Print "Battery capacity test utility V2.0"
650 ' define constants and arrays
655 Do
660   Print
670   Print "C = Constant current drain"
680   Print "P = Constant power drain"
690   Print "R = Constant resistive load"
700   Print "Select (default is "; DefaultType$; ") ";
710   Input Type$
715   If Asc(Type$) = 0 Then Type$ = DefaultType$
720   Type$ = Left$(UCase$(Type$), 1)
725 Loop Until Type$ = "C" Or Type$ = "P" Or Type$ = "R"
730 Print
740 '
750 If Type$ = "C" Then
760   Do
770     Print "Range is 600mA to 20mA"
780     Print "Enter current drain (default is"; DefaultBLoad; ") ";
790     Input BLoad
795     If BLoad = 0 Then Bload = DefaultBLoad
800   Loop While BLoad &gt; 600 Or BLoad &lt; 20
810 ElseIf Type$ = "P" Then
820   Do
830     Print "Range is 750mW to 25mW"
840     Print "Enter power drain (default is"; DefaultBLoad; ") ";
850     Input BLoad
855     If BLoad = 0 Then BLoad = DefaultBLoad
860   Loop While BLoad &gt; 750 Or BLoad &lt; 25
870 ElseIf Type$ = "R" Then
880   Do
900     Print "Range is 60 ohms to 1.8 ohms"
910     Print "Enter resistive load (default is"; DefaultRLoad; ") ";
920     Input BLoad
925     If BLoad = 0 Then BLoad = DefaultRLoad
930   Loop While BLoad &gt; 60 And BLoad &lt; 1.8
960 EndIf
970 '
975 Do
980   Print
990   Print "Enter the cutoff voltage (default is "; Format$(DefaultThreshold, "%3.1f"); ") ";
995   Print "Minimum cutoff is 0.5V"
1000   Input Threshold
1005   If Threshold = 0 Then Threshold = DefaultThreshold
1010 Loop While Threshold &lt; 0.5 Or Threshold &gt; 1.5
1020 Print
1030 '
1040 Do
1060   Input "Save the results to an Excel file (Y/N, default is N) ", SSave$
1070   SSave$ = Left$(UCase$(SSave$), 1)
1075   If Asc(SSave$) = 0 Then SSave$ = "N"
1080 Loop While Not(SSave$ = "Y" Or SSave$ = "N")
1089 '
1090 If SSave$ = "Y" Then
1100   Line Input "Filename (without an extension)&#58; "; FName$
1110   Open Left$(FName$, 8) + ".xls" For output As &#35;1
1120   Line Input "Description of battery under test&#58; "; R$
1130   Print &#35;1, R$
1140   If Type$ = "C" Then Print &#35;1, "Constant current of"; BLoad; "mA.  Cutoff at"; Threshold; "V"
1150   If Type$ = "P" Then Print &#35;1, "Constant power of"; BLoad; "mW.  Cutoff at"; Threshold; "V"
1160   If Type$ = "R" Then Print &#35;1, "Constant resistance of"; BLoad; " ohms.  Cutoff at"; Threshold; "V"
1170   Print &#35;1 &#58; Print &#35;1, "Time", "Voltage", "Current", "mAH"
1180 EndIf
1190 '
1200 Print
1210 Line Input "Press ENTER to start the test "; T$
1220 Pin(15) = 0 &#58; Pause 200                ' discharge any floating voltage
1230 Do While Pin(1) &#42; VCorrect &lt;= Threshold
1240   Print "Battery not inserted or not charged (voltage ="; Pin(1) &#42; VCorrect; ")"
1250   Print "Insert battery to continue ";
1260   While Pin(1) &#42; VCorrect &lt;= Threshold &#58; Wend
1270   Pause 750
1280 Loop
1290 '
1300 VScale = (Int(Pin(1) &#42; VCorrect &#42; 10) + 2)  ' set the vertical scale
1310 iHist = 0                                   ' zero the history
1320 GoSub 2790                                  ' draw the graph axies
1330 '
1340 Time$ = "00&#58;00&#58;00" &#58; LASTTIME$ = "00&#58;00&#58;00" ' init the starting time
1350 BattV = Pin(1) &#42; VCorrect                   ' initialise the battery voltage
1360 VStart = BattV
1370 VAverage = 0 &#58; AveCnt = 0
1380 '
1390 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
1400 ' Main test loop
1410 Do
1420   '
1430   If Type$ = "C" Then
1440     ' Calculate the setting required to draw the test current
1450     PrevTL = (BattV/R1) &#42; 1000
1460     For i = 2 To 31
1470       TL = 0
1480       If i And &amp;b00001 Then TL = TL + BattV/R1
1490       If i And &amp;b00010 Then TL = TL + BattV/R2
1500       If i And &amp;b00100 Then TL = TL + BattV/R3
1510       If i And &amp;b01000 Then TL = TL + BattV/R4
1520       If i And &amp;b10000 Then TL = TL + BattV/R5
1530       TL = TL &#42; 1000
1540       If PrevTL + (TL - PrevTL) / 2 &gt; BLoad Then Exit For
1550       PrevTL = TL
1560     Next i
1570   ElseIf Type$ = "P" Then
1580     ' Calculate the setting required to draw the test power
1590     PrevTL = ((BattV &#42; BattV)/R1) &#42; 1000
1600     For i = 2 To 31
1610       TL = 0
1620       If i And &amp;b00001 Then TL = TL + (BattV &#42; BattV)/R1
1630       If i And &amp;b00010 Then TL = TL + (BattV &#42; BattV)/R2
1640       If i And &amp;b00100 Then TL = TL + (BattV &#42; BattV)/R3
1650       If i And &amp;b01000 Then TL = TL + (BattV &#42; BattV)/R4
1660       If i And &amp;b10000 Then TL = TL + (BattV &#42; BattV)/R5
1670       TL = TL &#42; 1000
1680       If PrevTL + (TL - PrevTL) / 2 &gt; BLoad Then Exit For
1690       PrevTL = TL
1700     Next i
1710   ElseIf Type$ = "R" Then
1720     ' Calculate the setting required to draw the test resistance
1730     PrevTL = R1
1740     For i = 2 To 31
1750       TL = 100000000
1760       If i And &amp;b00001 Then TL = (TL &#42; R1) / (TL + R1)
1770       If i And &amp;b00010 Then TL = (TL &#42; R2) / (TL + R2)
1780       If i And &amp;b00100 Then TL = (TL &#42; R3) / (TL + R3)
1790       If i And &amp;b01000 Then TL = (TL &#42; R4) / (TL + R4)
1800       If i And &amp;b10000 Then TL = (TL &#42; R5) / (TL + R5)
1810       If PrevTL - (PrevTL - TL) / 2 &lt; BLoad Then Exit For
1820       PrevTL = TL
1830     Next i
1840     ' print "Selected nearest value of"; PrevTL; " ohms"
1850   Else
1860    Error "Invalid Type$"
1870   EndIf
1880   '
1890   i = i - 1
1900   '
1910   ' Set the reed relays to create the test load
1920   Pin(11) = Not(i And &amp;b00001)
1930   Pin(12) = Not(i And &amp;b00010)
1940   Pin(13) = Not(i And &amp;b00100)
1950   Pin(14) = Not(i And &amp;b01000)
1960   Pin(15) = Not(i And &amp;b10000)
1970   '
1980   ' calculate the current drain at this setting
1990   TC = 0
2000   If i And &amp;b00001 Then TC = TC + BattV/R1
2010   If i And &amp;b00010 Then TC = TC + BattV/R2
2020   If i And &amp;b00100 Then TC = TC + BattV/R3
2030   If i And &amp;b01000 Then TC = TC + BattV/R4
2040   If i And &amp;b10000 Then TC = TC + BattV/R5
2050   TC = TC &#42; 1000                           ' current drain in mA
2060   mAhours = mAhours + TC/3600              ' accumulate the mAH reading for each second
2070   '
2080   ' every minute update the display
2090   If Right$(Time$, 2) = "00" Then
2100     Hist(iHist) = BattV &#58; iHist = iHist + 1
2110     If iHist &gt; MaxHist Then GoTo 2330
2120     If iHist &gt; HScale &#42; 60 Then
2130       HScale = HScale + 1
2140       GoSub 2790                           ' redraw the graph scale
2150     EndIf
2160     GoSub 2660                             ' add this reading to the graph
2170     GoSub 3090                             ' print the running summary
2180   EndIf
2190   '
2200   ' wait for the next second
2210   LoopCount = 1
2220   Do While Time$ = LASTTIME$
2230     BattV = BattV + Pin(1) &#42; VCorrect      ' while we are waiting make many measurements
2240     LoopCount = LoopCount + 1              ' count the number of measurements
2250   Loop
2260   LASTTIME$ = Time$
2270   BattV = BattV/LoopCount                  ' and average
2280   '
2290 VAverage = VAverage + BattV &#58; AveCnt = AveCnt + 1
2300 Loop While BattV &gt;= Threshold
2310 '
2320 ' the test has finished - remove the load
2330 Pin(11) = 1 &#58; Pin(12) = 1 &#58; Pin(13) = 1 &#58; Pin(14) = 1 &#58; Pin(15) = 1
2340 '
2350 '
2360 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2370 ' print the summary
2380 GoSub 3090                                 ' update the running summary
2390 Print &#58; T$ = "Test complete.  "
2400 T$ = T$ + "Battery capacity is " + Format$(mAhours, "%1.0fmAH") + " at a constant "
2410 If Type$ = "C" Then T$ = T$ + "current of" + Str$(BLoad) + "mA."
2420 If Type$ = "P" Then T$ = T$ + "power of" + Str$(BLoad) + "mW."
2430 If Type$ = "R" Then T$ = T$ + "resistance of" + Str$(BLoad) + " ohms."
2440 If SSave$ = "Y" Then Print &#35;1 &#58; Print &#35;1 &#58; Print &#35;1, T$
2450 Print "  " + T$
2460 T$ = "Start voltage = " + Format$(VStart, "%3.2f") + ".  End voltage = " + Format$(BattV, "%3.2f")
2470 T$ = T$ + ".  Average voltage = " + Format$(VAverage/AveCnt, "%3.2f") + "."
2480 If SSave$ = "Y" Then Print &#35;1, T$
2490 Print "    " + T$
2500 If SSave$ = "Y" Then Close &#35;1
2510 '
2520 Print "    Press ENTER to test again or CTRL-C to quit...";
2530 Do                                          ' flash LED while waiting
2540   Pause 200 &#58; If Inkey$ = Chr$(&amp;H0D) Then GoTo 500
2550   Pin(0) = 0 &#58; Pause 100 &#58; Pin(0) = 1 &#58; If Inkey$ = Chr$(&amp;H0D) Then GoTo 500
2560 Loop
2570 '
2580 '
2590 '
2600 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2610 ' SUBROUTINES
2620 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2630 '
2640 ' Subroutine to print the trend line on the graph
2650 '
2660 For i = 1 To iHist - 1
2670   x1 = margin + (width / (HScale &#42; 60)) &#42; (i - 1)
2680   x2 = margin + (width / (HScale &#42; 60)) &#42; (i)
2690   y1 = height - ((Hist(i - 1) &#42; 10) / VScale) &#42; height
2700   y2 = height - ((Hist(i) &#42; 10) / VScale) &#42; height
2710   Line (x1, y1) - (x2, y2), 1
2720 Next i
2730 Return
2740 '
2750 '
2760 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
2770 ' Subroutine to print the graph axies
2780 '
2790 height = MM.VRes - 100 &#58; margin = 45 &#58; width = MM.HRes - margin - 12
2800 '
2810 Cls
2820 Line (margin,height)-(margin, 0), 1 ' Draw the vert line
2830 Line (margin,height)-(margin + width ,height), 1  ' Draw the horiz line
2840 For i = 0 To VScale                        ' This loop draws the tick marks
2850   h = height - (height / VScale) &#42; i
2860   t = margin - 5
2870   If i Mod 5 = 0 Then                      ' Special mark for a unit of 0.1V
2880     Locate margin - 42, h - 3
2890     If h - 3 &lt; 0 Then Locate margin - 42, 0 ' fix if we are off the screen
2900     Print Left$(Format$(i/10,"%f"),3);"V"; ' Label the tick mark
2910     t = margin - 15
2920   EndIf
2930   Line (margin, h)-(t, h), 1               ' Draw the tick mark
2940 Next i
2950 For i = 0 To HScale
2960   t = margin + (width/Hscale) &#42; i
2970   Line (t, height)-(t, height + 9), 1
2980   If i &lt; 10 Then Locate t - 8, height + 14 Else Locate t - 11, height + 14
2990   Print i;
3000 Next i
3010 Locate margin + width/2 - 14, height + 25
3020 Print "Hours"
3030 Return
3040 '
3050 '
3060 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
3070 ' Subroutine to print the summary data below the graph
3080 '
3090 T$ = Left$(Time$, 5) + "    " + Format$(BattV, "%5.3fV  ") + "  " + Format$(TC, "%5.1fmA  ")
3100 T$ = T$ + " " + Format$(mAhours, "%5.0fmAH")
3110 Locate margin + (width - (Len(T$) &#42; 6)) / 2, height + 40
3120 Print t$
3130 If SSave$ = "Y" Then Print &#35;1, (iHist - 1)/60, BattV, TC, mAhours
3140 Return
3150 '

</pre><br /><br /><br /><br />
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		<div id="Anthem_ctl00_CphMaster_attachmentViewer_rptItems__">
		<table id="AttachmentViewerTable" class="generic" cellpadding="0" cellspacing="0">
			<thead>
			<tr class="tableheader">
				<th>&nbsp;</th>
				<th>Name</th>
				<th>Size</th>
			</tr>
			</thead>
			<tbody>
	
		<tr class="tablerow">
			<td><img src="Images/File.png" alt="-" /></td>
			<td><a href='Battery6de8.gif?File=Battery.gif&amp;AsStreamAttachment=1&amp;Provider=ScrewTurn.Wiki.FilesStorageProvider&amp;IsPageAttachment=1&amp;Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library' title="Download">Battery.gif</a></td>
			<td>27.51 KB</td>
		</tr>
	
		<tr class="tablerowalternate">
			<td><img src="Images/File.png" alt="-" /></td>
			<td><a href='BATTERY24a5d.pdf?File=BATTERY2.pdf&amp;AsStreamAttachment=1&amp;Provider=ScrewTurn.Wiki.FilesStorageProvider&amp;IsPageAttachment=1&amp;Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library' title="Download">BATTERY2.pdf</a></td>
			<td>197.63 KB</td>
		</tr>
	
		</tbody>
		</table>
	</div>

    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:42:20 GMT -->
</html>
