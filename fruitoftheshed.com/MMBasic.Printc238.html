

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Data-Logger-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:15:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Data Logger - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Data-Logger-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFvB08aDEgY2xhc3M9InBhZ2V0aXRsZSI+RGF0YSBMb2dnZXI8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDE2LzEyLzIzIDIzOjI2IGJ5IEFkbWluaXN0cmF0b3IgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogQ29udHJvbCwgRWxlY3Ryb25pY3MsIEVudmlyb25tZW50LCBfTElCIE9yaWdpbmFsIE1NQmFzaWM8L3NtYWxsPjxiciAvPjxiciAvPjxoMiBjbGFzcz0ic2VwYXJhdG9yIj5UaGlzIG1vZHVsZSBpcyBwYXJ0IG9mIHRoZSBvcmlnaW5hbCBNTUJhc2ljIGxpYnJhcnkuIEl0IGlzIHJlcHJvZHVjZWQgaGVyZSB3aXRoIGtpbmQgcGVybWlzc2lvbiBvZiBIdWdoIEJ1Y2tsZSBhbmQgR2VvZmYgR3JhaGFtLiBCZSBhd2FyZSBpdCBtYXkgcmVmZXJlbmNlIGZ1bmN0aW9uYWxpdHkgd2hpY2ggaGFzIGNoYW5nZWQgb3IgaXMgZGVwcmVjYXRlZCBpbiB0aGUgbGF0ZXN0IHZlcnNpb25zIG9mIE1NQmFzaWMuPGEgY2xhc3M9ImhlYWRlcmFuY2hvciIgaWQ9IlRoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgaHJlZj0iI1RoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgdGl0bGU9IkxpbmsgdG8gdGhpcyBTZWN0aW9uIj4mIzAxODI7PC9hPjwvaDI+PGI+Tm90ZTwvYj46IEFueSByZXF1aXJlZCBmaWxlKHMpIGFyZSBhdmFpbGFibGUgaW4gdGhlIGF0dGFjaG1lbnRzIHRhYiAodG9wIHJpZ2h0KS48YnIgLz48YnIgLz48YnIgLz48Yj5EQVRBTE9HLkJBUyA8L2I+PGJyIC8+PHByZT4NCjEwMCAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjExMCAnIERBVEFMT0cuQkFTDQoxMjAgJyBFdmVyeSBzZWNvbmQgdGhpcyBwcm9ncmFtIHdpbGwmIzU4Ow0KMTMwICcgIC0gbWVhc3VyZSB0aGUgdm9sdGFnZSBvbiBwaW5zIDEgdG8gMTANCjE0MCAnICAtIGdldCB0aGUgbG9naWMgbGV2ZWwgb24gcGlucyAxMSB0byAyMA0KMTUwICcgIC0gZGlzcGxheSB0aGUgZGF0YSBvbiBib3RoIHRoZSBVU0IgYW5kIHZpZGVvIG91dHB1dHMNCjE2MCAnICAtIHJlY29yZCBpdCBpbiB0aGUgZmlsZSBEQVRBTE9HLlhMUw0KMTcwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KMTgwICcNCjE5MCAnIGNvbmZpZ3VyZSBwaW5zIDEgdG8gMTAgYXMgYW5hbG9nIGlucHV0cw0KMjAwIEZPUiBpID0gMSBUTyAxMCAmIzU4OyBTRVRQSU4gaSwgMSAmIzU4OyBORVhUIGkNCjIxMCAnDQoyMjAgJyBjb25maWd1cmUgcGlucyAxMSB0byAyMCBhcyBkaWdpdGFsIGlucHV0cw0KMjMwIEZPUiBpID0gMTEgVE8gMjAgJiM1ODsgU0VUUElOIGksIDIgJiM1ODsgTkVYVCBpDQoyNDAgJw0KMjUwICcgemVybyB0aGUgZGF0YSBmaWxlIGFuZCBwcmludCB0aGUgaGVhZGluZw0KMjYwIE9QRU4gIkRBVEFMT0cuWExTIiBGT1Igb3V0cHV0IEFTICYjMzU7MQ0KMjcwIFBSSU5UICYjMzU7MSwgIlRJTUUiOyBDSFIkKDkpOw0KMjgwIEZPUiBpID0gMSBUTyAyMCAmIzU4OyBQUklOVCAmIzM1OzEsICJQSU4iO2k7Q0hSJCg5KTsgJiM1ODsgTkVYVA0KMjg1IFBSSU5UICYjMzU7MQ0KMjkwIENMT1NFICYjMzU7MQ0KMzAwICcNCjMxMCAnIHN0YXJ0IHRoZSBsb29wDQozMjAgVElNRSQgPSAiMDAmIzU4OzAwJiM1ODswMCIgICAgICAgJyB6ZXJvIHRoZSB0aW1lDQozMzAgRE8NCjM0MCAgIFRJTUVSID0gMCAgICAgICAgICAgICAgJyB1c2VkIHRvIHRpbWUgb25lIHNlY29uZA0KMzUwICAgdCA9IHQgLSAxDQozNjAgICBJRiB0ICZsdDs9IDAgVEhFTiAgICAgICAgICcgY2xlYXIgc2NyZWVuIGV2ZXJ5IDEwIGxvb3BzDQozNzAgICAgIFBSSU5UIENIUiQoMjcpICsgIiYjOTE7MkoiOw0KMzgwICAgICBDTFMNCjM5MCAgICAgdCA9IDEwDQo0MDAgICBFTkRJRg0KNDEwICAgJyBwb3NpdGlvbiB0aGUgY3Vyc29yIGF0IHRoZSB0b3Agb2YgdGhlIHNjcmVlbg0KNDIwICAgTE9DQVRFIDAsIDAgICAgICAgICAgICAnIEN1cnNvciBob21lICh2aWRlbykNCjQzMCAgIFBSSU5UIENIUiQoMjcpICsgIiYjOTE7SCI7ICcgQ3Vyc29yIGhvbWUgKFVTQikNCjQ0MCAgIExPQ0FURSAwLCAwICAgICAgICAgICAgJyBDdXJzb3IgaG9tZSAodmlkZW8pDQo0NTAgICBQUklOVCAiICAgIFJ1biBUaW1lJiM1ODsgIjsgVElNRSQmIzU4OyBQUklOVA0KNDYwICAgJyBkYSQgaXMgdXNlZCB0byBob2xkIHRoZSBhbmFsb2cgZGF0YSBmb3IgdGhlIGNhcmQNCjQ2NSAgICcgZGQkIGlzIHVzZWQgdG8gaG9sZCB0aGUgZGlnaXRhbCBkYXRhDQo0NzAgICBkYSQgPSBUSU1FJCArIENIUiQoOSkgJiM1ODsgZGQkID0gIiINCjQ4MCAgIEZPUiBpID0gMSBUTyAxMA0KNDg1ICAgICAnIGhhbmRsZSB0aGUgYW5hbG9nIHBpbnMNCjQ5MCAgICAgUFJJTlQgIiAgICBQaW4gIjsgRk9STUFUJChpLCAiJTJnID0gIik7DQo1MjAgICAgIFBSSU5UIEZPUk1BVCQoUElOKGkpICYjNDI7IDAuOTk1LCAiJTEuM2YiKTsgIlYgICAgICAiOw0KNTMwICAgICBkYSQgPSBkYSQgKyBTVFIkKFBJTihpKSkgKyBDSFIkKDkpDQo1NTAgICAgICcgaGFuZGxlIHRoZSBkaWdpdGFsIGlucHV0cw0KNTU1ICAgICBQUklOVCAiICAgIFBpbiAiOyBGT1JNQVQkKGkrMTAsICIlMmcgPSAiKTsNCjU2MCAgICAgSUYgUElOKGkrMTApIFRIRU4gUFJJTlQgIkhJR0giIEVMU0UgUFJJTlQgIkxPVyAiDQo1NzAgICAgIGRkJCA9IGRkJCArIFNUUiQoUElOKGkrMTApKSArIENIUiQoOSkNCjYwMCAgIE5FWFQgaQ0KNjEwICAgT1BFTiAiREFUQUxPRy5YTFMiIEZPUiBhcHBlbmQgQVMgJiMzNTsxDQo2MjAgICBQUklOVCAmIzM1OzEsIGRhJDsgZGQkDQo2MzAgICBDTE9TRSAmIzM1OzENCjY0MCAgICcNCjY1MCAgICcgd2FpdCBmb3IgdGhlIG9uZSBzZWNvbmQgbWFyayB0byBjb21lIHVwDQo2NjAgICBETyBXSElMRSBUSU1FUiAmbHQ7IDEwMDAgJiM1ODsgTE9PUA0KNjcwIExPT1ANCg0KPC9wcmU+PGJyIC8+ZGQf6MmGeexTo6leA4Uu/L+zyM0Tkw==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Data Logger</h1><small>Modified on 2016/12/23 23:26 by Administrator &mdash; Categorized as: Control, Electronics, Environment, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><br /><b>DATALOG.BAS </b><br /><pre>
100 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
110 ' DATALOG.BAS
120 ' Every second this program will&#58;
130 '  - measure the voltage on pins 1 to 10
140 '  - get the logic level on pins 11 to 20
150 '  - display the data on both the USB and video outputs
160 '  - record it in the file DATALOG.XLS
170 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
180 '
190 ' configure pins 1 to 10 as analog inputs
200 FOR i = 1 TO 10 &#58; SETPIN i, 1 &#58; NEXT i
210 '
220 ' configure pins 11 to 20 as digital inputs
230 FOR i = 11 TO 20 &#58; SETPIN i, 2 &#58; NEXT i
240 '
250 ' zero the data file and print the heading
260 OPEN "DATALOG.XLS" FOR output AS &#35;1
270 PRINT &#35;1, "TIME"; CHR$(9);
280 FOR i = 1 TO 20 &#58; PRINT &#35;1, "PIN";i;CHR$(9); &#58; NEXT
285 PRINT &#35;1
290 CLOSE &#35;1
300 '
310 ' start the loop
320 TIME$ = "00&#58;00&#58;00"       ' zero the time
330 DO
340   TIMER = 0              ' used to time one second
350   t = t - 1
360   IF t &lt;= 0 THEN         ' clear screen every 10 loops
370     PRINT CHR$(27) + "&#91;2J";
380     CLS
390     t = 10
400   ENDIF
410   ' position the cursor at the top of the screen
420   LOCATE 0, 0            ' Cursor home (video)
430   PRINT CHR$(27) + "&#91;H"; ' Cursor home (USB)
440   LOCATE 0, 0            ' Cursor home (video)
450   PRINT "    Run Time&#58; "; TIME$&#58; PRINT
460   ' da$ is used to hold the analog data for the card
465   ' dd$ is used to hold the digital data
470   da$ = TIME$ + CHR$(9) &#58; dd$ = ""
480   FOR i = 1 TO 10
485     ' handle the analog pins
490     PRINT "    Pin "; FORMAT$(i, "%2g = ");
520     PRINT FORMAT$(PIN(i) &#42; 0.995, "%1.3f"); "V      ";
530     da$ = da$ + STR$(PIN(i)) + CHR$(9)
550     ' handle the digital inputs
555     PRINT "    Pin "; FORMAT$(i+10, "%2g = ");
560     IF PIN(i+10) THEN PRINT "HIGH" ELSE PRINT "LOW "
570     dd$ = dd$ + STR$(PIN(i+10)) + CHR$(9)
600   NEXT i
610   OPEN "DATALOG.XLS" FOR append AS &#35;1
620   PRINT &#35;1, da$; dd$
630   CLOSE &#35;1
640   '
650   ' wait for the one second mark to come up
660   DO WHILE TIMER &lt; 1000 &#58; LOOP
670 LOOP

</pre><br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Data-Logger-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:15:12 GMT -->
</html>
