

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Multiple-LCD-panel-displays by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:21:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Multiple LCD panel displays - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Multiple-LCD-panel-displays" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFtiM8aDEgY2xhc3M9InBhZ2V0aXRsZSI+TXVsdGlwbGUgTENEIHBhbmVsIGRpc3BsYXlzPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAyMC8wMy8xMyAwNzo0NCBieSBDYXB0YWluQm9pbmcgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogQ29udHJvbCwgRWxlY3Ryb25pY3MsIEdyYXBoaWNzLCBIYXJkd2FyZTwvc21hbGw+PGJyIC8+PGJyIC8+TU1CYXNpYyBvbiB0aGUgTWljcm9taXRlIGNhbiBuYXRpdmVseSBkcml2ZSBhIG51bWJlciBvZiBjb21tb24gTENEIHBhbmVsIHR5cGVzLCB0aGVzZSBjYW4gcmVhbGx5IGJyaW5nIGEgc3Bhcmsgb2YgcGFuYWNoZSB0byBhIHByb2plY3QgYW5kIGFyZSBjaGVhcGx5IGF2YWlsYWJsZSBvbiBlbGVjdHJvbmljcyBjb21wb25lbnRzIG91dGxldHMvdGF0LWJhemFhcnMgYXQgYXJvdW5kIHRoZSDCozUgKFVTJDYsIEFVJDgsIGU2KSBtYXJrLjxiciAvPjxiciAvPkkgaGF2ZSBhIHJlcXVpcmVtZW50IGZvciBzdWNoIGEgZGlzcGxheSBidXQgaXQgbmVlZHMgdG8gYmUgbG9uZyByYXRoZXIgdGhhbiBiaWcgZHVlIHRvIHJlc3RyaWN0aW9ucyBvbiB0aGUgc3BhY2UgYXZhaWxhYmxlLiBJIGRlY2lkZWQgdG8gdHJ5IHN0YWNraW5nIHR3byAyLjgiIGNvbG91ciBURlRzIHNpZGUgYnkgc2lkZSwgYnV0IHdvdWxkIGl0IGJlIHBvc3NpYmxlIHRvIGRyaXZlIHRoZW0gZnJvbSBhIHNpbmdsZSBNaWNyb21pdGU/PGJyIC8+PGJyIC8+SW4gdGhlIGJyZWFkYm9hcmQga25vY2stdXAsIEkgaGFuZGxlIHRoZSBDUyBwaW5zIG9mIGVhY2ggZGlzcGxheSBpbmRpdmlkdWFsbHkuIFRoaXMgcmVxdWlyZXMgdHdvIGV4dHJhIG91dHB1dHMgYW5kIHRoZSBjb2RlIHN3aXRjaGVzIHRvIHRoZSByZWxldmFudCBkaXNwbGF5IGltbWVkaWF0ZWx5IGJlZm9yZSBkb2luZyBhbnl0aGluZyBvbiBpdC48YnIgLz48YnIgLz5IZXJlIGlzIGEgc21hbGwgPGEgY2xhc3M9ImV4dGVybmFsbGluayIgaHJlZj0iaHR0cHM6Ly95b3V0dS5iZS9zRUNwQm9faThoUSIgdGl0bGU9InZpZGVvIiB0YXJnZXQ9Il9ibGFuayI+dmlkZW88L2E+IG9mIHRoZSBiZWxvdyBjb2RlIGluIGFjdGlvbiBvbiBhIGJyZWFkYm9hcmQgd2l0aCBhIE1pY3JvbWl0ZSBNa0lJIDQ0cGluLjxiciAvPjxiciAvPkN1cnJlbnRseSB0aGUgZGlzcGxheXMgYXJlIHF1aXRlIHNpbXBsaXN0aWMgYXMgdGhpcyBpcyBvbmx5IGEgcHJvb2Ygb2YgY29uY2VwdC4gSSB0b29rIHRoZSBmYW1pbGlhciB0ZXN0IHByb2dyYW0gZnJvbSB0aGUgTWljcm9taXRlIG1hbnVhbCBhbmQgdHdlYWtlZCBpdCB0byBob2xkIHRoZSByZWxldmFudCBzd2l0Y2hpbmcgYW5kIHNvbWUgYWRkaXRpb25hbCBzY3JpYmJsZSB0byBkZW1vbnN0cmF0ZSB0aGUgZGlzcGxheXMgYXJlIGluZGVwZW5kZW50LCBidXQgaXQgaXMgZXNzZW50aWFsbHkgdGhlIHNhbWUuIFJlYWxseSwgdGhlcmUgaXMgbm8gcHJhY3RpY2FsIGxpbWl0IHRvIHRoZSBudW1iZXIgb2YgTENEcyB5b3UgY291bGQgZHJpdmUgaW4gdGhpcyB3YXkuPGJyIC8+PGJyIC8+VGhlIE1pY3JvbWl0ZSBuZWVkcyB0byBoYXZlIHRoZSBMQ0Qgb3B0aW9ucyBzZXQgYXQgdGhlIGNvbW1hbmQgcHJvbXB0IGFzIHVzdWFsIGFuZCB0aGUgcHJvZ3JhbSBpbml0aWFsaXNlcyBlYWNoIG9mIHRoZSBMQ0QgcGFuZWxzIHdpdGggdGhlIEdVSSBSRVNFVCBjb21tYW5kIHNvIHRoZXkgcGxheSBuaWNlbHkuIEkgYWxzbyB0aWVkIHRoZSBMQ0QgcmVzZXQgcGlucyB0byBWQ0MgdG8gcHJldmVudCB0aGUgR1VJIFJFU0VUIGNvbW1hbmRzIGZpZ2h0aW5nLiBZb3Ugd291bGQgcHJvYmFibHkgYmUgYmV0dGVyIG9mZiB0eWluZyB0aGVtIHRvIHRoZSBtYXN0ZXIgcmVzZXQgb3IgdG8gYW5vdGhlciBvdXRwdXQgcGluIGFuZCBjb250cm9sbGluZyB0aGVtIG1hbnVhbGx5IHRvby4gVGhpcyBkb2VzIG1lYW4gdGhhdCB0aGUgcmVzZXQgcGluIGRlc2lnbmF0ZWQgaW4gdGhlIGluIHRoZSBPUFRJT04gTENEUEFORUwgY29tbWFuZCAoMTkgaW4gdGhpcyBjYXNlKSBpcyAgc3RlcmlsaXNlZCBmcm9tIHVzZSBzbyBjaG9vc2UgYSBtdW5kYW5lIHBpbiB3aXRoIGxvdyBmZWF0dXJlcy4gTU1CYXNpYyBoYXMgbm8gaWRlYSB0aGF0IGl0cyAiZ29hbC1wb3N0cyIgYXJlIGJlaW5nIG1vdmVkIC0gdGhpcyBpcyBsaWtlbHkgdG8gaW50ZXJmZXJlIHdpdGggdGhlIG1vcmUgY29tcGxleCBMQ0QgUGFuZWwgc3R1ZmYgbGlrZSBidXR0b25zIGV0Yy48YnIgLz48YnIgLz5JZiB5b3UgYXJlIGNhcmVmdWwgd2l0aCB0aGUgQ1MgYWN0aXZpdHksIHRoZXJlIGlzIG5vIHJlYXNvbiB0byBsb3NlIGFueSBmdW5jdGlvbmFsaXR5IC0gZXZlbiB3aGVuIHJlYWRpbmcgZnJvbSB0aGUgcGFuZWxzIC0gTUlTTyBpcyB0cmktc3RhdGVkIGJ5IHRoZSBzbGF2ZShzKSB1bnRpbCBDUyBnb2VzIGxvIChtYWtlIHN1cmUgeW91IGRvbid0IGhhdmUgYm90aCBsbyBzaW11bHRhbmVvdXNseSkgYnV0IHlvdSBzaG91bGQgYmUgYWJsZSB0byByZWFkIGZyb20gdGhlIGRpc3BsYXlzIHRvbyAtIGV2ZW4gQkxJVCBjb21tYW5kcyBzaG91bGQgd29yayBidXQgSSBhbSB5ZXQgdG8gdHJ5LiBUbyBtaW5pbWlzZSB0aGUgY29udHJvbCBwaW5zLCB5b3UgY2FuIHVzZSBhIHNpbXBsZSBzZWxlY3RvciBhbmQgYSBzaW5nbGUgaGkvbG8gc2VsZWN0b3IgZm9yIHRoZSBkaXNwbGF5cyBhcyBzaG93biBiZWxvdy4gVGhpcyBjb3VsZCBiZSBleHBhbmRlZCB2ZXJ5IGVhc2lseSB0byAxNiBkaXNwbGF5cyghKSB3aXRoIHNvbWV0aGluZyBsaWtlIGEgNzRIQzE1NC48YnIgLz48YnIgLz5UaGlzIG1ldGhvZCBhbmQgdGhlIGJlbG93IHByb2cgYXJlIHN0aWxsIGJvdW5kIGJ5IHRoZSBNTUJhc2ljIHNwZWVkIHJlc3RyaWN0aW9ucyBpLmUuIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBkcml2ZSBhbnkgcGFuZWwgYXQgYSBDUFUgc3BlZWQgb2YgMTBNSHogb3IgbGVzcy48YnIgLz48YnIgLz5VcGRhdGU6PGJyIC8+SWYgeW91IGhhdmUgc3BhcmUgcGlucyBvbiB5b3VyIGNvbnRyb2xsZXIsIGlnbm9yZSB0aGUgaW1hZ2UgYmVsb3cgYW5kIHNpbXBseSBzZWxlY3QgdGhlIENTIGJlZm9yZSB5b3UgZG8gYW55IHNjcmVlbiBvdXRwdXQuIFlvdSBsb3NlIHRoZSBkZXNpZ25hdGVkIENTIHBpbiBpbiB0aGUgcGFuZWwgY29uZmlnIGJ1dCBzYXZlIHlvdXJzZWxmIHRoZSB0d28gY2hpcHMhPGJyIC8+PGJyIC8+PGEgY2xhc3M9InVua25vd25saW5rIiBocmVmPSJNTUJhc2ljLi5hc2h4IiB0aXRsZT0iTU1CYXNpYy4iPjwvYT48aW1nIHNyYz0iR2V0RmlsZS5hc3B4P0ZpbGU9L2NzbXV4LnBuZyIgYWx0PSJJbWFnZSIgLz48YnIgLz48YnIgLz48cHJlPg0KDQonIHNldCB0aGUgZGlzcGxheSBwcm9wZXJ0aWVzIGF0IHRoZSBjb21tYW5kIHByb21wdCYjNTg7DQonIE9QVElPTiBMQ0RQQU5FTCBJTEk5MzQxLCBvcmllbnRhdGlvbiwgRC9DIHBpbiwgcmVzZXQgcGluICYjOTE7LENTIHBpbiYjOTM7DQonIE9QVElPTiBMQ0RQQU5FTCBJTEk5MzQxLFJMLDE1LDE5LDIxDQoNCiAgRGltIG4gQXMgSW50ZWdlcg0KDQogIFNldFBpbiAyMyxkb3V0JiM1ODsgUGluKDIzKT0xICcgc2V0IGJvdGggQ1MgSEkNCiAgU2V0UGluIDI0LGRvdXQmIzU4OyBQaW4oMjQpPTENCg0KICBQaW4oMjMpPTAmIzU4O0dVSSByZXNldCBsY2RwYW5lbCYjNTg7UGluKDIzKT0xKScgcmVzZXQgZWFjaCBkaXNwbGF5IGluIHR1cm4gIENTIExPIC0mZ3Q7IFJFU0VUIC0mZ3Q7IENTIEhJDQogIFBpbigyNCk9MCYjNTg7R1VJIHJlc2V0IGxjZHBhbmVsJiM1ODtQaW4oMjQpPTEpDQoNCiAgJ0NvbnN0IERCbHVlID0gUkdCKDAsIDAsIDEyOCkgJyBBIGRhcmsgYmx1ZSBjb2xvdXINCiAgQ29sb3VyIFJHQih3aGl0ZSksIFJHQihCTEFDSykgJyBTZXQgdGhlIGRlZmF1bHQgY29sb3Vycw0KDQogIEZvbnQgMSwyICcgU2V0IHRoZSBkZWZhdWx0IGZvbnQNCg0KICBEbw0KICAgIEZvciBuPTIzIFRvIDI0ICcgZWFzeSB3YXkgdG8gZ2V0IHRoZSBDUyBwaW5zIGZvciBlYWNoIGRpc3BsYXkNCiAgICAgIFBpbihuKT0wICcgQ1MgTE8NCg0KICAgICAgJ2RyYXcgc29tZSBzdHVmZg0KICAgICAgQm94IDAsIDAsIE1NLkhSZXMtMSwgTU0uVlJlcy8yLCAzLCBSR0IoUkVEKSwgUkdCKFJuZCYjNDI7MTI4LFJuZCYjNDI7MTI4LFJuZCYjNDI7MTI4KQ0KICAgICAgVGV4dCBNTS5IUmVzLzIsIE1NLlZSZXMvNCwgVGltZSQsICJDTSIgLCAxLCA0LCBSR0IoQ1lBTiksIERCbHVlDQogICAgICAnVGV4dCBNTS5IUmVzLzIsIE1NLlZSZXMmIzQyOzMvNCwgIkRpc3AiK1N0ciQobi0yMikrIiAiK0RhdGUkLCAiQ00iDQogICAgICBUZXh0IFJuZCYjNDI7MzIwLCBSbmQmIzQyOzI0MCwgIkRpc3AiK1N0ciQobi0yMikrIiAiK0RhdGUkDQogICAgICBDaXJjbGUgUm5kJiM0MjszMjAsUm5kJiM0MjsyNDAsUm5kJiM0MjsxMDANCiAgICAgIEJveCBSbmQmIzQyOzMyMCxSbmQmIzQyOzI0MCxSbmQmIzQyOzMyMCxSbmQmIzQyOzI0MCwzLCBSR0IoUm5kJiM0MjsxMjgsUm5kJiM0MjsxMjgsUm5kJiM0MjsxMjgpDQoNCiAgICAgIFBpbihuKT0xJyAgQ1MgSEkNCiAgICBOZXh0DQogIExvb3ANCg0KPC9wcmU+ZGSwwS93VKt2qLiDdNQGVb5TJnOG8A==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Multiple LCD panel displays</h1><small>Modified on 2020/03/13 07:44 by CaptainBoing &mdash; Categorized as: Control, Electronics, Graphics, Hardware</small><br /><br />MMBasic on the Micromite can natively drive a number of common LCD panel types, these can really bring a spark of panache to a project and are cheaply available on electronics components outlets/tat-bazaars at around the Â£5 (US$6, AU$8, e6) mark.<br /><br />I have a requirement for such a display but it needs to be long rather than big due to restrictions on the space available. I decided to try stacking two 2.8" colour TFTs side by side, but would it be possible to drive them from a single Micromite?<br /><br />In the breadboard knock-up, I handle the CS pins of each display individually. This requires two extra outputs and the code switches to the relevant display immediately before doing anything on it.<br /><br />Here is a small <a class="externallink" href="https://youtu.be/sECpBo_i8hQ" title="video" target="_blank">video</a> of the below code in action on a breadboard with a Micromite MkII 44pin.<br /><br />Currently the displays are quite simplistic as this is only a proof of concept. I took the familiar test program from the Micromite manual and tweaked it to hold the relevant switching and some additional scribble to demonstrate the displays are independent, but it is essentially the same. Really, there is no practical limit to the number of LCDs you could drive in this way.<br /><br />The Micromite needs to have the LCD options set at the command prompt as usual and the program initialises each of the LCD panels with the GUI RESET command so they play nicely. I also tied the LCD reset pins to VCC to prevent the GUI RESET commands fighting. You would probably be better off tying them to the master reset or to another output pin and controlling them manually too. This does mean that the reset pin designated in the in the OPTION LCDPANEL command (19 in this case) is  sterilised from use so choose a mundane pin with low features. MMBasic has no idea that its "goal-posts" are being moved - this is likely to interfere with the more complex LCD Panel stuff like buttons etc.<br /><br />If you are careful with the CS activity, there is no reason to lose any functionality - even when reading from the panels - MISO is tri-stated by the slave(s) until CS goes lo (make sure you don't have both lo simultaneously) but you should be able to read from the displays too - even BLIT commands should work but I am yet to try. To minimise the control pins, you can use a simple selector and a single hi/lo selector for the displays as shown below. This could be expanded very easily to 16 displays(!) with something like a 74HC154.<br /><br />This method and the below prog are still bound by the MMBasic speed restrictions i.e. it is not possible to drive any panel at a CPU speed of 10MHz or less.<br /><br />Update:<br />If you have spare pins on your controller, ignore the image below and simply select the CS before you do any screen output. You lose the designated CS pin in the panel config but save yourself the two chips!<br /><br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="csmux0d57.png?File=/csmux.png" alt="Image" /><br /><br /><pre>

' set the display properties at the command prompt&#58;
' OPTION LCDPANEL ILI9341, orientation, D/C pin, reset pin &#91;,CS pin&#93;
' OPTION LCDPANEL ILI9341,RL,15,19,21

  Dim n As Integer

  SetPin 23,dout&#58; Pin(23)=1 ' set both CS HI
  SetPin 24,dout&#58; Pin(24)=1

  Pin(23)=0&#58;GUI reset lcdpanel&#58;Pin(23)=1)' reset each display in turn  CS LO -&gt; RESET -&gt; CS HI
  Pin(24)=0&#58;GUI reset lcdpanel&#58;Pin(24)=1)

  'Const DBlue = RGB(0, 0, 128) ' A dark blue colour
  Colour RGB(white), RGB(BLACK) ' Set the default colours

  Font 1,2 ' Set the default font

  Do
    For n=23 To 24 ' easy way to get the CS pins for each display
      Pin(n)=0 ' CS LO

      'draw some stuff
      Box 0, 0, MM.HRes-1, MM.VRes/2, 3, RGB(RED), RGB(Rnd&#42;128,Rnd&#42;128,Rnd&#42;128)
      Text MM.HRes/2, MM.VRes/4, Time$, "CM" , 1, 4, RGB(CYAN), DBlue
      'Text MM.HRes/2, MM.VRes&#42;3/4, "Disp"+Str$(n-22)+" "+Date$, "CM"
      Text Rnd&#42;320, Rnd&#42;240, "Disp"+Str$(n-22)+" "+Date$
      Circle Rnd&#42;320,Rnd&#42;240,Rnd&#42;100
      Box Rnd&#42;320,Rnd&#42;240,Rnd&#42;320,Rnd&#42;240,3, RGB(Rnd&#42;128,Rnd&#42;128,Rnd&#42;128)

      Pin(n)=1'  CS HI
    Next
  Loop

</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Multiple-LCD-panel-displays by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:21:57 GMT -->
</html>
