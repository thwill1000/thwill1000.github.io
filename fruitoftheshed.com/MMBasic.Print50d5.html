

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.BMPSHOW-BAS-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	BMPSHOW.BAS - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.BMPSHOW-BAS-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF0iM8aDEgY2xhc3M9InBhZ2V0aXRsZSI+Qk1QU0hPVy5CQVM8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDE2LzEyLzIzIDIzOjIxIGJ5IEFkbWluaXN0cmF0b3IgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogR3JhcGhpY3MsIF9MSUIgT3JpZ2luYWwgTU1CYXNpYzwvc21hbGw+PGJyIC8+PGJyIC8+PGgyIGNsYXNzPSJzZXBhcmF0b3IiPlRoaXMgbW9kdWxlIGlzIHBhcnQgb2YgdGhlIG9yaWdpbmFsIE1NQmFzaWMgbGlicmFyeS4gSXQgaXMgcmVwcm9kdWNlZCBoZXJlIHdpdGgga2luZCBwZXJtaXNzaW9uIG9mIEh1Z2ggQnVja2xlIGFuZCBHZW9mZiBHcmFoYW0uIEJlIGF3YXJlIGl0IG1heSByZWZlcmVuY2UgZnVuY3Rpb25hbGl0eSB3aGljaCBoYXMgY2hhbmdlZCBvciBpcyBkZXByZWNhdGVkIGluIHRoZSBsYXRlc3QgdmVyc2lvbnMgb2YgTU1CYXNpYy48YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiBocmVmPSIjVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMj48Yj5Ob3RlPC9iPjogVGhlIHJlcXVpcmVkIGZpbGUocykgYXJlIGF2YWlsYWJsZSBpbiB0aGUgYXR0YWNobWVudHMgdGFiICh0b3AgcmlnaHQpLjxiciAvPjxiciAvPjxwcmU+DQoxMCAnIEJNUFNIT1cmIzU4OyBkaXNwbGF5cyBhIDEtYml0IEJNUCBpbWFnZQ0KMjAgJyBmcm9tIEJydWNlIE1pdGNoZWxsICZsdDticnVjZXB5dGhvbkBnbWFpbC5jb20mZ3Q7IA0KMzAgJw0KNDAgJyBCTVAgaXMgYSBmb3JtYXQgd2l0aCBtYW55IHZhcmlhdGlvbnMgYW5kIHZhZ2FyaWVzLg0KNTAgJyBEb24ndCBiZSBzdXJwcmlzZWQgaWYgc29tZSBpbWFnZXMgYXBwZWFyIGludmVydGVkLCBuZWdhdGl2ZSBvcg0KNjAgJyBvdGhlcndpc2Ugd2VpcmQuIA0KNzAgJyBTZWUgZW4ud2lraXBlZGlhLm9yZC93aWtpL0JNUF9maWxlX2Zvcm1hdCBmb3IgYmFzaWMgaW5mbyBhbmQgc29tZSANCjgwICcgdXNlZnVsIHJlZmVyZW5jZXMuDQo5MCAnIE1heCBpbWFnZSBzaXplIGRpc3BsYXllZCBpcyA0ODAgd2lkZSB4IDQzMiBoaWdoLg0KMTAwICdMYXJnZXIgaW1hZ2VzIG1pZ2h0IGxvYWQgT0sgYnV0IG9ubHkgYSBjb3JuZXIgd2lsbCBiZSBzaG93bi4NCjExMCAnSXQncyBzbG93IQ0KMTIwICcNCjEzMCAnUG9zc2libGUgZW5oYW5jZW1lbnRzIG1pZ2h0IGluY2x1ZGUgY2hvaWNlcyB0byBkaXNwbGF5IHRoZSBpbWFnZSBhcyYjNTg7DQoxNDAgJyAmIzQyOyBpbnZlcnRlZA0KMTUwICcgJiM0MjsgbmVnYXRpdmUNCjE2MCAnICYjNDI7IGZsaXBwZWQgaG9yaXpvbnRhbGx5DQoxNzAgJyAmIzQyOyBsb2NhdGVkIGF0IHgseSByYXRoZXIgdGhhbiB0b3AgbGVmdC4NCjE4MCAnDQoxOTAgSU5QVVQgIkJNUCBmaWxlIHRvIGxvYWQmIzU4OyAiOyBmJA0KMjAwIElGIFVDQVNFJChSSUdIVCQoZiQsNCkpJmx0OyZndDsiLkJNUCIgVEhFTiBmJD1mJCsiLkJNUCINCjIxMCBPUEVOIGYkIEZPUiBpbnB1dCBBUyAmIzM1OzENCjIyMCAnDQoyMzAgYm91bmRhcnk9NCAmIzU4OyAnIEJNUCBsaW5lIGRhdGEgY29tZXMgaW4gNCBieXRlIGNodW5rcy4NCjI0MCBGT1IgcHRyPTAgVE8gOSYjNTg7YSQ9SU5QVVQkKDEsJiMzNTsxKSYjNTg7TkVYVCYjNTg7ICcgU2tpcCB0aGUgc2lnbmF0dXJlIGZpZWxkLg0KMjUwICcNCjI2MCAnR2V0IGRhdGEgb2Zmc2V0Lg0KMjcwIEdPU1VCIDc3MCYjNTg7IG9mZnNldCA9IGJ5dGUtMQ0KMjgwIEZPUiBwdHI9cHRyIFRPIHB0cis1JiM1ODthJD1JTlBVVCQoMSwmIzM1OzEpJiM1ODtORVhUDQoyOTAgJw0KMzAwIEdPU1VCIDc3MCYjNTg7d2lkdGg9Ynl0ZQ0KMzEwIEZPUiBwdHI9cHRyIFRPIHB0cisxJiM1ODthJD1JTlBVVCQoMSwmIzM1OzEpJiM1ODtORVhUDQozMjAgR09TVUIgNzcwJiM1ODtoZWlnaHQ9Ynl0ZQ0KMzMwIHB0cj1wdHIrOA0KMzQwICcNCjM1MCAnIEdldCBjb2xvdXIgZGVwdGggaW4gYml0cyBmcm9tICZhbXA7MUMuDQozNjAgRk9SIHB0cj1wdHIgVE8gcHRyKzMmIzU4O2EkPUlOUFVUJCgxLCYjMzU7MSkNCjM3MCBORVhUDQozODAgR09TVUIgNzcwJiM1ODsgZGVwdGg9Ynl0ZQ0KMzkwICcNCjQwMCBJRiBkZXB0aCZsdDsmZ3Q7MSBUSEVOIFBSSU5UICJPbmx5IDEtYml0IEJNUCBpbWFnZXMgYXJlIHN1cHBvcnRlZC4iJiM1ODtFTkQNCjQxMCAnDQo0MjAgUkVNIFBSSU5UICJIZWlnaHQ9IjtoZWlnaHQmIzU4OycgUmVtb3ZlIFJFTSBpZiB5b3UgbmVlZCB0byBjaGVjayB0aGUgaW1hZ2Ugc2l6ZS4NCjQzMCBSRU0gUFJJTlQgIldpZHRoID0iO3dpZHRoJiM1ODsnICBTZWUgYWJvdmUuDQo0NDAgJw0KNDUwIENMT1NFICYjMzU7MSYjNTg7IE9QRU4gZiQgRk9SIGlucHV0IEFTICYjMzU7MSYjNTg7JyBSZXNldCB0byBzdGFydCBvZiBmaWxlLg0KNDYwIEZPUiBwdHI9MCBUTyBvZmZzZXQmIzU4O2EkPUlOUFVUJCgxLCYjMzU7MSkmIzU4O05FWFQmIzU4OycgcHRyIHBvaW50cyB0byBzdGFydCBvZiBiaXRtYXAuDQo0NzAgJw0KNDgwICdDb3B5IHRoZSBiaXRtYXAgdG8gdGhlIHNjcmVlbi4NCjQ5MCBDTFMNCjUwMCBGT1IgeT1oZWlnaHQtMSBUTyAwIFNURVAgLTENCjUxMCAgJ0NsZWFyIHRoZSBmbGFnIHRoYXQgc2lnbmFscyB0aGUgZmluYWwgYnl0ZShzKSBpbiB0aGUgcm93Lg0KNTIwICAgZW5kYnl0ZT1mYWxzZQ0KNTMwICAnUGxvdCB0aGUgcm93Lg0KNTQwICAgRk9SIHg9MCBUTyB3aWR0aC04IFNURVAgOA0KNTUwICAgICBHT1NVQiA4MjANCjU2MCAgIE5FWFQgeA0KNTcwICAnIEFyZSB3ZSBhdCBhIDQtYnl0ZSBib3VuZGFyeT8NCjU4MCAgIElGIHggJmx0OyB3aWR0aCBUSEVODQo1OTAgICAgIGVuZGJ5dGUgPSB0cnVlDQo2MDAgICAgICcgUGFkZGluZyB0byB0aGUgbmVhcmVzdCA0LWJ5dGUgYm91bmRhcnkgZXhpc3RzLiANCjYxMCAgICAgJyBDb3VudCB0aGUgcGl4ZWxzIHRvIGJlIGRyYXduIGFuZCBkcmF3IHRoZW0sIHRoZW4gc2tpcCB0aGUgcGFkZGluZy4NCjYyMCAgICAgbj13aWR0aC14ICYjNTg7ICcgVGhlcmUgYXJlIG4gcGl4ZWxzIGxlZnQgaW4gdGhlIHJvdy4NCjYzMCAgICAgSUYgbiZndDs9OCBUSEVOIEdPU1VCIDgyMCAmIzU4OyB4PXgrOCAmIzU4OyBHT1RPIDYzMCYjNTg7J0Rpc3BsYXkgZWlnaHQgYml0cy4NCjY0MCAgICAgYnl0ZT1BU0MoSU5QVVQkKDEsJiMzNTsxKSkNCjY1MCAgIEVORElGDQo2NjAgICBETyBXSElMRSAoeCBNT0QgYm91bmRhcnkpJmd0OzANCjY3MCAgICAgYSQ9SU5QVVQkKDEsJiMzNTsxKSYjNTg7eD14KzENCjY4MCAgIExPT1ANCjY5MCBORVhUIHkNCjcwMCAnDQo3MTAgJ0luZGljYXRlIGpvYiBpcyBkb25lIGFuZCB3YWl0IGZvciBhIGtleXByZXNzLg0KNzIwIFNPVU5EIDQ0MCwxMDANCjczMCBJRiBJTktFWSQ9IiIgVEhFTiBHT1RPIDczMA0KNzQwIEVORA0KNzUwICcNCjc2MCAnJiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7IFNVQlJPVVRJTkVTICYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOw0KNzcwICcgR2V0IG5leHQgdHdvIGJ5dGVzIGZyb20gcHRyLCByZXR1cm4gYXMgJ2J5dGUnLCB0aGVuIGluYyBmaWxlIHB0ci4NCjc4MCBsc2I9QVNDKElOUFVUJCgxLCYjMzU7MSkpJiM1ODttc2I9QVNDKElOUFVUJCgxLCYjMzU7MSkpDQo3OTAgYnl0ZT0obXNiICYjNDI7IDI1NikgKyBsc2INCjgwMCBSRVRVUk4NCjgxMCAnDQo4MjAgJyBEaXNwbGF5IG5leHQgOCBwaXhlbHMgaW4gdGhlIHJvdy4NCjgzMCBieXRlPUFTQyhJTlBVVCQoMSwmIzM1OzEpKQ0KODQwIElGIGVuZGJ5dGU9dHJ1ZSBUSEVOIEdPVE8gODcwJiM1ODsgJ1Nob3J0IGN1dHMgY2FuIHNwaWxsIHBhc3QgdGhlIGVkZ2UuDQo4NTAgSUYgYnl0ZT0mYW1wO2hGRiBUSEVOIFJFVFVSTiYjNTg7JyBOb3RoaW5nIHRvIGRyYXcuDQo4NjAgSUYgYnl0ZT0wIFRIRU4gTElORSh4LHkpLSh4KzgseSksMSYjNTg7UkVUVVJOJiM1ODsnRHJhd2luZyBhIGxpbmUgaXMgZmFzdGVyLg0KODcwIEZPUiBiaXQ9NyBUTyAwIFNURVAgLTENCjg4MCAgIFBJWEVMKHgrNy1iaXQseSk9Tk9UKGJ5dGUgQU5EIDJeYml0KQ0KODkwIE5FWFQgYml0DQo5MDAgUkVUVVJODQoNCjwvcHJlPmRkhjz6YIOTcmHYqd2YDOukhNmrufI=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">BMPSHOW.BAS</h1><small>Modified on 2016/12/23 23:21 by Administrator &mdash; Categorized as: Graphics, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: The required file(s) are available in the attachments tab (top right).<br /><br /><pre>
10 ' BMPSHOW&#58; displays a 1-bit BMP image
20 ' from Bruce Mitchell &lt;brucepython@gmail.com&gt; 
30 '
40 ' BMP is a format with many variations and vagaries.
50 ' Don't be surprised if some images appear inverted, negative or
60 ' otherwise weird. 
70 ' See en.wikipedia.ord/wiki/BMP_file_format for basic info and some 
80 ' useful references.
90 ' Max image size displayed is 480 wide x 432 high.
100 'Larger images might load OK but only a corner will be shown.
110 'It's slow!
120 '
130 'Possible enhancements might include choices to display the image as&#58;
140 ' &#42; inverted
150 ' &#42; negative
160 ' &#42; flipped horizontally
170 ' &#42; located at x,y rather than top left.
180 '
190 INPUT "BMP file to load&#58; "; f$
200 IF UCASE$(RIGHT$(f$,4))&lt;&gt;".BMP" THEN f$=f$+".BMP"
210 OPEN f$ FOR input AS &#35;1
220 '
230 boundary=4 &#58; ' BMP line data comes in 4 byte chunks.
240 FOR ptr=0 TO 9&#58;a$=INPUT$(1,&#35;1)&#58;NEXT&#58; ' Skip the signature field.
250 '
260 'Get data offset.
270 GOSUB 770&#58; offset = byte-1
280 FOR ptr=ptr TO ptr+5&#58;a$=INPUT$(1,&#35;1)&#58;NEXT
290 '
300 GOSUB 770&#58;width=byte
310 FOR ptr=ptr TO ptr+1&#58;a$=INPUT$(1,&#35;1)&#58;NEXT
320 GOSUB 770&#58;height=byte
330 ptr=ptr+8
340 '
350 ' Get colour depth in bits from &amp;1C.
360 FOR ptr=ptr TO ptr+3&#58;a$=INPUT$(1,&#35;1)
370 NEXT
380 GOSUB 770&#58; depth=byte
390 '
400 IF depth&lt;&gt;1 THEN PRINT "Only 1-bit BMP images are supported."&#58;END
410 '
420 REM PRINT "Height=";height&#58;' Remove REM if you need to check the image size.
430 REM PRINT "Width =";width&#58;'  See above.
440 '
450 CLOSE &#35;1&#58; OPEN f$ FOR input AS &#35;1&#58;' Reset to start of file.
460 FOR ptr=0 TO offset&#58;a$=INPUT$(1,&#35;1)&#58;NEXT&#58;' ptr points to start of bitmap.
470 '
480 'Copy the bitmap to the screen.
490 CLS
500 FOR y=height-1 TO 0 STEP -1
510  'Clear the flag that signals the final byte(s) in the row.
520   endbyte=false
530  'Plot the row.
540   FOR x=0 TO width-8 STEP 8
550     GOSUB 820
560   NEXT x
570  ' Are we at a 4-byte boundary?
580   IF x &lt; width THEN
590     endbyte = true
600     ' Padding to the nearest 4-byte boundary exists. 
610     ' Count the pixels to be drawn and draw them, then skip the padding.
620     n=width-x &#58; ' There are n pixels left in the row.
630     IF n&gt;=8 THEN GOSUB 820 &#58; x=x+8 &#58; GOTO 630&#58;'Display eight bits.
640     byte=ASC(INPUT$(1,&#35;1))
650   ENDIF
660   DO WHILE (x MOD boundary)&gt;0
670     a$=INPUT$(1,&#35;1)&#58;x=x+1
680   LOOP
690 NEXT y
700 '
710 'Indicate job is done and wait for a keypress.
720 SOUND 440,100
730 IF INKEY$="" THEN GOTO 730
740 END
750 '
760 '&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61; SUBROUTINES &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
770 ' Get next two bytes from ptr, return as 'byte', then inc file ptr.
780 lsb=ASC(INPUT$(1,&#35;1))&#58;msb=ASC(INPUT$(1,&#35;1))
790 byte=(msb &#42; 256) + lsb
800 RETURN
810 '
820 ' Display next 8 pixels in the row.
830 byte=ASC(INPUT$(1,&#35;1))
840 IF endbyte=true THEN GOTO 870&#58; 'Short cuts can spill past the edge.
850 IF byte=&amp;hFF THEN RETURN&#58;' Nothing to draw.
860 IF byte=0 THEN LINE(x,y)-(x+8,y),1&#58;RETURN&#58;'Drawing a line is faster.
870 FOR bit=7 TO 0 STEP -1
880   PIXEL(x+7-bit,y)=NOT(byte AND 2^bit)
890 NEXT bit
900 RETURN

</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.BMPSHOW-BAS-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:03 GMT -->
</html>
