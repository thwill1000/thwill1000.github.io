

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.ByREF-ByVAL-VB-work-a-like by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	ByREF & ByVAL - (VB work-a-like) - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.ByREF-ByVAL-VB-work-a-like" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF8RY8aDEgY2xhc3M9InBhZ2V0aXRsZSI+QnlSRUYgJiBCeVZBTCAtIChWQiB3b3JrLWEtbGlrZSk8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDIxLzExLzI1IDE3OjQ4IGJ5IENhcHRhaW5Cb2luZyAmbWRhc2g7IENhdGVnb3JpemVkIGFzOiBNYXRocywgTWVtb3J5LCBQcm9ncmFtIEZsb3csIFByb2dyYW1taW5nIE1ldGhvZCwgU3RyaW5nczwvc21hbGw+PGJyIC8+PGJyIC8+Tm90IGEgZGlyZWN0IHdvcmstYS1saWtlIGJ1dCBhIHdvcmstYXJvdW5kLi4uPGJyIC8+PGJyIC8+TU1CYXNpYywgZ29vZCBhcyBpdCBpcyBoYXMgc29tZSBvbWlzc2lvbnMgZm9yY2VkIG9uIGl0IGJ5IHRoZSB0YXJnZXQgZW52aXJvbm1lbnQgLSB0aGVyZSBpcyBvbmx5IHNvIG11Y2ggeW91IGNhbiBkbyBpbiB0aGUgc21hbGwgbWVtb3JpZXMgb2YgbWljcm8tY29udHJvbGxlcnMuPGJyIC8+PGJyIC8+V2hlbiBwYXNzaW5nIGFyZ3VtZW50cyBpbnRvIFN1YnMgYW5kIEZ1bmN0aW9ucywgcHJvZ3JhbW1lcnMgb2YgbW9yZSBoZWF2eS13ZWlnaHQgbGFuZ3VhZ2VzIGFyZSB1c2VkIHRvIGJlaW5nIGFibGUgdG8gc3BlY2lmeSB0aGUgbWV0aG9kIHdpdGggd2hpY2ggYSB2YXJpYWJsZSBpcyBwYXNzZWQuPGJyIC8+PGJyIC8+VkIsIGZvciBpbnN0YW5jZSwgc3VwcG9ydHMgdGhlIGZvbGxvd2luZzo8YnIgLz48YnIgLz48cHJlPlN1YiBNeVN1YiAoQnlWYWwgeCBBcyBJbnRlZ2VyKTwvcHJlPjxiciAvPk9yIDxiciAvPjxiciAvPjxwcmU+U3ViIE15U3ViIChCeVJlZiB4IEFzIEludGVnZXIpPC9wcmU+PGJyIC8+VGhlIGZpcnN0IHBhc3NlcyB0aGUgYWN0dWFsIFZBTHVlIG9mIHRoZSB2YXJpYWJsZS4gQW55IGFjdGlvbnMgcGVyZm9ybWVkIG9uIHRoYXQgdmFyaWFibGUgaW5zaWRlIHRoZSBTdWIgb3IgRnVuY3Rpb24gYXJlIG5vdCByZWZsZWN0ZWQgYmFjayBpbnRvIHRoZSBwYXNzZWQgYXJndW1lbnQuIFRoZSBzZWNvbmQgcGFzc2VzIHRoZSBwb2ludGVyIChSRUZlcmVuY2UpIG9mIHRoZSB2YXJpYWJsZS4gVGhpcyBtZWFucyB0aGF0IGFueSBhY3Rpb25zIHBlcmZvcm1lZCBvbiB0aGUgdmFyaWFibGUgYnkgdGhlIFN1Yiwgd2lsbCBhbHRlciBpdCAtIHRoZSB2YXJpYWJsZSB3aWxsIGNoYW5nZSB2YWx1ZSwgc28gd2hlbiB5b3UgY29tZSBiYWNrIGZyb20gdGhlIFN1YiwgdGhlIGNhbGxpbmcgcHJvZ3JhbSBjYW4gZXhwZWN0IGEgZGlmZmVyZW50IHZhbHVlIGluIHRoYXQgdmFyaWFibGUuIFRoaXMgY2FuIGJlIGV4cGxvaXRlZCBhcyBhIHdheSB0byBnZXQgbW9yZSB0aGFuIG9uZSByZXN1bHQgZnJvbSBGdW5jdGlvbnMgYnV0IGNhbiBhbHNvIGxlYWQgdG8gdHJpY2t5IGJ1Z3MuPGJyIC8+PGJyIC8+V2l0aCBNTUJhc2ljLCBhbGwgdmFyaWFibGVzIGFyZSBwYXNzZWQgdXNpbmcsIGVmZmVjdGl2ZWx5LCB0aGUgQnlSZWYgbWV0aG9kIC0gaXQgaXMgaW1wbGljaXQgYW5kIHlvdSBjYW4ndCBjaGFuZ2UgaXQuIEZ1bmN0aW9ucyBhbmQgU3VicyB0aGF0IHBlcmZvcm0gYWN0aW9ucyBvbiB0aGVzZSBhcmd1bWVudHMgd2lsbCBhbHRlciB0aGUgdmFsdWUgb2YgdGhlIHZhcmlhYmxlIGluIHRoZSBjYWxsaW5nIGNvZGUuIElmIHRoaXMgaXMgc29tZXRoaW5nIHlvdSBhcmUgZ29pbmcgdG8gbmVlZCBsYXRlciwgeW91IGhhdmUgdG8gdGFrZSBwcmVjYXV0aW9ucyBhZ2FpbnN0IHRoYXQgZGVzdHJ1Y3Rpb24uIE9mdGVuIHRoaXMgaW52b2x2ZXMgbWFraW5nIGEgY29weSB0aGF0IGNhbiBiZSByZXN0b3JlZCBhZnRlciB0aGUgU3ViIGhhcyBkb25lIGl0cyB3b3JrLCBidXQgdGhlcmUgaXMgYW5vdGhlciwgc2ltcGxlciwgd2F5Li4uPGJyIC8+PGJyIC8+RW5jbG9zaW5nIHRoZSBwYXNzZWQgdmFyaWFibGUgaW4gcGFyZW50aGVzaXMgKCkgY2F1c2VzIGFuIGV2YWx1YXRpb24gdG8gYmUgcGVyZm9ybWVkLiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBvbiB0aGUgaGVhcCBpbiBtZW1vcnkgYW5kIHRoZSBwb2ludGVyIHRvIHRoYXQgKG5vdCB0aGUgdmFyaWFibGUpIGlzIHBhc3NlZC48YnIgLz48YnIgLz5Db25zaWRlciB0aGUgZm9sbG93aW5nIGRlbW9uc3RyYXRpb246PGJyIC8+PGJyIC8+PHByZT4NCglEaW0gSW50ZWdlciB4LHoNCgl4PTEwDQoJej1NeUZ1bmMoeCkJDQoJUHJpbnQgeA0KCQ0KCQ0KCXg9MTANCgl6PU15RnVuYygoeCkpCQ0KCVByaW50IHgNCgkNCgkNCglGdW5jdGlvbiBNeUZ1bmMgKGEgQXMgSW50ZWdlcikNCgkJYT1hLzINCglFbmQgRnVuY3Rpb24NCjwvcHJlPjxiciAvPk15RnVuYyB0cmFzaGVzIHRoZSBwYXNzZWQtaW4gdmFyaWFibGUgYnkgYWN0aW5nIGRpcmVjdGx5IG9uIGl0IChhcyBpdHMgYWxpYXMgJ2EnKSBhbmQgdGhpcyBjYW4gYmUgc2VlbiBpbiB0aGUgZmlyc3QgZXhhbXBsZSB3aXRoIHggY2hhbmdpbmcgdmFsdWUgZnJvbSAxMCB0byA1LiBUaGUgc2Vjb25kIHdyYXBzIFggaW4gYW4gYWRkaXRpb25hbCBzZXQgb2YgcGFyZW50aGVzaXMuIFRoaXMgY2FsbHMgdGhlIGV2YWx1YXRvciB0byB3b3JrIG91dCB0aGUgcmVzdWx0IG9mIHRoZSBleHByZXNzaW9uICh0aGVyZSBpcyBub25lIHJlYWxseSkgYnV0IHRoZSBldmFsdWF0aW9uIGlzIGRvbmUgbm9uZXRoZWxlc3Mgd2l0aCB0aGUgcmVzdWx0IGJlaW5nIHN0b3JlZCB0ZW1wb3JhcmlseSBvbiB0aGUgaGVhcCBpbiBSQU0uIFRoZSAiQnlSZWYiIHBvaW50ZXIgcGFzc2VkIHRvIE15RnVuYyBpcyB0aGF0IG9mIHRoZSB0ZW1wb3JhcnkgYXJlYSBhbmQgbm90IG9mIHRoZSBvcmlnaW5hbCB2YXJpYWJsZSBsZWF2aW5nIGl0IGludGFjdCBhbmQgdGh1cyBlbXVsYXRpbmcgQnlWQUwuPGJyIC8+PGJyIC8+VGhpcyB0cmljayB3b3JrcyBmb3IgYWxsIHZhcmlhYmxlIHR5cGVzLCBlLmcuIChhJCksIChiJSkgYW5kIChjISkgd2lsbCBhbGwgcmVtYWluIGludGFjdCBhbmQgc2FmZSBmcm9tIHRoZSB2YW5kYWxpc20gb2YgdGhlIFN1Yi48YnIgLz4gZGRwm8Yh95QTIXL730vHlWrzMRXLWA==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">ByREF & ByVAL - (VB work-a-like)</h1><small>Modified on 2021/11/25 17:48 by CaptainBoing &mdash; Categorized as: Maths, Memory, Program Flow, Programming Method, Strings</small><br /><br />Not a direct work-a-like but a work-around...<br /><br />MMBasic, good as it is has some omissions forced on it by the target environment - there is only so much you can do in the small memories of micro-controllers.<br /><br />When passing arguments into Subs and Functions, programmers of more heavy-weight languages are used to being able to specify the method with which a variable is passed.<br /><br />VB, for instance, supports the following:<br /><br /><pre>Sub MySub (ByVal x As Integer)</pre><br />Or <br /><br /><pre>Sub MySub (ByRef x As Integer)</pre><br />The first passes the actual VALue of the variable. Any actions performed on that variable inside the Sub or Function are not reflected back into the passed argument. The second passes the pointer (REFerence) of the variable. This means that any actions performed on the variable by the Sub, will alter it - the variable will change value, so when you come back from the Sub, the calling program can expect a different value in that variable. This can be exploited as a way to get more than one result from Functions but can also lead to tricky bugs.<br /><br />With MMBasic, all variables are passed using, effectively, the ByRef method - it is implicit and you can't change it. Functions and Subs that perform actions on these arguments will alter the value of the variable in the calling code. If this is something you are going to need later, you have to take precautions against that destruction. Often this involves making a copy that can be restored after the Sub has done its work, but there is another, simpler, way...<br /><br />Enclosing the passed variable in parenthesis () causes an evaluation to be performed. The result is stored on the heap in memory and the pointer to that (not the variable) is passed.<br /><br />Consider the following demonstration:<br /><br /><pre>
	Dim Integer x,z
	x=10
	z=MyFunc(x)	
	Print x
	
	
	x=10
	z=MyFunc((x))	
	Print x
	
	
	Function MyFunc (a As Integer)
		a=a/2
	End Function
</pre><br />MyFunc trashes the passed-in variable by acting directly on it (as its alias 'a') and this can be seen in the first example with x changing value from 10 to 5. The second wraps X in an additional set of parenthesis. This calls the evaluator to work out the result of the expression (there is none really) but the evaluation is done nonetheless with the result being stored temporarily on the heap in RAM. The "ByRef" pointer passed to MyFunc is that of the temporary area and not of the original variable leaving it intact and thus emulating ByVAL.<br /><br />This trick works for all variable types, e.g. (a$), (b%) and (c!) will all remain intact and safe from the vandalism of the Sub.<br /> 
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.ByREF-ByVAL-VB-work-a-like by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:11 GMT -->
</html>
