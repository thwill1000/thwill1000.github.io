

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.String-editing-on-screen-for-VT-compatible-Terminals by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:24:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	String editing on-screen for VT compatible Terminals - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.String-editing-on-screen-for-VT-compatible-Terminals" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFxRM8aDEgY2xhc3M9InBhZ2V0aXRsZSI+U3RyaW5nIGVkaXRpbmcgb24tc2NyZWVuIGZvciBWVCBjb21wYXRpYmxlIFRlcm1pbmFsczwvaDE+PHNtYWxsPk1vZGlmaWVkIG9uIDIwMjAvMDcvMTMgMTc6MzEgYnkgQ2FwdGFpbkJvaW5nICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IENvbnNvbGUsIERhdGVzLCBUaW1lIGFuZCBDbG9ja3MsIFByb2dyYW0gRmxvdywgU3RyaW5nczwvc21hbGw+PGJyIC8+PGJyIC8+U3RyRWRpdCQoKSBhbGxvd3MgdGhlIHVzZXIgdG8gZWRpdCAob3IgZW50ZXIgLSBzdGFydCB3aXRoICIiKSBhIHN0cmluZyBhdCBhIGdpdmVuIHBvc2l0aW9uIGluIGEgdGVybWluYWwgd2luZG93IGFuZCBjb25zdHJhaW5lZCB0byBhIHNwZWNpZmllZCBsZW5ndGguIEl0IGlzIGEgbW9yZSBpbnRlbGxpZ2VudCB2ZXJzaW9uIG9mIElucHV0IGluIHRoYXQgaXQgcGVyZm9ybXMgdGhlIHNhbWUgZnVuY3Rpb24gYnV0IGlzIG5vbi1ibG9ja2luZyAod2l0aCA8Y29kZT5JbnB1dDwvY29kZT4sIHlvdXIgcHJvZ3JhbSBsb3NlcyBjb250cm9sIHdoaWxlIGl0IHdhaXRzIGZvciB0aGUgdXNlciksIGxpbWl0cyB0aGUgYW1vdW50IG9mIGRhdGEsIHByb3ZpZGVzIG5pY2UgZWRpdGluZyBhbmQgbmljZSBkaXNwbGF5cyByZW1pbmlzY2VudCBvZiB0aGUgODBzICYgOTBzIHRlcm1pbmFsIGJhc2VkIGlucHV0LjxiciAvPjxiciAvPllvdXIgdGVybWluYWwgZW11bGF0b3IgbXVzdCBiZSBWVCBjb21wbGlhbnQgdG8gdW5kZXJzdGFuZCB0aGUgQU5TSSBjb2RlcyAoSSB1c2UgUHVUVFkpPGJyIC8+PGJyIC8+PGI+RGVwZW5kYW5jaWVzPC9iPjxiciAvPjx1bD48YnIgLz48bGk+T3B0aW9uIEJhc2UgMDwvbGk+PGJyIC8+PGxpPjxhIGNsYXNzPSJwYWdlbGluayIgaHJlZj0iTU1CYXNpYy5WQi1Xb3JrLWEtbGlrZS1MVHJpbS1hbmQtUlRSSU0tRnVuY3Rpb25zLmFzaHgiIHRpdGxlPSJMVHJpbSBhbmQgUlRyaW0gRnVuY3Rpb25zIChWQiB3b3JrLWEtbGlrZSkiPkxUcmltIGFuZCBSVFJJTSBGdW5jdGlvbnMgKFZCIHdvcmstYS1saWtlKTwvYT4gb3IgdGhlIGVxdWl2YWxlbnQgPGEgY2xhc3M9InBhZ2VsaW5rIiBocmVmPSJNTUJhc2ljLkxUcmltLVJUcmltLWNGdW5jdGlvbnMuYXNoeCIgdGl0bGU9IkxUcmltIFJUcmltIENGdW5jdGlvbnMiPkxUcmltIFJUcmltIENGdW5jdGlvbnM8L2E+IChub3RlIHRoaXMgbGF0dGVyIGRvZXMgbm90IHRyZWF0IFRBQnMgYXMgd2hpdGUtc3BhY2UgYW5kIHNvIGFyZSBub3QgdHJpbW1lZCkuPC9saT48YnIgLz48bGk+PGEgY2xhc3M9InBhZ2VsaW5rIiBocmVmPSJNTUJhc2ljLlNpbXBsZS1zY3JlZW4tQ29udHJvbC1mb3ItQU5TSS1iYXNlZC1Db25zb2xlcy1WVDEwMC1ldGMuYXNoeCIgdGl0bGU9IlZUIENvbnNvbGUgUGFjay4gU2NyZWVuIFBvc2l0aW9uaW5nLCBTYW5lIEtleSBTY2FubmluZyBBbmQgYSBTdHJpbmcgRWRpdGluZyBSb3V0aW5lIj5WVCBDb25zb2xlIFBhY2suIFNjcmVlbiBQb3NpdGlvbmluZywgU2FuZSBLZXkgU2Nhbm5pbmcgQW5kIGEgU3RyaW5nIEVkaXRpbmcgUm91dGluZTwvYT48L2xpPjxiciAvPjwvdWw+PGJyIC8+PGI+RXhhbXBsZSBVc2FnZTwvYj48YnIgLz5NeURUJD1TdHJFZGl0JChNeURUJCwxMCwxMCw4KTxiciAvPjxiciAvPjxwcmU+DQoJJ0VkaXQgdGhlIHN0cmluZyBhdCB0aGUgcG9zaXRpb24gZ2l2ZW4gbGltaXRlZCB0byBxIGNoYXJhY3RlcnMgbG9uZw0KCUZ1bmN0aW9uIFN0ckVkaXQkKGwkLGggQXMgSW50ZWdlcix2IEFzIEludGVnZXIscSBBcyBJbnRlZ2VyKQ0KCQlMb2NhbCB4JCxhJA0KCQlhJD1SVHJpbSQoTGVmdCQobCQscSkpDQoJCVNTdHIgYSQsaCx2DQoNCgkJRG8NCgkJCURvJiM1ODt4JD1WVEtleSQoKSYjNTg7TG9vcCBVbnRpbCB4JCZsdDsmZ3Q7IiINCgkJCUlmIExlbih4JCk9MSBUaGVuDQoJCQkJU2VsZWN0IENhc2UgQXNjKHgkKQ0KCQkJCQlDYXNlIDMyIFRvIDEyNg0KCQkJCQkJSWYgTGVuKGEkKSZsdDtxIFRoZW4gYSQ9YSQreCQmIzU4O1NTdHIgYSQsaCx2DQoJCQkJCUNhc2UgMTI3LDgNCgkJCQkJCUlmIExlbihhJCkgVGhlbg0KCQkJCQkJCWEkPUxlZnQkKGEkLExlbihhJCktMSkmIzU4O1NTdHIgYSQsaCx2DQoJCQkJCQlFbmRJZg0KCQkJCQlDYXNlIDEzDQoJCQkJCQlTdHJFZGl0JD1hJCYjNTg7RXhpdCBGdW5jdGlvbg0KCQkJCQlDYXNlIEVsc2UNCgkJCQkJCSdpZ25vcmUNCgkJCQlFbmQgU2VsZWN0DQoJCQlFbHNlDQoJCQkJSWYgeCQ9Il9ETCIgVGhlbg0KCQkJCQlJZiBMZW4oYSQpIFRoZW4NCgkJCQkJCWEkPUxlZnQkKGEkLExlbihhJCktMSkmIzU4O1NTdHIgYSQsaCx2DQoJCQkJCUVuZElmDQoJCQkJRW5kSWYNCgkJCUVuZElmDQoJCUxvb3ANCglFbmQgRnVuY3Rpb24NCg0KCVN1YiBTU3RyKGEkLGggQXMgSW50ZWdlciwgdiBBcyBJbnRlZ2VyKScgc3VwcG9ydCBTdWIgZm9yIFN0ckVkaXQkKCkNCgkJUHJpbnQgQXQoaCx2KTthJDsiICI7JiM1ODtQcmludCBBdChoLHYpO2EkOw0KCUVuZCBTdWINCjwvcHJlPjxiciAvPmRkijmaVPEOQV1/U5gPaQr3iuJ4Ce0=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">String editing on-screen for VT compatible Terminals</h1><small>Modified on 2020/07/13 17:31 by CaptainBoing &mdash; Categorized as: Console, Dates, Time and Clocks, Program Flow, Strings</small><br /><br />StrEdit$() allows the user to edit (or enter - start with "") a string at a given position in a terminal window and constrained to a specified length. It is a more intelligent version of Input in that it performs the same function but is non-blocking (with <code>Input</code>, your program loses control while it waits for the user), limits the amount of data, provides nice editing and nice displays reminiscent of the 80s & 90s terminal based input.<br /><br />Your terminal emulator must be VT compliant to understand the ANSI codes (I use PuTTY)<br /><br /><b>Dependancies</b><br /><ul><br /><li>Option Base 0</li><br /><li><a class="pagelink" href="MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions.html" title="LTrim and RTrim Functions (VB work-a-like)">LTrim and RTRIM Functions (VB work-a-like)</a> or the equivalent <a class="pagelink" href="MMBasic.LTrim-RTrim-cFunctions.html" title="LTrim RTrim CFunctions">LTrim RTrim CFunctions</a> (note this latter does not treat TABs as white-space and so are not trimmed).</li><br /><li><a class="pagelink" href="MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc.html" title="VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine">VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine</a></li><br /></ul><br /><b>Example Usage</b><br />MyDT$=StrEdit$(MyDT$,10,10,8)<br /><br /><pre>
	'Edit the string at the position given limited to q characters long
	Function StrEdit$(l$,h As Integer,v As Integer,q As Integer)
		Local x$,a$
		a$=RTrim$(Left$(l$,q))
		SStr a$,h,v

		Do
			Do&#58;x$=VTKey$()&#58;Loop Until x$&lt;&gt;""
			If Len(x$)=1 Then
				Select Case Asc(x$)
					Case 32 To 126
						If Len(a$)&lt;q Then a$=a$+x$&#58;SStr a$,h,v
					Case 127,8
						If Len(a$) Then
							a$=Left$(a$,Len(a$)-1)&#58;SStr a$,h,v
						EndIf
					Case 13
						StrEdit$=a$&#58;Exit Function
					Case Else
						'ignore
				End Select
			Else
				If x$="_DL" Then
					If Len(a$) Then
						a$=Left$(a$,Len(a$)-1)&#58;SStr a$,h,v
					EndIf
				EndIf
			EndIf
		Loop
	End Function

	Sub SStr(a$,h As Integer, v As Integer)' support Sub for StrEdit$()
		Print At(h,v);a$;" ";&#58;Print At(h,v);a$;
	End Sub
</pre><br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.String-editing-on-screen-for-VT-compatible-Terminals by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:24:44 GMT -->
</html>
