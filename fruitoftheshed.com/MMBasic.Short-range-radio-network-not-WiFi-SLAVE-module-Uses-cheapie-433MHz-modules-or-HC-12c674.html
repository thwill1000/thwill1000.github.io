

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12.ashx?NS=MMBasic by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:53:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12 - Fruit Of The Shed
</title><meta name="keywords" content="radio, 433, network" /><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12&amp;NS=MMBasic" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPZBYCZg8WAh4LXyFJdGVtQ291bnQCARYCAgEPZBYCZg8VBOsBR2V0RmlsZS5hc3B4P0ZpbGU9NDMzTUh6JTIwUmFkaW8uemlwJmFtcDtBc1N0cmVhbUF0dGFjaG1lbnQ9MSZhbXA7UHJvdmlkZXI9U2NyZXdUdXJuLldpa2kuRmlsZXNTdG9yYWdlUHJvdmlkZXImYW1wO0lzUGFnZUF0dGFjaG1lbnQ9MSZhbXA7UGFnZT1NTUJhc2ljLlNob3J0LXJhbmdlLXJhZGlvLW5ldHdvcmstbm90LVdpRmktU0xBVkUtbW9kdWxlLVVzZXMtY2hlYXBpZS00MzNNSHotbW9kdWxlcy1vci1IQy0xMghEb3dubG9hZBA0MzNNSHogUmFkaW8uemlwBzQuNTMgS0JkZNrO8NLoBhOC2oNDXH4xnME4uIpi" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Logind161.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dShort-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12%26NS%3dMMBasic" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.Historyfb13.html?Page=MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12">History</a>
			<a id="PageAttachmentsLink" title="Attachments" href="#" onclick="javascript:return __ToggleAttachmentsMenu(event.clientX, event.clientY);">Attachments</a>
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Printfb13.html?Page=MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2018/11/28 01:38
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.User6a4a.html?Username=admin">Administrator</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPagesc884.html?Cat=MMBasic.Communications" title="Communications">Communications</a>, <a href="MMBasic.AllPagese076.html?Cat=MMBasic.Control" title="Control">Control</a>, <a href="MMBasic.AllPages5ce5.html?Cat=MMBasic.Electronics" title="Electronics">Electronics</a>, <a href="MMBasic.AllPagesbcca.html?Cat=MMBasic.Environment" title="Environment">Environment</a>, <a href="MMBasic.AllPages9386.html?Cat=MMBasic.Hardware" title="Hardware">Hardware</a>, <a href="MMBasic.AllPagesa19c.html?Cat=MMBasic.Network" title="Network">Network</a>, <a href="MMBasic.AllPagesbbe2.html?Cat=MMBasic.Radio" title="Radio">Radio</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="fecff03f8-5b53-4faf-abe0-984db1833633" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fecff03f8-5b53-4faf-abe0-984db1833633');"></div><div id="f0faf312f-00ac-4f4c-8b48-46dce792219d" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f0faf312f-00ac-4f4c-8b48-46dce792219d');"><a href="MMBasic.Sort-algorithms-A-comparison.html" title="Sort algorithms - A comparison">Sort algorithms - A comparison</a></div><div id="f9aeb3340-037b-4e62-b186-ccf02729aaa0" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f9aeb3340-037b-4e62-b186-ccf02729aaa0');"><a href="MMBasic.Sensible-Cartesian-Co-ordinate-graphics-pack.html" title="Sensible Cartesian Co-ordinate graphics pack">Sensible Cartesian Co-ordinate graphics pack</a></div><div id="sebbd6254-5f37-4bb8-a9e8-0a17305c8e83" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('sebbd6254-5f37-4bb8-a9e8-0a17305c8e83');"></div><div id="s85b44513-cba4-4da1-a7e5-e065439f0215" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s85b44513-cba4-4da1-a7e5-e065439f0215');"><a href="MMBasic.Sort-algorithms-A-comparison.html" title="Sort algorithms - A comparison">Sort algorithms - A comparison</a></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.Shell-Sort.html" title="Shell Sort (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 's85b44513-cba4-4da1-a7e5-e065439f0215', this);" id="lnks85b44513-cba4-4da1-a7e5-e065439f0215" onmouseout="javascript:return __HideDropDown('s85b44513-cba4-4da1-a7e5-e065439f0215');">Shell Sort (MMBasic)</a> &raquo; <a href="MMBasic.SHIFT-or-ROTATE-an-array-of-integers.html" title="SHIFT or ROTATE an array of integers (MMBasic)">SHIFT or ROTATE an array of integers (MMBasic)</a> &raquo; <b><a href="MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12.html" title="Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12 (MMBasic)">Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12 (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="MMBasic.RENUM-BAS-part-of-the-original-MMBasic-library.html" title="RENUM.BAS (MMBasic)">RENUM.BAS (MMBasic)</a> &raquo; <a href="MMBasic.VB-Work-a-like-REPLACE-Function.html" title="REPLACE$ Function (VB work-a-like) (MMBasic)">REPLACE$ Function (VB work-a-like) (MMBasic)</a> &raquo; <a href="MMBasic.REVERSE-BAS-part-of-the-original-MMBasic-library.html" title="REVERSE.BAS (MMBasic)">REVERSE.BAS (MMBasic)</a> &raquo; <a href="MMBasic.RTC-DOW-BAS-part-of-the-original-MMBasic-library.html" title="RTC-DOW.BAS (MMBasic)">RTC-DOW.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Sample-AUTORUN-BAS-file-part-of-the-original-MMBasic-library.html" title="Sample AUTORUN.BAS (MMBasic)">Sample AUTORUN.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Sensible-Cartesian-Co-ordinate-graphics-pack.html" title="Sensible Cartesian Co-ordinate graphics pack (MMBasic)">Sensible Cartesian Co-ordinate graphics pack (MMBasic)</a> &raquo; <a href="MMBasic.Shape-drawing-for-Complex-Lines-and-Polygons.html" title="Shape drawing for Complex Lines and Polygons (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'f9aeb3340-037b-4e62-b186-ccf02729aaa0', this);" id="lnkf9aeb3340-037b-4e62-b186-ccf02729aaa0" onmouseout="javascript:return __HideDropDown('f9aeb3340-037b-4e62-b186-ccf02729aaa0');">Shape drawing for Complex Lines and Polygons (MMBasic)</a> &raquo; <a href="MMBasic.Shell-Sort.html" title="Shell Sort (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'f0faf312f-00ac-4f4c-8b48-46dce792219d', this);" id="lnkf0faf312f-00ac-4f4c-8b48-46dce792219d" onmouseout="javascript:return __HideDropDown('f0faf312f-00ac-4f4c-8b48-46dce792219d');">Shell Sort (MMBasic)</a> &raquo; <a href="MMBasic.SHIFT-or-ROTATE-an-array-of-integers.html" title="SHIFT or ROTATE an array of integers (MMBasic)">SHIFT or ROTATE an array of integers (MMBasic)</a> &raquo; <b><a href="MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12.html" title="Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12 (MMBasic)">Short range radio network (not WiFi). SLAVE module. Uses cheapie 433MHz modules or HC-12 (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		The following is a protocol I developed for a short range radio network without all the fluff associated with establishing and using a WiFi Ethernet presence. It is a simple star network with a master device initiating all communications to addressed slave modules. Messages may be passed back and forth-the content and interpretation of which is down to the application.<br /><br />VB6 source code for the master is attached.<br /><br /><br /><b>Protocol</b>:<br /><pre>
Master is always address 0
Slaves are address 1-998
Broadcast is address 999

Master initiates all communication and slaves only ever respond to Master requests for interaction (STAT or POLL).
Packets consist of a 4 character verb and then the payload.

All devices must be on the same "channel". It was explored that each slave might exist on its own channel but this was abandoned
early on because the cons outweighed the pros&#58;

Separate channel&#58; 	Pro    slave does not need to parse the addresses from the packet-if it hears the packet then it must be for that slave.
                        Con    Broadcast becomes impossible.
                               Device addresses limited to 127.
                               Cheap RxTx modules have no concept of channel.

Single channel&#58;         Pro    Slave address is encoded as part of the packet header with a maximum of 998 slave devices. Different channels
                               permit single master with multiple slave zones if required, thus giving &lt; 128000 devices (but broadcast and use of
                               cheapie modules will be impacted).
                               Broadcast is simple-all devices hear the broadcast and pick the addresses from the packet as normal.
                               Can use cheapie 433MHz TxRx pairs with no onboard processing (see preamble).
                        Con    HC-12 module is more expensive


Command		Source  Details
&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-+&#45;&#45;&#45;&#45;&#45;&#45;-+&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;
STAT&#58;           Master	Master STATs address.
		        Slave MUST respond within 1.5 seconds and may send back data, thus a STAT contains an implicit POLL.
		        Nil response will result in the slave marked as not available in the status register (master will not POLL).
		        Slave must reply with ACK0 only-If the Slave has more to say, it must wait for a poll.
POLL&#58;           Master	Master POLLs address.
		        Slave may respond but must do so within within 1.5 seconds if it has something to say but keeps quiet otherwise.
ACK0&#58;           Slave	This is the terminating response to a STAT or POLL. This packet will cause the Master to accept the response and
		        move on to the next section of the cycle.
ACK1&#58;           Slave	This is the response to a POLL only but signifies the slave has more to report. This packet will cause the
		        Master to accept the response and then immediately issue another POLL to the same slave. Multiple ACK1's may be
		        sent and the Master will continue to POLL and accept packets until receipt of ACK0 or a timeout occurs, at which
		        point the master will move on to the next section of the cycle. The slave must pause for 1.5 seconds between each
		        ACKx packet. An improvement would be to limit the amount of ACK1s to prevent a slave blocking the master.
INIT&#58;		Master	The addressed slave must restart.
SAFE&#58;		Master	The addressed slave must go to its safe mode state.

Broadcasts&#58;	Any packet with destination address 999 is assumed to be a broadcast. Usually only the Master Broadcasts. Slaves must not reply to broadcasts.
TIME&#58;		Master	The payload is hh&#58;mm&#58;ss,dd/mm/yyyy
		        All slaves will respond to this packet and synchronise their clocks to the payload.
INIT&#58;		Master	All slaves must restart.
SAFE&#58;		Master	All slaves must go to their safe mode state.
FIRE&#58;		Master	All slaves must go to their FIRE mode state.


Slaves must respond to STAT. The response (or lack of it) updates the internal status register for that slave. Slaves that do not
respond to a STAT will be skipped in the POLL cycle. The master will attempt to discover all addresses continually.

Master&#58; STAT (nn)
	Slave&#58;	Must reply with ACK0 to the Master. The payload may be empty. Failure to respond will record that address as
	unavailable/empty in the slave register.

Master&#58;	POLL (nn)
	Slave&#58;	May reply with ACK0 (or ACK1 if there are multiple payloads) to the Master. The payload may be empty but it is
	recommended the slave not respond to a POLL if it has nothing to report. This reduces the cycle time and processing load.
	There is no advantage to replying with an empty payload.

The Packet format (all nodes)&#58;
Note the bracket forms below do not form part of the message and are here simply to logically group sections.
&#91;optional preamble&#93;STX&lt;checksum&gt;GS&#123;RC4&lt;dest address&gt;&lt;src address&gt;&lt;&lt;Packet&gt;&#125;ETX

The data between the GS and ETX is encrypted before transmission. The checksum is for all bytes between &#123;&#125;
RC4 (elsewhere on this wiki) is a complex algorithm with a moderate data requirement (0.5K). A simpler encryption algorithm XORing a
variable length key is available if the simple nature of the slaves cannot support it i.e. simple PIC/Atmel chips.
Smaller Micromites can struggle to maintain timings with RC4 and large packets-use simple encryption or slow the cycle.

The payload must only contain "Printable" characters in the range 32-126. This avoids erroneous control characters interfering with network operation.

A typical Tx from the master to device 05 looks like

Preamble      When using cheap TxRx modules with no onboard processing, it is necessary to send a stream of 1's with occasional zero so the Rx
              can set it's levels before the actual data arrives.
			  Without preamble, some bits may be lost while the Rx adjusts its levels. Anything to the left of the STX must be discarded.
			  Chr FE has a large amount of "1" space and the trailing 0 ensures the levels are set on Rx devices
              immediately before they are required to be accurate. A string of at least 2 FE chars is effective.
              Using devices like HC-12 where there is onboard processing to assure data integrity, a preamble is not necessary as it is
              taken care of by the radio modem.

              &#91;FE FE ...&#93;

Packet structure
              02 = STX Start of Text, sync marker. This indicate the start of valid data.
              CHK_HI ascii Hex of checksum of packet between the following GS and ETX
              CHK_LO
              1D = GS group separator, start of the addressing and instruction details.
              30 = attention device 005 in ascii
              30
              35
              30 = from the master 000 in ascii
              30
              30
              50 Command verb, STAT, POLL, ACK0 etc...
              49
              4E
              47
              &#91; optional payload here &#93;
              03 = ETX End of Text, marks the end of the packet. No further data is permitted.

Any response must begin transmission in the next 1.5 seconds
</pre><br /><br /><b>Master module.</b><br /><br />You need to add your own code to interpret the content of the packets (both master and slaves) but standardise functionality so the master and slaves know what each other is doing. The master does not have to be a MicroMite-I have working VB code which uses a HC-12 on a USB<->Serial adapter so a Windows server can control the network-this opens up all sorts of possibilities and is used in the Snooker Hall metering for club membership and time charging etc.<br /><br />Slaves and (micromite)master log to their console but this may be disconnected in general use. The modules detect "first run" and will prompt for config (i.e. their address and name-which is usually the location) at the console, after that it stores it's config and just gets on with things. So use the console to set the thing up and then just leave it to run. The modules I built have their console connections brought to a 3.5mm stereo jack which goes to a USB<->Serial jobby plugged in the installers laptop, just plug in to each and turn on, configure and run then unplug and move on to the next.<br /><br />The master "pings" every address from 001 to 998 every so often and if a module responds, it is marked as "live" and recorded along with it's name. Live Slave modules are polled in order for any messages interspersed with the next discovery. So the cycle might look like:<br /><br /><code>Stat 1 (responds)<br />Poll 1<br />Stat 2<br />Poll 1<br />Stat 3 (responds)<br />Poll 3<br />Stat 4<br />Poll 1<br />Stat 5<br />Poll 3<br />Stat 6<br />Poll 1<br />...<br />Stat 998<br />Time</code><br /><br />Only known live salves are regularly polled and newly discovered slaves are added as they are discovered. This ensures that we discover all modules over time but do not delay polling known live modules.<br /><br />Undiscovered addresses are polled continually in the above cycle allowing "live" addition of new modules without the need to re-initialse the master.<br /><br />At the end of the cycle, a TIME packet is sent on the broadcast address and all slaves set their clocks.<br /><br />INIT messages can be sent to restart an individual module, SAFE messages can be sent to individual or all modules to set them to their safe mode (maybe an engineer is about to open them up and doesn't want a mains circuit up his arm). A FIRE message can be sent to all modules-this sets the module to it's emergency mode-perhaps turn all the lights on, play a recorded message to evacuate the building etc...<br /><br /><br /><b>Slave module. </b><br /><br />You will need to adapt it as you see fit but it works really well and offers some nice features.<br /><br />Slave modules listen to radio transmissions for their address or the broadcast address and respond accordingly. I have used this for a number of different projects: Snooker/Pool table light control, Customer feedback pods etc.<br /><br />The Master initiates all communication and transmits structured and encrypted packets for specific slave addresses.<br /><br />The Master is always address 000 and slaves can be any from 001 to 998 (doesn't have to be contiguous). 999 is the broadcast address. You could easily extend this but probably a thousand slave modules will cover most installations. You don't have to use them all and the master won't waste time trying to talk to addresses that don't respond to discovery.<br /><br />The master also sends out TIME packets so slaves don't need RTCs (much cheapness!), only a single RTC on a network of 1000 modules!<br /><br /><b> Slave Module Code</b>:<br /><pre>

	Option Autorun On

	Print "Node boot"
	timer=0

	Option Base 0
	'Option Explicit

	Const KEY$="&gt;4!1x4q3z4+7%4&#123;9?5\3HhH^5$9=6@1~6,7_7|1)7'3&#93;7&#91;9&#58;8&lt;3&#42;8S9I9l7Z1eT0r1"
	Const GS=&amp;H1D
    Const STX=2
    Const ETX=3
	Const io=1
	Const DoPreamble=0	' No. of preamble bytes. Only for when using cheap dumb RxTx module pairs. Drop the baud rate right down (2400 ish) And set this value to 2 or more
	Const Link$="COM1&#58;9600,260"

	Dim MyAddr As Integer
	Dim MyJob As String

	Dim a$, tm$, cmd$, pl$, R ' R is the serial buffer
	Dim Integer c,src,dst,n
	Dim Integer FLAGS=0  ' 0 STX
                             ' 1 GS
                             ' 2 ETX
                             ' 3 Init. device has restarted And never heard from the master
                             ' 4 in FIRE mode
                             ' 5 in SAFE mode
                             ' 6 just been configured
                             ' 7
                             ' 8
                             ' 9
                             '10
                             '11
                             '12
                             '13
                             '14
                             '15
                             '16
                             '17
                             '18
                             '19
                             '20
                             '21
                             '22
                             '23
                             '24
                             '25
                             '26
                             '27
                             '28
                             '29
                             '30
                             '31

	Var Restore

	FlagSet 3 ' just booted

	IF MyAddr=0 Then
		Do
			Do
				Input "Enter Node address (1-998) &gt;", a$
				MyAddr=int(val("0"+a$))
			Loop Until MyAddr &gt;0 And MyAddr&lt;999

			Do
				Input "Enter Node Task Name       &gt;", a$
				Myjob=A$
			Loop Until MyJob&lt;&gt;""

			Print "Is This Correct? (Y/N)";
			Do&#58;Input a$&#58;a$=UCASE$(a$)&#58;Loop Until a$="Y" OR a$="N"
		Loop While a$="N"

		Var Save MyAddr,MyJob

		FlagSet 6 ' Just completed setup-need INIT
	EndIf

	Open Link$ As &#35;io ' may need to drop this for cheap TxRx modules, HC12 etc do not require
	FlushIO io

	Print "Node";MyAddr;" up in";Timer;"mS Name ";MyJob

	Do
		If Loc(&#35;io)&lt;&gt;0 Then
			C=Asc(Input$(1,&#35;io))
			Select Case C
				Case 2
					R=""
					If FLAGS&lt;&gt;0 Then Goto SafeExit
					FlagSet 0
				Case &amp;H1D	' test GS
					If Flagtest(0)&lt;&gt;1 And FlagTest(2)&lt;&gt;0 Then Goto SafeExit
					FlagSet 1
					R=R+","
				Case 3
					If Flagtest(0)&lt;&gt;1 And FlagTest(2)&lt;&gt;1 Then Goto SafeExit
					FlagSet 2
				Case &amp;H30 TO &amp;h39
					If Flagtest(0)&lt;&gt;1 Then Goto SafeExit ' only accept chars after STX
					R=R+Chr$(C)
				Case &amp;h41 TO &amp;H46
					If Flagtest(0)&lt;&gt;1 Then Goto SafeExit
					R=R+Chr$(C)
				Case Else
					'ignore anything else
			End Select
		EndIf

		If (FLAGS And 7)=7 Then	'STX,GS,ETX


			' check GS position(5)
			c=Instr(R,",")
			If c&lt;&gt;5 Then Goto BadFrame '? "GS bad position"&#58;

			' data after GS should always be even count
			c=Len(Mid$(R,6))
			If (c And 1) Then Goto BadFrame '? "Data length is odd"&#58;GOTO BadFrame ' If bit0 set then odd number

			'calculate checksum of rec'd data
			c=Val("&amp;H"+Left$(r,4))
			a$=Mid$(R,6) 'payload

			For n=1 To Len(a$)&#58;c=c-Asc(Mid$(a$,n,1))&#58;Next

			If c&lt;&gt;0 Then Goto BadFrame '? "bad checksum ";r&#58;GOTO BadFrame
			' For some reason, slaves calculate bad checksums For each others reply packets.
			' haven't determined why but it gives a quick exit If the packet isn't For me

			'decode valid frame

			Timer=0
			a$=DECRYPT$(a$)
			dst=Val(Left$(a$,3))&#58;src=Val(Mid$(a$,4,3))&#58;cmd$=Mid$(a$,7,4)&#58;pl$=Mid$(a$,11)

			If dst=MyAddr Then ' specific
				Print Str$(dst,3);" ";TIME$;" ";cmd$;" ";pl$';Timer

				Select Case cmd$
					Case "STAT" ' must reply with info
						RadioSend src,MyAddr,"ACK0&#58;STAT"+Bin$(FLAGS,32)+"&#58;NAME="+MyJob+"&#58;NTYP="+MM.Device$+","+Str$(MM.Ver)
					Case "POLL" ' may reply with data
						If FlagTest 6=0 Then 'If 1 we are waiting INIT so do not answer
							If int(Rnd&#42;2))&gt;0 Then ' decide To answer or not
								RadioSend src,MyAddr,"ACK0"
							EndIf
						EndIf
					Case "INIT"
						CPU Restart
					Case "SAFE"
						Mode 5,pl$
					' ignore anything else
				End Select

			ElseIf dst=999 Then ' broadcast only
				Print Str$(dst,3);" ";Time$;" ";cmd$;" ";pl$
				Select Case cmd$
					Case "TIME"
						If Len(pl$)=19 Then
							If Mid$(pl$,9,1)="," Then
								On Error Skip 1&#58;Time$=Left$(pl$,8)
								On Error Skip 1&#58;Date$=Right$(pl$,10)
							EndIf
						EndIf
					Case "INIT"
						CPU Restart
					Case "SAFE"	' safe mode For working on node
						Mode 5,pl$
					Case "FIRE" ' emergency mode-i.e. all nodes turn on lights
						Mode 4,pl$
					' other broadcast CASEs go here
				End Select
			EndIf

			Goto SafeExit
		EndIf

		Goto LoopEnd
BadFrame&#58;
	' ignore it
SafeExit&#58;
	FlushIO(io)
LoopEnd&#58;
	Loop

	SubMode(fg As Integer,x$)
		If x$="OFF" Then
			FlagRes fg
		ELSE
			FlagSet fg
		EndIf
	End Sub

	Function ZPad$(x As Integer)
		ZPad$=Right$("000"+Str$(x), 3)
	End Function

	SubRadioSend(d As Integer,s As Integer,msg As String)
		Local qq$
		Local Integer chk,m
		qq$=ZPad$(d)+ZPad$(s)+msg
		For m=1 To Len(qq$)&#58;chk=chk+Asc(Mid$(qq$,m,1))&#58;Next
		qq$=Chr$(STX)+HEX$(chk,4)+Chr$(GS)+ENCRYPT$(qq$)+Chr$(ETX)
		Print&#35;io, String$(DoPreamble,Chr$(&amp;HFE))+qq$;
		Pause Len(qq$)' wait For the packet To go
	End Sub

	Function ENCRYPT$(A$)
		Local Integer N,P
		Local B$
		P=1
		For N=1 To Len(A$)
			B$=B$+HEX$(Asc(Mid$(A$,N,1),2) Xor Asc(Mid$(KEY$,P,1)),2)
			P=P+1&#58;If P&gt;Len(KEY$) Then P=1
		Next
		ENCRYPT$=B$
	End Function

	Function DECRYPT$(A$)
		Local Integer N,P
		Local B$
		P=1
		For N=1 To Len(A$) Step 2
			B$=B$+Chr$(Val("&amp;H"+Mid$(A$,N,2)) Xor Asc(Mid$(KEY$,P,1)))
			P=P+1&#58;If P&gt;Len(KEY$) Then P=1
		Next
		DECRYPT$=B$
	End Function

	SubFlagSet(bit As Integer)
		FLAGS=FLAGS Or (2^bit)
	End Sub

	SubFlagRes(bit As Integer)
		FLAGS=(FLAGS Or (2^bit)) Xor (2^bit)
	End Sub

	Function FlagTest(bit As Integer) As Integer
		FlagTest=Abs(Sgn(FLAGS And (2^bit)))
	End Function

	SubFlushIO(CH)
		Local A$
		Do While LOC(&#35;CH)&gt;0
			A$=Input$(Min(Loc(&#35;CH),255),&#35;CH)
			Pause 20
		Loop
		R=""&#58;FLAGS=FLAGS And &amp;HFFFFFFFFFFFFFFF8
	End Sub



</pre>
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		<div id="Anthem_ctl00_CphMaster_attachmentViewer_rptItems__">
		<table id="AttachmentViewerTable" class="generic" cellpadding="0" cellspacing="0">
			<thead>
			<tr class="tableheader">
				<th>&nbsp;</th>
				<th>Name</th>
				<th>Size</th>
			</tr>
			</thead>
			<tbody>
	
		<tr class="tablerow">
			<td><img src="Images/File.png" alt="-" /></td>
			<td><a href='433MHz%20Radioa028.zip?File=433MHz%20Radio.zip&amp;AsStreamAttachment=1&amp;Provider=ScrewTurn.Wiki.FilesStorageProvider&amp;IsPageAttachment=1&amp;Page=MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12' title="Download">433MHz Radio.zip</a></td>
			<td>4.53 KB</td>
		</tr>
	
		</tbody>
		</table>
	</div>

    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Short-range-radio-network-not-WiFi-SLAVE-module-Uses-cheapie-433MHz-modules-or-HC-12.ashx?NS=MMBasic by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:53:13 GMT -->
</html>
