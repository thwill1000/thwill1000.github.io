

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Compact-Quick-Day-Of-Week-function-with-historical-capability by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Compact Quick Day Of Week function with historical capability - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Compact-Quick-Day-Of-Week-function-with-historical-capability" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF7Qg8aDEgY2xhc3M9InBhZ2V0aXRsZSI+Q29tcGFjdCBRdWljayBEYXkgT2YgV2VlayBmdW5jdGlvbiB3aXRoIGhpc3RvcmljYWwgY2FwYWJpbGl0eTwvaDE+PHNtYWxsPk1vZGlmaWVkIG9uIDIwMTcvMDgvMDQgMDg6NTEgYnkgQ2FwdGFpbkJvaW5nICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IERhdGVzLCBUaW1lIGFuZCBDbG9ja3M8L3NtYWxsPjxiciAvPjxiciAvPkZhc3QsY29tcGFjdCBEYXkgb2YgdGhlIFdlZWsgZnVuY3Rpb24gdGhhdCBjb3JyZWN0bHkgaGFuZGxlcyBwcmUgMjAwMSBkYXRlcyBjb3JyZWN0bHk8YnIgLz48YnIgLz48Yj5jcmVkaXQ6PC9iPiBUQlMgdXNlciBNaWNyb0Jsb2NrcywgdGhlIG9yaWdpbmFsIHRocmVhZCBjYW4gYmUgc2VlbiBoZXJlOiA8YSBjbGFzcz0iZXh0ZXJuYWxsaW5rIiBocmVmPSJodHRwOi8vd3d3LnRoZWJhY2tzaGVkLmNvbS9mb3J1bS9mb3J1bV9wb3N0cy5hc3A/VElEPTYyMzUmYW1wO0tXPXdlZWtkYXkmYW1wO1BOPTEmYW1wO1RQTj0xIiB0aXRsZT0iaHR0cDovL3d3dy50aGViYWNrc2hlZC5jb20vZm9ydW0vZm9ydW1fcG9zdHMuYXNwP1RJRD02MjM1JktXPXdlZWtkYXkmUE49MSZUUE49MSIgdGFyZ2V0PSJfYmxhbmsiPmh0dHA6Ly93d3cudGhlYmFja3NoZWQuY29tL2ZvcnVtL2ZvcnVtX3Bvc3RzLmFzcD9USUQ9NjIzNSZLVz13ZWVrZGF5JlBOPTEmVFBOPTE8L2E+PGJyIC8+PGJyIC8+SXQgaGFzIGJlZW4gdHdlYWtlZCBoZXJlIHRvIGFkZCB0eXBpbmcgdG8gdGhlIGZ1bmN0aW9uIGFuZCBsb2NhbCB2YXJpYWJsZXM8YnIgLz48YnIgLz48cHJlPg0KRnVuY3Rpb24gRGF5T2ZXZWVrKHllYXIgQXMgSW50ZWdlcixtb250aCBBcyBJbnRlZ2VyLGRheSBBcyBJbnRlZ2VyKSBBcyBJbnRlZ2VyDQonIHN1biBtb24gdHVlIHdlZCB0aHUgZnJpIHNhdA0KJyAgMCAgIDEgICAyICAgMyAgIDQgICA1ICAgNg0KICBsb2NhbCBpbnRlZ2VyIGEsbSx5DQogIGEgPSBpbnQoKDE0LW1vbnRoKS8xMikgDQogIG0gPSBtb250aCArIDEyJiM0MjthIC0gMiANCiAgeSA9IHllYXIgLSBhIA0KICBEYXlPZldlZWsgPSAoZGF5ICsgeSArIGludCh5LzQpLWludCh5LzEwMCkraW50KHkvNDAwKStpbnQoMzEmIzQyO20vMTIpKSBtb2QgNyANCkVuZCBGdW5jdGlvbiANCjwvcHJlPmRkwyWxbNpfiJXgl5H8f8kLnBTeWIk=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Compact Quick Day Of Week function with historical capability</h1><small>Modified on 2017/08/04 08:51 by CaptainBoing &mdash; Categorized as: Dates, Time and Clocks</small><br /><br />Fast,compact Day of the Week function that correctly handles pre 2001 dates correctly<br /><br /><b>credit:</b> TBS user MicroBlocks, the original thread can be seen here: <a class="externallink" href="http://www.thebackshed.com/forum/forum_posts.asp?TID=6235&amp;KW=weekday&amp;PN=1&amp;TPN=1" title="http://www.thebackshed.com/forum/forum_posts.asp?TID=6235&KW=weekday&PN=1&TPN=1" target="_blank">http://www.thebackshed.com/forum/forum_posts.asp?TID=6235&KW=weekday&PN=1&TPN=1</a><br /><br />It has been tweaked here to add typing to the function and local variables<br /><br /><pre>
Function DayOfWeek(year As Integer,month As Integer,day As Integer) As Integer
' sun mon tue wed thu fri sat
'  0   1   2   3   4   5   6
  local integer a,m,y
  a = int((14-month)/12) 
  m = month + 12&#42;a - 2 
  y = year - a 
  DayOfWeek = (day + y + int(y/4)-int(y/100)+int(y/400)+int(31&#42;m/12)) mod 7 
End Function 
</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Compact-Quick-Day-Of-Week-function-with-historical-capability by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:14:57 GMT -->
</html>
