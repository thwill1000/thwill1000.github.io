

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:13:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Battery Capacity Test - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF8bEBPGgxIGNsYXNzPSJwYWdldGl0bGUiPkJhdHRlcnkgQ2FwYWNpdHkgVGVzdDwvaDE+PHNtYWxsPk1vZGlmaWVkIG9uIDIwMTYvMTIvMjMgMjM6MTkgYnkgQWRtaW5pc3RyYXRvciAmbWRhc2g7IENhdGVnb3JpemVkIGFzOiBDb250cm9sLCBFbGVjdHJvbmljcywgRW52aXJvbm1lbnQsIF9MSUIgT3JpZ2luYWwgTU1CYXNpYzwvc21hbGw+PGJyIC8+PGJyIC8+PGgyIGNsYXNzPSJzZXBhcmF0b3IiPlRoaXMgbW9kdWxlIGlzIHBhcnQgb2YgdGhlIG9yaWdpbmFsIE1NQmFzaWMgbGlicmFyeS4gSXQgaXMgcmVwcm9kdWNlZCBoZXJlIHdpdGgga2luZCBwZXJtaXNzaW9uIG9mIEh1Z2ggQnVja2xlIGFuZCBHZW9mZiBHcmFoYW0uIEJlIGF3YXJlIGl0IG1heSByZWZlcmVuY2UgZnVuY3Rpb25hbGl0eSB3aGljaCBoYXMgY2hhbmdlZCBvciBpcyBkZXByZWNhdGVkIGluIHRoZSBsYXRlc3QgdmVyc2lvbnMgb2YgTU1CYXNpYy48YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiBocmVmPSIjVGhpc19tb2R1bGVfaXNfcGFydF9vZl90aGVfb3JpZ2luYWxfTU1CYXNpY19saWJyYXJ5X0l0X2lzX3JlcHJvZHVjZWRfaGVyZV93aXRoX2tpbmRfcGVybWlzc2lvbl9vZl9IdWdoX0J1Y2tsZV9hbmRfR2VvZmZfR3JhaGFtX0JlX2F3YXJlX2l0X21heV9yZWZlcmVuY2VfZnVuY3Rpb25hbGl0eV93aGljaF9oYXNfY2hhbmdlZF9vcl9pc19kZXByZWNhdGVkX2luX3RoZV9sYXRlc3RfdmVyc2lvbnNfb2ZfTU1CYXNpY18wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMj48Yj5Ob3RlPC9iPjogQW55IHJlcXVpcmVkIGZpbGUocykgYXJlIGF2YWlsYWJsZSBpbiB0aGUgYXR0YWNobWVudHMgdGFiICh0b3AgcmlnaHQpLjxiciAvPjxiciAvPjxiciAvPjxiPkJBVFRFUlkuQkFTIDwvYj48YnIgLz48cHJlPg0KMTAwICcgQkFUVEVSWS5CQVMNCjEwNSAnIFByb2dyYW0gdG8gdGVzdCB0aGUgY2FwYWNpdHkgb2YgYSBiYXR0ZXJ5DQoxMTAgJyBTZWUgU2lsaWNvbiBDaGlwIE1heSAyMDExIGZvciBjaXJjdWl0IGRldGFpbHMNCjExNSAnIFYxLjANCjEyMCAnDQoxMjUgJw0KMTMwICcgTWVhc3VyZWQgcmVzaXN0YW5jZSBvZiB0aGUgZm91ciBsb2FkIHJlc2lzdG9ycw0KMTM1ICcgVGhlc2UgYXJlIGNvbnN0YW50IHZhbHVlcyBkZXRlcm1pbmVkIGJ5IG1lYXN1cmluZyB0aGUgYWN0dWFsIHJlc2lzdGFuY2UNCjE0MCAnIHdpdGggYSBkaWdpdGFsIG11bHRpbWV0ZXIuICBUaGV5IG11c3QgYmUgaW4gZGVzY2VuZGluZyBvcmRlciBvZiB2YWx1ZXMNCjE0NSBSMSA9IDU2LjAwDQoxNTAgUjIgPSAyMi4wMA0KMTU1IFIzID0gIDguMjANCjE2MCBSNCA9ICAzLjMzDQoxNjUgJw0KMTcwICcgTWVhc3VyZWQgdmFsdWUgb2YgdGhlIDMuMyB2b2x0IHN1cHBseQ0KMTc1IFZkZCA9IDMuMjkNCjE4MCAnDQoxODUgJw0KMTkwICcgRGVmYXVsdCB0ZXJtaW5hdGluZyB2b2x0YWdlIGxldmVsIGFuZCB0ZXN0IGN1cnJlbnQNCjE5NSBUZXJtaW5hdGluZ1ZvbHRzID0gMS4wDQoyMDAgVGVzdEN1cnJlbnQgPSAxMjANCjIwNSAnDQoyMTAgJw0KMjE1ICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KMjIwICcgQ29uZmlndXJlIHRoZSBpbnB1dCBhbmQgb3V0cHV0IHBpbnMNCjIyNSBQSU4oMTEpID0gMSAmIzU4OyBQSU4oMTIpID0gMSAmIzU4OyBQSU4oMTMpID0gMSAmIzU4OyBQSU4oMTQpID0gMQ0KMjMwIFNFVFBJTiAxMSwgOSAmIzU4OyBTRVRQSU4gMTIsIDkgJiM1ODsgU0VUUElOIDEzLCA5ICYjNTg7IFNFVFBJTiAxNCwgOQ0KMjM1IFNFVFBJTiAxLDENCjI0MCAnDQoyNDUgJw0KMjUwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KMjU1ICcgR2V0IHRoZSBvcGVyYXRpbmcgcGFyYW1ldGVycyBmcm9tIHRoZSB1c2VyDQoyNjAgJyBjaGVjayBlYWNoIHJlc3BvbnNlIHRvIG1ha2Ugc3VyZSB0aGF0IGl0IGlzIHdpdGhpbiBhY2NlcHRhYmxlIHJhbmdlDQoyNjUgJw0KMjcwIENMUyAmIzU4OyBQUklOVCAiQmF0dGVyeSB0ZXN0IFYxLjAiICYjNTg7IFBSSU5UDQoyNzUgRE8NCjI4MCAgIElOUFVUICJFbnRlciB0aGUgYXBwcm94IHRlc3QgY3VycmVudCBpbiBtQSAoNjAwIHRvIDI1KSYjNTg7ICIsIFRlc3RDdXJyZW50DQoyODUgTE9PUCBXSElMRSBUZXN0Q3VycmVudCAmbHQ7IDI1IE9SIFRlc3RDdXJyZW50ICZndDsgNjAwDQoyOTAgJw0KMjk1IERPDQozMDAgICBQUklOVCAiRW50ZXIgdGhlIHRlcm1pbmF0aW5nIHZvbHRhZ2UgIjsNCjMwNSAgIFBSSU5UICIoZGVmYXVsdCAiOyBGT1JNQVQkKFRlcm1pbmF0aW5nVm9sdHMsICIlNC4yZiIpOyAiKSYjNTg7ICI7DQozMTAgICBJTlBVVCAiIiwgVGVybWluYXRpbmdWb2x0cw0KMzE1IExPT1AgV0hJTEUgVGVybWluYXRpbmdWb2x0cyAmbHQ7IDAuNSBPUiBUZXJtaW5hdGluZ1ZvbHRzICZndDsgMg0KMzIwICcNCjMyNSBQUklOVA0KMzMwIElGIFBJTigxKSAvIDMuMyAmIzQyOyBWZGQgJmx0OyBUZXJtaW5hdGluZ1ZvbHRzIFRIRU4NCjMzNSAgIFBSSU5UICJUbyBzdGFydCB0aGUgdGVzdCBwbGFjZSB0aGUgY2hhcmdlZCBiYXR0ZXJ5IGluIHRoZSBob2xkZXIiOw0KMzQwICAgRE8gJiM1ODsgTE9PUCBXSElMRSBQSU4oMSkgLyAzLjMgJiM0MjsgVmRkICZsdDsgVGVybWluYXRpbmdWb2x0cw0KMzQ1ICAgUFJJTlQgJiM1ODsgUFJJTlQNCjM1MCBFTkRJRg0KMzU1ICcNCjM2MCAnDQozNjUgJw0KMzcwIFRJTUUkID0gIjAmIzU4OzAmIzU4OzAiDQozNzUgTEFTVFRJTUUkID0gVElNRSQNCjM4MCBQUklOVCAiVElNRSAgICAiLCAiVk9MVFMgICAiLCAiQ1VSUkVOVCIsICIgICAgIEFDQ1VNVUxBVEVEIg0KMzg1IFBSSU5UICImIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOz0iDQozOTAgJw0KMzk1ICcNCjQwMCAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjQwNSAnIE1haW4gdGVzdCBsb29wDQo0MTAgRE8NCjQxNSAgIEJhdHRWID0gUElOKDEpIC8gMy4zICYjNDI7IFZkZCAgICAgICAgICAgICAgJyBtZWFzdXJlIHRoZSBiYXR0ZXJ5IHZvbHRhZ2UNCjQyMCAgICcNCjQyNSAgICcgQ2FsY3VsYXRlIHRoZSBzZXR0aW5nIHJlcXVpcmVkIHRvIGRyYXcgdGhlIHRlc3QgY3VycmVudA0KNDMwICAgUHJldlRDID0gQmF0dFYvUjEgJiM0MjsgMTAwMA0KNDM1ICAgRk9SIGkgPSAyIFRPIDE1DQo0NDAgICAgIFRDID0gMA0KNDQ1ICAgICBJRiBpIEFORCAmYW1wO2IwMDAxIFRIRU4gVEMgPSBUQyArIEJhdHRWL1IxDQo0NTAgICAgIElGIGkgQU5EICZhbXA7YjAwMTAgVEhFTiBUQyA9IFRDICsgQmF0dFYvUjINCjQ1NSAgICAgSUYgaSBBTkQgJmFtcDtiMDEwMCBUSEVOIFRDID0gVEMgKyBCYXR0Vi9SMw0KNDYwICAgICBJRiBpIEFORCAmYW1wO2IxMDAwIFRIRU4gVEMgPSBUQyArIEJhdHRWL1I0DQo0NjUgICAgIFRDID0gVEMgJiM0MjsgMTAwMA0KNDcwICAgICBJRiBQcmV2VEMgKyAoVEMgLSBQcmV2VEMpIC8gMiAmZ3Q7IFRlc3RDdXJyZW50IFRIRU4gRVhJVCBGT1INCjQ3NSAgICAgUHJldlRDID0gVEMNCjQ4MCAgIE5FWFQgaQ0KNDg1ICAgaSA9IGkgLSAxDQo0OTAgICAnDQo0OTUgICAnIFNldCB0aGUgcmVlZCByZWxheXMgdG8gZHJhdyB0aGUgdGVzdCBjdXJyZW50DQo1MDAgICBQSU4oMTEpID0gTk9UKGkgQU5EICZhbXA7YjAwMDEpDQo1MDUgICBQSU4oMTIpID0gTk9UKGkgQU5EICZhbXA7YjAwMTApDQo1MTAgICBQSU4oMTMpID0gTk9UKGkgQU5EICZhbXA7YjAxMDApDQo1MTUgICBQSU4oMTQpID0gTk9UKGkgQU5EICZhbXA7YjEwMDApDQo1MjAgICAnDQo1MjUgICBtQWhvdXJzID0gbUFob3VycyArIFByZXZUQy8zNjAwICAgICAgICAnIGFjY3VtdWxhdGUgdGhlIG1BSCByZWFkaW5nDQo1MzAgICAnDQo1MzUgICBJRiBSSUdIVCQoVElNRSQsIDIpID0gIjAwIiBUSEVODQo1NDAgICAgIFBSSU5UIFRJTUUkLEZPUk1BVCQoQmF0dFYsICIlNS4zZlYgICIpLEZPUk1BVCQoUHJldlRDLCAiJTUuMWZtQSAgIiksOyANCjU0NSAgICAgUFJJTlQgRk9STUFUJChtQWhvdXJzLCAiJTUuMGZtQUgiKQ0KNTUwICAgRU5ESUYNCjU1NSAgICcNCjU2MCAgICcgd2FpdCBmb3IgdGhlIG5leHQgc2Vjb25kDQo1NjUgICBETyBXSElMRSBUSU1FJCA9IExBU1RUSU1FJCAmIzU4OyBMT09QDQo1NzAgICBMQVNUVElNRSQgPSBUSU1FJA0KNTc1ICAgJw0KNTgwIExPT1AgV0hJTEUgQmF0dFYgJmd0OyBUZXJtaW5hdGluZ1ZvbHRzDQo1ODUgJw0KNTkwIFBJTigxMSkgPSAxICYjNTg7IFBJTigxMikgPSAxICYjNTg7IFBJTigxMykgPSAxICYjNTg7IFBJTigxNCkgPSAxDQo1OTUgJw0KNjAwICcNCjYwNSAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQo2MTAgJyBwcmludCB0aGUgc3VtbWFyeQ0KNjE1IFBSSU5UICYjNTg7IFBSSU5UICJUZXN0IGNvbXBsZXRlLiAgIjsNCjYyMCBQUklOVCAiQmF0dGVyeSBjYXBhY2l0eSBpcyAiOyBGT1JNQVQkKG1BaG91cnMsICIlNS4wZm1BSCIpDQo2MjUgUFJJTlQgJiM1ODsgUFJJTlQNCg0KPC9wcmU+PGJyIC8+PGJyIC8+PGJyIC8+PGI+QkFUVEVSWTIuQkFTIDwvYj48YnIgLz48cHJlPg0KMTAwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjExMCAnIEJBVFRFUlkuQkFTDQoxMjAgJyBQcm9ncmFtIHRvIHRlc3QgdGhlIGNhcGFjaXR5IG9mIGEgYmF0dGVyeQ0KMTMwICcgVjIuMCAgIEdlb2ZmIEdyYWhhbSAgIEphbiAyMDExDQoxNDAgJw0KMTUwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjE2MCAnDQoxNzAgJyBUaGlzIGlzIGFuIGV4dGVuZGVkIHZlcnNpb24gb2YgdGhlIGJhdHRlcnkgdGVzdCBwcm9ncmFtIGRlc2NyaWJlZCBpbg0KMTgwICcgdGhlIE1heSAyMDExIGlzc3VlIG9mIFNpbGljb24gQ2hpcC4gIEFkZGl0aW9uYWwgZmVhdHVyZXMgaW5jbHVkZSYjNTg7DQoxOTAgJyAgLSBXaWxsIGRyYXcgYSBncmFwaCBvZiB0aGUgYmF0dGVyeSB2b2x0YWdlIG9uIHRoZSB2aWRlbyBvdXRwdXQNCjIwMCAnICAtIENob2ljZSBvZiBhIGNvbnN0YW50IGN1cnJlbnQsIHBvd2VyIG9yIHJlc2lzdGFuY2UgdHlwZSBvZiBsb2FkDQoyMTAgJyAgLSBBYmlsaXR5IHRvIHNhdmUgdGhlIGRhdGEgaW4gYW4gRXhjZWwgY29tcGF0aWJsZSBmaWxlDQoyMjAgJyAgLSBPcHRpb25hbCBhYmlsaXR5IHRvIHVzZSA1IHJlbGF5cyBmb3IgYSBmaW5lciBsZXZlbCBvZiBsb2FkIGNvbnRyb2wNCjIzMCAnDQoyNDAgJyBTZWUgdGhlIFNpbGljb24gQ2hpcCBhcnRpY2xlIG9yIHRoZSBhY2NvbXBhbnlpbmcgUERGIGZvciBjaXJjdWl0IGRldGFpbHMNCjI1MCAnDQoyNjAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQoyNzAgJw0KMjgwICcgTWVhc3VyZWQgcmVzaXN0YW5jZSBvZiB0aGUgZml2ZSBsb2FkIHJlc2lzdG9ycw0KMjkwICcgVGhlc2UgYXJlIGNvbnN0YW50IHZhbHVlcyBkZXRlcm1pbmVkIGJ5IG1lYXN1cmluZyB0aGUgYWN0dWFsIHJlc2lzdGFuY2UNCjMwMCAnIHdpdGggYSBkaWdpdGFsIG11bHRpbWV0ZXIuICBUaGV5IG11c3QgYmUgaW4gZGVzY2VuZGluZyBvcmRlciBvZiB2YWx1ZXMNCjMxMCAnIGlmIHlvdSBvbmx5IGhhdmUgNCByZWxheXMgc2V0IHRoZSB2YWx1ZSBvZiBSNSB0byBhIHZlcnkgbG93IHZhbHVlIChlZywgMC4wMDAxKQ0KMzIwICcNCjMzMCBSMSA9IDU5LjIyOA0KMzQwIFIyID0gMjkuNzg5DQozNTAgUjMgPSAxNC45NDQNCjM2MCBSNCA9ICA3LjUxNg0KMzcwIFI1ID0gIDMuNzg5DQozODAgJw0KMzkwICcgQ29ycmVjdGlvbiBmb3IgYW55IGVycm9yIGluIG1lYXN1cmluZyB2b2x0YWdlIChpZS4gYWN0dWFsIFYgLyBNYXhpbWl0ZSBWKQ0KNDAwIFZDb3JyZWN0ID0gMS4wMTkNCjQxMCAnDQo0MjAgJyBkZWZhdWx0IHNldHRpbmdzDQo0MzAgRGVmYXVsdFR5cGUkID0gIkMiICAgICAgICAgICAgICAgJyBjb25zdGFudCBjdXJyZW50DQo0NDAgRGVmYXVsdEJMb2FkID0gMjAwICAgICAgICAgICAgICAgJyBsb2FkIG9mIDIwMCBtQSBvciBtVw0KNDQ1IERlZmF1bHRSTG9hZCA9IDI1ICAgICAgICAgICAgICAgICcgcmVzaXN0aXZlIGxvYWQgMjUgb2htcw0KNDUwIERlZmF1bHRUaHJlc2hvbGQgPSAwLjkgICAgICAgICAgICcgY3V0b3V0IHZvbHRhZ2UgdG8gc3RvcCB0aGUgdGVzdA0KNDYwICcNCjQ3MCAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjQ4MCBNYXhIaXN0ID0gMTAwICYjNDI7IDYwICAgICAgICAnIG1heGltdW0gaGlzdG9yeSB0byBiZSBzYXZlZCAoaW4gbWludXRlcykNCjQ5MCBEaW0gSGlzdChNYXhIaXN0KSAgICAgICAgICcgYXJyYXkgZm9yIGhvbGRpbmcgdGhlIGhpc3RvcnkgZGF0YQ0KNTAwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KNTEwICcgUHJvZ3JhbSBTdGFydA0KNTIwICcgVGhlIHByb2dyYW0gcmV0dXJucyB0byBoZXJlIHdoZW4gdGhlIHRlc3QgaGFzIGZpbmlzaGVkDQo1MzAgJw0KNTQwICcgQ29uZmlndXJlIHRoZSBpbnB1dCBhbmQgb3V0cHV0IHBpbnMNCjU1MCBQaW4oMTEpID0gMSAmIzU4OyBQaW4oMTIpID0gMSAmIzU4OyBQaW4oMTMpID0gMSAmIzU4OyBQaW4oMTQpID0gMSAmIzU4OyBQaW4oMTUpID0gMQ0KNTYwIFNldFBpbiAxMSwgOSAmIzU4OyBTZXRQaW4gMTIsIDkgJiM1ODsgU2V0UGluIDEzLCA5ICYjNTg7IFNldFBpbiAxNCwgOSAmIzU4OyBTZXRQaW4gMTUsIDkNCjU3MCBTZXRQaW4gMSwxDQo1ODAgJw0KNTkwIEhTY2FsZSA9IDINCjU5NSBtQWhvdXJzID0gMA0KNjAwICcNCjYxMCBQaW4oMCkgPSAxICYjNTg7IFByaW50ICYjNTg7IFByaW50ICYjNTg7IENscw0KNjIwICcNCjYzMCAnIEdldCB0aGUgdGVzdCBwYXJhbWV0ZXJzIGZyb20gdGhlIHVzZXINCjY0MCBQcmludCAiQmF0dGVyeSBjYXBhY2l0eSB0ZXN0IHV0aWxpdHkgVjIuMCINCjY1MCAnIGRlZmluZSBjb25zdGFudHMgYW5kIGFycmF5cw0KNjU1IERvDQo2NjAgICBQcmludA0KNjcwICAgUHJpbnQgIkMgPSBDb25zdGFudCBjdXJyZW50IGRyYWluIg0KNjgwICAgUHJpbnQgIlAgPSBDb25zdGFudCBwb3dlciBkcmFpbiINCjY5MCAgIFByaW50ICJSID0gQ29uc3RhbnQgcmVzaXN0aXZlIGxvYWQiDQo3MDAgICBQcmludCAiU2VsZWN0IChkZWZhdWx0IGlzICI7IERlZmF1bHRUeXBlJDsgIikgIjsNCjcxMCAgIElucHV0IFR5cGUkDQo3MTUgICBJZiBBc2MoVHlwZSQpID0gMCBUaGVuIFR5cGUkID0gRGVmYXVsdFR5cGUkDQo3MjAgICBUeXBlJCA9IExlZnQkKFVDYXNlJChUeXBlJCksIDEpDQo3MjUgTG9vcCBVbnRpbCBUeXBlJCA9ICJDIiBPciBUeXBlJCA9ICJQIiBPciBUeXBlJCA9ICJSIg0KNzMwIFByaW50DQo3NDAgJw0KNzUwIElmIFR5cGUkID0gIkMiIFRoZW4NCjc2MCAgIERvDQo3NzAgICAgIFByaW50ICJSYW5nZSBpcyA2MDBtQSB0byAyMG1BIg0KNzgwICAgICBQcmludCAiRW50ZXIgY3VycmVudCBkcmFpbiAoZGVmYXVsdCBpcyI7IERlZmF1bHRCTG9hZDsgIikgIjsNCjc5MCAgICAgSW5wdXQgQkxvYWQNCjc5NSAgICAgSWYgQkxvYWQgPSAwIFRoZW4gQmxvYWQgPSBEZWZhdWx0QkxvYWQNCjgwMCAgIExvb3AgV2hpbGUgQkxvYWQgJmd0OyA2MDAgT3IgQkxvYWQgJmx0OyAyMA0KODEwIEVsc2VJZiBUeXBlJCA9ICJQIiBUaGVuDQo4MjAgICBEbw0KODMwICAgICBQcmludCAiUmFuZ2UgaXMgNzUwbVcgdG8gMjVtVyINCjg0MCAgICAgUHJpbnQgIkVudGVyIHBvd2VyIGRyYWluIChkZWZhdWx0IGlzIjsgRGVmYXVsdEJMb2FkOyAiKSAiOw0KODUwICAgICBJbnB1dCBCTG9hZA0KODU1ICAgICBJZiBCTG9hZCA9IDAgVGhlbiBCTG9hZCA9IERlZmF1bHRCTG9hZA0KODYwICAgTG9vcCBXaGlsZSBCTG9hZCAmZ3Q7IDc1MCBPciBCTG9hZCAmbHQ7IDI1DQo4NzAgRWxzZUlmIFR5cGUkID0gIlIiIFRoZW4NCjg4MCAgIERvDQo5MDAgICAgIFByaW50ICJSYW5nZSBpcyA2MCBvaG1zIHRvIDEuOCBvaG1zIg0KOTEwICAgICBQcmludCAiRW50ZXIgcmVzaXN0aXZlIGxvYWQgKGRlZmF1bHQgaXMiOyBEZWZhdWx0UkxvYWQ7ICIpICI7DQo5MjAgICAgIElucHV0IEJMb2FkDQo5MjUgICAgIElmIEJMb2FkID0gMCBUaGVuIEJMb2FkID0gRGVmYXVsdFJMb2FkDQo5MzAgICBMb29wIFdoaWxlIEJMb2FkICZndDsgNjAgQW5kIEJMb2FkICZsdDsgMS44DQo5NjAgRW5kSWYNCjk3MCAnDQo5NzUgRG8NCjk4MCAgIFByaW50DQo5OTAgICBQcmludCAiRW50ZXIgdGhlIGN1dG9mZiB2b2x0YWdlIChkZWZhdWx0IGlzICI7IEZvcm1hdCQoRGVmYXVsdFRocmVzaG9sZCwgIiUzLjFmIik7ICIpICI7DQo5OTUgICBQcmludCAiTWluaW11bSBjdXRvZmYgaXMgMC41ViINCjEwMDAgICBJbnB1dCBUaHJlc2hvbGQNCjEwMDUgICBJZiBUaHJlc2hvbGQgPSAwIFRoZW4gVGhyZXNob2xkID0gRGVmYXVsdFRocmVzaG9sZA0KMTAxMCBMb29wIFdoaWxlIFRocmVzaG9sZCAmbHQ7IDAuNSBPciBUaHJlc2hvbGQgJmd0OyAxLjUNCjEwMjAgUHJpbnQNCjEwMzAgJw0KMTA0MCBEbw0KMTA2MCAgIElucHV0ICJTYXZlIHRoZSByZXN1bHRzIHRvIGFuIEV4Y2VsIGZpbGUgKFkvTiwgZGVmYXVsdCBpcyBOKSAiLCBTU2F2ZSQNCjEwNzAgICBTU2F2ZSQgPSBMZWZ0JChVQ2FzZSQoU1NhdmUkKSwgMSkNCjEwNzUgICBJZiBBc2MoU1NhdmUkKSA9IDAgVGhlbiBTU2F2ZSQgPSAiTiINCjEwODAgTG9vcCBXaGlsZSBOb3QoU1NhdmUkID0gIlkiIE9yIFNTYXZlJCA9ICJOIikNCjEwODkgJw0KMTA5MCBJZiBTU2F2ZSQgPSAiWSIgVGhlbg0KMTEwMCAgIExpbmUgSW5wdXQgIkZpbGVuYW1lICh3aXRob3V0IGFuIGV4dGVuc2lvbikmIzU4OyAiOyBGTmFtZSQNCjExMTAgICBPcGVuIExlZnQkKEZOYW1lJCwgOCkgKyAiLnhscyIgRm9yIG91dHB1dCBBcyAmIzM1OzENCjExMjAgICBMaW5lIElucHV0ICJEZXNjcmlwdGlvbiBvZiBiYXR0ZXJ5IHVuZGVyIHRlc3QmIzU4OyAiOyBSJA0KMTEzMCAgIFByaW50ICYjMzU7MSwgUiQNCjExNDAgICBJZiBUeXBlJCA9ICJDIiBUaGVuIFByaW50ICYjMzU7MSwgIkNvbnN0YW50IGN1cnJlbnQgb2YiOyBCTG9hZDsgIm1BLiAgQ3V0b2ZmIGF0IjsgVGhyZXNob2xkOyAiViINCjExNTAgICBJZiBUeXBlJCA9ICJQIiBUaGVuIFByaW50ICYjMzU7MSwgIkNvbnN0YW50IHBvd2VyIG9mIjsgQkxvYWQ7ICJtVy4gIEN1dG9mZiBhdCI7IFRocmVzaG9sZDsgIlYiDQoxMTYwICAgSWYgVHlwZSQgPSAiUiIgVGhlbiBQcmludCAmIzM1OzEsICJDb25zdGFudCByZXNpc3RhbmNlIG9mIjsgQkxvYWQ7ICIgb2htcy4gIEN1dG9mZiBhdCI7IFRocmVzaG9sZDsgIlYiDQoxMTcwICAgUHJpbnQgJiMzNTsxICYjNTg7IFByaW50ICYjMzU7MSwgIlRpbWUiLCAiVm9sdGFnZSIsICJDdXJyZW50IiwgIm1BSCINCjExODAgRW5kSWYNCjExOTAgJw0KMTIwMCBQcmludA0KMTIxMCBMaW5lIElucHV0ICJQcmVzcyBFTlRFUiB0byBzdGFydCB0aGUgdGVzdCAiOyBUJA0KMTIyMCBQaW4oMTUpID0gMCAmIzU4OyBQYXVzZSAyMDAgICAgICAgICAgICAgICAgJyBkaXNjaGFyZ2UgYW55IGZsb2F0aW5nIHZvbHRhZ2UNCjEyMzAgRG8gV2hpbGUgUGluKDEpICYjNDI7IFZDb3JyZWN0ICZsdDs9IFRocmVzaG9sZA0KMTI0MCAgIFByaW50ICJCYXR0ZXJ5IG5vdCBpbnNlcnRlZCBvciBub3QgY2hhcmdlZCAodm9sdGFnZSA9IjsgUGluKDEpICYjNDI7IFZDb3JyZWN0OyAiKSINCjEyNTAgICBQcmludCAiSW5zZXJ0IGJhdHRlcnkgdG8gY29udGludWUgIjsNCjEyNjAgICBXaGlsZSBQaW4oMSkgJiM0MjsgVkNvcnJlY3QgJmx0Oz0gVGhyZXNob2xkICYjNTg7IFdlbmQNCjEyNzAgICBQYXVzZSA3NTANCjEyODAgTG9vcA0KMTI5MCAnDQoxMzAwIFZTY2FsZSA9IChJbnQoUGluKDEpICYjNDI7IFZDb3JyZWN0ICYjNDI7IDEwKSArIDIpICAnIHNldCB0aGUgdmVydGljYWwgc2NhbGUNCjEzMTAgaUhpc3QgPSAwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHplcm8gdGhlIGhpc3RvcnkNCjEzMjAgR29TdWIgMjc5MCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGRyYXcgdGhlIGdyYXBoIGF4aWVzDQoxMzMwICcNCjEzNDAgVGltZSQgPSAiMDAmIzU4OzAwJiM1ODswMCIgJiM1ODsgTEFTVFRJTUUkID0gIjAwJiM1ODswMCYjNTg7MDAiICcgaW5pdCB0aGUgc3RhcnRpbmcgdGltZQ0KMTM1MCBCYXR0ViA9IFBpbigxKSAmIzQyOyBWQ29ycmVjdCAgICAgICAgICAgICAgICAgICAnIGluaXRpYWxpc2UgdGhlIGJhdHRlcnkgdm9sdGFnZQ0KMTM2MCBWU3RhcnQgPSBCYXR0Vg0KMTM3MCBWQXZlcmFnZSA9IDAgJiM1ODsgQXZlQ250ID0gMA0KMTM4MCAnDQoxMzkwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KMTQwMCAnIE1haW4gdGVzdCBsb29wDQoxNDEwIERvDQoxNDIwICAgJw0KMTQzMCAgIElmIFR5cGUkID0gIkMiIFRoZW4NCjE0NDAgICAgICcgQ2FsY3VsYXRlIHRoZSBzZXR0aW5nIHJlcXVpcmVkIHRvIGRyYXcgdGhlIHRlc3QgY3VycmVudA0KMTQ1MCAgICAgUHJldlRMID0gKEJhdHRWL1IxKSAmIzQyOyAxMDAwDQoxNDYwICAgICBGb3IgaSA9IDIgVG8gMzENCjE0NzAgICAgICAgVEwgPSAwDQoxNDgwICAgICAgIElmIGkgQW5kICZhbXA7YjAwMDAxIFRoZW4gVEwgPSBUTCArIEJhdHRWL1IxDQoxNDkwICAgICAgIElmIGkgQW5kICZhbXA7YjAwMDEwIFRoZW4gVEwgPSBUTCArIEJhdHRWL1IyDQoxNTAwICAgICAgIElmIGkgQW5kICZhbXA7YjAwMTAwIFRoZW4gVEwgPSBUTCArIEJhdHRWL1IzDQoxNTEwICAgICAgIElmIGkgQW5kICZhbXA7YjAxMDAwIFRoZW4gVEwgPSBUTCArIEJhdHRWL1I0DQoxNTIwICAgICAgIElmIGkgQW5kICZhbXA7YjEwMDAwIFRoZW4gVEwgPSBUTCArIEJhdHRWL1I1DQoxNTMwICAgICAgIFRMID0gVEwgJiM0MjsgMTAwMA0KMTU0MCAgICAgICBJZiBQcmV2VEwgKyAoVEwgLSBQcmV2VEwpIC8gMiAmZ3Q7IEJMb2FkIFRoZW4gRXhpdCBGb3INCjE1NTAgICAgICAgUHJldlRMID0gVEwNCjE1NjAgICAgIE5leHQgaQ0KMTU3MCAgIEVsc2VJZiBUeXBlJCA9ICJQIiBUaGVuDQoxNTgwICAgICAnIENhbGN1bGF0ZSB0aGUgc2V0dGluZyByZXF1aXJlZCB0byBkcmF3IHRoZSB0ZXN0IHBvd2VyDQoxNTkwICAgICBQcmV2VEwgPSAoKEJhdHRWICYjNDI7IEJhdHRWKS9SMSkgJiM0MjsgMTAwMA0KMTYwMCAgICAgRm9yIGkgPSAyIFRvIDMxDQoxNjEwICAgICAgIFRMID0gMA0KMTYyMCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMDAwMSBUaGVuIFRMID0gVEwgKyAoQmF0dFYgJiM0MjsgQmF0dFYpL1IxDQoxNjMwICAgICAgIElmIGkgQW5kICZhbXA7YjAwMDEwIFRoZW4gVEwgPSBUTCArIChCYXR0ViAmIzQyOyBCYXR0VikvUjINCjE2NDAgICAgICAgSWYgaSBBbmQgJmFtcDtiMDAxMDAgVGhlbiBUTCA9IFRMICsgKEJhdHRWICYjNDI7IEJhdHRWKS9SMw0KMTY1MCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMTAwMCBUaGVuIFRMID0gVEwgKyAoQmF0dFYgJiM0MjsgQmF0dFYpL1I0DQoxNjYwICAgICAgIElmIGkgQW5kICZhbXA7YjEwMDAwIFRoZW4gVEwgPSBUTCArIChCYXR0ViAmIzQyOyBCYXR0VikvUjUNCjE2NzAgICAgICAgVEwgPSBUTCAmIzQyOyAxMDAwDQoxNjgwICAgICAgIElmIFByZXZUTCArIChUTCAtIFByZXZUTCkgLyAyICZndDsgQkxvYWQgVGhlbiBFeGl0IEZvcg0KMTY5MCAgICAgICBQcmV2VEwgPSBUTA0KMTcwMCAgICAgTmV4dCBpDQoxNzEwICAgRWxzZUlmIFR5cGUkID0gIlIiIFRoZW4NCjE3MjAgICAgICcgQ2FsY3VsYXRlIHRoZSBzZXR0aW5nIHJlcXVpcmVkIHRvIGRyYXcgdGhlIHRlc3QgcmVzaXN0YW5jZQ0KMTczMCAgICAgUHJldlRMID0gUjENCjE3NDAgICAgIEZvciBpID0gMiBUbyAzMQ0KMTc1MCAgICAgICBUTCA9IDEwMDAwMDAwMA0KMTc2MCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMDAwMSBUaGVuIFRMID0gKFRMICYjNDI7IFIxKSAvIChUTCArIFIxKQ0KMTc3MCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMDAxMCBUaGVuIFRMID0gKFRMICYjNDI7IFIyKSAvIChUTCArIFIyKQ0KMTc4MCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMDEwMCBUaGVuIFRMID0gKFRMICYjNDI7IFIzKSAvIChUTCArIFIzKQ0KMTc5MCAgICAgICBJZiBpIEFuZCAmYW1wO2IwMTAwMCBUaGVuIFRMID0gKFRMICYjNDI7IFI0KSAvIChUTCArIFI0KQ0KMTgwMCAgICAgICBJZiBpIEFuZCAmYW1wO2IxMDAwMCBUaGVuIFRMID0gKFRMICYjNDI7IFI1KSAvIChUTCArIFI1KQ0KMTgxMCAgICAgICBJZiBQcmV2VEwgLSAoUHJldlRMIC0gVEwpIC8gMiAmbHQ7IEJMb2FkIFRoZW4gRXhpdCBGb3INCjE4MjAgICAgICAgUHJldlRMID0gVEwNCjE4MzAgICAgIE5leHQgaQ0KMTg0MCAgICAgJyBwcmludCAiU2VsZWN0ZWQgbmVhcmVzdCB2YWx1ZSBvZiI7IFByZXZUTDsgIiBvaG1zIg0KMTg1MCAgIEVsc2UNCjE4NjAgICAgRXJyb3IgIkludmFsaWQgVHlwZSQiDQoxODcwICAgRW5kSWYNCjE4ODAgICAnDQoxODkwICAgaSA9IGkgLSAxDQoxOTAwICAgJw0KMTkxMCAgICcgU2V0IHRoZSByZWVkIHJlbGF5cyB0byBjcmVhdGUgdGhlIHRlc3QgbG9hZA0KMTkyMCAgIFBpbigxMSkgPSBOb3QoaSBBbmQgJmFtcDtiMDAwMDEpDQoxOTMwICAgUGluKDEyKSA9IE5vdChpIEFuZCAmYW1wO2IwMDAxMCkNCjE5NDAgICBQaW4oMTMpID0gTm90KGkgQW5kICZhbXA7YjAwMTAwKQ0KMTk1MCAgIFBpbigxNCkgPSBOb3QoaSBBbmQgJmFtcDtiMDEwMDApDQoxOTYwICAgUGluKDE1KSA9IE5vdChpIEFuZCAmYW1wO2IxMDAwMCkNCjE5NzAgICAnDQoxOTgwICAgJyBjYWxjdWxhdGUgdGhlIGN1cnJlbnQgZHJhaW4gYXQgdGhpcyBzZXR0aW5nDQoxOTkwICAgVEMgPSAwDQoyMDAwICAgSWYgaSBBbmQgJmFtcDtiMDAwMDEgVGhlbiBUQyA9IFRDICsgQmF0dFYvUjENCjIwMTAgICBJZiBpIEFuZCAmYW1wO2IwMDAxMCBUaGVuIFRDID0gVEMgKyBCYXR0Vi9SMg0KMjAyMCAgIElmIGkgQW5kICZhbXA7YjAwMTAwIFRoZW4gVEMgPSBUQyArIEJhdHRWL1IzDQoyMDMwICAgSWYgaSBBbmQgJmFtcDtiMDEwMDAgVGhlbiBUQyA9IFRDICsgQmF0dFYvUjQNCjIwNDAgICBJZiBpIEFuZCAmYW1wO2IxMDAwMCBUaGVuIFRDID0gVEMgKyBCYXR0Vi9SNQ0KMjA1MCAgIFRDID0gVEMgJiM0MjsgMTAwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICcgY3VycmVudCBkcmFpbiBpbiBtQQ0KMjA2MCAgIG1BaG91cnMgPSBtQWhvdXJzICsgVEMvMzYwMCAgICAgICAgICAgICAgJyBhY2N1bXVsYXRlIHRoZSBtQUggcmVhZGluZyBmb3IgZWFjaCBzZWNvbmQNCjIwNzAgICAnDQoyMDgwICAgJyBldmVyeSBtaW51dGUgdXBkYXRlIHRoZSBkaXNwbGF5DQoyMDkwICAgSWYgUmlnaHQkKFRpbWUkLCAyKSA9ICIwMCIgVGhlbg0KMjEwMCAgICAgSGlzdChpSGlzdCkgPSBCYXR0ViAmIzU4OyBpSGlzdCA9IGlIaXN0ICsgMQ0KMjExMCAgICAgSWYgaUhpc3QgJmd0OyBNYXhIaXN0IFRoZW4gR29UbyAyMzMwDQoyMTIwICAgICBJZiBpSGlzdCAmZ3Q7IEhTY2FsZSAmIzQyOyA2MCBUaGVuDQoyMTMwICAgICAgIEhTY2FsZSA9IEhTY2FsZSArIDENCjIxNDAgICAgICAgR29TdWIgMjc5MCAgICAgICAgICAgICAgICAgICAgICAgICAgICcgcmVkcmF3IHRoZSBncmFwaCBzY2FsZQ0KMjE1MCAgICAgRW5kSWYNCjIxNjAgICAgIEdvU3ViIDI2NjAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgYWRkIHRoaXMgcmVhZGluZyB0byB0aGUgZ3JhcGgNCjIxNzAgICAgIEdvU3ViIDMwOTAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgcHJpbnQgdGhlIHJ1bm5pbmcgc3VtbWFyeQ0KMjE4MCAgIEVuZElmDQoyMTkwICAgJw0KMjIwMCAgICcgd2FpdCBmb3IgdGhlIG5leHQgc2Vjb25kDQoyMjEwICAgTG9vcENvdW50ID0gMQ0KMjIyMCAgIERvIFdoaWxlIFRpbWUkID0gTEFTVFRJTUUkDQoyMjMwICAgICBCYXR0ViA9IEJhdHRWICsgUGluKDEpICYjNDI7IFZDb3JyZWN0ICAgICAgJyB3aGlsZSB3ZSBhcmUgd2FpdGluZyBtYWtlIG1hbnkgbWVhc3VyZW1lbnRzDQoyMjQwICAgICBMb29wQ291bnQgPSBMb29wQ291bnQgKyAxICAgICAgICAgICAgICAnIGNvdW50IHRoZSBudW1iZXIgb2YgbWVhc3VyZW1lbnRzDQoyMjUwICAgTG9vcA0KMjI2MCAgIExBU1RUSU1FJCA9IFRpbWUkDQoyMjcwICAgQmF0dFYgPSBCYXR0Vi9Mb29wQ291bnQgICAgICAgICAgICAgICAgICAnIGFuZCBhdmVyYWdlDQoyMjgwICAgJw0KMjI5MCBWQXZlcmFnZSA9IFZBdmVyYWdlICsgQmF0dFYgJiM1ODsgQXZlQ250ID0gQXZlQ250ICsgMQ0KMjMwMCBMb29wIFdoaWxlIEJhdHRWICZndDs9IFRocmVzaG9sZA0KMjMxMCAnDQoyMzIwICcgdGhlIHRlc3QgaGFzIGZpbmlzaGVkIC0gcmVtb3ZlIHRoZSBsb2FkDQoyMzMwIFBpbigxMSkgPSAxICYjNTg7IFBpbigxMikgPSAxICYjNTg7IFBpbigxMykgPSAxICYjNTg7IFBpbigxNCkgPSAxICYjNTg7IFBpbigxNSkgPSAxDQoyMzQwICcNCjIzNTAgJw0KMjM2MCAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQoyMzcwICcgcHJpbnQgdGhlIHN1bW1hcnkNCjIzODAgR29TdWIgMzA5MCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgdXBkYXRlIHRoZSBydW5uaW5nIHN1bW1hcnkNCjIzOTAgUHJpbnQgJiM1ODsgVCQgPSAiVGVzdCBjb21wbGV0ZS4gICINCjI0MDAgVCQgPSBUJCArICJCYXR0ZXJ5IGNhcGFjaXR5IGlzICIgKyBGb3JtYXQkKG1BaG91cnMsICIlMS4wZm1BSCIpICsgIiBhdCBhIGNvbnN0YW50ICINCjI0MTAgSWYgVHlwZSQgPSAiQyIgVGhlbiBUJCA9IFQkICsgImN1cnJlbnQgb2YiICsgU3RyJChCTG9hZCkgKyAibUEuIg0KMjQyMCBJZiBUeXBlJCA9ICJQIiBUaGVuIFQkID0gVCQgKyAicG93ZXIgb2YiICsgU3RyJChCTG9hZCkgKyAibVcuIg0KMjQzMCBJZiBUeXBlJCA9ICJSIiBUaGVuIFQkID0gVCQgKyAicmVzaXN0YW5jZSBvZiIgKyBTdHIkKEJMb2FkKSArICIgb2htcy4iDQoyNDQwIElmIFNTYXZlJCA9ICJZIiBUaGVuIFByaW50ICYjMzU7MSAmIzU4OyBQcmludCAmIzM1OzEgJiM1ODsgUHJpbnQgJiMzNTsxLCBUJA0KMjQ1MCBQcmludCAiICAiICsgVCQNCjI0NjAgVCQgPSAiU3RhcnQgdm9sdGFnZSA9ICIgKyBGb3JtYXQkKFZTdGFydCwgIiUzLjJmIikgKyAiLiAgRW5kIHZvbHRhZ2UgPSAiICsgRm9ybWF0JChCYXR0ViwgIiUzLjJmIikNCjI0NzAgVCQgPSBUJCArICIuICBBdmVyYWdlIHZvbHRhZ2UgPSAiICsgRm9ybWF0JChWQXZlcmFnZS9BdmVDbnQsICIlMy4yZiIpICsgIi4iDQoyNDgwIElmIFNTYXZlJCA9ICJZIiBUaGVuIFByaW50ICYjMzU7MSwgVCQNCjI0OTAgUHJpbnQgIiAgICAiICsgVCQNCjI1MDAgSWYgU1NhdmUkID0gIlkiIFRoZW4gQ2xvc2UgJiMzNTsxDQoyNTEwICcNCjI1MjAgUHJpbnQgIiAgICBQcmVzcyBFTlRFUiB0byB0ZXN0IGFnYWluIG9yIENUUkwtQyB0byBxdWl0Li4uIjsNCjI1MzAgRG8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGZsYXNoIExFRCB3aGlsZSB3YWl0aW5nDQoyNTQwICAgUGF1c2UgMjAwICYjNTg7IElmIElua2V5JCA9IENociQoJmFtcDtIMEQpIFRoZW4gR29UbyA1MDANCjI1NTAgICBQaW4oMCkgPSAwICYjNTg7IFBhdXNlIDEwMCAmIzU4OyBQaW4oMCkgPSAxICYjNTg7IElmIElua2V5JCA9IENociQoJmFtcDtIMEQpIFRoZW4gR29UbyA1MDANCjI1NjAgTG9vcA0KMjU3MCAnDQoyNTgwICcNCjI1OTAgJw0KMjYwMCAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQoyNjEwICcgU1VCUk9VVElORVMNCjI2MjAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KMjYzMCAnDQoyNjQwICcgU3Vicm91dGluZSB0byBwcmludCB0aGUgdHJlbmQgbGluZSBvbiB0aGUgZ3JhcGgNCjI2NTAgJw0KMjY2MCBGb3IgaSA9IDEgVG8gaUhpc3QgLSAxDQoyNjcwICAgeDEgPSBtYXJnaW4gKyAod2lkdGggLyAoSFNjYWxlICYjNDI7IDYwKSkgJiM0MjsgKGkgLSAxKQ0KMjY4MCAgIHgyID0gbWFyZ2luICsgKHdpZHRoIC8gKEhTY2FsZSAmIzQyOyA2MCkpICYjNDI7IChpKQ0KMjY5MCAgIHkxID0gaGVpZ2h0IC0gKChIaXN0KGkgLSAxKSAmIzQyOyAxMCkgLyBWU2NhbGUpICYjNDI7IGhlaWdodA0KMjcwMCAgIHkyID0gaGVpZ2h0IC0gKChIaXN0KGkpICYjNDI7IDEwKSAvIFZTY2FsZSkgJiM0MjsgaGVpZ2h0DQoyNzEwICAgTGluZSAoeDEsIHkxKSAtICh4MiwgeTIpLCAxDQoyNzIwIE5leHQgaQ0KMjczMCBSZXR1cm4NCjI3NDAgJw0KMjc1MCAnDQoyNzYwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OycNCjI3NzAgJyBTdWJyb3V0aW5lIHRvIHByaW50IHRoZSBncmFwaCBheGllcw0KMjc4MCAnDQoyNzkwIGhlaWdodCA9IE1NLlZSZXMgLSAxMDAgJiM1ODsgbWFyZ2luID0gNDUgJiM1ODsgd2lkdGggPSBNTS5IUmVzIC0gbWFyZ2luIC0gMTINCjI4MDAgJw0KMjgxMCBDbHMNCjI4MjAgTGluZSAobWFyZ2luLGhlaWdodCktKG1hcmdpbiwgMCksIDEgJyBEcmF3IHRoZSB2ZXJ0IGxpbmUNCjI4MzAgTGluZSAobWFyZ2luLGhlaWdodCktKG1hcmdpbiArIHdpZHRoICxoZWlnaHQpLCAxICAnIERyYXcgdGhlIGhvcml6IGxpbmUNCjI4NDAgRm9yIGkgPSAwIFRvIFZTY2FsZSAgICAgICAgICAgICAgICAgICAgICAgICcgVGhpcyBsb29wIGRyYXdzIHRoZSB0aWNrIG1hcmtzDQoyODUwICAgaCA9IGhlaWdodCAtIChoZWlnaHQgLyBWU2NhbGUpICYjNDI7IGkNCjI4NjAgICB0ID0gbWFyZ2luIC0gNQ0KMjg3MCAgIElmIGkgTW9kIDUgPSAwIFRoZW4gICAgICAgICAgICAgICAgICAgICAgJyBTcGVjaWFsIG1hcmsgZm9yIGEgdW5pdCBvZiAwLjFWDQoyODgwICAgICBMb2NhdGUgbWFyZ2luIC0gNDIsIGggLSAzDQoyODkwICAgICBJZiBoIC0gMyAmbHQ7IDAgVGhlbiBMb2NhdGUgbWFyZ2luIC0gNDIsIDAgJyBmaXggaWYgd2UgYXJlIG9mZiB0aGUgc2NyZWVuDQoyOTAwICAgICBQcmludCBMZWZ0JChGb3JtYXQkKGkvMTAsIiVmIiksMyk7IlYiOyAnIExhYmVsIHRoZSB0aWNrIG1hcmsNCjI5MTAgICAgIHQgPSBtYXJnaW4gLSAxNQ0KMjkyMCAgIEVuZElmDQoyOTMwICAgTGluZSAobWFyZ2luLCBoKS0odCwgaCksIDEgICAgICAgICAgICAgICAnIERyYXcgdGhlIHRpY2sgbWFyaw0KMjk0MCBOZXh0IGkNCjI5NTAgRm9yIGkgPSAwIFRvIEhTY2FsZQ0KMjk2MCAgIHQgPSBtYXJnaW4gKyAod2lkdGgvSHNjYWxlKSAmIzQyOyBpDQoyOTcwICAgTGluZSAodCwgaGVpZ2h0KS0odCwgaGVpZ2h0ICsgOSksIDENCjI5ODAgICBJZiBpICZsdDsgMTAgVGhlbiBMb2NhdGUgdCAtIDgsIGhlaWdodCArIDE0IEVsc2UgTG9jYXRlIHQgLSAxMSwgaGVpZ2h0ICsgMTQNCjI5OTAgICBQcmludCBpOw0KMzAwMCBOZXh0IGkNCjMwMTAgTG9jYXRlIG1hcmdpbiArIHdpZHRoLzIgLSAxNCwgaGVpZ2h0ICsgMjUNCjMwMjAgUHJpbnQgIkhvdXJzIg0KMzAzMCBSZXR1cm4NCjMwNDAgJw0KMzA1MCAnDQozMDYwICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCjMwNzAgJyBTdWJyb3V0aW5lIHRvIHByaW50IHRoZSBzdW1tYXJ5IGRhdGEgYmVsb3cgdGhlIGdyYXBoDQozMDgwICcNCjMwOTAgVCQgPSBMZWZ0JChUaW1lJCwgNSkgKyAiICAgICIgKyBGb3JtYXQkKEJhdHRWLCAiJTUuM2ZWICAiKSArICIgICIgKyBGb3JtYXQkKFRDLCAiJTUuMWZtQSAgIikNCjMxMDAgVCQgPSBUJCArICIgIiArIEZvcm1hdCQobUFob3VycywgIiU1LjBmbUFIIikNCjMxMTAgTG9jYXRlIG1hcmdpbiArICh3aWR0aCAtIChMZW4oVCQpICYjNDI7IDYpKSAvIDIsIGhlaWdodCArIDQwDQozMTIwIFByaW50IHQkDQozMTMwIElmIFNTYXZlJCA9ICJZIiBUaGVuIFByaW50ICYjMzU7MSwgKGlIaXN0IC0gMSkvNjAsIEJhdHRWLCBUQywgbUFob3Vycw0KMzE0MCBSZXR1cm4NCjMxNTAgJw0KDQo8L3ByZT48YnIgLz48YnIgLz48YnIgLz48YnIgLz5kZMuPZYreY5y6KaM6Z4nPUCefhz98" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Battery Capacity Test</h1><small>Modified on 2016/12/23 23:19 by Administrator &mdash; Categorized as: Control, Electronics, Environment, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br /><br /><b>BATTERY.BAS </b><br /><pre>
100 ' BATTERY.BAS
105 ' Program to test the capacity of a battery
110 ' See Silicon Chip May 2011 for circuit details
115 ' V1.0
120 '
125 '
130 ' Measured resistance of the four load resistors
135 ' These are constant values determined by measuring the actual resistance
140 ' with a digital multimeter.  They must be in descending order of values
145 R1 = 56.00
150 R2 = 22.00
155 R3 =  8.20
160 R4 =  3.33
165 '
170 ' Measured value of the 3.3 volt supply
175 Vdd = 3.29
180 '
185 '
190 ' Default terminating voltage level and test current
195 TerminatingVolts = 1.0
200 TestCurrent = 120
205 '
210 '
215 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
220 ' Configure the input and output pins
225 PIN(11) = 1 &#58; PIN(12) = 1 &#58; PIN(13) = 1 &#58; PIN(14) = 1
230 SETPIN 11, 9 &#58; SETPIN 12, 9 &#58; SETPIN 13, 9 &#58; SETPIN 14, 9
235 SETPIN 1,1
240 '
245 '
250 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
255 ' Get the operating parameters from the user
260 ' check each response to make sure that it is within acceptable range
265 '
270 CLS &#58; PRINT "Battery test V1.0" &#58; PRINT
275 DO
280   INPUT "Enter the approx test current in mA (600 to 25)&#58; ", TestCurrent
285 LOOP WHILE TestCurrent &lt; 25 OR TestCurrent &gt; 600
290 '
295 DO
300   PRINT "Enter the terminating voltage ";
305   PRINT "(default "; FORMAT$(TerminatingVolts, "%4.2f"); ")&#58; ";
310   INPUT "", TerminatingVolts
315 LOOP WHILE TerminatingVolts &lt; 0.5 OR TerminatingVolts &gt; 2
320 '
325 PRINT
330 IF PIN(1) / 3.3 &#42; Vdd &lt; TerminatingVolts THEN
335   PRINT "To start the test place the charged battery in the holder";
340   DO &#58; LOOP WHILE PIN(1) / 3.3 &#42; Vdd &lt; TerminatingVolts
345   PRINT &#58; PRINT
350 ENDIF
355 '
360 '
365 '
370 TIME$ = "0&#58;0&#58;0"
375 LASTTIME$ = TIME$
380 PRINT "TIME    ", "VOLTS   ", "CURRENT", "     ACCUMULATED"
385 PRINT "&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;="
390 '
395 '
400 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
405 ' Main test loop
410 DO
415   BattV = PIN(1) / 3.3 &#42; Vdd              ' measure the battery voltage
420   '
425   ' Calculate the setting required to draw the test current
430   PrevTC = BattV/R1 &#42; 1000
435   FOR i = 2 TO 15
440     TC = 0
445     IF i AND &amp;b0001 THEN TC = TC + BattV/R1
450     IF i AND &amp;b0010 THEN TC = TC + BattV/R2
455     IF i AND &amp;b0100 THEN TC = TC + BattV/R3
460     IF i AND &amp;b1000 THEN TC = TC + BattV/R4
465     TC = TC &#42; 1000
470     IF PrevTC + (TC - PrevTC) / 2 &gt; TestCurrent THEN EXIT FOR
475     PrevTC = TC
480   NEXT i
485   i = i - 1
490   '
495   ' Set the reed relays to draw the test current
500   PIN(11) = NOT(i AND &amp;b0001)
505   PIN(12) = NOT(i AND &amp;b0010)
510   PIN(13) = NOT(i AND &amp;b0100)
515   PIN(14) = NOT(i AND &amp;b1000)
520   '
525   mAhours = mAhours + PrevTC/3600        ' accumulate the mAH reading
530   '
535   IF RIGHT$(TIME$, 2) = "00" THEN
540     PRINT TIME$,FORMAT$(BattV, "%5.3fV  "),FORMAT$(PrevTC, "%5.1fmA  "),; 
545     PRINT FORMAT$(mAhours, "%5.0fmAH")
550   ENDIF
555   '
560   ' wait for the next second
565   DO WHILE TIME$ = LASTTIME$ &#58; LOOP
570   LASTTIME$ = TIME$
575   '
580 LOOP WHILE BattV &gt; TerminatingVolts
585 '
590 PIN(11) = 1 &#58; PIN(12) = 1 &#58; PIN(13) = 1 &#58; PIN(14) = 1
595 '
600 '
605 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
610 ' print the summary
615 PRINT &#58; PRINT "Test complete.  ";
620 PRINT "Battery capacity is "; FORMAT$(mAhours, "%5.0fmAH")
625 PRINT &#58; PRINT

</pre><br /><br /><br /><b>BATTERY2.BAS </b><br /><pre>
100 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
110 ' BATTERY.BAS
120 ' Program to test the capacity of a battery
130 ' V2.0   Geoff Graham   Jan 2011
140 '
150 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
160 '
170 ' This is an extended version of the battery test program described in
180 ' the May 2011 issue of Silicon Chip.  Additional features include&#58;
190 '  - Will draw a graph of the battery voltage on the video output
200 '  - Choice of a constant current, power or resistance type of load
210 '  - Ability to save the data in an Excel compatible file
220 '  - Optional ability to use 5 relays for a finer level of load control
230 '
240 ' See the Silicon Chip article or the accompanying PDF for circuit details
250 '
260 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
270 '
280 ' Measured resistance of the five load resistors
290 ' These are constant values determined by measuring the actual resistance
300 ' with a digital multimeter.  They must be in descending order of values
310 ' if you only have 4 relays set the value of R5 to a very low value (eg, 0.0001)
320 '
330 R1 = 59.228
340 R2 = 29.789
350 R3 = 14.944
360 R4 =  7.516
370 R5 =  3.789
380 '
390 ' Correction for any error in measuring voltage (ie. actual V / Maximite V)
400 VCorrect = 1.019
410 '
420 ' default settings
430 DefaultType$ = "C"               ' constant current
440 DefaultBLoad = 200               ' load of 200 mA or mW
445 DefaultRLoad = 25                ' resistive load 25 ohms
450 DefaultThreshold = 0.9           ' cutout voltage to stop the test
460 '
470 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
480 MaxHist = 100 &#42; 60        ' maximum history to be saved (in minutes)
490 Dim Hist(MaxHist)         ' array for holding the history data
500 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
510 ' Program Start
520 ' The program returns to here when the test has finished
530 '
540 ' Configure the input and output pins
550 Pin(11) = 1 &#58; Pin(12) = 1 &#58; Pin(13) = 1 &#58; Pin(14) = 1 &#58; Pin(15) = 1
560 SetPin 11, 9 &#58; SetPin 12, 9 &#58; SetPin 13, 9 &#58; SetPin 14, 9 &#58; SetPin 15, 9
570 SetPin 1,1
580 '
590 HScale = 2
595 mAhours = 0
600 '
610 Pin(0) = 1 &#58; Print &#58; Print &#58; Cls
620 '
630 ' Get the test parameters from the user
640 Print "Battery capacity test utility V2.0"
650 ' define constants and arrays
655 Do
660   Print
670   Print "C = Constant current drain"
680   Print "P = Constant power drain"
690   Print "R = Constant resistive load"
700   Print "Select (default is "; DefaultType$; ") ";
710   Input Type$
715   If Asc(Type$) = 0 Then Type$ = DefaultType$
720   Type$ = Left$(UCase$(Type$), 1)
725 Loop Until Type$ = "C" Or Type$ = "P" Or Type$ = "R"
730 Print
740 '
750 If Type$ = "C" Then
760   Do
770     Print "Range is 600mA to 20mA"
780     Print "Enter current drain (default is"; DefaultBLoad; ") ";
790     Input BLoad
795     If BLoad = 0 Then Bload = DefaultBLoad
800   Loop While BLoad &gt; 600 Or BLoad &lt; 20
810 ElseIf Type$ = "P" Then
820   Do
830     Print "Range is 750mW to 25mW"
840     Print "Enter power drain (default is"; DefaultBLoad; ") ";
850     Input BLoad
855     If BLoad = 0 Then BLoad = DefaultBLoad
860   Loop While BLoad &gt; 750 Or BLoad &lt; 25
870 ElseIf Type$ = "R" Then
880   Do
900     Print "Range is 60 ohms to 1.8 ohms"
910     Print "Enter resistive load (default is"; DefaultRLoad; ") ";
920     Input BLoad
925     If BLoad = 0 Then BLoad = DefaultRLoad
930   Loop While BLoad &gt; 60 And BLoad &lt; 1.8
960 EndIf
970 '
975 Do
980   Print
990   Print "Enter the cutoff voltage (default is "; Format$(DefaultThreshold, "%3.1f"); ") ";
995   Print "Minimum cutoff is 0.5V"
1000   Input Threshold
1005   If Threshold = 0 Then Threshold = DefaultThreshold
1010 Loop While Threshold &lt; 0.5 Or Threshold &gt; 1.5
1020 Print
1030 '
1040 Do
1060   Input "Save the results to an Excel file (Y/N, default is N) ", SSave$
1070   SSave$ = Left$(UCase$(SSave$), 1)
1075   If Asc(SSave$) = 0 Then SSave$ = "N"
1080 Loop While Not(SSave$ = "Y" Or SSave$ = "N")
1089 '
1090 If SSave$ = "Y" Then
1100   Line Input "Filename (without an extension)&#58; "; FName$
1110   Open Left$(FName$, 8) + ".xls" For output As &#35;1
1120   Line Input "Description of battery under test&#58; "; R$
1130   Print &#35;1, R$
1140   If Type$ = "C" Then Print &#35;1, "Constant current of"; BLoad; "mA.  Cutoff at"; Threshold; "V"
1150   If Type$ = "P" Then Print &#35;1, "Constant power of"; BLoad; "mW.  Cutoff at"; Threshold; "V"
1160   If Type$ = "R" Then Print &#35;1, "Constant resistance of"; BLoad; " ohms.  Cutoff at"; Threshold; "V"
1170   Print &#35;1 &#58; Print &#35;1, "Time", "Voltage", "Current", "mAH"
1180 EndIf
1190 '
1200 Print
1210 Line Input "Press ENTER to start the test "; T$
1220 Pin(15) = 0 &#58; Pause 200                ' discharge any floating voltage
1230 Do While Pin(1) &#42; VCorrect &lt;= Threshold
1240   Print "Battery not inserted or not charged (voltage ="; Pin(1) &#42; VCorrect; ")"
1250   Print "Insert battery to continue ";
1260   While Pin(1) &#42; VCorrect &lt;= Threshold &#58; Wend
1270   Pause 750
1280 Loop
1290 '
1300 VScale = (Int(Pin(1) &#42; VCorrect &#42; 10) + 2)  ' set the vertical scale
1310 iHist = 0                                   ' zero the history
1320 GoSub 2790                                  ' draw the graph axies
1330 '
1340 Time$ = "00&#58;00&#58;00" &#58; LASTTIME$ = "00&#58;00&#58;00" ' init the starting time
1350 BattV = Pin(1) &#42; VCorrect                   ' initialise the battery voltage
1360 VStart = BattV
1370 VAverage = 0 &#58; AveCnt = 0
1380 '
1390 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
1400 ' Main test loop
1410 Do
1420   '
1430   If Type$ = "C" Then
1440     ' Calculate the setting required to draw the test current
1450     PrevTL = (BattV/R1) &#42; 1000
1460     For i = 2 To 31
1470       TL = 0
1480       If i And &amp;b00001 Then TL = TL + BattV/R1
1490       If i And &amp;b00010 Then TL = TL + BattV/R2
1500       If i And &amp;b00100 Then TL = TL + BattV/R3
1510       If i And &amp;b01000 Then TL = TL + BattV/R4
1520       If i And &amp;b10000 Then TL = TL + BattV/R5
1530       TL = TL &#42; 1000
1540       If PrevTL + (TL - PrevTL) / 2 &gt; BLoad Then Exit For
1550       PrevTL = TL
1560     Next i
1570   ElseIf Type$ = "P" Then
1580     ' Calculate the setting required to draw the test power
1590     PrevTL = ((BattV &#42; BattV)/R1) &#42; 1000
1600     For i = 2 To 31
1610       TL = 0
1620       If i And &amp;b00001 Then TL = TL + (BattV &#42; BattV)/R1
1630       If i And &amp;b00010 Then TL = TL + (BattV &#42; BattV)/R2
1640       If i And &amp;b00100 Then TL = TL + (BattV &#42; BattV)/R3
1650       If i And &amp;b01000 Then TL = TL + (BattV &#42; BattV)/R4
1660       If i And &amp;b10000 Then TL = TL + (BattV &#42; BattV)/R5
1670       TL = TL &#42; 1000
1680       If PrevTL + (TL - PrevTL) / 2 &gt; BLoad Then Exit For
1690       PrevTL = TL
1700     Next i
1710   ElseIf Type$ = "R" Then
1720     ' Calculate the setting required to draw the test resistance
1730     PrevTL = R1
1740     For i = 2 To 31
1750       TL = 100000000
1760       If i And &amp;b00001 Then TL = (TL &#42; R1) / (TL + R1)
1770       If i And &amp;b00010 Then TL = (TL &#42; R2) / (TL + R2)
1780       If i And &amp;b00100 Then TL = (TL &#42; R3) / (TL + R3)
1790       If i And &amp;b01000 Then TL = (TL &#42; R4) / (TL + R4)
1800       If i And &amp;b10000 Then TL = (TL &#42; R5) / (TL + R5)
1810       If PrevTL - (PrevTL - TL) / 2 &lt; BLoad Then Exit For
1820       PrevTL = TL
1830     Next i
1840     ' print "Selected nearest value of"; PrevTL; " ohms"
1850   Else
1860    Error "Invalid Type$"
1870   EndIf
1880   '
1890   i = i - 1
1900   '
1910   ' Set the reed relays to create the test load
1920   Pin(11) = Not(i And &amp;b00001)
1930   Pin(12) = Not(i And &amp;b00010)
1940   Pin(13) = Not(i And &amp;b00100)
1950   Pin(14) = Not(i And &amp;b01000)
1960   Pin(15) = Not(i And &amp;b10000)
1970   '
1980   ' calculate the current drain at this setting
1990   TC = 0
2000   If i And &amp;b00001 Then TC = TC + BattV/R1
2010   If i And &amp;b00010 Then TC = TC + BattV/R2
2020   If i And &amp;b00100 Then TC = TC + BattV/R3
2030   If i And &amp;b01000 Then TC = TC + BattV/R4
2040   If i And &amp;b10000 Then TC = TC + BattV/R5
2050   TC = TC &#42; 1000                           ' current drain in mA
2060   mAhours = mAhours + TC/3600              ' accumulate the mAH reading for each second
2070   '
2080   ' every minute update the display
2090   If Right$(Time$, 2) = "00" Then
2100     Hist(iHist) = BattV &#58; iHist = iHist + 1
2110     If iHist &gt; MaxHist Then GoTo 2330
2120     If iHist &gt; HScale &#42; 60 Then
2130       HScale = HScale + 1
2140       GoSub 2790                           ' redraw the graph scale
2150     EndIf
2160     GoSub 2660                             ' add this reading to the graph
2170     GoSub 3090                             ' print the running summary
2180   EndIf
2190   '
2200   ' wait for the next second
2210   LoopCount = 1
2220   Do While Time$ = LASTTIME$
2230     BattV = BattV + Pin(1) &#42; VCorrect      ' while we are waiting make many measurements
2240     LoopCount = LoopCount + 1              ' count the number of measurements
2250   Loop
2260   LASTTIME$ = Time$
2270   BattV = BattV/LoopCount                  ' and average
2280   '
2290 VAverage = VAverage + BattV &#58; AveCnt = AveCnt + 1
2300 Loop While BattV &gt;= Threshold
2310 '
2320 ' the test has finished - remove the load
2330 Pin(11) = 1 &#58; Pin(12) = 1 &#58; Pin(13) = 1 &#58; Pin(14) = 1 &#58; Pin(15) = 1
2340 '
2350 '
2360 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2370 ' print the summary
2380 GoSub 3090                                 ' update the running summary
2390 Print &#58; T$ = "Test complete.  "
2400 T$ = T$ + "Battery capacity is " + Format$(mAhours, "%1.0fmAH") + " at a constant "
2410 If Type$ = "C" Then T$ = T$ + "current of" + Str$(BLoad) + "mA."
2420 If Type$ = "P" Then T$ = T$ + "power of" + Str$(BLoad) + "mW."
2430 If Type$ = "R" Then T$ = T$ + "resistance of" + Str$(BLoad) + " ohms."
2440 If SSave$ = "Y" Then Print &#35;1 &#58; Print &#35;1 &#58; Print &#35;1, T$
2450 Print "  " + T$
2460 T$ = "Start voltage = " + Format$(VStart, "%3.2f") + ".  End voltage = " + Format$(BattV, "%3.2f")
2470 T$ = T$ + ".  Average voltage = " + Format$(VAverage/AveCnt, "%3.2f") + "."
2480 If SSave$ = "Y" Then Print &#35;1, T$
2490 Print "    " + T$
2500 If SSave$ = "Y" Then Close &#35;1
2510 '
2520 Print "    Press ENTER to test again or CTRL-C to quit...";
2530 Do                                          ' flash LED while waiting
2540   Pause 200 &#58; If Inkey$ = Chr$(&amp;H0D) Then GoTo 500
2550   Pin(0) = 0 &#58; Pause 100 &#58; Pin(0) = 1 &#58; If Inkey$ = Chr$(&amp;H0D) Then GoTo 500
2560 Loop
2570 '
2580 '
2590 '
2600 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2610 ' SUBROUTINES
2620 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
2630 '
2640 ' Subroutine to print the trend line on the graph
2650 '
2660 For i = 1 To iHist - 1
2670   x1 = margin + (width / (HScale &#42; 60)) &#42; (i - 1)
2680   x2 = margin + (width / (HScale &#42; 60)) &#42; (i)
2690   y1 = height - ((Hist(i - 1) &#42; 10) / VScale) &#42; height
2700   y2 = height - ((Hist(i) &#42; 10) / VScale) &#42; height
2710   Line (x1, y1) - (x2, y2), 1
2720 Next i
2730 Return
2740 '
2750 '
2760 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
2770 ' Subroutine to print the graph axies
2780 '
2790 height = MM.VRes - 100 &#58; margin = 45 &#58; width = MM.HRes - margin - 12
2800 '
2810 Cls
2820 Line (margin,height)-(margin, 0), 1 ' Draw the vert line
2830 Line (margin,height)-(margin + width ,height), 1  ' Draw the horiz line
2840 For i = 0 To VScale                        ' This loop draws the tick marks
2850   h = height - (height / VScale) &#42; i
2860   t = margin - 5
2870   If i Mod 5 = 0 Then                      ' Special mark for a unit of 0.1V
2880     Locate margin - 42, h - 3
2890     If h - 3 &lt; 0 Then Locate margin - 42, 0 ' fix if we are off the screen
2900     Print Left$(Format$(i/10,"%f"),3);"V"; ' Label the tick mark
2910     t = margin - 15
2920   EndIf
2930   Line (margin, h)-(t, h), 1               ' Draw the tick mark
2940 Next i
2950 For i = 0 To HScale
2960   t = margin + (width/Hscale) &#42; i
2970   Line (t, height)-(t, height + 9), 1
2980   If i &lt; 10 Then Locate t - 8, height + 14 Else Locate t - 11, height + 14
2990   Print i;
3000 Next i
3010 Locate margin + width/2 - 14, height + 25
3020 Print "Hours"
3030 Return
3040 '
3050 '
3060 &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
3070 ' Subroutine to print the summary data below the graph
3080 '
3090 T$ = Left$(Time$, 5) + "    " + Format$(BattV, "%5.3fV  ") + "  " + Format$(TC, "%5.1fmA  ")
3100 T$ = T$ + " " + Format$(mAhours, "%5.0fmAH")
3110 Locate margin + (width - (Len(T$) &#42; 6)) / 2, height + 40
3120 Print t$
3130 If SSave$ = "Y" Then Print &#35;1, (iHist - 1)/60, BattV, TC, mAhours
3140 Return
3150 '

</pre><br /><br /><br /><br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Battery-Capacity-Test-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:13:41 GMT -->
</html>
