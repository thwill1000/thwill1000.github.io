

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions&Revision=00003 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 13:11:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Page History - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/History.aspx?NS=MMBasic&amp;Page=MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions&amp;Revision=00003" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEzMjI3OTE2NTkPZBYCZg9kFgICAQ9kFgICCQ9kFggCAQ8WAh4EVGV4dAU4UGFnZSBIaXN0b3J5OiBMVHJpbSBhbmQgUlRyaW0gRnVuY3Rpb25zIChWQiB3b3JrLWEtbGlrZSlkAgUPEGQQFQQBMwEyATEBMBUEATMBMgExATAUKwMEZ2dnZ2RkAgcPEGQQFQUHQ3VycmVudAEzATIBMQEwFQUHQ3VycmVudAEzATIBMQEwFCsDBWdnZ2dnZGQCCw8WAh8ABYMbPHRhYmxlIGNsYXNzPSJib3giIGNlbGxwYWRkaW5nPSIwIiBjZWxsc3BhY2luZz0iMCI+PHRyPjx0ZD48cCBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyI+PGI+PGEgaHJlZj0iTU1CYXNpYy5IaXN0b3J5LmFzcHg/UGFnZT1NTUJhc2ljLlZCLVdvcmstYS1saWtlLUxUcmltLWFuZC1SVFJJTS1GdW5jdGlvbnMmYW1wO1JldmlzaW9uPTAwMDAyIj4mbGFxdW87IE9sZGVyIFJldmlzaW9uPC9hPiAtIDxhIGhyZWY9Ik1NQmFzaWMuSGlzdG9yeS5hc3B4P1BhZ2U9TU1CYXNpYy5WQi1Xb3JrLWEtbGlrZS1MVHJpbS1hbmQtUlRSSU0tRnVuY3Rpb25zIj5CYWNrIHRvIFBhZ2UgSGlzdG9yeTwvYT4gLSA8YSBocmVmPSJNTUJhc2ljLlZCLVdvcmstYS1saWtlLUxUcmltLWFuZC1SVFJJTS1GdW5jdGlvbnMuYXNoeCI+Q3VycmVudCBSZXZpc2lvbjwvYT48L2I+PC9wPjwvdGQ+PC90cj48L3RhYmxlPjxiciAvPjxoMyBjbGFzcz0ic2VwYXJhdG9yIj5QYWdlIFJldmlzaW9uOiAyMDIxLzAyLzAxIDEyOjI3PC9oMz48YnIgLz5UaGUgZm9sbG93aW5nIGZ1bmN0aW9ucyByZXR1cm4gdGhlIGlucHV0IHN0cmluZyB3aXRoIGxlYWRpbmcgb3IgdHJhaWxpbmcgd2hpdGUtc3BhY2UgY2hhcmFjdGVycyAoJkgyMCAmICZIMDkpIHJlbW92ZWQuPGJyIC8+PGJyIC8+SWYgeW91IG5lZWQgdGhlIGZ1bmN0aW9ucyBmb3IgTU0rLCBNTVgsIFBpQ3JvbWl0ZSwgb3IgQVJNTWl0ZSB5b3Ugc2hvdWxkIHVzZSB0aGUgdmVyc2lvbnMgc2hvd24gYmVsb3cuIElmIHlvdSBhcmUgdXNpbmcgYSBNaWNyb01pdGUgTWsyICgyOCBvciA0OCBwaW4gTVgxNzApLCB0aGUgYmVsb3cgYXJlIGZ1bGx5IGNvbXBhdGlibGUsIGJ1dCB5b3UgYXJlIGJldHRlciBvZmYgdXNpbmcgPGEgY2xhc3M9InBhZ2VsaW5rIiBocmVmPSJNTUJhc2ljLkxUcmltLVJUcmltLWNGdW5jdGlvbnMuYXNoeCIgdGl0bGU9IkxUcmltIFJUcmltIENGdW5jdGlvbnMiPnRoZXNlIHZlcnNpb25zPC9hPi4gQmVpbmcgQ0Z1bmN0aW9ucywgdGhleSBhcmUgaHVnZWx5IGZhc3RlciAoYXQgbGVhc3QgMTB4IGFuZCBvZnRlbiBuZWFyZXIgMTAweCkgLSBub3QgPGk+cHJlY2lzZWx5IDwvaT5WQiBjb21wYXRpYmxlIGFzIHRoZXkgb25seSByZWNvZ25pc2UgYSBDSFIkKDMyKSBhcyB3aGl0ZSBzcGFjZSAtIHVubGlrZWx5IHRvIGJlIGEgcHJvYmxlbS48YnIgLz48YnIgLz5Vc2luZyBDT05TVHMgYW5kIGEgdGVtcG9yYXJ5IHN0cmluZyBmb3IgdGhlIGNvbXBhcmUgc2xpY2UgZ2l2ZXMgYSBnb29kIHNwZWVkIGluY3JlYXNlLiA8YnIgLz4gPUxUcmltJChSVHJpbSQoImEiKSl0YWtlcyBvbmx5IDExLjVtUyBhdCA0OE1IeiBvbiBNWDE3MDxiciAvPjxiciAvPjxiPlN5bnRheDwvYj46PGJyIC8+ICAgIExUcmltJChleHByZXNzaW9uKTxiciAvPiAgICBSVHJpbSQoZXhwcmVzc2lvbik8YnIgLz48YnIgLz48Yj5FeGFtcGxlPC9iPjo8YnIgLz4gICAgYSQ9UlRyaW0kKHVzZXJpbnB1dCQpPGJyIC8+PGJyIC8+PGI+Q29kZTwvYj46PGJyIC8+IDxiciAvPjxwcmU+DQoncHJlYW1ibGUNCglDb25zdCBzVCQ9Q2hyJCg5KSwgc1MkPSIgIg0KDQoJRnVuY3Rpb24gTFRyaW0kKGEkKQ0KCQlMb2NhbCBJbnRlZ2VyIG0NCgkJRm9yIG09MSBUbyBMZW4oYSQpDQoJCQlJZiBOb3QoTWlkJChhJCxtLDEpPSIgIiBPciBNaWQkKGEkLG0sMSk9Q2hyJCg5KSkgVGhlbiBMVHJpbSQ9TWlkJChhJCxtKSYjNTg7IEV4aXQgRnVuY3Rpb24NCgkJTmV4dCAgICANCgkJTFRyaW0kPSIiDQoJRW5kIEZ1bmN0aW9uDQoNCglGdW5jdGlvbiBSVHJpbSQoYWEkKQ0KCQlMb2NhbCBJbnRlZ2VyIG4seA0KCQlsb2NhbCBxJA0KCQlxJD1hYSQNCgkJRm9yIG49UEVFSyhWQVIgcSQsMCkgVE8gMSBTdGVwIC0xDQoJCQl4PVBFRUsoVkFSIHEkLCBuKQ0KCQkJSWYgTm90KHg9JmFtcDtvNDAgT3IgeD0mYW1wO28xMSkgVGhlbiBQT0tFIFZBUiBxJCwgMCwgbiYjNTg7IEV4aXQgRm9yDQoJCU5leHQgDQoJCVJUcmltJD1xJA0KCUVuZCBGdW5jdGlvbg0KPC9wcmU+PGJyIC8+PGJyIC8+Rm9yIHRob3NlIG5lZWRpbmcgcmVkdWNlZCB0aW1pbmdzIHdpdGhvdXQgcmVzb3J0aW5nIHRvIENTdWJzLCBpbiB0aGUgYWx0ZXJuYXRpdmUgUlRyaW0kKCkgYmVsb3csIHNvbWUgdHJpY2tzIHdoaWNoIHNwZWVkIHVwIHRoaW5ncyB1cCBieSBhYm91dCAyNSUgYXJlIHVzZWQ7IEluc3RlYWQgb2YgcmVtb3ZpbmcgcGFkZGluZyBmcm9tIHRoZSByaWdodCBieSByZXBlYXRlZCBzdHJpbmcgc2xpY2luZywgaXQgYW5hbHl6ZXMgYnl0ZXMgLSBzdG9wcGluZyB3aGVuIGl0IGhpdHMgYSBub24tc3BhY2UuIEl0IHRoZW4gUE9LRXMgdGhhdCBwb3NpdGlvbiBpbnRvIHRoZSB2YXJpYWJsZSBkZXNjcmlwdG9yIHRvIHRydW5jYXRlIHRoZSBzdHJpbmcgaW4gb25lIGdvLiBUaGlzIG1ldGhvZCBpcyBmYWlybHkgYWR2YW5jZWQgTU1CYXNpYyBhbmQgdHdlYWtlcnMgc2hvdWxkIGJlIHdhcnkgb2YgY2hhbmdpbmcgdGhlIFBPS0UgY29tbWFuZHMuIEl0IGlzIGdvb2QgdG8gdHJ5IHRvIHVuZGVyc3RhbmQgd2hhdCBpcyBoYXBwZW5pbmcgdGhvdWdoLiA8YnIgLz48YnIgLz48cHJlPg0KCUZ1bmN0aW9uIFJUcmltJChhYSQpDQoJCUxvY2FsIEludGVnZXIgbix4DQoJCWxvY2FsIHEkDQoJCXEkPWFhJA0KCQlGb3Igbj1QZWVrKFZhciBxJCwwKSBUTyAwIFN0ZXAgLTENCgkJCXg9UGVlayhWYXIgcSQsIG4pDQoJCQlJZiBOb3QoeD0mYW1wO280MCBPciB4PSZhbXA7bzExKSBUaGVuIFBva2UgVmFyIHEkLCAwLCBuJiM1ODsgRXhpdCBGb3INCgkJTmV4dCANCgkJUlRyaW0kPXEkDQoJRW5kIEZ1bmN0aW9uDQo8L3ByZT48YnIgLz5BcyB3aXRoIG1vc3Qgb3B0aW1pemF0aW9ucyByZXN1bHRpbmcgaW4gYW4gaW5jcmVhc2VkIGNvZGUgZm9vdHByaW50LCB0aGVyZSBpcyBhIHN3ZWV0LXNwb3Qgd2hlcmUgdGhlIGxhcmdlciBzaXplIGNhbiB3b3JrIGFnYWluc3QgdGhlIHdvcmtsb2FkLiBUaGlzIHNlZW1zIHRvIGJlIGEgc3RyaW5nIG9mIHNpeCBzcGFjZXMgd2hlcmUgdGhlIG5ldyB2ZXJzaW9uIGlzIG9ubHkgc2xpZ2h0bHkgZmFzdGVyIHRoYW4gdGhlIG9sZCAodGhlIGludmVyc2UgaXMgdHJ1ZSkuPGJyIC8+PGJyIC8+Tm90ZSBhbHNvLCB0aGUgcGFkIGNoYXJhY3RlcnMgYXJlIGRlc2NyaWJlZCBpbiBvY3RhbCB3aGljaCBpcyB0aGUgZmFzdGVzdCByYWRpeCBmb3IgdGhlIGludGVycHJldGVyLjxiciAvPjxiciAvPlN1Y2ggYSB0cmljayBpcyBub3QgcG9zc2libGUgd2l0aCBMVHJpbSQoKSBiZWNhdXNlIHdlIHdvdWxkIG5lZWQgdG8gY29weSB0aGUgdXNlZnVsIHBhcnQgb2YgdGhlIHN0cmluZyBkb3duIHRvIHN0YXJ0IGF0IHBvc2l0aW9uIG9uZSBpbiB0aGUgc3RyaW5nIGRlc2NyaXB0b3IsIGxpa2VseSB2b2lkaW5nIGFueSBnYWlucyBhbmQgcXVpdGUgcG9zc2libHkgbWFraW5nIHRoaW5ncyBhIGxvdCB3b3JzZSBvbiBsYXJnZSBzdHJpbmdzLiAgPGJyIC8+PGJyIC8+ZGSkJNDh++I9BYCXov7ApKc5wg86eA==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="2068001F" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWCwKXmeyYAgK/z/TSAwK8z/TSAwK9z/TSAwKiz/TSAwK3j57gBwLA5ta/BQLD5ta/BQLC5ta/BQLd5ta/BQL9yYWiCTantylaBdUNuS1jZErFsDVskq8P" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login3274.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fHistory.aspx%3fNS%3dMMBasic%26Page%3dMMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions%26Revision%3d00003" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBa925f7376d16452eba58fcd259b58efc() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBa925f7376d16452eba58fcd259b58efc').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBa925f7376d16452eba58fcd259b58efc" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBa925f7376d16452eba58fcd259b58efc(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBa925f7376d16452eba58fcd259b58efc(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <h1 class="pagetitlesystem">Page History: LTrim and RTrim Functions (VB work-a-like)</h1>
    <p>Compare Page Revisions</p> 
    <select name="ctl00$CphMaster$lstRev1" id="ctl00_CphMaster_lstRev1">
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <select name="ctl00$CphMaster$lstRev2" id="ctl00_CphMaster_lstRev2">
	<option value="Current">Current</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <input type="submit" name="ctl00$CphMaster$btnCompare" value="Compare" id="ctl00_CphMaster_btnCompare" />
    <br /><br />
    
    <table class="box" cellpadding="0" cellspacing="0"><tr><td><p style="text-align: center;"><b><a href="MMBasic.Historyc8b2.html?Page=MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions&amp;Revision=00002">&laquo; Older Revision</a> - <a href="MMBasic.History9415.html?Page=MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions">Back to Page History</a> - <a href="MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions.html">Current Revision</a></b></p></td></tr></table><br /><h3 class="separator">Page Revision: 2021/02/01 12:27</h3><br />The following functions return the input string with leading or trailing white-space characters (&H20 & &H09) removed.<br /><br />If you need the functions for MM+, MMX, PiCromite, or ARMMite you should use the versions shown below. If you are using a MicroMite Mk2 (28 or 48 pin MX170), the below are fully compatible, but you are better off using <a class="pagelink" href="MMBasic.LTrim-RTrim-cFunctions.html" title="LTrim RTrim CFunctions">these versions</a>. Being CFunctions, they are hugely faster (at least 10x and often nearer 100x) - not <i>precisely </i>VB compatible as they only recognise a CHR$(32) as white space - unlikely to be a problem.<br /><br />Using CONSTs and a temporary string for the compare slice gives a good speed increase. <br /> =LTrim$(RTrim$("a"))takes only 11.5mS at 48MHz on MX170<br /><br /><b>Syntax</b>:<br />    LTrim$(expression)<br />    RTrim$(expression)<br /><br /><b>Example</b>:<br />    a$=RTrim$(userinput$)<br /><br /><b>Code</b>:<br /> <br /><pre>
'preamble
	Const sT$=Chr$(9), sS$=" "

	Function LTrim$(a$)
		Local Integer m
		For m=1 To Len(a$)
			If Not(Mid$(a$,m,1)=" " Or Mid$(a$,m,1)=Chr$(9)) Then LTrim$=Mid$(a$,m)&#58; Exit Function
		Next    
		LTrim$=""
	End Function

	Function RTrim$(aa$)
		Local Integer n,x
		local q$
		q$=aa$
		For n=PEEK(VAR q$,0) TO 1 Step -1
			x=PEEK(VAR q$, n)
			If Not(x=&amp;o40 Or x=&amp;o11) Then POKE VAR q$, 0, n&#58; Exit For
		Next 
		RTrim$=q$
	End Function
</pre><br /><br />For those needing reduced timings without resorting to CSubs, in the alternative RTrim$() below, some tricks which speed up things up by about 25% are used; Instead of removing padding from the right by repeated string slicing, it analyzes bytes - stopping when it hits a non-space. It then POKEs that position into the variable descriptor to truncate the string in one go. This method is fairly advanced MMBasic and tweakers should be wary of changing the POKE commands. It is good to try to understand what is happening though. <br /><br /><pre>
	Function RTrim$(aa$)
		Local Integer n,x
		local q$
		q$=aa$
		For n=Peek(Var q$,0) TO 0 Step -1
			x=Peek(Var q$, n)
			If Not(x=&amp;o40 Or x=&amp;o11) Then Poke Var q$, 0, n&#58; Exit For
		Next 
		RTrim$=q$
	End Function
</pre><br />As with most optimizations resulting in an increased code footprint, there is a sweet-spot where the larger size can work against the workload. This seems to be a string of six spaces where the new version is only slightly faster than the old (the inverse is true).<br /><br />Note also, the pad characters are described in octal which is the fastest radix for the interpreter.<br /><br />Such a trick is not possible with LTrim$() because we would need to copy the useful part of the string down to start at position one in the string descriptor, likely voiding any gains and quite possibly making things a lot worse on large strings.  <br /><br />
    
    


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions&Revision=00003 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 13:11:30 GMT -->
</html>
