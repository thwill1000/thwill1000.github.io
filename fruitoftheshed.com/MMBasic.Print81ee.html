

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.MMX-time-of-the-seasons by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:21:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	MMX - time of the seasons - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.MMX-time-of-the-seasons" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFu8wBPGgxIGNsYXNzPSJwYWdldGl0bGUiPk1NWCAtIHRpbWUgb2YgdGhlIHNlYXNvbnM8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDE4LzEyLzA0IDIyOjQzIGJ5IEFkbWluaXN0cmF0b3IgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogRGF0ZXMsIFRpbWUgYW5kIENsb2Nrczwvc21hbGw+PGJyIC8+PGJyIC8+PHByZT4NCg0KICAnIHNlYXNvbnMuYmFzICAgICAgICAgTWFyY2ggNiwgMjAxNw0KICANCiAgJyBjYWxlbmRhciBkYXRlIGFuZCBVVEMgdGltZSBvZiB0aGUgc2Vhc29ucw0KICANCiAgJyBNaWNyb21pdGUgZVh0cmVtZSB2ZXJzaW9uDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQogICcgZGltZW5zaW9uIGdsb2JhbCBhcnJheXMNCiAgDQogIGRpbSBzbCg1MCkgYXMgZmxvYXQsIHNyKDUwKSBhcyBmbG9hdCwgc2EoNTApIGFzIGZsb2F0LCBzYig1MCkgYXMgZmxvYXQNCiAgDQogIGRpbSBqZGxlYXAoMjgpIGFzIGZsb2F0LCBsZWFwc2VjKDI4KSBhcyBmbG9hdCwgbW9udGgkKDEyKSBhcyBzdHJpbmcNCiAgDQogICcgZ2xvYmFsIGNvbnN0YW50cw0KICANCiAgY29uc3QgcGkyID0gMi4wICYjNDI7IHBpLCBwaWRpdjIgPSAwLjUgJiM0MjsgcGksIGR0ciA9IHBpIC8gMTgwLjANCiAgDQogICcgcmVhZCBzb2xhciBlcGhlbWVyaXMgZGF0YQ0KICANCiAgZm9yIGklID0gMSB0byA1MA0KICAgIA0KICAgIHJlYWQgc2woaSUpLCBzcihpJSksIHNhKGklKSwgc2IoaSUpDQogICAgDQogIG5leHQgaSUNCiAgDQogIGRhdGEgNDAzNDA2LCAgICAgIDAsIDQuNzIxOTY0LCAgICAgIDEuNjIxMDQzDQogIGRhdGEgMTk1MjA3LCAtOTc1OTcsIDUuOTM3NDU4LCAgNjI4MzAuMzQ4MDY3DQogIGRhdGEgMTE5NDMzLCAtNTk3MTUsIDEuMTE1NTg5LCAgNjI4MzAuODIxNTI0DQogIGRhdGEgMTEyMzkyLCAtNTYxODgsIDUuNzgxNjE2LCAgNjI4MjkuNjM0MzAyDQogIGRhdGEgICAzODkxLCAgLTE1NTYsIDUuNTQ3NCAgLCAxMjU2NjAuNTY5MQ0KICBkYXRhICAgMjgxOSwgIC0xMTI2LCAxLjUxMjAgICwgMTI1NjYwLjk4NDUNCiAgZGF0YSAgIDE3MjEsICAgLTg2MSwgNC4xODk3ICAsICA2MjgzMi40NzY2DQogIGRhdGEgICAgICAwLCAgICA5NDEsIDEuMTYzICAgLCAgICAgIDAuODEzDQogIGRhdGEgICAgNjYwLCAgIC0yNjQsIDUuNDE1ICAgLCAxMjU2NTkuMzEwDQogIGRhdGEgICAgMzUwLCAgIC0xNjMsIDQuMzE1ICAgLCAgNTc1MzMuODUwDQogIGRhdGEgICAgMzM0LCAgICAgIDAsIDQuNTUzICAgLCAgICAtMzMuOTMxDQogIGRhdGEgICAgMzE0LCAgICAzMDksIDUuMTk4ICAgLCA3NzcxMzcuNzE1DQogIGRhdGEgICAgMjY4LCAgIC0xNTgsIDUuOTg5ICAgLCAgNzg2MDQuMTkxDQogIGRhdGEgICAgMjQyLCAgICAgIDAsIDIuOTExICAgLCAgICAgIDUuNDEyDQogIGRhdGEgICAgMjM0LCAgICAtNTQsIDEuNDIzICAgLCAgMzkzMDIuMDk4DQogIGRhdGEgICAgMTU4LCAgICAgIDAsIDAuMDYxICAgLCAgICAtMzQuODYxDQogIGRhdGEgICAgMTMyLCAgICAtOTMsIDIuMzE3ICAgLCAxMTUwNjcuNjk4DQogIGRhdGEgICAgMTI5LCAgICAtMjAsIDMuMTkzICAgLCAgMTU3NzQuMzM3DQogIGRhdGEgICAgMTE0LCAgICAgIDAsIDIuODI4ICAgLCAgIDUyOTYuNjcwDQogIGRhdGEgICAgIDk5LCAgICAtNDcsIDAuNTIgICAgLCAgNTg4NDkuMjcNCiAgZGF0YSAgICAgOTMsICAgICAgMCwgNC42NSAgICAsICAgNTI5Ni4xMQ0KICBkYXRhICAgICA4NiwgICAgICAwLCA0LjM1ICAgICwgIC0zOTgwLjcwDQogIGRhdGEgICAgIDc4LCAgICAtMzMsIDIuNzUgICAgLCAgNTIyMzcuNjkNCiAgZGF0YSAgICAgNzIsICAgIC0zMiwgNC41MCAgICAsICA1NTA3Ni40Nw0KICBkYXRhICAgICA2OCwgICAgICAwLCAzLjIzICAgICwgICAgMjYxLjA4DQogIGRhdGEgICAgIDY0LCAgICAtMTAsIDEuMjIgICAgLCAgMTU3NzMuODUNCiAgZGF0YSAgICAgNDYsICAgIC0xNiwgMC4xNCAgICAsIDE4ODQ5MS4wMw0KICBkYXRhICAgICAzOCwgICAgICAwLCAzLjQ0ICAgICwgIC03NzU2LjU1DQogIGRhdGEgICAgIDM3LCAgICAgIDAsIDQuMzcgICAgLCAgICAyNjQuODkNCiAgZGF0YSAgICAgMzIsICAgIC0yNCwgMS4xNCAgICAsIDExNzkwNi4yNw0KICBkYXRhICAgICAyOSwgICAgLTEzLCAyLjg0ICAgICwgIDU1MDc1Ljc1DQogIGRhdGEgICAgIDI4LCAgICAgIDAsIDUuOTYgICAgLCAgLTc5NjEuMzkNCiAgZGF0YSAgICAgMjcsICAgICAtOSwgNS4wOSAgICAsIDE4ODQ4OS44MQ0KICBkYXRhICAgICAyNywgICAgICAwLCAxLjcyICAgICwgICAyMTMyLjE5DQogIGRhdGEgICAgIDI1LCAgICAtMTcsIDIuNTYgICAgLCAxMDk3NzEuMDMNCiAgZGF0YSAgICAgMjQsICAgIC0xMSwgMS45MiAgICAsICA1NDg2OC41Ng0KICBkYXRhICAgICAyMSwgICAgICAwLCAwLjA5ICAgICwgIDI1NDQzLjkzDQogIGRhdGEgICAgIDIxLCAgICAgMzEsIDUuOTggICAgLCAtNTU3MzEuNDMNCiAgZGF0YSAgICAgMjAsICAgIC0xMCwgNC4wMyAgICAsICA2MDY5Ny43NA0KICBkYXRhICAgICAxOCwgICAgICAwLCA0LjI3ICAgICwgICAyMTMyLjc5DQogIGRhdGEgICAgIDE3LCAgICAtMTIsIDAuNzkgICAgLCAxMDk3NzEuNjMNCiAgZGF0YSAgICAgMTQsICAgICAgMCwgNC4yNCAgICAsICAtNzc1Mi44Mg0KICBkYXRhICAgICAxMywgICAgIC01LCAyLjAxICAgICwgMTg4NDkxLjkxDQogIGRhdGEgICAgIDEzLCAgICAgIDAsIDIuNjUgICAgLCAgICAyMDcuODENCiAgZGF0YSAgICAgMTMsICAgICAgMCwgNC45OCAgICAsICAyOTQyNC42Mw0KICBkYXRhICAgICAxMiwgICAgICAwLCAwLjkzICAgICwgICAgIC03Ljk5DQogIGRhdGEgICAgIDEwLCAgICAgIDAsIDIuMjEgICAgLCAgNDY5NDEuMTQNCiAgZGF0YSAgICAgMTAsICAgICAgMCwgMy41OSAgICAsICAgIC02OC4yOQ0KICBkYXRhICAgICAxMCwgICAgICAwLCAxLjUwICAgICwgIDIxNDYzLjI1DQogIGRhdGEgICAgIDEwLCAgICAgLTksIDIuNTUgICAgLCAxNTcyMDguNDANCiAgDQogICcgcmVhZCBsZWFwIHNlY29uZCBkYXRhDQogIA0KICBmb3IgaSUgPSAxIHRvIDI4DQogICAgDQogICAgcmVhZCBqZGxlYXAoaSUpLCBsZWFwc2VjKGklKQ0KICAgIA0KICBuZXh0IGklDQogIA0KICBkYXRhIDI0NDEzMTcuNSwgIDEwLjANCiAgZGF0YSAyNDQxNDk5LjUsICAxMS4wDQogIGRhdGEgMjQ0MTY4My41LCAgMTIuMA0KICBkYXRhIDI0NDIwNDguNSwgIDEzLjANCiAgZGF0YSAyNDQyNDEzLjUsICAxNC4wDQogIGRhdGEgMjQ0Mjc3OC41LCAgMTUuMA0KICBkYXRhIDI0NDMxNDQuNSwgIDE2LjANCiAgZGF0YSAyNDQzNTA5LjUsICAxNy4wDQogIGRhdGEgMjQ0Mzg3NC41LCAgMTguMA0KICBkYXRhIDI0NDQyMzkuNSwgIDE5LjANCiAgZGF0YSAyNDQ0Nzg2LjUsICAyMC4wDQogIGRhdGEgMjQ0NTE1MS41LCAgMjEuMA0KICBkYXRhIDI0NDU1MTYuNSwgIDIyLjANCiAgZGF0YSAyNDQ2MjQ3LjUsICAyMy4wDQogIGRhdGEgMjQ0NzE2MS41LCAgMjQuMA0KICBkYXRhIDI0NDc4OTIuNSwgIDI1LjANCiAgZGF0YSAyNDQ4MjU3LjUsICAyNi4wDQogIGRhdGEgMjQ0ODgwNC41LCAgMjcuMA0KICBkYXRhIDI0NDkxNjkuNSwgIDI4LjANCiAgZGF0YSAyNDQ5NTM0LjUsICAyOS4wDQogIGRhdGEgMjQ1MDA4My41LCAgMzAuMA0KICBkYXRhIDI0NTA2MzAuNSwgIDMxLjANCiAgZGF0YSAyNDUxMTc5LjUsICAzMi4wDQogIGRhdGEgMjQ1MzczNi41LCAgMzMuMA0KICBkYXRhIDI0NTQ4MzIuNSwgIDM0LjANCiAgREFUQSAyNDU2MTA5LjUsICAzNS4wDQogIGRhdGEgMjQ1NzIwNC41LCAgMzYuMA0KICBkYXRhIDI0NTc3NTQuNSwgIDM3LjANCiAgDQogICcgY2FsZW5kYXIgbW9udGhzDQogIA0KICBtb250aCQoMSkgPSAiSmFudWFyeSINCiAgbW9udGgkKDIpID0gIkZlYnJ1YXJ5Ig0KICBtb250aCQoMykgPSAiTWFyY2giDQogIG1vbnRoJCg0KSA9ICJBcHJpbCINCiAgbW9udGgkKDUpID0gIk1heSINCiAgbW9udGgkKDYpID0gIkp1bmUiDQogIG1vbnRoJCg3KSA9ICJKdWx5Ig0KICBtb250aCQoOCkgPSAiQXVndXN0Ig0KICBtb250aCQoOSkgPSAiU2VwdGVtYmVyIg0KICBtb250aCQoMTApID0gIk9jdG9iZXIiDQogIG1vbnRoJCgxMSkgPSAiTm92ZW1iZXIiDQogIG1vbnRoJCgxMikgPSAiRGVjZW1iZXIiDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgJyBiZWdpbiBzaW11bGF0aW9uDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICANCiAgcHJpbnQgIiAiDQogIHByaW50ICJ0aW1lIG9mIHRoZSBzZWFzb25zIg0KICBwcmludCAiJiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsmIzYxOyYjNjE7JiM2MTsiDQogIHByaW50ICIgIg0KICANCiAgJyByZXF1ZXN0IGNhbGVuZGFyIHllYXINCiAgDQogIHByaW50ICJwbGVhc2UgaW5wdXQgdGhlIGNhbGVuZGFyIHllYXIiDQogIA0KICBpbnB1dCB5ZWFyDQogIA0KICAnIHByb2Nlc3MgZWFjaCBzZWFzb24NCiAgDQogIGZvciBpZXF1c29sJSA9IDEgdG8gNA0KICAgIA0KICAgIHNlbGVjdCBjYXNlIGllcXVzb2wlDQogICAgICAgIA0KICAgICAgY2FzZSAoMSkNCiAgICAgICAgDQogICAgICAgIGNtb250aCA9IDMNCiAgICAgICAgDQogICAgICAgIGRheSA9IDE1DQogICAgICAgIA0KICAgICAgICBqdWxpYW4oY21vbnRoLCBkYXksIHllYXIsIGpkYXlpKQ0KICAgICAgICANCiAgICAgIGNhc2UgKDIpDQogICAgICAgIA0KICAgICAgICBjbW9udGggPSA2DQogICAgICAgIA0KICAgICAgICBkYXkgPSAxNQ0KICAgICAgICANCiAgICAgICAganVsaWFuKGNtb250aCwgZGF5LCB5ZWFyLCBqZGF5aSkNCiAgICAgICAgDQogICAgICAgIGFsb25nMiA9IDAuNSAmIzQyOyBwaQ0KICAgICAgICANCiAgICAgIGNhc2UgKDMpDQogICAgICAgIA0KICAgICAgICBjbW9udGggPSA5DQogICAgICAgIA0KICAgICAgICBkYXkgPSAxNQ0KICAgICAgICANCiAgICAgICAganVsaWFuKGNtb250aCwgZGF5LCB5ZWFyLCBqZGF5aSkNCiAgICAgICAgDQogICAgICBjYXNlICg0KQ0KICAgICAgICANCiAgICAgICAgY21vbnRoID0gMTINCiAgICAgICAgDQogICAgICAgIGRheSA9IDE1DQogICAgICAgIA0KICAgICAgICBqdWxpYW4oY21vbnRoLCBkYXksIHllYXIsIGpkYXlpKQ0KICAgICAgICANCiAgICAgICAgYWxvbmcyID0gMS41ICYjNDI7IHBpDQogICAgICAgIA0KICAgIGVuZCBzZWxlY3QNCiAgICANCiAgICAnIGZpbmQgZXZlbnQNCiAgICANCiAgICB4MSA9IDAuMA0KICAgIA0KICAgIHgyID0gMTAuMA0KICAgIA0KICAgIHJlYWxyb290MSh4MSwgeDIsIDEuMGUtOCwgeHJvb3QsIGZyb290KQ0KICAgIA0KICAgICcgVERCIGp1bGlhbiBkYXkgb2YgZXZlbnQNCiAgICANCiAgICBqZHRkYiA9IGpkYXlpICsgeHJvb3QNCiAgICANCiAgICAnIGNvbXB1dGUgVVRDIGp1bGlhbiBkYXkNCiAgICANCiAgICB0ZGIydXRjKGpkdGRiLCBqZHV0YykNCiAgICANCiAgICAnIHByaW50IHJlc3VsdHMgZm9yIHRoaXMgZXZlbnQNCiAgICANCiAgICBwcmludCAiICINCiAgICANCiAgICBzZWxlY3QgY2FzZSBpZXF1c29sJQ0KICAgICAgICANCiAgICAgIGNhc2UgKDEpDQogICAgICAgIA0KICAgICAgICBwcmludCAic3ByaW5nIGVxdWlub3giDQogICAgICAgIHByaW50ICImIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7Ig0KICAgICAgICANCiAgICAgIGNhc2UgKDIpDQogICAgICAgIA0KICAgICAgICBwcmludCAic3VtbWVyIHNvbHN0aWNlIg0KICAgICAgICBwcmludCAiJiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1Oy0iDQogICAgICAgIA0KICAgICAgY2FzZSAoMykNCiAgICAgICAgDQogICAgICAgIHByaW50ICJmYWxsIGVxdWlub3giDQogICAgICAgIHByaW50ICImIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsiDQogICAgICAgIA0KICAgICAgY2FzZSAoNCkNCiAgICAgICAgDQogICAgICAgIHByaW50ICJ3aW50ZXIgc29sc3RpY2UiDQogICAgICAgIHByaW50ICImIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7LSINCiAgICAgICAgDQogICAgZW5kIHNlbGVjdA0KICAgIA0KICAgIHByaW50ICIgIg0KICAgIA0KICAgIGdkYXRlIChqZHV0YywgY21vbnRoLCBkYXksIHllYXIpDQogICAgDQogICAgcHJpbnQgImNhbGVuZGFyIGRhdGUgICIsIG1vbnRoJChjbW9udGgpLCAiICIsIFNUUiQoaW50KGRheSkpLCAiICIsIHN0ciQoeWVhcikNCiAgICANCiAgICBwcmludCAiICINCiAgICANCiAgICB0aHIwID0gMjQuMCAmIzQyOyAoZGF5IC0gaW50KGRheSkpDQogICAgDQogICAgdGhyID0gaW50KHRocjApDQogICAgDQogICAgdG1pbjAgPSA2MC4wICYjNDI7ICh0aHIwIC0gdGhyKQ0KICAgIA0KICAgIHRtaW4gPSBpbnQodG1pbjApDQogICAgDQogICAgdHNlYyA9IDYwLjAgJiM0MjsgKHRtaW4wIC0gdG1pbikNCiAgICANCiAgICBwcmludCAiVVRDIHRpbWUgICAgICAgIiwgc3RyJCh0aHIpICsgIiBob3VycyAiICsgc3RyJCh0bWluKSArICIgbWludXRlcyAiICsgc3RyJCh0c2VjLCAwLCAyKSArICIgc2Vjb25kcyINCiAgICANCiAgbmV4dCBpZXF1c29sJQ0KICANCiAgcHJpbnQgIiAiDQogIA0KZW5kDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0Kc3ViIGVzZnVuYyh4LCBmeCkNCiAgDQogICcgZXF1aW5veC9zb2xzdGljZSBvYmplY3RpdmUgZnVuY3Rpb24NCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OycNCiAgDQogIGxvY2FsIGpkYXksIHJsc3VuLCByYXNjLCBkZWNsDQogIA0KICBqZGF5ID0gamRheWkgKyB4DQogIA0KICBzb2xhcihqZGF5LCBybHN1biwgcmFzYywgZGVjbCkNCiAgDQogIGlmIChpZXF1c29sJSA9IDEgb3IgaWVxdXNvbCUgPSAzKSB0aGVuDQogICAgDQogICAgZnggPSBkZWNsDQogICAgDQogIGVsc2UNCiAgICANCiAgICBmeCA9IGFsb25nMiAtIHJsc3VuDQogICAgDQogIGVuZCBpZg0KICANCmVuZCBzdWINCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQpzdWIgdGRiMnV0YyAoamR0ZGIsIGpkdXRjKQ0KICANCiAgJyBjb252ZXJ0IFREQiBqdWxpYW4gZGF5IHRvIFVUQyBqdWxpYW4gZGF5IHN1YnJvdXRpbmUNCiAgDQogICcgaW5wdXQNCiAgDQogICcgIGpkdGRiID0gVERCIGp1bGlhbiBkYXkNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBqZHV0YyA9IFVUQyBqdWxpYW4gZGF5DQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsnDQogIA0KICBsb2NhbCB4MSwgeDIsIHhyb290LCBmcm9vdA0KICANCiAgamRzYXZlZCA9IGpkdGRiDQogIA0KICAnIHNldCBsb3dlciBhbmQgdXBwZXIgYm91bmRzDQogIA0KICB4MSA9IGpkc2F2ZWQgLSAwLjENCiAgDQogIHgyID0gamRzYXZlZCArIDAuMQ0KICANCiAgJyBzb2x2ZSBmb3IgVVRDIGp1bGlhbiBkYXkgdXNpbmcgQnJlbnQncyBtZXRob2QNCiAgDQogIHJlYWxyb290Mih4MSwgeDIsIDEuMGUtOCwgeHJvb3QsIGZyb290KQ0KICANCiAgamR1dGMgPSB4cm9vdA0KICANCmVuZCBzdWINCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OycNCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7Jw0KICANCnN1YiBqZGZ1bmMgKGpkaW4sIGZ4KQ0KICANCiAgJyBvYmplY3RpdmUgZnVuY3Rpb24gZm9yIHRkYjJ1dGMNCiAgDQogICcgaW5wdXQNCiAgDQogICcgIGpkaW4gPSBjdXJyZW50IHZhbHVlIGZvciBVVEMganVsaWFuIGRheQ0KICANCiAgJyBvdXRwdXQNCiAgDQogICcgIGZ4ID0gZGVsdGEganVsaWFuIGRheQ0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0KICBsb2NhbCBqZHdyaywgdGFpX3V0Yw0KICANCiAgZmluZGxlYXAoamRpbiwgdGFpX3V0YykNCiAgDQogIHV0YzJ0ZGIoamRpbiwgdGFpX3V0YywgamR3cmspDQogIA0KICBmeCA9IGpkd3JrIC0gamRzYXZlZA0KICANCmVuZCBzdWINCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OycNCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7Jw0KICANCnN1YiBzb2xhciAoamQsIHJsc3VuLCByYXNjLCBkZWNsKQ0KICANCiAgJyBwcmVjaXNpb24gZXBoZW1lcmlzIG9mIHRoZSBTdW4NCiAgDQogICcgaW5wdXQNCiAgDQogICcgIGpkID0ganVsaWFuIGVwaGVtZXJpcyBkYXkNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBybHN1biA9IGVjbGlwdGljIGxvbmdpdHVkZSBvZiB0aGUgc3VuDQogICcgICAgICAgICAgKDAgJmx0Oz0gcmxzdW4gJmx0Oz0gMiBwaSkNCiAgJyAgcmFzYyAgPSByaWdodCBhc2NlbnNpb24gb2YgdGhlIFN1biAocmFkaWFucykNCiAgJyAgICAgICAgICAoMCAmbHQ7PSByYXNjICZsdDs9IDIgcGkpDQogICcgIGRlY2wgID0gZGVjbGluYXRpb24gb2YgdGhlIFN1biAocmFkaWFucykNCiAgJyAgICAgICAgICAoLXBpLzIgJmx0Oz0gZGVjbCAmbHQ7PSBwaS8yKQ0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7Jw0KICANCiAgbG9jYWwgdSwgYTEsIGEyLCBwc2ksIGRlcHMsIG1lcHMsIGVwcywgc2VwcywgY2Vwcw0KICANCiAgbG9jYWwgZGwsIGRyLCB3LCBzcmwsIGNybCwgc3JiLCBjcmIsIHNyYSwgY3JhDQogIA0KICB1ID0gKGpkIC0gMjQ1MTU0NS4wKSAvIDM2NTI1MDAuMA0KICANCiAgJyBjb21wdXRlIG51dGF0aW9uIGluIGxvbmdpdHVkZQ0KICANCiAgYTEgPSAyLjE4ICsgdSAmIzQyOyAoLTMzNzUuNyArIHUgJiM0MjsgMC4zNikNCiAgDQogIGEyID0gMy41MSArIHUgJiM0MjsgKDEyNTY2Ni4zOSArIHUgJiM0MjsgMC4xKQ0KICANCiAgcHNpID0gMC4wMDAwMDAxICYjNDI7ICgtODM0LjAgJiM0Mjsgc2luKGExKSAtIDY0LjAgJiM0Mjsgc2luKGEyKSkNCiAgDQogICcgY29tcHV0ZSBudXRhdGlvbiBpbiBvYmxpcXVpdHkNCiAgDQogIGRlcHMgPSAwLjAwMDAwMDEgJiM0MjsgdSAmIzQyOyAoLTIyNjkzOCArIHUgJiM0MjsgKC03NSArIHUgJiM0MjsgKDk2OTI2ICsgdSAmIzQyOyAoLTI0OTEgLSB1ICYjNDI7IDEyMTA0KSkpKQ0KICANCiAgbWVwcyA9IDAuMDAwMDAwMSAmIzQyOyAoNDA5MDkyOC4wICsgNDQ2LjAgJiM0MjsgY29zKGExKSArIDI4LjAgJiM0MjsgY29zKGEyKSkNCiAgDQogIGVwcyA9IG1lcHMgKyBkZXBzDQogIA0KICBzZXBzID0gc2luKGVwcykNCiAgDQogIGNlcHMgPSBjb3MoZXBzKQ0KICANCiAgZGwgPSAwLjANCiAgDQogIGRyID0gMC4wDQogIA0KICBmb3IgaSUgPSAxIHRvIDUwDQogICAgDQogICAgdyA9IHNhKGklKSArIHNiKGklKSAmIzQyOyB1DQogICAgDQogICAgZGwgPSBkbCArIHNsKGklKSAmIzQyOyBzaW4odykNCiAgICANCiAgICBpZiAoc3IoaSUpICZsdDsmZ3Q7IDAuMCkgdGhlbg0KICAgICAgDQogICAgICBkciA9IGRyICsgc3IoaSUpICYjNDI7IGNvcyh3KQ0KICAgICAgDQogICAgZW5kIGlmDQogICAgDQogIG5leHQgaSUNCiAgDQogIGRsID0gbW9kdWxvKGRsICYjNDI7IDAuMDAwMDAwMSArIDQuOTM1MzkyOSArIDYyODMzLjE5NjE2OCAmIzQyOyB1KQ0KICANCiAgZHIgPSAxNDk1OTc4NzAuNjkxICYjNDI7IChkciAmIzQyOyAwLjAwMDAwMDEgKyAxLjAwMDEwMjYpDQogIA0KICBybHN1biA9IG1vZHVsbyhkbCArIDAuMDAwMDAwMSAmIzQyOyAoLTk5My4wICsgMTcuMCAmIzQyOyBjb3MoMy4xICsgNjI4MzAuMTQgJiM0MjsgdSkpICsgcHNpKQ0KICANCiAgcmIgPSAwLjANCiAgDQogICcgY29tcHV0ZSBnZW9jZW50cmljIGRlY2xpbmF0aW9uIGFuZCByaWdodCBhc2NlbnNpb24NCiAgDQogIGNybCA9IGNvcyhybHN1bikNCiAgc3JsID0gc2luKHJsc3VuKQ0KICBjcmIgPSBjb3MocmIpDQogIHNyYiA9IHNpbihyYikNCiAgDQogIGRlY2wgPSBhc2luKGNlcHMgJiM0Mjsgc3JiICsgc2VwcyAmIzQyOyBjcmIgJiM0Mjsgc3JsKQ0KICANCiAgc3JhID0gLXNlcHMgJiM0Mjsgc3JiICsgY2VwcyAmIzQyOyBjcmIgJiM0Mjsgc3JsDQogIA0KICBjcmEgPSBjcmIgJiM0MjsgY3JsDQogIA0KICByYXNjID0gYXRhbjMoc3JhLCBjcmEpDQogIA0KZW5kIHN1Yg0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0Kc3ViIHJlYWxyb290MSh4MSwgeDIsIHRvbCwgeHJvb3QsIGZyb290KQ0KICANCiAgJyByZWFsIHJvb3Qgb2YgYSBzaW5nbGUgbm9uLWxpbmVhciBmdW5jdGlvbiBzdWJyb3V0aW5lDQogIA0KICAnIGlucHV0DQogIA0KICAnICB4MSAgPSBsb3dlciBib3VuZCBvZiBzZWFyY2ggaW50ZXJ2YWwNCiAgJyAgeDIgID0gdXBwZXIgYm91bmQgb2Ygc2VhcmNoIGludGVydmFsDQogICcgIHRvbCA9IGNvbnZlcmdlbmNlIGNyaXRlciVpYQ0KICANCiAgJyBvdXRwdXQNCiAgDQogICcgIHhyb290ID0gcmVhbCByb290IG9mIGYoeCkgPSAwDQogICcgIGZyb290ID0gZnVuY3Rpb24gdmFsdWUNCiAgDQogICcgbm90ZSYjNTg7IHJlcXVpcmVzIHN1YiBlc2Z1bmMNCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICANCiAgbG9jYWwgZXBzLCBhLCBiLCBjLCBkLCBlLCBmYSwgZmIsIGZjYywgdG9sMQ0KICANCiAgbG9jYWwgeG0sIHAsIHEsIHIsIHMsIHhtaW4sIHRtcA0KICANCiAgZXBzID0gMi4yM2UtMTYNCiAgDQogIGUgPSAwLjANCiAgDQogIGEgPSB4MQ0KICANCiAgYiA9IHgyDQogIA0KICBlc2Z1bmMoYSwgZmEpDQogIA0KICBlc2Z1bmMoYiwgZmIpDQogIA0KICBmY2MgPSBmYg0KICANCiAgZm9yIGl0ZXIlID0gMSB0byA1MA0KICAgIA0KICAgIGlmIChmYiAmIzQyOyBmY2MgJmd0OyAwLjApIHRoZW4NCiAgICAgIA0KICAgICAgYyA9IGENCiAgICAgIA0KICAgICAgZmNjID0gZmENCiAgICAgIA0KICAgICAgZCA9IGIgLSBhDQogICAgICANCiAgICAgIGUgPSBkDQogICAgICANCiAgICBlbmQgaWYNCiAgICANCiAgICBpZiAoYWJzKGZjYykgJmx0OyBhYnMoZmIpKSB0aGVuDQogICAgICANCiAgICAgIGEgPSBiDQogICAgICANCiAgICAgIGIgPSBjDQogICAgICANCiAgICAgIGMgPSBhDQogICAgICANCiAgICAgIGZhID0gZmINCiAgICAgIA0KICAgICAgZmIgPSBmY2MNCiAgICAgIA0KICAgICAgZmNjID0gZmENCiAgICAgIA0KICAgIGVuZCBpZg0KICAgIA0KICAgIHRvbDEgPSAyLjAgJiM0MjsgZXBzICYjNDI7IGFicyhiKSArIDAuNSAmIzQyOyB0b2wNCiAgICANCiAgICB4bSA9IDAuNSAmIzQyOyAoYyAtIGIpDQogICAgDQogICAgaWYgKGFicyh4bSkgJmx0Oz0gdG9sMSBvciBmYiA9IDAuMCkgdGhlbiBleGl0IGZvcg0KICAgIA0KICAgIGlmIChhYnMoZSkgJmd0Oz0gdG9sMSBhbmQgYWJzKGZhKSAmZ3Q7IGFicyhmYikpIHRoZW4NCiAgICAgIA0KICAgICAgcyA9IGZiIC8gZmENCiAgICAgIA0KICAgICAgaWYgKGEgPSBjKSB0aGVuDQogICAgICAgIA0KICAgICAgICBwID0gMi4wICYjNDI7IHhtICYjNDI7IHMNCiAgICAgICAgDQogICAgICAgIHEgPSAxLjAgLSBzDQogICAgICAgIA0KICAgICAgZWxzZQ0KICAgICAgICANCiAgICAgICAgcSA9IGZhIC8gZmNjDQogICAgICAgIA0KICAgICAgICByID0gZmIgLyBmY2MNCiAgICAgICAgDQogICAgICAgIHAgPSBzICYjNDI7ICgyLjAgJiM0MjsgeG0gJiM0MjsgcSAmIzQyOyAocSAtIHIpIC0gKGIgLSBhKSAmIzQyOyAociAtIDEuMCkpDQogICAgICAgIA0KICAgICAgICBxID0gKHEgLSAxLjApICYjNDI7IChyIC0gMS4wKSAmIzQyOyAocyAtIDEuMCkNCiAgICAgICAgDQogICAgICBlbmQgaWYNCiAgICAgIA0KICAgICAgaWYgKHAgJmd0OyAwLjApIHRoZW4gcSA9IC1xDQogICAgICANCiAgICAgIHAgPSBhYnMocCkNCiAgICAgIA0KICAgICAgbWluID0gYWJzKGUgJiM0MjsgcSkNCiAgICAgIA0KICAgICAgdG1wID0gMy4wICYjNDI7IHhtICYjNDI7IHEgLSBhYnModG9sMSAmIzQyOyBxKQ0KICAgICAgDQogICAgICBpZiAobWluICZsdDsgdG1wKSB0aGVuIG1pbiA9IHRtcA0KICAgICAgDQogICAgICBpZiAoMi4wICYjNDI7IHAgJmx0OyBtaW4pIHRoZW4NCiAgICAgICAgDQogICAgICAgIGUgPSBkDQogICAgICAgIA0KICAgICAgICBkID0gcCAvIHENCiAgICAgICAgDQogICAgICBlbHNlDQogICAgICAgIA0KICAgICAgICBkID0geG0NCiAgICAgICAgDQogICAgICAgIGUgPSBkDQogICAgICAgIA0KICAgICAgZW5kIGlmDQogICAgICANCiAgICBlbHNlDQogICAgICANCiAgICAgIGQgPSB4bQ0KICAgICAgDQogICAgICBlID0gZA0KICAgICAgDQogICAgZW5kIGlmDQogICAgDQogICAgYSA9IGINCiAgICANCiAgICBmYSA9IGZiDQogICAgDQogICAgaWYgKGFicyhkKSAmZ3Q7IHRvbDEpIHRoZW4NCiAgICAgIA0KICAgICAgYiA9IGIgKyBkDQogICAgICANCiAgICBlbHNlDQogICAgICANCiAgICAgIGIgPSBiICsgc2duKHhtKSAmIzQyOyB0b2wxDQogICAgICANCiAgICBlbmQgaWYNCiAgICANCiAgICBlc2Z1bmMoYiwgZmIpDQogICAgDQogIG5leHQgaXRlciUNCiAgDQogIGZyb290ID0gZmINCiAgDQogIHhyb290ID0gYg0KICANCmVuZCBzdWINCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICANCnN1YiByZWFscm9vdDIoeDEsIHgyLCB0b2wsIHhyb290LCBmcm9vdCkNCiAgDQogICcgcmVhbCByb290IG9mIGEgc2luZ2xlIG5vbi1saW5lYXIgZnVuY3Rpb24gc3Vicm91dGluZQ0KICANCiAgJyBpbnB1dA0KICANCiAgJyAgeDEgID0gbG93ZXIgYm91bmQgb2Ygc2VhcmNoIGludGVydmFsDQogICcgIHgyICA9IHVwcGVyIGJvdW5kIG9mIHNlYXJjaCBpbnRlcnZhbA0KICAnICB0b2wgPSBjb252ZXJnZW5jZSBjcml0ZXIlaWENCiAgDQogICcgb3V0cHV0DQogIA0KICAnICB4cm9vdCA9IHJlYWwgcm9vdCBvZiBmKHgpID0gMA0KICAnICBmcm9vdCA9IGZ1bmN0aW9uIHZhbHVlDQogIA0KICAnIG5vdGUmIzU4OyByZXF1aXJlcyBzdWIgamRmdW5jDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQogIGxvY2FsIGVwcywgYSwgYiwgYywgZCwgZSwgZmEsIGZiLCBmY2MsIHRvbDENCiAgDQogIGxvY2FsIHhtLCBwLCBxLCByLCBzLCB4bWluLCB0bXANCiAgDQogIGVwcyA9IDIuMjNlLTE2DQogIA0KICBlID0gMC4wDQogIA0KICBhID0geDENCiAgDQogIGIgPSB4Mg0KICANCiAgamRmdW5jKGEsIGZhKQ0KICANCiAgamRmdW5jKGIsIGZiKQ0KICANCiAgZmNjID0gZmINCiAgDQogIGZvciBpdGVyJSA9IDEgdG8gNTANCiAgICANCiAgICBpZiAoZmIgJiM0MjsgZmNjICZndDsgMC4wKSB0aGVuDQogICAgICANCiAgICAgIGMgPSBhDQogICAgICANCiAgICAgIGZjYyA9IGZhDQogICAgICANCiAgICAgIGQgPSBiIC0gYQ0KICAgICAgDQogICAgICBlID0gZA0KICAgICAgDQogICAgZW5kIGlmDQogICAgDQogICAgaWYgKGFicyhmY2MpICZsdDsgYWJzKGZiKSkgdGhlbg0KICAgICAgDQogICAgICBhID0gYg0KICAgICAgDQogICAgICBiID0gYw0KICAgICAgDQogICAgICBjID0gYQ0KICAgICAgDQogICAgICBmYSA9IGZiDQogICAgICANCiAgICAgIGZiID0gZmNjDQogICAgICANCiAgICAgIGZjYyA9IGZhDQogICAgICANCiAgICBlbmQgaWYNCiAgICANCiAgICB0b2wxID0gMi4wICYjNDI7IGVwcyAmIzQyOyBhYnMoYikgKyAwLjUgJiM0MjsgdG9sDQogICAgDQogICAgeG0gPSAwLjUgJiM0MjsgKGMgLSBiKQ0KICAgIA0KICAgIGlmIChhYnMoeG0pICZsdDs9IHRvbDEgb3IgZmIgPSAwKSB0aGVuIGV4aXQgZm9yDQogICAgDQogICAgaWYgKGFicyhlKSAmZ3Q7PSB0b2wxIGFuZCBhYnMoZmEpICZndDsgYWJzKGZiKSkgdGhlbg0KICAgICAgDQogICAgICBzID0gZmIgLyBmYQ0KICAgICAgDQogICAgICBpZiAoYSA9IGMpIHRoZW4NCiAgICAgICAgDQogICAgICAgIHAgPSAyLjAgJiM0MjsgeG0gJiM0Mjsgcw0KICAgICAgICANCiAgICAgICAgcSA9IDEuMCAtIHMNCiAgICAgICAgDQogICAgICBlbHNlDQogICAgICAgIA0KICAgICAgICBxID0gZmEgLyBmY2MNCiAgICAgICAgDQogICAgICAgIHIgPSBmYiAvIGZjYw0KICAgICAgICANCiAgICAgICAgcCA9IHMgJiM0MjsgKDIuMCAmIzQyOyB4bSAmIzQyOyBxICYjNDI7IChxIC0gcikgLSAoYiAtIGEpICYjNDI7IChyIC0gMS4wKSkNCiAgICAgICAgDQogICAgICAgIHEgPSAocSAtIDEuMCkgJiM0MjsgKHIgLSAxLjApICYjNDI7IChzIC0gMS4wKQ0KICAgICAgICANCiAgICAgIGVuZCBpZg0KICAgICAgDQogICAgICBpZiAocCAmZ3Q7IDApIHRoZW4gcSA9IC1xDQogICAgICANCiAgICAgIHAgPSBhYnMocCkNCiAgICAgIA0KICAgICAgeG1pbiA9IGFicyhlICYjNDI7IHEpDQogICAgICANCiAgICAgIHRtcCA9IDMuMCAmIzQyOyB4bSAmIzQyOyBxIC0gYWJzKHRvbDEgJiM0MjsgcSkNCiAgICAgIA0KICAgICAgaWYgKHhtaW4gJmx0OyB0bXApIHRoZW4geG1pbiA9IHRtcA0KICAgICAgDQogICAgICBpZiAoMi4wICYjNDI7IHAgJmx0OyB4bWluKSB0aGVuDQogICAgICAgIA0KICAgICAgICBlID0gZA0KICAgICAgICANCiAgICAgICAgZCA9IHAgLyBxDQogICAgICAgIA0KICAgICAgZWxzZQ0KICAgICAgICANCiAgICAgICAgZCA9IHhtDQogICAgICAgIA0KICAgICAgICBlID0gZA0KICAgICAgICANCiAgICAgIGVuZCBpZg0KICAgICAgDQogICAgZWxzZQ0KICAgICAgDQogICAgICBkID0geG0NCiAgICAgIA0KICAgICAgZSA9IGQNCiAgICAgIA0KICAgIGVuZCBpZg0KICAgIA0KICAgIGEgPSBiDQogICAgDQogICAgZmEgPSBmYg0KICAgIA0KICAgIGlmIChhYnMoZCkgJmd0OyB0b2wxKSB0aGVuDQogICAgICANCiAgICAgIGIgPSBiICsgZA0KICAgICAgDQogICAgZWxzZQ0KICAgICAgDQogICAgICBiID0gYiArIHNnbih4bSkgJiM0MjsgdG9sMQ0KICAgICAgDQogICAgZW5kIGlmDQogICAgDQogICAgamRmdW5jKGIsIGZiKQ0KICAgIA0KICBuZXh0IGl0ZXIlDQogIA0KICBmcm9vdCA9IGZiDQogIA0KICB4cm9vdCA9IGINCiAgDQplbmQgc3ViDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQpzdWIganVsaWFuKG1vbnRoLCBkYXksIHllYXIsIGpkYXkpDQogIA0KICAnIEdyZWdvcmlhbiBkYXRlIHRvIGp1bGlhbiBkYXkgc3Vicm91dGluZQ0KICANCiAgJyBpbnB1dA0KICANCiAgJyAgbW9udGggPSBjYWxlbmRhciBtb250aA0KICAnICBkYXkgICA9IGNhbGVuZGFyIGRheQ0KICAnICB5ZWFyICA9IGNhbGVuZGFyIHllYXIgKGFsbCBmb3VyIGRpZ2l0cykNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBqZGF5ID0ganVsaWFuIGRheQ0KICANCiAgJyBzcGVjaWFsIG5vdGVzDQogIA0KICAnICAoMSkgY2FsZW5kYXIgeWVhciBtdXN0IGluY2x1ZGUgYWxsIGRpZ2l0cw0KICANCiAgJyAgKDIpIHdpbGwgcmVwb3J0IE9jdG9iZXIgNSwgMTU4MiB0byBPY3RvYmVyIDE0LCAxNTgyDQogICcgICAgICBhcyBpbnZhbGlkIGNhbGVuZGFyIGRhdGVzIGFuZCBleGl0DQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0KICBsb2NhbCBhLCBiLCBjLCBtLCB5DQogIA0KICB5ID0geWVhcg0KICANCiAgbSA9IG1vbnRoDQogIA0KICBiID0gMC4wDQogIA0KICBjID0gMC4wDQogIA0KICBpZiAobSAmbHQ7PSAyLjApIHRoZW4NCiAgICANCiAgICB5ID0geSAtIDEuMA0KICAgIA0KICAgIG0gPSBtICsgMTIuMA0KICAgIA0KICBlbmQgaWYNCiAgDQogIGlmICh5ICZsdDsgMC4wKSB0aGVuIGMgPSAtMC43NQ0KICANCiAgaWYgKHllYXIgJmx0OyAxNTgyLjApIHRoZW4NCiAgICANCiAgICAnIG51bGwNCiAgICANCiAgZWxzZWlmICh5ZWFyICZndDsgMTU4Mi4wKSB0aGVuDQogICAgDQogICAgYSA9IGZpeCh5IC8gMTAwLjApDQogICAgDQogICAgYiA9IDIuMCAtIGEgKyBmaXgoYSAvIDQuMCkNCiAgICANCiAgZWxzZWlmIChtb250aCAmbHQ7IDEwLjApIHRoZW4NCiAgICANCiAgICAnIG51bGwNCiAgICANCiAgZWxzZWlmIChtb250aCAmZ3Q7IDEwLjApIHRoZW4NCiAgICANCiAgICBhID0gZml4KHkgLyAxMDAuMCkNCiAgICANCiAgICBiID0gMi4wIC0gYSArIGZpeChhIC8gNC4wKQ0KICAgIA0KICBlbHNlaWYgKGRheSAmbHQ7PSA0LjApIHRoZW4NCiAgICANCiAgICAnIG51bGwNCiAgICANCiAgZWxzZWlmIChkYXkgJmd0OyAxNC4wKSB0aGVuDQogICAgDQogICAgYSA9IGZpeCh5IC8gMTAwLjApDQogICAgDQogICAgYiA9IDIuMCAtIGEgKyBmaXgoYSAvIDQuMCkNCiAgICANCiAgZWxzZQ0KICAgIA0KICAgIHByaW50ICJ0aGlzIGRhdGUgZG9lcyBub3QgZXhpc3QhISINCiAgICANCiAgICBleGl0DQogICAgDQogIGVuZCBpZg0KICANCiAgamRheSA9IGZpeCgzNjUuMjUgJiM0MjsgeSArIGMpICsgZml4KDMwLjYwMDEgJiM0MjsgKG0gKyAxLjApKSArIGRheSArIGIgKyAxNzIwOTk0LjUNCiAgDQplbmQgc3ViDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQpzdWIgZ2RhdGUgKGpkYXksIG1vbnRoLCBkYXksIHllYXIpDQogIA0KICAnIEp1bGlhbiBkYXkgdG8gR3JlZ29yaWFuIGRhdGUgc3Vicm91dGluZQ0KICANCiAgJyBpbnB1dA0KICANCiAgJyAgamRheSA9IGp1bGlhbiBkYXkNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBtb250aCA9IGNhbGVuZGFyIG1vbnRoDQogICcgIGRheSAgID0gY2FsZW5kYXIgZGF5DQogICcgIHllYXIgID0gY2FsZW5kYXIgeWVhcg0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0KICBsb2NhbCBhLCBiLCBjLCBkLCBlLCBmLCB6LCBhbHBoYQ0KICANCiAgeiA9IGZpeChqZGF5ICsgMC41KQ0KICANCiAgZiA9IGpkYXkgKyAwLjUgLSB6DQogIA0KICBpZiAoeiAmbHQ7IDIyOTkxNjEpIHRoZW4NCiAgICANCiAgICBhID0geg0KICAgIA0KICBlbHNlDQogICAgDQogICAgYWxwaGEgPSBmaXgoKHogLSAxODY3MjE2LjI1KSAvIDM2NTI0LjI1KQ0KICAgIA0KICAgIGEgPSB6ICsgMS4wICsgYWxwaGEgLSBmaXgoYWxwaGEgLyA0LjApDQogICAgDQogIGVuZCBpZg0KICANCiAgYiA9IGEgKyAxNTI0LjANCiAgDQogIGMgPSBmaXgoKGIgLSAxMjIuMSkgLyAzNjUuMjUpDQogIA0KICBkID0gZml4KDM2NS4yNSAmIzQyOyBjKQ0KICANCiAgZSA9IGZpeCgoYiAtIGQpIC8gMzAuNjAwMSkNCiAgDQogIGRheSA9IGIgLSBkIC0gZml4KDMwLjYwMDEgJiM0MjsgZSkgKyBmDQogIA0KICBpZiAoZSAmbHQ7IDEzLjUpIHRoZW4NCiAgICANCiAgICBtb250aCA9IGUgLSAxLjANCiAgICANCiAgZWxzZQ0KICAgIA0KICAgIG1vbnRoID0gZSAtIDEzLjANCiAgICANCiAgZW5kIGlmDQogIA0KICBpZiAobW9udGggJmd0OyAyLjUpIHRoZW4NCiAgICANCiAgICB5ZWFyID0gYyAtIDQ3MTYuMA0KICAgIA0KICBlbHNlDQogICAgDQogICAgeWVhciA9IGMgLSA0NzE1LjANCiAgICANCiAgZW5kIGlmDQogIA0KZW5kIHN1Yg0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICANCnN1YiB1dGMydGRiIChqZHV0YywgdGFpX3V0YywgamR0ZGIpDQogIA0KICAnIGNvbnZlcnQgVVRDIGp1bGlhbiBkYXRlIHRvIFREQiBqdWxpYW4gZGF0ZQ0KICANCiAgJyBpbnB1dA0KICANCiAgJyAgamR1dGMgICA9IFVUQyBqdWxpYW4gZGF5DQogICcgIHRhaV91dGMgPSBUQUktVVRDIChzZWNvbmRzKQ0KICANCiAgJyBvdXRwdXQNCiAgDQogICcgIGpkdGRiID0gVERCIGp1bGlhbiBkYXkNCiAgDQogICcgUmVmZXJlbmNlIEZyYW1lcyBpbiBBc3Ryb25vbXkgYW5kIEdlb3BoeXNpY3MNCiAgJyBKLiBLb3ZhbGV2c2t5IGV0IGFsLiwgMTk4OSwgcHAuIDQzOS00NDINCiAgDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQogIGxvY2FsIGNvcnIsIGpkdGR0LCB0DQogIA0KICAnIFREVCBqdWxpYW4gZGF0ZQ0KICANCiAgY29yciA9ICh0YWlfdXRjICsgMzIuMTg0KSAvIDg2NDAwLjANCiAgDQogIGpkdGR0ID0gamR1dGMgKyBjb3JyDQogIA0KICAnIHRpbWUgYXJndW1lbnQgZm9yIGNvcnJlY3Rpb24NCiAgDQogIHQgPSAoamR0ZHQgLSAyNDUxNTQ1LjApIC8gMzY1MjUuMA0KICANCiAgJyBjb21wdXRlIGNvcnJlY3Rpb24gaW4gbWljcm9zZWNvbmRzDQogIA0KICBjb3JyID0gMTY1Ni42NzUgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMzU5OTkuMzcyOSAmIzQyOyB0ICsgMzU3LjUyODcpKQ0KICBjb3JyID0gY29yciArIDIyLjQxOCAgICAgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMzI5NjQuNDY3ICAmIzQyOyB0ICsgMjQ2LjE5OSkpDQogIGNvcnIgPSBjb3JyICsgMTMuODQgICAgICAmIzQyOyBzaW4oZHRyICYjNDI7ICg3MTk5OC43NDYgICYjNDI7IHQgKyAzNTUuMDU3KSkNCiAgY29yciA9IGNvcnIgKyAgNC43NyAgICAgICYjNDI7IHNpbihkdHIgJiM0MjsgKCAzMDM0LjkwNiAgJiM0MjsgdCArICAyNS40NjMpKQ0KICBjb3JyID0gY29yciArICA0LjY3NyAgICAgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMzQ3NzcuMjU5ICAmIzQyOyB0ICsgMjMwLjM5NCkpDQogIGNvcnIgPSBjb3JyICsgMTAuMjE2ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMzU5OTkuMzczICAmIzQyOyB0ICsgMjQzLjQ1MSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMTcxICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoNzE5OTguNzQ2ICAmIzQyOyB0ICsgMjQwLjk4ICkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDI3ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoIDEyMjIuMTE0ICAmIzQyOyB0ICsgMTk0LjY2MSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDI3ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoIDMwMzQuOTA2ICAmIzQyOyB0ICsgMzM2LjA2MSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDI2ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoICAtMjAuMTg2ICAmIzQyOyB0ICsgICA5LjM4MikpDQogIGNvcnIgPSBjb3JyICsgIDAuMDA3ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMjk5MjkuNTYyICAmIzQyOyB0ICsgMjY0LjkxMSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDA2ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoICAxNTAuNjc4ICAmIzQyOyB0ICsgIDU5Ljc3NSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDA1ICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoIDkwMzcuNTEzICAmIzQyOyB0ICsgMjU2LjAyNSkpDQogIGNvcnIgPSBjb3JyICsgIDAuMDQzICYjNDI7IHQgJiM0Mjsgc2luKGR0ciAmIzQyOyAoMzU5OTkuMzczICAmIzQyOyB0ICsgMTUxLjEyMSkpDQogIA0KICAnIGNvbnZlcnQgY29ycmVjdGlvbnMgdG8gZGF5cw0KICANCiAgY29yciA9IDAuMDAwMDAxICYjNDI7IGNvcnIgLyA4NjQwMC4wDQogIA0KICAnIFREQiBqdWxpYW4gZGF0ZQ0KICANCiAgamR0ZGIgPSBqZHRkdCArIGNvcnINCiAgDQplbmQgc3ViDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsnDQogICYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OycNCiAgDQpzdWIgZmluZGxlYXAoamRheSwgbGVhcHNlY29uZCkNCiAgDQogICcgZmluZCBudW1iZXIgb2YgbGVhcCBzZWNvbmRzIGZvciB1dGMganVsaWFuIGRheQ0KICANCiAgJyBpbnB1dA0KICANCiAgJyAgamRheSA9IHV0YyBqdWxpYW4gZGF5DQogIA0KICAnIGlucHV0IHZpYSBnbG9iYWwNCiAgDQogICcgIGpkbGVhcCAgPSBhcnJheSBvZiB1dGMganVsaWFuIGRhdGVzDQogICcgIGxlYXBzZWMgPSBhcnJheSBvZiBsZWFwIHNlY29uZHMNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBsZWFwc2Vjb25kID0gbnVtYmVyIG9mIGxlYXAgc2Vjb25kcw0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5Ow0KICANCiAgaWYgKGpkYXkgJmx0Oz0gamRsZWFwKDEpKSB0aGVuDQogICAgDQogICAgJyBkYXRlIGlzICZsdDs9IDE5NzI7IHNldCB0byBmaXJzdCBkYXRhIGVsZW1lbnQNCiAgICANCiAgICBsZWFwc2Vjb25kID0gbGVhcHNlYygxKQ0KICAgIA0KICAgIGV4aXQgc3ViDQogICAgDQogIGVuZCBpZg0KICANCiAgaWYgKGpkYXkgJmd0Oz0gamRsZWFwKDI4KSkgdGhlbg0KICAgIA0KICAgICcgZGF0ZSBpcyAmZ3Q7PSBlbmQgb2YgY3VycmVudCBkYXRhDQogICAgJyBzZXQgdG8gbGFzdCBkYXRhIGVsZW1lbnQNCiAgICANCiAgICBsZWFwc2Vjb25kID0gbGVhcHNlYygyOCkNCiAgICANCiAgICBleGl0IHN1Yg0KICAgIA0KICBlbmQgaWYNCiAgDQogICcgZmluZCBkYXRhIHdpdGhpbiB0YWJsZQ0KICANCiAgZm9yIGklID0gMSB0byAyNw0KICAgIA0KICAgIGlmIChqZGF5ICZndDs9IGpkbGVhcChpJSkgYW5kIGpkYXkgJmx0OyBqZGxlYXAoaSUgKyAxKSkgdGhlbg0KICAgICAgDQogICAgICBsZWFwc2Vjb25kID0gbGVhcHNlYyhpJSkNCiAgICAgIA0KICAgICAgZXhpdCBzdWINCiAgICAgIA0KICAgIGVuZCBpZg0KICAgIA0KICBuZXh0IGklDQogIA0KZW5kIHN1Yg0KICANCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7Jw0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsnDQogIA0KZnVuY3Rpb24gbW9kdWxvKHgpIGFzIGZsb2F0DQogIA0KICAnIG1vZHVsbyAyIHBpIGZ1bmN0aW9uDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsnDQogIA0KICBsb2NhbCBhDQogIA0KICBhID0geCAtIHBpMiAmIzQyOyBmaXgoeCAvIHBpMikNCiAgDQogIGlmIChhICZsdDsgMC4wKSB0aGVuDQogICAgDQogICAgYSA9IGEgKyBwaTINCiAgICANCiAgZW5kIGlmDQogIA0KICBtb2R1bG8gPSBhDQogIA0KZW5kIGZ1bmN0aW9uDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgJiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7DQogIA0KZnVuY3Rpb24gYXRhbjMoYSwgYikgYXMgZmxvYXQNCiAgDQogICcgZm91ciBxdWFkcmFudCBpbnZlcnNlIHRhbmdlbnQgZnVuY3Rpb24NCiAgDQogICcgaW5wdXQNCiAgDQogICcgIGEgPSBzaW5lIG9mIGFuZ2xlDQogICcgIGIgPSBjb3NpbmUgb2YgYW5nbGUNCiAgDQogICcgb3V0cHV0DQogIA0KICAnICBhdGFuMyA9IGFuZ2xlICgwID0mbHQ7IGF0YW4zICZsdDs9IDIgJiM0MjsgcGk7IHJhZGlhbnMpDQogIA0KICAmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsmIzM5OyYjMzk7JiMzOTsNCiAgDQogIGxvY2FsIGMNCiAgDQogIGlmIChhYnMoYSkgJmx0OyAxLjBlLTEwKSB0aGVuDQogICAgDQogICAgYXRhbjMgPSAoMS4wIC0gc2duKGIpKSAmIzQyOyBwaWRpdjINCiAgICANCiAgICBleGl0IGZ1bmN0aW9uDQogICAgDQogIGVsc2UNCiAgICANCiAgICBjID0gKDIuMCAtIHNnbihhKSkgJiM0MjsgcGlkaXYyDQogICAgDQogIGVuZGlmDQogIA0KICBpZiAoYWJzKGIpICZsdDsgMS4wZS0xMCkgdGhlbg0KICAgIA0KICAgIGF0YW4zID0gYw0KICAgIA0KICAgIGV4aXQgZnVuY3Rpb24NCiAgICANCiAgZWxzZQ0KICAgIA0KICAgIGF0YW4zID0gYyArIHNnbihhKSAmIzQyOyBzZ24oYikgJiM0MjsgKGFicyhhdG4oYSAvIGIpKSAtIHBpZGl2MikNCiAgICANCiAgZW5kaWYNCiAgDQplbmQgZnVuY3Rpb24NCg0KPC9wcmU+PGJyIC8+ICBkZCdd3H37cumIAabZUiEhRcc01+/t" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">MMX - time of the seasons</h1><small>Modified on 2018/12/04 22:43 by Administrator &mdash; Categorized as: Dates, Time and Clocks</small><br /><br /><pre>

  ' seasons.bas         March 6, 2017
  
  ' calendar date and UTC time of the seasons
  
  ' Micromite eXtreme version
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  ' dimension global arrays
  
  dim sl(50) as float, sr(50) as float, sa(50) as float, sb(50) as float
  
  dim jdleap(28) as float, leapsec(28) as float, month$(12) as string
  
  ' global constants
  
  const pi2 = 2.0 &#42; pi, pidiv2 = 0.5 &#42; pi, dtr = pi / 180.0
  
  ' read solar ephemeris data
  
  for i% = 1 to 50
    
    read sl(i%), sr(i%), sa(i%), sb(i%)
    
  next i%
  
  data 403406,      0, 4.721964,      1.621043
  data 195207, -97597, 5.937458,  62830.348067
  data 119433, -59715, 1.115589,  62830.821524
  data 112392, -56188, 5.781616,  62829.634302
  data   3891,  -1556, 5.5474  , 125660.5691
  data   2819,  -1126, 1.5120  , 125660.9845
  data   1721,   -861, 4.1897  ,  62832.4766
  data      0,    941, 1.163   ,      0.813
  data    660,   -264, 5.415   , 125659.310
  data    350,   -163, 4.315   ,  57533.850
  data    334,      0, 4.553   ,    -33.931
  data    314,    309, 5.198   , 777137.715
  data    268,   -158, 5.989   ,  78604.191
  data    242,      0, 2.911   ,      5.412
  data    234,    -54, 1.423   ,  39302.098
  data    158,      0, 0.061   ,    -34.861
  data    132,    -93, 2.317   , 115067.698
  data    129,    -20, 3.193   ,  15774.337
  data    114,      0, 2.828   ,   5296.670
  data     99,    -47, 0.52    ,  58849.27
  data     93,      0, 4.65    ,   5296.11
  data     86,      0, 4.35    ,  -3980.70
  data     78,    -33, 2.75    ,  52237.69
  data     72,    -32, 4.50    ,  55076.47
  data     68,      0, 3.23    ,    261.08
  data     64,    -10, 1.22    ,  15773.85
  data     46,    -16, 0.14    , 188491.03
  data     38,      0, 3.44    ,  -7756.55
  data     37,      0, 4.37    ,    264.89
  data     32,    -24, 1.14    , 117906.27
  data     29,    -13, 2.84    ,  55075.75
  data     28,      0, 5.96    ,  -7961.39
  data     27,     -9, 5.09    , 188489.81
  data     27,      0, 1.72    ,   2132.19
  data     25,    -17, 2.56    , 109771.03
  data     24,    -11, 1.92    ,  54868.56
  data     21,      0, 0.09    ,  25443.93
  data     21,     31, 5.98    , -55731.43
  data     20,    -10, 4.03    ,  60697.74
  data     18,      0, 4.27    ,   2132.79
  data     17,    -12, 0.79    , 109771.63
  data     14,      0, 4.24    ,  -7752.82
  data     13,     -5, 2.01    , 188491.91
  data     13,      0, 2.65    ,    207.81
  data     13,      0, 4.98    ,  29424.63
  data     12,      0, 0.93    ,     -7.99
  data     10,      0, 2.21    ,  46941.14
  data     10,      0, 3.59    ,    -68.29
  data     10,      0, 1.50    ,  21463.25
  data     10,     -9, 2.55    , 157208.40
  
  ' read leap second data
  
  for i% = 1 to 28
    
    read jdleap(i%), leapsec(i%)
    
  next i%
  
  data 2441317.5,  10.0
  data 2441499.5,  11.0
  data 2441683.5,  12.0
  data 2442048.5,  13.0
  data 2442413.5,  14.0
  data 2442778.5,  15.0
  data 2443144.5,  16.0
  data 2443509.5,  17.0
  data 2443874.5,  18.0
  data 2444239.5,  19.0
  data 2444786.5,  20.0
  data 2445151.5,  21.0
  data 2445516.5,  22.0
  data 2446247.5,  23.0
  data 2447161.5,  24.0
  data 2447892.5,  25.0
  data 2448257.5,  26.0
  data 2448804.5,  27.0
  data 2449169.5,  28.0
  data 2449534.5,  29.0
  data 2450083.5,  30.0
  data 2450630.5,  31.0
  data 2451179.5,  32.0
  data 2453736.5,  33.0
  data 2454832.5,  34.0
  DATA 2456109.5,  35.0
  data 2457204.5,  36.0
  data 2457754.5,  37.0
  
  ' calendar months
  
  month$(1) = "January"
  month$(2) = "February"
  month$(3) = "March"
  month$(4) = "April"
  month$(5) = "May"
  month$(6) = "June"
  month$(7) = "July"
  month$(8) = "August"
  month$(9) = "September"
  month$(10) = "October"
  month$(11) = "November"
  month$(12) = "December"
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  ' begin simulation
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  print " "
  print "time of the seasons"
  print "&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;"
  print " "
  
  ' request calendar year
  
  print "please input the calendar year"
  
  input year
  
  ' process each season
  
  for iequsol% = 1 to 4
    
    select case iequsol%
        
      case (1)
        
        cmonth = 3
        
        day = 15
        
        julian(cmonth, day, year, jdayi)
        
      case (2)
        
        cmonth = 6
        
        day = 15
        
        julian(cmonth, day, year, jdayi)
        
        along2 = 0.5 &#42; pi
        
      case (3)
        
        cmonth = 9
        
        day = 15
        
        julian(cmonth, day, year, jdayi)
        
      case (4)
        
        cmonth = 12
        
        day = 15
        
        julian(cmonth, day, year, jdayi)
        
        along2 = 1.5 &#42; pi
        
    end select
    
    ' find event
    
    x1 = 0.0
    
    x2 = 10.0
    
    realroot1(x1, x2, 1.0e-8, xroot, froot)
    
    ' TDB julian day of event
    
    jdtdb = jdayi + xroot
    
    ' compute UTC julian day
    
    tdb2utc(jdtdb, jdutc)
    
    ' print results for this event
    
    print " "
    
    select case iequsol%
        
      case (1)
        
        print "spring equinox"
        print "&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;"
        
      case (2)
        
        print "summer solstice"
        print "&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-"
        
      case (3)
        
        print "fall equinox"
        print "&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;"
        
      case (4)
        
        print "winter solstice"
        print "&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-"
        
    end select
    
    print " "
    
    gdate (jdutc, cmonth, day, year)
    
    print "calendar date  ", month$(cmonth), " ", STR$(int(day)), " ", str$(year)
    
    print " "
    
    thr0 = 24.0 &#42; (day - int(day))
    
    thr = int(thr0)
    
    tmin0 = 60.0 &#42; (thr0 - thr)
    
    tmin = int(tmin0)
    
    tsec = 60.0 &#42; (tmin0 - tmin)
    
    print "UTC time       ", str$(thr) + " hours " + str$(tmin) + " minutes " + str$(tsec, 0, 2) + " seconds"
    
  next iequsol%
  
  print " "
  
end
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub esfunc(x, fx)
  
  ' equinox/solstice objective function
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
  local jday, rlsun, rasc, decl
  
  jday = jdayi + x
  
  solar(jday, rlsun, rasc, decl)
  
  if (iequsol% = 1 or iequsol% = 3) then
    
    fx = decl
    
  else
    
    fx = along2 - rlsun
    
  end if
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub tdb2utc (jdtdb, jdutc)
  
  ' convert TDB julian day to UTC julian day subroutine
  
  ' input
  
  '  jdtdb = TDB julian day
  
  ' output
  
  '  jdutc = UTC julian day
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
  local x1, x2, xroot, froot
  
  jdsaved = jdtdb
  
  ' set lower and upper bounds
  
  x1 = jdsaved - 0.1
  
  x2 = jdsaved + 0.1
  
  ' solve for UTC julian day using Brent's method
  
  realroot2(x1, x2, 1.0e-8, xroot, froot)
  
  jdutc = xroot
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
sub jdfunc (jdin, fx)
  
  ' objective function for tdb2utc
  
  ' input
  
  '  jdin = current value for UTC julian day
  
  ' output
  
  '  fx = delta julian day
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local jdwrk, tai_utc
  
  findleap(jdin, tai_utc)
  
  utc2tdb(jdin, tai_utc, jdwrk)
  
  fx = jdwrk - jdsaved
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
sub solar (jd, rlsun, rasc, decl)
  
  ' precision ephemeris of the Sun
  
  ' input
  
  '  jd = julian ephemeris day
  
  ' output
  
  '  rlsun = ecliptic longitude of the sun
  '          (0 &lt;= rlsun &lt;= 2 pi)
  '  rasc  = right ascension of the Sun (radians)
  '          (0 &lt;= rasc &lt;= 2 pi)
  '  decl  = declination of the Sun (radians)
  '          (-pi/2 &lt;= decl &lt;= pi/2)
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
  local u, a1, a2, psi, deps, meps, eps, seps, ceps
  
  local dl, dr, w, srl, crl, srb, crb, sra, cra
  
  u = (jd - 2451545.0) / 3652500.0
  
  ' compute nutation in longitude
  
  a1 = 2.18 + u &#42; (-3375.7 + u &#42; 0.36)
  
  a2 = 3.51 + u &#42; (125666.39 + u &#42; 0.1)
  
  psi = 0.0000001 &#42; (-834.0 &#42; sin(a1) - 64.0 &#42; sin(a2))
  
  ' compute nutation in obliquity
  
  deps = 0.0000001 &#42; u &#42; (-226938 + u &#42; (-75 + u &#42; (96926 + u &#42; (-2491 - u &#42; 12104))))
  
  meps = 0.0000001 &#42; (4090928.0 + 446.0 &#42; cos(a1) + 28.0 &#42; cos(a2))
  
  eps = meps + deps
  
  seps = sin(eps)
  
  ceps = cos(eps)
  
  dl = 0.0
  
  dr = 0.0
  
  for i% = 1 to 50
    
    w = sa(i%) + sb(i%) &#42; u
    
    dl = dl + sl(i%) &#42; sin(w)
    
    if (sr(i%) &lt;&gt; 0.0) then
      
      dr = dr + sr(i%) &#42; cos(w)
      
    end if
    
  next i%
  
  dl = modulo(dl &#42; 0.0000001 + 4.9353929 + 62833.196168 &#42; u)
  
  dr = 149597870.691 &#42; (dr &#42; 0.0000001 + 1.0001026)
  
  rlsun = modulo(dl + 0.0000001 &#42; (-993.0 + 17.0 &#42; cos(3.1 + 62830.14 &#42; u)) + psi)
  
  rb = 0.0
  
  ' compute geocentric declination and right ascension
  
  crl = cos(rlsun)
  srl = sin(rlsun)
  crb = cos(rb)
  srb = sin(rb)
  
  decl = asin(ceps &#42; srb + seps &#42; crb &#42; srl)
  
  sra = -seps &#42; srb + ceps &#42; crb &#42; srl
  
  cra = crb &#42; crl
  
  rasc = atan3(sra, cra)
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub realroot1(x1, x2, tol, xroot, froot)
  
  ' real root of a single non-linear function subroutine
  
  ' input
  
  '  x1  = lower bound of search interval
  '  x2  = upper bound of search interval
  '  tol = convergence criter%ia
  
  ' output
  
  '  xroot = real root of f(x) = 0
  '  froot = function value
  
  ' note&#58; requires sub esfunc
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local eps, a, b, c, d, e, fa, fb, fcc, tol1
  
  local xm, p, q, r, s, xmin, tmp
  
  eps = 2.23e-16
  
  e = 0.0
  
  a = x1
  
  b = x2
  
  esfunc(a, fa)
  
  esfunc(b, fb)
  
  fcc = fb
  
  for iter% = 1 to 50
    
    if (fb &#42; fcc &gt; 0.0) then
      
      c = a
      
      fcc = fa
      
      d = b - a
      
      e = d
      
    end if
    
    if (abs(fcc) &lt; abs(fb)) then
      
      a = b
      
      b = c
      
      c = a
      
      fa = fb
      
      fb = fcc
      
      fcc = fa
      
    end if
    
    tol1 = 2.0 &#42; eps &#42; abs(b) + 0.5 &#42; tol
    
    xm = 0.5 &#42; (c - b)
    
    if (abs(xm) &lt;= tol1 or fb = 0.0) then exit for
    
    if (abs(e) &gt;= tol1 and abs(fa) &gt; abs(fb)) then
      
      s = fb / fa
      
      if (a = c) then
        
        p = 2.0 &#42; xm &#42; s
        
        q = 1.0 - s
        
      else
        
        q = fa / fcc
        
        r = fb / fcc
        
        p = s &#42; (2.0 &#42; xm &#42; q &#42; (q - r) - (b - a) &#42; (r - 1.0))
        
        q = (q - 1.0) &#42; (r - 1.0) &#42; (s - 1.0)
        
      end if
      
      if (p &gt; 0.0) then q = -q
      
      p = abs(p)
      
      min = abs(e &#42; q)
      
      tmp = 3.0 &#42; xm &#42; q - abs(tol1 &#42; q)
      
      if (min &lt; tmp) then min = tmp
      
      if (2.0 &#42; p &lt; min) then
        
        e = d
        
        d = p / q
        
      else
        
        d = xm
        
        e = d
        
      end if
      
    else
      
      d = xm
      
      e = d
      
    end if
    
    a = b
    
    fa = fb
    
    if (abs(d) &gt; tol1) then
      
      b = b + d
      
    else
      
      b = b + sgn(xm) &#42; tol1
      
    end if
    
    esfunc(b, fb)
    
  next iter%
  
  froot = fb
  
  xroot = b
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub realroot2(x1, x2, tol, xroot, froot)
  
  ' real root of a single non-linear function subroutine
  
  ' input
  
  '  x1  = lower bound of search interval
  '  x2  = upper bound of search interval
  '  tol = convergence criter%ia
  
  ' output
  
  '  xroot = real root of f(x) = 0
  '  froot = function value
  
  ' note&#58; requires sub jdfunc
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local eps, a, b, c, d, e, fa, fb, fcc, tol1
  
  local xm, p, q, r, s, xmin, tmp
  
  eps = 2.23e-16
  
  e = 0.0
  
  a = x1
  
  b = x2
  
  jdfunc(a, fa)
  
  jdfunc(b, fb)
  
  fcc = fb
  
  for iter% = 1 to 50
    
    if (fb &#42; fcc &gt; 0.0) then
      
      c = a
      
      fcc = fa
      
      d = b - a
      
      e = d
      
    end if
    
    if (abs(fcc) &lt; abs(fb)) then
      
      a = b
      
      b = c
      
      c = a
      
      fa = fb
      
      fb = fcc
      
      fcc = fa
      
    end if
    
    tol1 = 2.0 &#42; eps &#42; abs(b) + 0.5 &#42; tol
    
    xm = 0.5 &#42; (c - b)
    
    if (abs(xm) &lt;= tol1 or fb = 0) then exit for
    
    if (abs(e) &gt;= tol1 and abs(fa) &gt; abs(fb)) then
      
      s = fb / fa
      
      if (a = c) then
        
        p = 2.0 &#42; xm &#42; s
        
        q = 1.0 - s
        
      else
        
        q = fa / fcc
        
        r = fb / fcc
        
        p = s &#42; (2.0 &#42; xm &#42; q &#42; (q - r) - (b - a) &#42; (r - 1.0))
        
        q = (q - 1.0) &#42; (r - 1.0) &#42; (s - 1.0)
        
      end if
      
      if (p &gt; 0) then q = -q
      
      p = abs(p)
      
      xmin = abs(e &#42; q)
      
      tmp = 3.0 &#42; xm &#42; q - abs(tol1 &#42; q)
      
      if (xmin &lt; tmp) then xmin = tmp
      
      if (2.0 &#42; p &lt; xmin) then
        
        e = d
        
        d = p / q
        
      else
        
        d = xm
        
        e = d
        
      end if
      
    else
      
      d = xm
      
      e = d
      
    end if
    
    a = b
    
    fa = fb
    
    if (abs(d) &gt; tol1) then
      
      b = b + d
      
    else
      
      b = b + sgn(xm) &#42; tol1
      
    end if
    
    jdfunc(b, fb)
    
  next iter%
  
  froot = fb
  
  xroot = b
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub julian(month, day, year, jday)
  
  ' Gregorian date to julian day subroutine
  
  ' input
  
  '  month = calendar month
  '  day   = calendar day
  '  year  = calendar year (all four digits)
  
  ' output
  
  '  jday = julian day
  
  ' special notes
  
  '  (1) calendar year must include all digits
  
  '  (2) will report October 5, 1582 to October 14, 1582
  '      as invalid calendar dates and exit
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local a, b, c, m, y
  
  y = year
  
  m = month
  
  b = 0.0
  
  c = 0.0
  
  if (m &lt;= 2.0) then
    
    y = y - 1.0
    
    m = m + 12.0
    
  end if
  
  if (y &lt; 0.0) then c = -0.75
  
  if (year &lt; 1582.0) then
    
    ' null
    
  elseif (year &gt; 1582.0) then
    
    a = fix(y / 100.0)
    
    b = 2.0 - a + fix(a / 4.0)
    
  elseif (month &lt; 10.0) then
    
    ' null
    
  elseif (month &gt; 10.0) then
    
    a = fix(y / 100.0)
    
    b = 2.0 - a + fix(a / 4.0)
    
  elseif (day &lt;= 4.0) then
    
    ' null
    
  elseif (day &gt; 14.0) then
    
    a = fix(y / 100.0)
    
    b = 2.0 - a + fix(a / 4.0)
    
  else
    
    print "this date does not exist!!"
    
    exit
    
  end if
  
  jday = fix(365.25 &#42; y + c) + fix(30.6001 &#42; (m + 1.0)) + day + b + 1720994.5
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub gdate (jday, month, day, year)
  
  ' Julian day to Gregorian date subroutine
  
  ' input
  
  '  jday = julian day
  
  ' output
  
  '  month = calendar month
  '  day   = calendar day
  '  year  = calendar year
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local a, b, c, d, e, f, z, alpha
  
  z = fix(jday + 0.5)
  
  f = jday + 0.5 - z
  
  if (z &lt; 2299161) then
    
    a = z
    
  else
    
    alpha = fix((z - 1867216.25) / 36524.25)
    
    a = z + 1.0 + alpha - fix(alpha / 4.0)
    
  end if
  
  b = a + 1524.0
  
  c = fix((b - 122.1) / 365.25)
  
  d = fix(365.25 &#42; c)
  
  e = fix((b - d) / 30.6001)
  
  day = b - d - fix(30.6001 &#42; e) + f
  
  if (e &lt; 13.5) then
    
    month = e - 1.0
    
  else
    
    month = e - 13.0
    
  end if
  
  if (month &gt; 2.5) then
    
    year = c - 4716.0
    
  else
    
    year = c - 4715.0
    
  end if
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
sub utc2tdb (jdutc, tai_utc, jdtdb)
  
  ' convert UTC julian date to TDB julian date
  
  ' input
  
  '  jdutc   = UTC julian day
  '  tai_utc = TAI-UTC (seconds)
  
  ' output
  
  '  jdtdb = TDB julian day
  
  ' Reference Frames in Astronomy and Geophysics
  ' J. Kovalevsky et al., 1989, pp. 439-442
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local corr, jdtdt, t
  
  ' TDT julian date
  
  corr = (tai_utc + 32.184) / 86400.0
  
  jdtdt = jdutc + corr
  
  ' time argument for correction
  
  t = (jdtdt - 2451545.0) / 36525.0
  
  ' compute correction in microseconds
  
  corr = 1656.675 &#42; sin(dtr &#42; (35999.3729 &#42; t + 357.5287))
  corr = corr + 22.418     &#42; sin(dtr &#42; (32964.467  &#42; t + 246.199))
  corr = corr + 13.84      &#42; sin(dtr &#42; (71998.746  &#42; t + 355.057))
  corr = corr +  4.77      &#42; sin(dtr &#42; ( 3034.906  &#42; t +  25.463))
  corr = corr +  4.677     &#42; sin(dtr &#42; (34777.259  &#42; t + 230.394))
  corr = corr + 10.216 &#42; t &#42; sin(dtr &#42; (35999.373  &#42; t + 243.451))
  corr = corr +  0.171 &#42; t &#42; sin(dtr &#42; (71998.746  &#42; t + 240.98 ))
  corr = corr +  0.027 &#42; t &#42; sin(dtr &#42; ( 1222.114  &#42; t + 194.661))
  corr = corr +  0.027 &#42; t &#42; sin(dtr &#42; ( 3034.906  &#42; t + 336.061))
  corr = corr +  0.026 &#42; t &#42; sin(dtr &#42; (  -20.186  &#42; t +   9.382))
  corr = corr +  0.007 &#42; t &#42; sin(dtr &#42; (29929.562  &#42; t + 264.911))
  corr = corr +  0.006 &#42; t &#42; sin(dtr &#42; (  150.678  &#42; t +  59.775))
  corr = corr +  0.005 &#42; t &#42; sin(dtr &#42; ( 9037.513  &#42; t + 256.025))
  corr = corr +  0.043 &#42; t &#42; sin(dtr &#42; (35999.373  &#42; t + 151.121))
  
  ' convert corrections to days
  
  corr = 0.000001 &#42; corr / 86400.0
  
  ' TDB julian date
  
  jdtdb = jdtdt + corr
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
sub findleap(jday, leapsecond)
  
  ' find number of leap seconds for utc julian day
  
  ' input
  
  '  jday = utc julian day
  
  ' input via global
  
  '  jdleap  = array of utc julian dates
  '  leapsec = array of leap seconds
  
  ' output
  
  '  leapsecond = number of leap seconds
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  if (jday &lt;= jdleap(1)) then
    
    ' date is &lt;= 1972; set to first data element
    
    leapsecond = leapsec(1)
    
    exit sub
    
  end if
  
  if (jday &gt;= jdleap(28)) then
    
    ' date is &gt;= end of current data
    ' set to last data element
    
    leapsecond = leapsec(28)
    
    exit sub
    
  end if
  
  ' find data within table
  
  for i% = 1 to 27
    
    if (jday &gt;= jdleap(i%) and jday &lt; jdleap(i% + 1)) then
      
      leapsecond = leapsec(i%)
      
      exit sub
      
    end if
    
  next i%
  
end sub
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
function modulo(x) as float
  
  ' modulo 2 pi function
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;'
  
  local a
  
  a = x - pi2 &#42; fix(x / pi2)
  
  if (a &lt; 0.0) then
    
    a = a + pi2
    
  end if
  
  modulo = a
  
end function
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
function atan3(a, b) as float
  
  ' four quadrant inverse tangent function
  
  ' input
  
  '  a = sine of angle
  '  b = cosine of angle
  
  ' output
  
  '  atan3 = angle (0 =&lt; atan3 &lt;= 2 &#42; pi; radians)
  
  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;
  
  local c
  
  if (abs(a) &lt; 1.0e-10) then
    
    atan3 = (1.0 - sgn(b)) &#42; pidiv2
    
    exit function
    
  else
    
    c = (2.0 - sgn(a)) &#42; pidiv2
    
  endif
  
  if (abs(b) &lt; 1.0e-10) then
    
    atan3 = c
    
    exit function
    
  else
    
    atan3 = c + sgn(a) &#42; sgn(b) &#42; (abs(atn(a / b)) - pidiv2)
    
  endif
  
end function

</pre><br />  
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.MMX-time-of-the-seasons by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:21:37 GMT -->
</html>
