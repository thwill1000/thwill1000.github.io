

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.sinput-String-input-with-edit-functions by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	sinput - String input, with edit functions - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.sinput-String-input-with-edit-functions" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF+xw8aDEgY2xhc3M9InBhZ2V0aXRsZSI+c2lucHV0IC0gU3RyaW5nIGlucHV0LCB3aXRoIGVkaXQgZnVuY3Rpb25zPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxNy8wOS8yMiAwOToxMCBieSBQZXRlcjYzICZtZGFzaDsgQ2F0ZWdvcml6ZWQgYXM6IENvbnRyb2wsIERlYnVnLCBFbnZpcm9ubWVudCwgRmlsZSBNYW5hZ2VtZW50LCBGaWxlc3lzdGVtLCBTdHJpbmdzPC9zbWFsbD48YnIgLz48YnIgLz4nPGJyIC8+JyBQcm9ncmFtOiBzaW5wdXQuYmFzPGJyIC8+JzxiciAvPicgU3RyaW5nIGlucHV0LCB3aXRoIGVkaXQgZnVuY3Rpb25zPGJyIC8+JzxiciAvPicgRGF0ZTogMjAxNy4wOS4xMCBQZXRlciBTdmFyZDxiciAvPic8YnIgLz48YnIgLz4nIG1ha2UgYSBpbmRleCBtZW1vcnkgb2YgNSBzdHJpbmdzPGJyIC8+RGltIG0kKDUpIEFzIHN0cmluZzxiciAvPm0kKDEpPSJPbmUgT25lIE9uZSBPbmUgT25lIDEgMSAxIDEgMSI8YnIgLz5tJCgyKT0iVHdvIFR3byBUd28gVHdvIFR3byAyIDIgMiAyIDIiPGJyIC8+bSQoMyk9IlRocmVlIFRocmVlIFRocmVlIFRocmVlIFRocmVlIDMgMyAzIDMgMyI8YnIgLz5tJCg0KT0iRm91ciBGb3VyIEZvdXIgRm91ciBGb3VyIDQgNCA0IDQgNCI8YnIgLz5tJCg1KT0iRml2ZSBGaXZlIEZpdmUgRml2ZSBGaXZlIDUgNSA1IDUgNSI8YnIgLz48YnIgLz48YnIgLz4nIHByaW50IHNvbWUgdGV4dCBvbiBzY3JlZW4gZm9yIHRoaXMgdGVzdDxiciAvPkNsczxiciAvPlByaW50ICJUZXN0aW5nIHNpbnB1dCI8YnIgLz5QcmludDxiciAvPkN1cnNvciAyMCwxMDpQcmludCAiMDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OSI8YnIgLz48YnIgLz4nIC0tLSB0ZXN0IHNpbnB1dDxiciAvPkRpbSB4cyBBcyBzdHJpbmc8YnIgLz5EaW0gcCBBcyBpbnRlZ2VyPGJyIC8+RGltIGVrZXkgQXMgaW50ZWdlcjxiciAvPkRpbSBjIEFzIGludGVnZXI8YnIgLz5wPTEwICcgc2V0IGN1cnNvciBwb3NpdGlvbjxiciAvPmM9MSAnIGluZGV4IGNvdW50ZXI8YnIgLz5EbzxiciAvPkZvciBpPTIgVG8gNjpDdXJzb3IgMjAsaTpQcmludCBTcGFjZSQoNTApOk5leHQgaTxiciAvPicgc2hvdyBhbGwgZml2ZSBpbmRleCBzdHJpbmdzIHRvIHNjcmVlbjxiciAvPkN1cnNvciAyMCwyOlByaW50IG0kKDEpPGJyIC8+Q3Vyc29yIDIwLDM6UHJpbnQgbSQoMik8YnIgLz5DdXJzb3IgMjAsNDpQcmludCBtJCgzKTxiciAvPkN1cnNvciAyMCw1OlByaW50IG0kKDQpPGJyIC8+Q3Vyc29yIDIwLDY6UHJpbnQgbSQoNSk8YnIgLz54cz1tJChjKTxiciAvPnNpbnB1dCB4cywyMCwxMixwLDQwLGVrZXkgJyBlZGl0IHN0cmluZzxiciAvPm0kKGMpPXhzICcgc2F2ZSBzdHJpbmcgdG8gaW5kZXg8YnIgLz5JZiBla2V5PTEyOCBBbmQgYz4xIFRoZW4gYz1jLTEgJyBjdXJzb3IgdXA8YnIgLz5JZiBla2V5PTEyOSBBbmQgYzw1IFRoZW4gYz1jKzEgJyBjdXJzb3IgZG93bjxiciAvPidDdXJzb3IgMTAsMzpQcmludCB4czxiciAvPkN1cnNvciAyMCwxNTpQcmludCJlS2V5LWNvZGUgPSAiO2VrZXk7IiAgIjxiciAvPkxvb3A8YnIgLz48YnIgLz5FbmQ8YnIgLz48YnIgLz4nPGJyIC8+JyBzaW5wdXQ8YnIgLz4nPGJyIC8+JyBWYXJpYWJsZXM6PGJyIC8+JyAgICAgIHhzICBzdHJpbmc8YnIgLz4nIGNvbCxyb3cgIHNjcmVlbiBwb3NpdGlvbjxiciAvPicgICAgICAgcCAgY3Vyc29yIHBvc2l0aW9uIGluIHN0cmluZyAoLTE9YXV0byBwb3MuKTxiciAvPicgICAgIG1heCAgbWF4IGNoYXJhY3RlcnMgaW4gc3RyaW5nPGJyIC8+JyAgICBla2V5ICByZXR1cm4ga2V5LWNvZGUgKDEzPUVudGVyLCBVcC9Eb3duLCBQZ1VwL1BnRG4sIEYxLUYxMCwgRXNjKTxiciAvPic8YnIgLz5TdWIgc2lucHV0KHhzIEFzIHN0cmluZyxjb2wgQXMgaW50ZWdlcixyb3cgQXMgaW50ZWdlcixwIEFzIGludGVnZXIsbWF4IEFzIGludGVnZXIsIGVrZXkgQXMgaW50ZWdlcik8YnIgLz5Mb2NhbCBzIEFzIHN0cmluZzxiciAvPnMgPSB4czxiciAvPicgY2hlY2sgaWYgc3RyaW5nIGlzIHRvIGxvbmc8YnIgLz5JZiBMZW4ocyk+bWF4IFRoZW4gcz1NaWQkKHMsMSxtYXgpICcgY3V0IG9mIHN0cmluZyB0byBtYXgtdmFsdWU8YnIgLz4nIGNoZWNrIGlmIHN0cmluZyBpcyB0byBzaG9ydCwgc2V0IHRvIG1heC12YWx1ZTxiciAvPklmIExlbihzKTxtYXggVGhlbiBzPXMrU3BhY2UkKG1heC1MZW4ocykpICcgZXh0ZW5kIHRvIG1heDxiciAvPicgbG9jYWwgdmFyaWFibGVzPGJyIC8+TG9jYWwgdCBBcyBpbnRlZ2VyICcgaW5rZXkkIGtleS1jb2RlPGJyIC8+TG9jYWwgdyBBcyBpbnRlZ2VyICcgbGFzdCBjaGFyYWN0ZXIgaW4gc3RyaW5nPGJyIC8+JyBpbml0IHJ1dGluIGJlZm9yZSBtYWluLWxvb3A8YnIgLz5la2V5PTAgJyBlS2V5IHJlc2V0PGJyIC8+Q3Vyc29yIGNvbCxyb3cgJyBwb3NpdGlvbiBjdXJzb3I8YnIgLz5QcmludCBzICcgcHJpbnQgb3V0IHN0cmluZzxiciAvPklmIHA9LTEgVGhlbiBwPUxlbihzKSAnIHNldCBjdXJzb3IgYXV0byBwb3NpdGlvbjxiciAvPicgc3RhcnQgbWFpbiBsb29wIGZvciBzaW5wdXQ8YnIgLz5EbzxiciAvPkN1cnNvciBjb2wrcCxyb3c8YnIgLz50PUFzYyhJbmtleSQpICcgd2FpdCBmb3IgYSBrZXk8YnIgLz5JZiB0PTggQW5kIHA+MCBUaGVuICcgYmFja3NwYWNlPGJyIC8+ICAgIHM9TWlkJChzLDEscC0xKStNaWQkKHMscCsxKStDaHIkKDMyKTxiciAvPiAgICBwPXAtMTxiciAvPkVuZCBJZjxiciAvPklmIHQ9MTI3IFRoZW4gJyBEZWxldGU8YnIgLz4gICAgcz1NaWQkKHMsMSxwKStNaWQkKHMscCsyKStDaHIkKDMyKTxiciAvPkVuZCBJZjxiciAvPklmIHQ9MTMwIEFuZCBwPjAgVGhlbiBwPXAtMSAnIGN1cnNvciBsZWZ0PGJyIC8+SWYgdD0xMzEgQW5kIHA8bWF4IFRoZW4gcD1wKzEgJyBjdXJzb3IgcmlnaHQ8YnIgLz4nIHNvbWUgZUtleSBjb2RlPGJyIC8+SWYgdD0yNyBPciB0PTEzIFRoZW4gZWtleT10OkV4aXQgRG8gJyBFc2Mgb3IgRW50ZXI8YnIgLz5JZiB0PTEyOCBPciB0PTEyOSBUaGVuIGVrZXk9dDpFeGl0IERvICcgY3Vyc29yIFVwIG9yIERvd248YnIgLz5JZiB0PTEzNiBPciB0PTEzNyBUaGVuIGVrZXk9dDpFeGl0IERvICcgUGdVcCBvciBQZ0RuPGJyIC8+SWYgdD4xNDQgQW5kIHQ8MTU1IFRoZW4gZWtleT10OkV4aXQgRG8gJyBGMS1GMTA8YnIgLz5JZiAodD4zMSBBbmQgdDwxMjcpIFRoZW4gJyBBU0NJSSAzMi0xMjYgY2hhcmFjdGVyczxiciAvPiAgICB3PUFzYyhNaWQkKHMsbWF4LDEpKSAnIGxhc3QgY2hhcmFjdGVyPGJyIC8+ICAgIElmIHA9MCBUaGVuPGJyIC8+ICAgICAgICBJZiB3PTMyIFRoZW4gcz1DaHIkKHQpK01pZCQocyxwKzEpICcgZmlyc3QgcG9zaXRpb248YnIgLz4gICAgICAgIEVsc2U8YnIgLz4gICAgICAgIElmIHc9MzIgVGhlbiBzPU1pZCQocywxLHApK0NociQodCkrTWlkJChzLHArMSkgJyBzb21ld2hlcmUgZWxzZSBwb3NpdGlvbjxiciAvPiAgICBFbmQgSWY8YnIgLz4gICAgSWYgcDxtYXggQW5kIHc9MzIgVGhlbiBwPXArMSAnIG1vdmUgY3Vyc29yIHRvIHJpZ2h0PGJyIC8+RW5kIElmPGJyIC8+PGJyIC8+SWYgdDw+MCBUaGVuICcgdXBkYXRlIHN0cmluZyB0byBzY3JlZW48YnIgLz4gICAgQ3Vyc29yIGNvbCxyb3c6UHJpbnQgU3BhY2UkKG1heCk8YnIgLz4gICAgQ3Vyc29yIGNvbCxyb3c6UHJpbnQgczxiciAvPkVuZCBJZjxiciAvPjxiciAvPkxvb3A8YnIgLz54cz1zPGJyIC8+RW5kIFN1YjxiciAvPmRkjhue7XFmVcqSqJ5/1Tt9FTptA+Q=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">sinput - String input, with edit functions</h1><small>Modified on 2017/09/22 09:10 by Peter63 &mdash; Categorized as: Control, Debug, Environment, File Management, Filesystem, Strings</small><br /><br />'<br />' Program: sinput.bas<br />'<br />' String input, with edit functions<br />'<br />' Date: 2017.09.10 Peter Svard<br />'<br /><br />' make a index memory of 5 strings<br />Dim m$(5) As string<br />m$(1)="One One One One One 1 1 1 1 1"<br />m$(2)="Two Two Two Two Two 2 2 2 2 2"<br />m$(3)="Three Three Three Three Three 3 3 3 3 3"<br />m$(4)="Four Four Four Four Four 4 4 4 4 4"<br />m$(5)="Five Five Five Five Five 5 5 5 5 5"<br /><br /><br />' print some text on screen for this test<br />Cls<br />Print "Testing sinput"<br />Print<br />Cursor 20,10:Print "0123456789012345678901234567890123456789"<br /><br />' --- test sinput<br />Dim xs As string<br />Dim p As integer<br />Dim ekey As integer<br />Dim c As integer<br />p=10 ' set cursor position<br />c=1 ' index counter<br />Do<br />For i=2 To 6:Cursor 20,i:Print Space$(50):Next i<br />' show all five index strings to screen<br />Cursor 20,2:Print m$(1)<br />Cursor 20,3:Print m$(2)<br />Cursor 20,4:Print m$(3)<br />Cursor 20,5:Print m$(4)<br />Cursor 20,6:Print m$(5)<br />xs=m$(c)<br />sinput xs,20,12,p,40,ekey ' edit string<br />m$(c)=xs ' save string to index<br />If ekey=128 And c>1 Then c=c-1 ' cursor up<br />If ekey=129 And c<5 Then c=c+1 ' cursor down<br />'Cursor 10,3:Print xs<br />Cursor 20,15:Print"eKey-code = ";ekey;"  "<br />Loop<br /><br />End<br /><br />'<br />' sinput<br />'<br />' Variables:<br />'      xs  string<br />' col,row  screen position<br />'       p  cursor position in string (-1=auto pos.)<br />'     max  max characters in string<br />'    ekey  return key-code (13=Enter, Up/Down, PgUp/PgDn, F1-F10, Esc)<br />'<br />Sub sinput(xs As string,col As integer,row As integer,p As integer,max As integer, ekey As integer)<br />Local s As string<br />s = xs<br />' check if string is to long<br />If Len(s)>max Then s=Mid$(s,1,max) ' cut of string to max-value<br />' check if string is to short, set to max-value<br />If Len(s)<max Then s=s+Space$(max-Len(s)) ' extend to max<br />' local variables<br />Local t As integer ' inkey$ key-code<br />Local w As integer ' last character in string<br />' init rutin before main-loop<br />ekey=0 ' eKey reset<br />Cursor col,row ' position cursor<br />Print s ' print out string<br />If p=-1 Then p=Len(s) ' set cursor auto position<br />' start main loop for sinput<br />Do<br />Cursor col+p,row<br />t=Asc(Inkey$) ' wait for a key<br />If t=8 And p>0 Then ' backspace<br />    s=Mid$(s,1,p-1)+Mid$(s,p+1)+Chr$(32)<br />    p=p-1<br />End If<br />If t=127 Then ' Delete<br />    s=Mid$(s,1,p)+Mid$(s,p+2)+Chr$(32)<br />End If<br />If t=130 And p>0 Then p=p-1 ' cursor left<br />If t=131 And p<max Then p=p+1 ' cursor right<br />' some eKey code<br />If t=27 Or t=13 Then ekey=t:Exit Do ' Esc or Enter<br />If t=128 Or t=129 Then ekey=t:Exit Do ' cursor Up or Down<br />If t=136 Or t=137 Then ekey=t:Exit Do ' PgUp or PgDn<br />If t>144 And t<155 Then ekey=t:Exit Do ' F1-F10<br />If (t>31 And t<127) Then ' ASCII 32-126 characters<br />    w=Asc(Mid$(s,max,1)) ' last character<br />    If p=0 Then<br />        If w=32 Then s=Chr$(t)+Mid$(s,p+1) ' first position<br />        Else<br />        If w=32 Then s=Mid$(s,1,p)+Chr$(t)+Mid$(s,p+1) ' somewhere else position<br />    End If<br />    If p<max And w=32 Then p=p+1 ' move cursor to right<br />End If<br /><br />If t<>0 Then ' update string to screen<br />    Cursor col,row:Print Space$(max)<br />    Cursor col,row:Print s<br />End If<br /><br />Loop<br />xs=s<br />End Sub<br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.sinput-String-input-with-edit-functions by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:23:54 GMT -->
</html>
