

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&Revision=14 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:50:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Page History - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/History.aspx?NS=MMBasic&amp;Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Revision=14" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEzMjI3OTE2NTkPZBYCZg9kFgICAQ9kFgICCQ9kFggCAQ8WAh4EVGV4dAVIUGFnZSBIaXN0b3J5OiBNTUJhc2ljIGNvZGUtcGFjayB0byBSZWFkIGFuZCBXcml0ZSBXaW5ib25kIEZsYXNoIE1lbW9yaWVzZAIFDxBkEBUPAjE0AjEzAjEyAjExAjEwATkBOAE3ATYBNQE0ATMBMgExATAVDwIxNAIxMwIxMgIxMQIxMAE5ATgBNwE2ATUBNAEzATIBMQEwFCsDD2dnZ2dnZ2dnZ2dnZ2dnZ2RkAgcPEGQQFRAHQ3VycmVudAIxNAIxMwIxMgIxMQIxMAE5ATgBNwE2ATUBNAEzATIBMQEwFRAHQ3VycmVudAIxNAIxMwIxMgIxMQIxMAE5ATgBNwE2ATUBNAEzATIBMQEwFCsDEGdnZ2dnZ2dnZ2dnZ2dnZ2dkZAILDxYCHwAFp8EBPHRhYmxlIGNsYXNzPSJib3giIGNlbGxwYWRkaW5nPSIwIiBjZWxsc3BhY2luZz0iMCI+PHRyPjx0ZD48cCBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyI+PGI+PGEgaHJlZj0iTU1CYXNpYy5IaXN0b3J5LmFzcHg/UGFnZT1NTUJhc2ljLk1NQmFzaWMtY29kZS1wYWNrLXRvLVJlYWQtYW5kLVdyaXRlLVdpbmJvbmQtRmxhc2gtTWVtb3JpZXMmYW1wO1JldmlzaW9uPTAwMDEzIj4mbGFxdW87IE9sZGVyIFJldmlzaW9uPC9hPiAtIDxhIGhyZWY9Ik1NQmFzaWMuSGlzdG9yeS5hc3B4P1BhZ2U9TU1CYXNpYy5NTUJhc2ljLWNvZGUtcGFjay10by1SZWFkLWFuZC1Xcml0ZS1XaW5ib25kLUZsYXNoLU1lbW9yaWVzIj5CYWNrIHRvIFBhZ2UgSGlzdG9yeTwvYT4gLSA8YSBocmVmPSJNTUJhc2ljLk1NQmFzaWMtY29kZS1wYWNrLXRvLVJlYWQtYW5kLVdyaXRlLVdpbmJvbmQtRmxhc2gtTWVtb3JpZXMuYXNoeCI+Q3VycmVudCBSZXZpc2lvbjwvYT48L2I+PC9wPjwvdGQ+PC90cj48L3RhYmxlPjxiciAvPjxoMyBjbGFzcz0ic2VwYXJhdG9yIj5QYWdlIFJldmlzaW9uOiAyMDIwLzA4LzA3IDA5OjQzPC9oMz48YnIgLz5XaW5ib25kIGZsYXNoIG1lbW9yaWVzIHByb3ZpZGUgYW4gZXhjZWxsZW50IG1ldGhvZCBvZiBzdG9yaW5nIHVwIHRvIDE2TUIgb2YgZGF0YSBpbiBhIHRpbnkgU1BJIGRyaXZlbiBjaGlwLiBBdCBhcm91bmQgJDAuNTAgZWFjaCAodmFyaWVzKSB0aGVzZSBvZmZlciBhbiBhbWF6aW5nIHN0b3JhZ2UvcHJpY2UgZGVuc2l0eSBhbmQgYXJlIHVzZWQgaW4gbWFueSBkZXZpY2VzIHRvIHN0b3JlIGNvbmZpZ3VyYXRpb24gYW5kIGZpcm13YXJlLiBUaHJvd2luZyBvdXQgYW4gb2xkIERTTCByb3V0ZXI/IENoZWNrIHRoZSBib2FyZCAtIHRoZXJlIGlzIGxpa2VseSBhIEZsYXNoIG1lbW9yeSB0aGF0IGNhbiBiZSByZWNvdmVyZWQgYW5kIHJlLXVzZWQuPGJyIC8+PGJyIC8+U1BJIGlzIHZlcnkgbXVjaCBmYXN0ZXIgYW5kIGVhc2llciB0byBkcml2ZSB0aGFuIEk8c3VwPjI8L3N1cD5DLiBUaGUgcm91dGluZXMgaGVyZSB3b3JrIGZsYXdsZXNzbHkgYXQgMjBNSHogYW5kIHdlcmUgaW5zcGlyZWQgYnkgd29yayBNYXRoZXJQIHB1Ymxpc2hlZCBvbiB0aGUgQmFja1NoZWQgaGVyZSA8YSBjbGFzcz0iZXh0ZXJuYWxsaW5rIiBocmVmPSJodHRwczovL3d3dy50aGViYWNrc2hlZC5jb20vZm9ydW0vVmlld1RvcGljLnBocD9USUQ9ODQ5MiIgdGl0bGU9Imh0dHBzOi8vd3d3LnRoZWJhY2tzaGVkLmNvbS9mb3J1bS9WaWV3VG9waWMucGhwP1RJRD04NDkyIiB0YXJnZXQ9Il9ibGFuayI+aHR0cHM6Ly93d3cudGhlYmFja3NoZWQuY29tL2ZvcnVtL1ZpZXdUb3BpYy5waHA/VElEPTg0OTI8L2E+PGJyIC8+PGJyIC8+VGhhdCB3b3JrIHVzZWQgQ1N1YnMgdG8gYWNjZXNzIHRoZSBGbGFzaCBhbmQgd2hlcmVhcyB0aGV5IGFyZSB2ZXJ5IHF1aWNrLCB0aGV5IGV4Y2x1ZGUgdXNlcnMgb2YgdGhlIGJpZ2dlciAnTWl0ZSBwbGF0Zm9ybXMgLSB0aGUgTU1YIGFuZCBTVCdzIEFybSBiYXNlIHByb2Nlc3NvcnMgLSB0aGUgSDcvRjQgcGxhdGZvcm1zLiBUaGUgcm91dGluZXMgYmVsb3cgYXJlIGEgcHVyZWx5IE1NQmFzaWMgc29sdXRpb24gYW5kIHNvIGNhbiBiZSB1c2VkIG9uIGFueSBNTUJhc2ljIHBsYXRmb3JtIHN1cHBvcnRpbmcgdGhlIFNQSSBidXMuPGJyIC8+PGJyIC8+VGhlIGFwcHJvYWNoIHdpdGggdGhlIGNvZGUgaGVyZSBpcyBjb21wYXJhYmxlIHRvIGEgc2VxdWVudGlhbCBmaWxlLiBEYXRhIGlzIHdyaXR0ZW4gdXNpbmcgb25lIGZ1bmN0aW9uIGFuZCByZWFkIGJhY2sgd2l0aCBhbm90aGVyLiBXaGVuIGRhdGEgaXMgZXhoYXVzdGVkIGEgbWFya2VyLCBDSFIkKDI1NSksIGlzIHJlYWNoZWQuIFRoaXMgaXMgYW5hbGFnb3VzIHdpdGggdGhlIEVPRiBjaGFyYWN0ZXIgb2YgZGlzayBmaWxpbmcgc3lzdGVtcy4gVGhpcyBjb2RlIHByb3ZpZGVzIGEgc2ltcGxlIGxvZ2dpbmcgc3lzdGVtIG9mIHN0cmluZ3MgaW4sIHN0cmluZ3Mgb3V0LiBJdCBoYW5kbGVzIHRoaXMgLSB5b3UgZGVjaWRlIHdoYXQgeW91IHdhbnQgdG8gZG8gd2l0aCB0aGVtLiBVc2luZyBhIHN0cnVjdHVyZWQgbG9nZ2luZyBtZXRob2QgZS5nLiA8YSBjbGFzcz0icGFnZWxpbmsiIGhyZWY9Ik1NQmFzaWMuVWx0cmEtQ29tcGFjdC1Mb2dnaW5nLXdpdGgtRmxhc2gtU3RvcmFnZS1vbi1zbWFsbC1NaWNyb01pdGVzLmFzaHgiIHRpdGxlPSJVbHRyYS1Db21wYWN0IExvZ2dpbmcgd2l0aCBGbGFzaCBTdG9yYWdlIG9uIHNtYWxsIE1pY3JvTWl0ZXMiPlVsdHJhLUNvbXBhY3QgTG9nZ2luZyB3aXRoIEZsYXNoIFN0b3JhZ2Ugb24gc21hbGwgTWljcm9NaXRlczwvYT4gaXQgd291bGQgYmUgcG9zc2libGUgdG8gbG9nIGNvbnRpbnVvdXNseSBhdCBvbmUgc2Vjb25kIGludGVydmFscyBmb3IgZWlnaHQgZGF5cyBzdHJhaWdodCBvbiBhIDRNQiBjaGlwLiBXaXRoIGFyYml0cmFyeSBzdHJpbmdzIG9mIGF2ZXJhZ2UgbGVuZ3RoIDUwIGJ5dGVzLCBpbiBleGNlc3Mgb2YgODMsMDAwIGxpbmVzIGNvdWxkIGJlIHN0b3JlZC48YnIgLz48YnIgLz48YSBocmVmPSJNTUJhc2ljLkVkaXQuYXNweD9QYWdlPU1NQmFzaWMuTU1CYXNpYy1jb2RlLXBhY2stdG8tUmVhZC1hbmQtV3JpdGUtV2luYm9uZC1GbGFzaC1NZW1vcmllcyZhbXA7U2VjdGlvbj0wIiBjbGFzcz0iZWRpdHNlY3Rpb25saW5rIj48L2E+PGgxIGNsYXNzPSJzZXBhcmF0b3IiPk9yZ2FuaXNhdGlvbiBvZiBTdHJpbmdzIGluIE1lbW9yeTxhIGNsYXNzPSJoZWFkZXJhbmNob3IiIGlkPSJPcmdhbmlzYXRpb25fb2ZfU3RyaW5nc19pbl9NZW1vcnlfMCIgaHJlZj0iI09yZ2FuaXNhdGlvbl9vZl9TdHJpbmdzX2luX01lbW9yeV8wIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMT5UaGUgRmxhc2ggdGVjaG5vbG9neSBwcm92aWRlcyBjb250aW51b3VzIHJlYWRpbmcgc3RhcnRpbmcgZnJvbSBhIHNpbmdsZSAyNCBiaXQgYWRkcmVzcy4gT25jZSBsYXRjaGVkLCB0aGUgYWRkcmVzcyBpbmNyZW1lbnRzIHdpdGggZWFjaCByZWFkIGFuZCBzbyB0aGUgZW50aXJlIG1lbW9yeSBjb3VsZCBiZSByYXBpZGx5IHJlYWQgb3V0IHdpdGggb25seSBhIHNpbmdsZSBhZGRyZXNzIHNldHVwIC0gYXQgMjBNSHogdGhpcyBjb3VsZCBiZSBsaXR0bGUgbW9yZSB0aGFuIDQwMG5TIHBlciA8dT5ieXRlPC91PiEgV3JpdGluZyB0aGUgZGV2aWNlcyBpcyBtb3JlIGludm9sdmVkLiBUaGUgbWVtb3J5IGlzIGFycmFuZ2VkIGludG8gUGFnZXMgb2YgMjU2IGJ5dGVzIGFuZCB0aGUgYWRkcmVzcyBsYXRjaGVkLCBhbHRob3VnaCAyNCBiaXRzLCBvbmx5IHdvcmtzIHdpdGhpbiB0aGUgc2VsZWN0ZWQgcGFnZS4gVGhlIHJvdXRpbmVzIHRha2UgY2FyZSBvZiB0aGlzIGFuZCByZWFkaW5nL3dyaXRpbmcgaXMgdHJhbnNwYXJlbnQgdG8gdGhlIHVzZXIuIFlvdSBjYW4gc2VlIGZyb20gdGhlIGdyYWIgYmVsb3cgdGhhdCBhIHN0cmluZyBjcm9zc2VzIHRoZSBib3VuZGFyeSB3aXRoIG5vIHByb2JsZW07IHRoZSB0d28gYnl0ZXMgaW4gdGhlIHllbGxvdyBib3hlcyBhcmUgdGhlIGxhc3QgYW5kIGZpc3QgYnl0ZXMgaW4gZGlmZmVyZW50IHBhZ2VzICgwMEZGaCAmIDAxMDBoKSBidXQgaXQncyBhbGwgaGFuZGxlZCBieSB0aGUgd3JpdGUgZnVuY3Rpb24uPGJyIC8+PGJyIC8+PGEgY2xhc3M9InVua25vd25saW5rIiBocmVmPSJNTUJhc2ljLi5hc2h4IiB0aXRsZT0iTU1CYXNpYy4iPjwvYT48aW1nIHNyYz0iR2V0RmlsZS5hc3B4P0ZpbGU9L01NQmFzaWMvd2JwYWdlcy5wbmciIGFsdD0iSW1hZ2UiIC8+PGJyIC8+PGJyIC8+WW91IGNhbiBzZWUgZnJvbSB0aGUgYWJvdmUgdGhlIG1ldGhvZCB1c2VkIHRvIHN0b3JlIHN0cmluZ3MgaW4gdGhlIEZsYXNoIG1lbW9yeS4gSW4gdGhlIGJlbG93IGRpYWdyYW0sIGVhY2ggY2VsbCByZXByZXNlbnRzIGEgYnl0ZSBpbiBGbGFzaCAtIGhlcmUgdGhlIHN0cmluZyAiSUlJSUkiPGJyIC8+PGEgY2xhc3M9InVua25vd25saW5rIiBocmVmPSJNTUJhc2ljLi5hc2h4IiB0aXRsZT0iTU1CYXNpYy4iPjwvYT48aW1nIHNyYz0iR2V0RmlsZS5hc3B4P0ZpbGU9L2ZsYXNoX3N0cmluZ3N0b3JlLnBuZyIgYWx0PSJJbWFnZSIgLz48YnIgLz5JdCBjYW4gYmUgc2VlbiBmcm9tIHRoaXMgdGhhdCBzdHJpbmdzIGFyZSBsaW1pdGVkIHRvIHRoZSBjaGFyYWN0ZXJzIDEgdG8gMjU0IC0gaS5lLiB5b3VyIHN0cmluZyBjYW5ub3QgY29udGFpbiBDSFIkKDApIG9yIENIUiQoMjU1KSBhbmQgdGhhdCBpcyB0aGUgb25seSBsaW1pdGF0aW9uLjxiciAvPjAgaXMgdXNlZCBhcyB0aGUgc3RyaW5nIGRlbGltaXRlciBpbiBtZW1vcnkgYW5kIDI1NSBpcyB0aGUgYmxhbmsgbWVtb3J5IGJ5dGUuPGJyIC8+PGJyIC8+VGhlIGluaXRpYWxpemF0aW9uIHJvdXRpbmUgcGVyZm9ybXMgc2V2ZXJhbCB1c2VmdWwgYW5kIHZpdGFsIGZ1bmN0aW9uczo8YnIgLz48dWw+PGJyIC8+PGxpPiBJdCBpZGVudGlmaWVzIHRoZSB0eXBlIG9mIEZsYXNoIGF0dGFjaGVkIChpZiBhbnkpIGFuZCBzZXRzIHRoZSBtYXhpbXVtIGFkZHJlc3MgdmFyaWFibGUgV0IuVG9wIHRvIHRoZSBsYXN0IGF2YWlsYWJsZSBtZW1vcnkgbG9jYXRpb24uPC9saT48YnIgLz48bGk+IEl0IHJhcGlkbHkgZGV0ZXJtaW5lcyB0aGUgZmlyc3QgdW51c2VkIGJ5dGUgaW4gdGhlIG1lbW9yeSAobW9yZSBvbiB0aGlzIGxhdGVyKSBhbmQgc2V0cyB0aGUgV0IuV1JwdHIgdmFyaWFibGUgc28gYXMgbm90IHRvIHRyYW1wbGUgb24gcHJldmlvdXNseSBzdG9yZWQgZGF0YTwvbGk+PGJyIC8+PC91bD48YnIgLz48YnIgLz48YSBocmVmPSJNTUJhc2ljLkVkaXQuYXNweD9QYWdlPU1NQmFzaWMuTU1CYXNpYy1jb2RlLXBhY2stdG8tUmVhZC1hbmQtV3JpdGUtV2luYm9uZC1GbGFzaC1NZW1vcmllcyZhbXA7U2VjdGlvbj0xIiBjbGFzcz0iZWRpdHNlY3Rpb25saW5rIj48L2E+PGgxIGNsYXNzPSJzZXBhcmF0b3IiPk1ldGhvZDxhIGNsYXNzPSJoZWFkZXJhbmNob3IiIGlkPSJNZXRob2RfMSIgaHJlZj0iI01ldGhvZF8xIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMT5UaGVyZSBhcmUgdHdvIGFkZHJlc3MgcG9pbnRlcnMsIG9uZSBmb3IgcmVhZCBhbmQgYW5vdGhlciBmb3Igd3JpdGUgLSB0aGlzIGdpdmVzIGFuIGVhc3kgYWNjZXNzIG1ldGhvZCBhbmQgdGhleSBkb24ndCBjbGFzaC4gSW4gbm9ybWFsIHVzZSwgdGhleSBhcmUgb2Ygbm8gY29uY2VybiBhbmQgYW55IHByb2dyYW0gd2lsbCBzaW1wbHkgdXNlIHRoZSBXQi5XUnN0cigpIGFuZCBXQi5SRHN0ciQoKSByb3V0aW5lcy48YnIgLz48YnIgLz48YnIgLz5Xcml0aW5nOjxiciAvPkFuIGVyYXNlZCBGbGFzaCBoYXMgYWxsIGxvY2F0aW9ucyBzZXQgdG8gMjU1IHNvIGl0IGZvbGxvd3MgdGhlIGxvd2VzdCBzdWNoIGJ5dGUgaXMgdGhlIGZpcnN0IHBsYWNlIHdlIGNhbiB3cml0ZSBkYXRhIHdpdGhvdXQgb3Zlci13cml0aW5nIGVhcmxpZXIgZGF0YSAobm93IGl0IGlzIGNsZWFyIHdoeSBDSFIkKDI1NSkgaXMgcHJvaGliaXRlZCBpbiBzdHJpbmdzKS4gTk9URTogTmV3IEZsYXNoIGNoaXBzIGFyZSBub3QgbmVjZXNzYXJpbHkgaW4gYW4gZXJhc2VkIHN0YXRlLiBOZXcgY2hpcHMgc2hvdWxkIGJlIGZvcm1hdHRlZCBiZWZvcmUgdXNlLiA8YnIgLz48YnIgLz5XQi5XUnB0ciBwb2ludHMgdG8gdGhlIGZpcnN0IHN1Y2ggbWVtb3J5IGxvY2F0aW9uIGkuZS4gdGhlIHBvc2l0aW9uIG5ldyBkYXRhIGNhbiBiZSByZWxpYWJseSBzdG9yZWQuIEZsYXNoIG1lbW9yaWVzIHJldGFpbiBkYXRhIGZvciB1cCB0byAyMCB5ZWFycyBhbmQgd2l0aCBzdWNoIGxhcmdlIGNhcGFjaXRpZXMsIGl0IGlzIGhpZ2hseSBsaWtlbHkgdGhhdCBkYXRhIHdpbGwgYmUgYWdncmVnYXRlZCBvdmVyIHBvd2VyLWN5Y2xlcy4gQXQgaW5pdGlhbGl6YXRpb24sIHRoZSBmaXJzdCBGRmggYnl0ZSBpcyBhc2NlcnRhaW5lZCBieSBhIHJhcGlkIHN1Y2Nlc3NpdmUgYXBwcm94aW1hdGlvbiBhbGdvcml0aG0gdGhhdCB3aWxsIHJldHVybiB0aGUgZmlyc3Qgc3VjaCBieXRlIGluIGFyb3VuZCA4MG1TIG9uIGEgNE1CIGNoaXAgd2l0aCA0OE1IeiBNaWNyb01pdGUuIFRoaXMgYWRkcmVzcyBpcyBub3Qgc3RvcmVkIGludGVybmFsbHkgdG8gdGhlIEZsYXNoIC0gaXQgaXMgZGV0ZXJtaW5lZCB3aXRoIGVhY2ggY2FsbCB0byBXQi5Jbml0LCB0aGUgZW50aXJlIG1lbW9yeSBpcyBhdmFpbGFibGUgZm9yIHVzZS4gPGJyIC8+PGEgY2xhc3M9InVua25vd25saW5rIiBocmVmPSJNTUJhc2ljLi5hc2h4IiB0aXRsZT0iTU1CYXNpYy4iPjwvYT48aW1nIHNyYz0iR2V0RmlsZS5hc3B4P0ZpbGU9L2ZsYXNocG9pbnRlcnMxLnBuZyIgYWx0PSJJbWFnZSIgLz48YnIgLz48YnIgLz5SZWFkaW5nOjxiciAvPkVhY2ggYnl0ZSBpcyByZWFkIGZyb20gbWVtb3J5IGFuZCBidWlsdCB1cCBpbiBhIHN0cmluZyB1bnRpbCBhIDAgaXMgcmVhZCB3aGVuY2UgdGhlIHN0cmluZyBpcyByZXR1cm5lZCAodGhlIDAgZG9lcyBub3QgZm9ybSBwYXJ0IG9mIHRoYXQgc3RyaW5nKS4gV0IuUkRwdHIgaXMgaW5jcmVtZW50ZWQgdG8ga2VlcCB0cmFjayBvZiB3aGVyZSByZWFkaW5nIG9jY3VycyBhbmQgd2lsbCBiZSBsZWZ0IHBvaW50aW5nIGF0IHRoZSBzdGFydCBvZiB0aGUgbmV4dCBzdHJpbmcuIElmIGFuIGF0dGVtcHQgdG8gcmVhZCBwYXN0IGFueSBkYXRhIGlzIG1hZGUsIENIUiQoMjU1KSBpcyByZXR1cm5lZCBhbmQgdGhlIHJlYWQgcG9pbnRlciBpcyBub3QgaW5jcmVtZW50ZWQuIFdoZW4gYWRkaXRpb25hbCBkYXRhIGlzIHdyaXR0ZW4sIHRoZSBuZXh0IHJlYWQgd2lsbCByZXR1cm4gdGhlIG5ldyBkYXRhIGFuZCBzbyBvbi4uLiBUaHVzLCB0aGUgcmVhZCBwb2ludGVyIHdpbGwgaGFwcGlseSB0cm90IGFsb25nIGJlaGluZCB0aGUgd3JpdGUgcG9pbnRlciBidXQgbmV2ZXIgcGFzcyBpdC48YnIgLz48YSBjbGFzcz0idW5rbm93bmxpbmsiIGhyZWY9Ik1NQmFzaWMuLmFzaHgiIHRpdGxlPSJNTUJhc2ljLiI+PC9hPjxpbWcgc3JjPSJHZXRGaWxlLmFzcHg/RmlsZT0vZmxhc2hwb2ludGVyczIucG5nIiBhbHQ9IkltYWdlIiAvPjxiciAvPjxiciAvPjxhIGhyZWY9Ik1NQmFzaWMuRWRpdC5hc3B4P1BhZ2U9TU1CYXNpYy5NTUJhc2ljLWNvZGUtcGFjay10by1SZWFkLWFuZC1Xcml0ZS1XaW5ib25kLUZsYXNoLU1lbW9yaWVzJmFtcDtTZWN0aW9uPTIiIGNsYXNzPSJlZGl0c2VjdGlvbmxpbmsiPjwvYT48aDEgY2xhc3M9InNlcGFyYXRvciI+R2xvYmFsIFZhcmlhYmxlczxhIGNsYXNzPSJoZWFkZXJhbmNob3IiIGlkPSJHbG9iYWxfVmFyaWFibGVzXzIiIGhyZWY9IiNHbG9iYWxfVmFyaWFibGVzXzIiIHRpdGxlPSJMaW5rIHRvIHRoaXMgU2VjdGlvbiI+JiMwMTgyOzwvYT48L2gxPlRoZSBwb2ludGVyIGZvciB0aGUgbmV4dCByZWFkIHN0cmluZyBvcGVyYXRpb248YnIgLz5JbnRlZ2VyIDxiPldCLlJEcHRyPC9iPjxiciAvPjxiciAvPlRoZSBwb2ludGVyIGZvciB0aGUgbmV4dCB3cml0ZSBzdHJpbmcgb3BlcmF0aW9uPGJyIC8+SW50ZWdlciA8Yj5XQi5XUnB0cjwvYj48YnIgLz48YnIgLz5UaGUgSkVERUMgaWRlbnRpZmllciBvZiB0aGUgRmxhc2ggaW5jbHVkaW5nIHRoZSBtYW51ZmFjdHVyZXIgYW5kIHRoZW4gdGhlIDIgYnl0ZSBkZXZpY2UgSUQ8YnIgLz5JbnRlZ2VyIDxiPldCLklEPC9iPjxiciAvPjxiciAvPkEgaHVtYW4gZnJpZW5kbHkgdmVyc2lvbiBvZiB0aGUgSUQgZS5nLiBXMjVRMzIgZXRjLjxiciAvPlN0cmluZyA8Yj5XQiQ8L2I+PGJyIC8+PGJyIC8+VGhlIHRvcC1tb3N0IGF2YWlsYWJsZSBtZW1vcnkgbG9jYXRpb248YnIgLz5JbnRlZ2VyIDxiPldCLlRvcDwvYj48YnIgLz48YnIgLz48YnIgLz48YSBocmVmPSJNTUJhc2ljLkVkaXQuYXNweD9QYWdlPU1NQmFzaWMuTU1CYXNpYy1jb2RlLXBhY2stdG8tUmVhZC1hbmQtV3JpdGUtV2luYm9uZC1GbGFzaC1NZW1vcmllcyZhbXA7U2VjdGlvbj0zIiBjbGFzcz0iZWRpdHNlY3Rpb25saW5rIj48L2E+PGgxIGNsYXNzPSJzZXBhcmF0b3IiPlRoZSBSb3V0aW5lczxhIGNsYXNzPSJoZWFkZXJhbmNob3IiIGlkPSJUaGVfUm91dGluZXNfMyIgaHJlZj0iI1RoZV9Sb3V0aW5lc18zIiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMT5EaXNjb3ZlciB3aGF0IHR5cGUgb2YgRmxhc2ggYW5kIEluaXRpYWxpc2UgdGhlIGludGVybmFsIHBvaW50ZXJzPGJyIC8+PGI+V0IuSW5pdDwvYj48YnIgLz48YnIgLz5SZWFkIHRoZSB0aHJlZSBzdGF0dXMgcmVnaXN0ZXJzPGJyIC8+PGI+PVdCLlN0YXQxUkQoKTwvYj48YnIgLz48Yj49V0IuU3RhdDJSRCgpPC9iPjxiciAvPjxiPj1XQi5TdGF0M1JEKCk8L2I+PGJyIC8+PGJyIC8+V2FpdCBmb3IgdGhlIEZsYXNoIHRvIGJlY29tZSBpZGxlIC0geW91IG1heSBuZWVkIHRvIHB1dCBhIFdBVENIRE9HIGluIGhlcmUgc28geW91ciBjb2RlIGRvZXNuJ3QgcmVzdGFydCBvbiBsb25nIHdhaXRzPGJyIC8+PGI+V0IuV2FpdEJ1c3k8L2I+PGJyIC8+PGJyIC8+Y2hlY2sgaWYgdGhlIEZsYXNoIGlzIGJ1c3kgd2l0aG91dCB3YWl0aW5nPGJyIC8+PGI+PVdCLlRlc3RCdXN5KCk8L2I+PGJyIC8+PGJyIC8+UGVlayBhIGJ5dGUgYXQgdGhlIGdpdmVuIGFkZHJlc3MgaW4gRmxhc2guIEZsYXNoIGlzIGVyYXNlZCB0byBGRiBzbyB3aGVuIHdlIHBlZWsgdGhlIG5leHQgYWRkcmVzczxiciAvPmFmdGVyIGEgc3RyaW5nIHdlIGNhbiB0ZWxsIGlmIHdlIGFyZSBhdCBFT0Y8YnIgLz48Yj49V0IuUGVlayhhZGRyZXNzKTwvYj48YnIgLz48YnIgLz5SZWFkIGEgc3RyaW5nIGZyb20gdGhlIGN1cnJlbnQgcmVhZCBwb2ludGVyIGFuZCBpbmNyZW1lbnQgdGhlIHBvaW50ZXI8YnIgLz5yZXR1cm5zIENociQoMjU1KSBpZiB3ZSBhcmUgYXQgdGhlIGVuZCBvZiB0aGUgZGF0YTxiciAvPjxiPj1XQi5SZWFkU3RyJCgpPC9iPjxiciAvPjxiciAvPldyaXRlIGEgc3RyaW5nIHRvIHRoZSBjdXJyZW50IHdyaXRlIHBvaW50ZXIgYW5kIGluY3JlbWVudCB0aGUgcG9pbnRlcjxiciAvPnJldHVybnMgYSB6ZXJvIGlmIHN1Y2Nlc3NmdWwgYW5kIDEgaWYgdGhlIHdyaXRlIHdvdWxkIGV4Y2VlZCBGbGFzaCBzdG9yYWdlPGJyIC8+PGI+PVdCLldyaXRlU3RyKGEkKTwvYj48YnIgLz48YnIgLz5FcmFzZSB0aGUgZW50aXJlIEZsYXNoOyBzZXRzIGFsbCBtZW1vcnkgbG9jYXRpb25zIHRvIGNvbnRhaW4gMEZGaCAtIGRvZXMgYW4gaW5pdGlhbGl6YXRpb24gYWZ0ZXJ3YXJkcyB0byByZXNldCBhbGwgdGhlIHBvaW50ZXJzLiBOZXcgRmxhc2ggY2hpcHMgc2hvdWxkIGJlIGZvcm1hdHRlZCBiZWZvcmUgdXNlIGFzIHRoZXkgbWF5IGNvbnRhaW4gcmFuZG9tIGRhdGEgdGhhdCB3aWxsIGNvbmZ1c2UgV0IuSW5pdCBhbmQgcmV0dXJuIGR1YmlvdXMgIHVzYWdlIGZpZ3VyZXMuPGJyIC8+PGI+V0IuRm9ybWF0PC9iPjxiciAvPjxiciAvPlN1cHBvcnQgcm91dGluZXMgLSB1bmxpa2VseSB0byBiZSB1c2VmdWwgaW4geW91ciBjb2RlOjxiciAvPjxiciAvPmxhdGNoIGEgdGhyZWUgYnl0ZSBhZGRyZXNzIGluIHRoZSBGbGFzaDxiciAvPjxiPldCLkFkZHIoYWRkcmVzcyk8L2I+PGJyIC8+PGJyIC8+RW5hYmxlL0Rpc2FibGUgd3JpdGUgZnVuY3Rpb248YnIgLz48Yj5XQi5XUkVuYWJsZSgwfDEpPC9iPjxiciAvPjxiciAvPlNldCB1cCB0aGUgcGFnZSBhZGRyZXNzIGR1cmluZyBhIHdyaXRlPGJyIC8+PGI+V0IuU2V0UGFnZTwvYj48YnIgLz48YnIgLz48YnIgLz48YSBocmVmPSJNTUJhc2ljLkVkaXQuYXNweD9QYWdlPU1NQmFzaWMuTU1CYXNpYy1jb2RlLXBhY2stdG8tUmVhZC1hbmQtV3JpdGUtV2luYm9uZC1GbGFzaC1NZW1vcmllcyZhbXA7U2VjdGlvbj00IiBjbGFzcz0iZWRpdHNlY3Rpb25saW5rIj48L2E+PGgxIGNsYXNzPSJzZXBhcmF0b3IiPkV4YW1wbGU8YSBjbGFzcz0iaGVhZGVyYW5jaG9yIiBpZD0iRXhhbXBsZV80IiBocmVmPSIjRXhhbXBsZV80IiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMT48cHJlPg0KJyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsNCicgeW91ciBzZXR1cCBjb2RlIGdvZXMgIGhlcmUNCicmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7DQpJbml0JiM1ODsNCglDUFUgNDgNCgknT3B0aW9uIEF1dG9ydW4gT24NCgknT3B0aW9uIEJhdWRyYXRlIDk2MDANCglPcHRpb24gRXhwbGljaXQNCglPcHRpb24gQmFzZSAwDQoNCglDb25zdCBWZXIkPSIwLjIwIG9mIDI0LU5PVi0yMDE5Ig0KDQonJiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7LQ0KJ1RoZSBvbmx5IGNvbmZpZyB5b3Ugc2hvdWxkIG5lZWQgdG8gZG8mIzU4Ow0KJ2NoYW5nZSB0aGUgZm9sbG93aW5nIHRvIHRoZSBDUyBwaW4gZm9yIHRoZSBGbGFzaCBtZW1vcnkNCglDb25zdCBXQi5DUz0yMw0KJ2NoYW5nZSB0aGUgZm9sbG93aW5nIHRvIHRoZSBTUEkgY2hhbm5lbCB3aGVyZSB5b3VyIEZsYXNoIGNoaXAgaXMgKGl0J3MgdXN1YWxseSBPSyB0byBsZWF2ZSBpdCBvcGVuDQonc28gbG9uZyBhcyBub3RoaW5nIGVsc2UgaXMgY29tcGV0aW5nIGFuZCBjbG9zZXMgaXQgYWZ0ZXIgdXNlIC0gZS5nLiBMQ0QgcGFuZWxzKQ0KCVNQSSBPcGVuIDIwMDAwMDAwLDAsOCcyME1IeiwgbW9kZSAwLCA4IGJpdHMuLi4gc2VlbXMgaGFwcHkgYXQgMjBNSHogYnV0IGRyb3AgdGhpcyBkb3duIGlmIHlvdSBnZXQgcHJvYnMNCicmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTstDQoNCg0KJ21hbmRhdG9yeSB2YXJpYWJsZXMgaW4geW91ciBwcm9ncmFtJiM1ODsNCicmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTstDQoJRGltIEludGVnZXIgV0IuUkRwdHIsV0IuV1JwdHIsV0IuVG9wLFdCLklELHgsbg0KCURpbSBXQiQNCicmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTstDQoNCgkNCg0KDQoNCg0KJyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsNCicgeW91ciBwcm9ncmFtIGdvZXMgIGhlcmUNCicmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7DQoNCg0KJ0EgbGl0dGxlIGRlbW9uc3RyYXRpb24gY29kZS4uLg0KDQoJeD1XQi5Jbml0KCkJJ3NpbmdsZSBmdW5jdGlvbiBpZCdzIHRoZSBkZXZpY2UsIHNldHMgbWVtIHNpemUgYW5kIGZpbmRzIGZpcnN0IHVzYWJsZSBhZGRyZXNzDQoJCQkneW91ciBjb2RlIHNob3VsZCBjaGVjayBXQi5Ub3AgYWZ0ZXIgdGhpcyBjYWxsLiBpZiBubyBGbGFzaCBmb3VuZCBvciBjb3VsZG4ndCBiZSBpZGVudGlmaWVkLCBXQi5Ub3A9LTENCglJZiB4Jmx0OyZndDswIFRoZW4NCgkJUHJpbnQiRmxhc2ggY2hpcCBub3QgcmVjb2duaXplZCYjNTg7ICI7SGV4JCh4LDYpDQoJCUVuZA0KCUVuZElmDQoNCglEaW0geSQNCglEaW0gSW50ZWdlciBtDQoNCglQcmludCJGb3VuZCAiO1dCJDsiICgiO0hleCQoV0IuSUQsNik7IikiDQoJUHJpbnQibWVtb3J5IHNpemUgaXMiOyhXQi5Ub3ArMSkvMTAyNDsiS0IgKDAtIitIZXgkKFdCLlRvcCkrIikiDQoJUHJpbnQiRmlyc3QgYmxhbmsgYWRkcmVzcyBpcyAiO0hleCQoV0IuV1JwdHIpOyJoIg0KDQoJSW5wdXQiRm9ybWF0IGJlZm9yZSB0ZXN0aW5nIChZL04pPyIseSQNCglJZiB5JD0ieSIgdGhlbg0KCQlQcmludCAiRm9ybWF0dGluZy4uLiINCgkJV0IuRm9ybWF0DQoJCVByaW50IkZpcnN0IGJsYW5rIGFkZHJlc3MgaXMgIjtIZXgkKFdCLldScHRyKTsiaCINCglFbmRJZg0KDQoJUmFuZG9taXplIFRpbWVyICcgZGVsZXRlIHRoaXMgbGluZSBvbiBNTVgvQXJtIGV0Yw0KDQond3JpdGUgc29tZSByYW5kb20gc3RyaW5ncyB0byBGbGFzaCB3aXRoIHRpbWluZ3MNCglQcmludA0KCVByaW50IiIsIldSIFRpbWUiDQoJUHJpbnQiJiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyINCg0KCUZvciBuPTEgVG8gMTANCgkJUHJpbnQgbiwNCgkJVGltZXI9MCYjNTg7eD1XQi5Xcml0ZVN0cihEYXRlJCsiICIrVGltZSQrIiAiK1N0cmluZyQoNjUsNDgrUm5kJiM0Mjs3MCkpJiM1ODtQcmludCBUaW1lcjsibVMiDQoJTmV4dA0KDQoncmVhZCBiYWNrIHRoZSBzdHJpbmdzIC0gZGVtb25zdHJhdGVzIGNociQoMjU1KSBpZiBhdHRlbXB0aW5nIHRvIHJlYWQNCglQcmludCYjNTg7UHJpbnQiUmVhZGluZyBiYWNrIGFsbCBzdHJpbmdzLi4uIg0KCVByaW50IkFkZHIiLCJUaW1lIiwiRGF0YSINCglQcmludCImIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7JiM0NTsmIzQ1OyYjNDU7Ig0KCURvDQoJCVByaW50IEhleCQoV0IuUkRwdHIsNCk7ImgiLA0KCQlUaW1lcj0wJiM1ODt5JD1XQi5SZWFkU3RyJCgpJiM1ODtQcmludCBUaW1lcix5JA0KCUxvb3AgV2hpbGUgeSQmbHQ7Jmd0O0NociQoMjU1KQ0KDQoJRm9yIG49MCBUbyAxMDIzIFN0ZXAgMTYNCgkJeSQ9IiINCgkJUHJpbnQgSGV4JChuLDQpOyIgICI7DQoJCUZvciBtPTAgVG8gMTUNCgkJCXg9V0IuUGVlayhuK20pDQoJCQlQcmludCBIZXgkKHgsMik7IiAgIjsNCgkJCUlmIHgmbHQ7MzIgT3IgeCZndDsxMjYgVGhlbiB4PSZhbXA7aDJlDQoJCQl5JD15JCtDaHIkKHgpDQoJCU5leHQNCgkJUHJpbnQgeSQNCglOZXh0DQoNCglJbnB1dCJGb3JtYXQgdGhlIEZsYXNoIChZL04pPyIseSQNCgl5JD1VQ2FzZSQoeSQpDQoJSWYgeSQ9IlkiIFRoZW4NCgkJUHJpbnQid2FpdCBhIG1vbWVudCINCgkJdGltZXI9MCYjNTg7V0IuRm9ybWF0JiM1ODtQcmludCB0aW1lcjsibVMiDQoJRW5kSWYNCg0KCUVuZA0KPC9wcmU+PGJyIC8+VGhlIHJvdXRpbmVzIGFyZSBmYWlybHkgYnJpc2sgYW5kIG51bWVyb3VzIHRlc3RpbmcvYWRqdXN0bWVudCBwaGFzZXMgaGF2ZSByZXN1bHRlZCBpbiBzb21lIHRyaWNrcyB0byBtYWtlIHRoZW0gYXMgZmFzdCBhcyBwb3NzaWJsZS4gVGhlIFdyaXRlIGZ1bmN0aW9uIHdhcyBhIGJvdHRsZS1uZWNrIGFuZCBoYXMgYmVlbiByZS13cml0dGVuLiBJdCBpcyBub3cgdmVyeSBxdWljayBhbmQgYmVjYXVzZSBvZiB0aGUgU1BJIEJ1bGsgV3JpdGUgbWV0aG9kcyBhdmFpbGFibGUsIHBhcmFkb3hpY2FsbHksIHdyaXRlcyBzdWJzdGFudGlhbGx5IG91dC1wZXJmb3JtIHJlYWRzIGJ5IGFib3V0IGEgZmFjdG9yIG9mIDMgd29yc3QgY2FzZSAoMjU1IGNoYXJhY3RlciBzdHJpbmdzKSBhdCB+MjBtUyBWcyB+NzBtUy4gV2l0aCAzIGNoYXJhY3RlciBzdHJpbmdzLCBSZWFkcyB0YWtlIGFyb3VuZCA1bVMgYW5kIFdyaXRlcyBhcmUgc3RpbGwgYXJvdW5kIHRoZSAyMG1TIG1hcmsuPGJyIC8+PGJyIC8+SGVyZSBhcmUgc29tZSB0aW1pbmdzIGZvciBzZXF1ZW50aWFsIHJlYWRzICYgd3JpdGVzIG9uIGEgNDhNSHogJzE3MCB3aXRoIDI0TUh6IFNQSSBidXMuPGJyIC8+PGJyIC8+UmFuZG9tIDI1NCBjaGFyIHN0cmluZ3MgKHdvcnN0IGNhc2UpPGJyIC8+PGNvZGU+PGJyIC8+bmV3IHdyaXRlIG1ldGhvZDo8YnIgLz48aHI+PGJyIC8+IDEgICAgICAgMTFtUzxiciAvPiAyICAgICAgIDE5bVM8YnIgLz4gMyAgICAgICAxOW1TPGJyIC8+IDQgICAgICAgMTltUzxiciAvPiA1ICAgICAgIDIwbVM8YnIgLz4gNiAgICAgICAxOW1TPGJyIC8+IDcgICAgICAgMTltUzxiciAvPiA4ICAgICAgIDE5bVM8YnIgLz4gOSAgICAgICAxOW1TPGJyIC8+IDEwICAgICAgMjBtUzxiciAvPjxiciAvPjxiciAvPm9sZCB3cml0ZSBtZXRob2Q6PGJyIC8+PGhyPjxiciAvPiAxICAgICAgIDg5bVM8YnIgLz4gMiAgICAgICA5N21TPGJyIC8+IDMgICAgICAgOTdtUzxiciAvPiA0ICAgICAgIDk2bVM8YnIgLz4gNSAgICAgICA5N21TPGJyIC8+IDYgICAgICAgOTZtUzxiciAvPiA3ICAgICAgIDk2bVM8YnIgLz4gOCAgICAgICA5N21TPGJyIC8+IDkgICAgICAgOTZtUzxiciAvPiAxMCAgICAgIDk3bVM8YnIgLz48L2NvZGU+PGJyIC8+PGJyIC8+UmVhZCAyNTQgY2hhcmFjdGVyIHN0cmluZzxiciAvPjxjb2RlPjxiciAvPjxocj48YnIgLz4gICAgNzNtUyAgICA8YnIgLz4gICAgNzJtUyAgICAgPGJyIC8+ICAgIDcybVMgICAgIDxiciAvPiAgICA3MW1TICAgICA8YnIgLz4gICAgNzJtUyAgICAgPGJyIC8+ICAgIDcybVMgICAgIDxiciAvPiAgICA3Mm1TICAgICA8YnIgLz4gICAgNzJtUzxiciAvPjwvY29kZT48YnIgLz5SZWFkIDMgY2hhcmFjdGVyIHN0cmluZzxiciAvPjxjb2RlPjxiciAvPjxocj4gIDxiciAvPiAgICA1bVMgICAgICA8YnIgLz4gICAgNW1TICAgICAgPGJyIC8+ICAgIDRtUyAgICAgIDxiciAvPiAgICA1bVMgICAgICA8YnIgLz4gICAgNW1TICAgICAgPGJyIC8+ICAgIDVtUyAgICAgIDxiciAvPiAgICA1bVMgICAgICA8YnIgLz4gICAgNG1TICAgICAgPGJyIC8+ICAgIDVtUyAgICAgIDxiciAvPjwvY29kZT48YnIgLz48YnIgLz48YSBocmVmPSJNTUJhc2ljLkVkaXQuYXNweD9QYWdlPU1NQmFzaWMuTU1CYXNpYy1jb2RlLXBhY2stdG8tUmVhZC1hbmQtV3JpdGUtV2luYm9uZC1GbGFzaC1NZW1vcmllcyZhbXA7U2VjdGlvbj01IiBjbGFzcz0iZWRpdHNlY3Rpb25saW5rIj48L2E+PGgxIGNsYXNzPSJzZXBhcmF0b3IiPlRoZSBDb2RlPGEgY2xhc3M9ImhlYWRlcmFuY2hvciIgaWQ9IlRoZV9Db2RlXzUiIGhyZWY9IiNUaGVfQ29kZV81IiB0aXRsZT0iTGluayB0byB0aGlzIFNlY3Rpb24iPiYjMDE4Mjs8L2E+PC9oMT48cHJlPg0KJyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsNCidGbGFzaCBTdWJzICZhbXA7IEZ1bmN0aW9ucw0KJ2FsbCBhYm9ydCBXQi5Ub3A9LTENCidPbmx5IHRlc3RlZCB3aXRoIDQgYW5kIDggTUIgZGV2aWNlcyAtIGJlIGNhcmVmdWwgaWYgc3RlcHBpbmcgb3V0IG9mIHRoaXMuDQoNCidEaXNjb3ZlciB0aGUgYXR0YWNoZWQgZmxhc2ggbWVtb3J5IGFuZCBpbml0aWFsaXplIGFsbCB0aGUgcG9pbnRlcnMgYW5kIHN0dWZmDQonc2V0cyB1cCB0aGUgQ1MgcGluIGFuZCBvcGVucyB0aGUgU1BJIGNoYW5uZWwNCidyZXR1cm5zIDAgaWYgdGhlIGNoaXAgaXMgSURlZCB3aXRoIGFsbCB0aGUgdmFyaWFibGVzIGNvcnJlY3RseSBzZXQgdXAuDQonZWxzZSByZXR1cm5zIHRoZSBJRCByZWFkIGZyb20gdGhlIGNoaXAgPSAmYW1wO0ZGRkZGRiBpcyBvcGVuIGJ1cyAobm8gY2hpcCkNCglGdW5jdGlvbiBXQi5Jbml0KCkgQXMgSW50ZWdlcg0KCQlMb2NhbCBJbnRlZ2VyIG4NCgkJV0IuVG9wPS0xJiM1ODtXQi5XUnB0cj0tMQ0KCQknaWRlbnRpZnkgdGhlIEZsYXNoIHJhbSBieSByZWFkaW5nIHRoZSBKRURFQyBJRCBhbmQgc2V0dGluZyBzb21lIGtleSB2YWx1ZXMNCgkJUGluKFdCLkNTKT0wDQoJCQl4PVNQSSgmYW1wO2g5RikNCgkJCVdCLklEPTY1NTM2JiM0MjtTUEkoMCkrMjU2JiM0MjtTUEkoMCkrU1BJKDApDQoJCVBpbihXQi5DUyk9MQ0KCQknaWYgeW91ciBkZXZpY2UgaXMgbm90IGxpc3RlZCBvciBjb21lcyB1cCB1bmtub3duLCB5b3UnbGwgaGF2ZSB0byBkZXRlcm1pbmUgdGhlIGNvcnJlY3QgSUQNCgkJJ2Zyb20gdGhlIGRldmljZSBQREYgYW5kIGFkZCBpdCBiZWxvdy4gR29vZCBuZXdzIGlzLCBpdCBsb29rcyBsaWtlIGFsbCB0aGUgV2luYm9uZCBXMjUmIzQyOyBhcmUNCgkJJzRLQiBzZWN0b3JzIGFuZCAyNTZCIHBhZ2Ugc2l6ZSBzbyB0aGUgY29kZSAmIzQyO3Nob3VsZCYjNDI7IHdvcmsgd2l0aG91dCBhbnkgY2hhbmdlcyAtIG5vIGd1YXJhbnRlZXMNCgkJJ29ubHkga25vd24gcHJvYmxlbSBpcyB0aGUgY29kZSBhc3N1bWVzIGEgMjQgYml0IGFkZHJlc3Mgd2hpY2ggYnJlYWtzIGZvciAmZ3Q7MTZNQiBkZXZpY2VzIGFuZCBtYXliZQ0KCQknb3RoZXJzIHdoaWNoIG1pZ2h0IG9ubHkgcHJvdmlkZSBhIDE2IGJpdCBhZGRyZXNzIC0gaGF2ZW4ndCBsb29rZWQgYXQgdGhlIFBERi4NCgkJJ1RoZSBXaW5ib25kIHByb2R1Y3Qgc2VsZWN0b3Igc2hvd3MgdGhlc2UgY2hpcHMgYnV0IEkgY291bGRuJ3QgZmluZCBQREZzIGZvciB0aGVtJiM1ODsNCgkJJ1cyNVEwMkpWCTI1Nk1CDQoJCSdXMjVRMDFKVgkxMjhNQg0KDQoJCVNlbGVjdCBDYXNlIFdCLklEDQoJCQknJiM0MjsmIzQyOyYjNDI7IFRlc3RlZA0KCQkJQ2FzZSAmYW1wO2hFRjQwMTgmIzU4O1dCLlRvcD0xNjM4NCYjNTg7V0IkPSJXMjVRMTI4IicxNk1CDQoJCQlDYXNlICZhbXA7aEVGNDAxNyYjNTg7V0IuVG9wPTgxOTImIzU4O1dCJD0iVzI1UTY0Iic4TUINCgkJCUNhc2UgJmFtcDtoRUY0MDE2JiM1ODtXQi5Ub3A9NDA5NiYjNTg7V0IkPSJXMjVRMzIiJzRNQg0KCQkJQ2FzZSAmYW1wO2hFRjQwMTUmIzU4O1dCLlRvcD0yMDQ4JiM1ODtXQiQ9IlcyNVExNiInMk1CDQoJCQlDYXNlICZhbXA7aEVGNDAxNCYjNTg7V0IuVG9wPTEwMjQmIzU4O1dCJD0iVzI1UTgwIicxTUINCgkJCScmIzQyOyYjNDI7JiM0MjsgVW5UZXN0ZWQNCgkJCUNhc2UgJmFtcDtoRUY0MDIwJiM1ODtXQi5Ub3A9NjU1MzYmIzU4O1dCJD0iVzI1UTUxMiInNjRNQiAtIHByb2JhYmx5IHdvbid0IHdvcmsgd2l0aCB0aGlzIGNvZGUgYXMgJmd0OzI0Yml0IGFkZHJlc3MNCgkJCUNhc2UgJmFtcDtoRUY0MDE5JiM1ODtXQi5Ub3A9MzI3NjgmIzU4O1dCJD0iVzI1UTI1NiInMzJNQiAtIHByb2JhYmx5IHdvbid0IHdvcmsgd2l0aCB0aGlzIGNvZGUgYXMgJmd0OzI0Yml0IGFkZHJlc3MNCgkJCUNhc2UgJmFtcDtoRUY0MDEzJiM1ODtXQi5Ub3A9NTEyJiM1ODtXQiQ9IlcyNVE0MCInNTEyS0INCgkJCUNhc2UgJmFtcDtoRUY1MDEyJiM1ODtXQi5Ub3A9MjU2JiM1ODtXQiQ9IlcyNVEyMCInMjU2S0INCgkJCUNhc2UgJmFtcDtoRUY2MDExJiM1ODtXQi5Ub3A9MTI4JiM1ODtXQiQ9IlcyNVExMCInMTI4S0INCgkJCUNhc2UgJmFtcDtoRUYzMDEwJiM1ODtXQi5Ub3A9NjQmIzU4O1dCJD0iVzI1WDA1Iic2NEtCDQoJCQknQ2FzZSAmYW1wO2hCRjI2NDImIzU4O1dCLlRvcD00MDk2JiM1ODtXQiQ9IlNTVDI2VkYwMzIiJ01pY3JvY2hpcCA0TUIgcGluIGFuZCBjb2RlIGNvbXBhdGlibGUgLSBuZWVkcyB3b3JrIG9uIGdsb2JhbCBlbmFibGUNCgkJCUNhc2UgRWxzZQ0KCQkJCVNQSSBDbG9zZSYjNTg7V0IuVG9wPS0xJiM1ODtXQi5Jbml0PVdCLklEJiM1ODtFeGl0IEZ1bmN0aW9uJ2Nhbid0IGlkZW50aWZ5DQoJCUVuZCBTZWxlY3QNCg0KCQlXQi5Ub3A9KFdCLlRvcCYjNDI7MTAyNCktMSdzZXQgdGhlIHRvcCBtZW1vcnkgbG9jYXRpb24NCg0KJ2ZpbmQgdGhlIGZpcnN0ICg9bG93ZXN0IGFkZHJlc3Mgd2l0aCkgRkYgYnl0ZQ0KCQlJZiBXQi5QZWVrKDApPTI1NSBUaGVuIFdCLldScHRyPTAmIzU4O1dCLlJEcHRyPTAmIzU4O0V4aXQgRnVuY3Rpb24nYmxhbmsgRmxhc2g7IGVhcmx5IGJhdGgNCidvdGhlcndpc2UgZmluZCBieSBzdWNjZXNzaXZlIGFwcHJveGltYXRpb24gLSB2ZXJ5IGZhc3QsIHNlYXJjaGVzIDRNQiBpcyA4MG1TDQoJCVdCLldScHRyPShXQi5Ub3ArMSlcMiYjNTg7bj1XQi5XUnB0clwyJ3N0YXJ0IGF0IHRoZSBtaWRkbGUgYW5kIGdvIGluIHNtYWxsZXIgYW5kIHNtYWxsZXIgaGFsdmVzDQoJCURvDQoJCQlJZiBXQi5QZWVrKFdCLldScHRyKT0yNTUgVGhlbg0KCQkJCVdCLldScHRyPVdCLldScHRyLW4nc3RpbGwgaW4gdm9pZCBzbyBnbyBkb3duIGJ5IGhhbGYgdGhlIHJlbWFpbmRlcg0KCQkJRWxzZQ0KCQkJCVdCLldScHRyPVdCLldScHRyK24nd2UgYXJlIGluIHRoZSBzdHJpbmdzIHNvIGdvIHVwIGJ5IGhhbGYgdGhlIHJlbWFpbmRlcg0KCQkJRW5kSWYNCgkJCUlmIG4mbHQ7Jmd0OzEgVGhlbiBuPW5cMidzbWFsbGVyIGFuZCBzbWFsbGVyIGhhbHZlcw0KCQlMb29wIFVudGlsIFdCLlBlZWsoV0IuV1JwdHIpPTI1NSBBbmQgV0IuUGVlayhXQi5XUnB0ci0xKSZsdDsmZ3Q7MjU1J2lzIHRoZSBieXRlIGJlZm9yZSB0aGUgRkYgIUZGPyBpcyBzbywgd2UgYXJlIGRvbmUNCglFbmQgRnVuY3Rpb24NCg0KJ3NldCBvciBjbGVhciBmbGFzaCB3cml0ZSBlbmFibGUgZmxhZw0KCVN1YiBXQi5XUkVuYWJsZShhIEFzIEludGVnZXIpDQoJCUlmIFdCLlRvcD0tMSBUaGVuIEV4aXQgU3ViDQoJCUxvY2FsIEludGVnZXIgeA0KCQlQaW4oV0IuQ1MpPTANCgkJCUlmIGE9MCBUaGVuDQoJCQkJeD1TUEkoNCkNCgkJCUVsc2UNCgkJCQl4PVNQSSg2KQ0KCQkJRW5kSWYNCgkJUGluKFdCLkNTKT0xDQoJCVdCLldhaXRCdXN5DQoJRW5kIFN1Yg0KDQond2FpdCB3aGlsZSBGbGFzaCBpcyBidXN5DQoJU3ViIFdCLldhaXRCdXN5DQoJCUlmIFdCLlRvcD0tMSBUaGVuIEV4aXQgU3ViDQoJCURvIFdoaWxlIFdCLlRlc3RCdXN5KCkNCgkJJ3lvdSBtaWdodCB3YW50IHRvIHB1dCBhIFdBVENIRE9HIGhlcmUuIExvbmcgb3BlcmF0aW9ucyBjb3VsZCBicmVhayB5b3VyIHByb2dyYW0NCgkJTG9vcA0KCUVuZCBTdWINCg0KJ3Rlc3QgQlVTWSBmbGFnIGluIFNUQVQxDQoJRnVuY3Rpb24gV0IuVGVzdEJ1c3koKSBBcyBJbnRlZ2VyDQoJCUlmIFdCLlRvcD0tMSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJV0IuVGVzdEJ1c3k9KFdCLlN0YXQxUkQoKSBBbmQgMSkNCglFbmQgRnVuY3Rpb24NCg0KCUZ1bmN0aW9uIFdCLlN0YXQxUkQoKSBBcyBJbnRlZ2VyDQoJCUlmIFdCLlRvcD0tMSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTG9jYWwgSW50ZWdlciB4DQoJCVBpbihXQi5DUyk9MA0KCQkJeD1TUEkoNSkNCgkJCVdCLlN0YXQxUkQ9U1BJKDApDQoJCVBpbihXQi5DUyk9MQ0KCUVuZCBGdW5jdGlvbg0KDQoJRnVuY3Rpb24gV0IuU3RhdDJSRCgpIEFzIEludGVnZXINCgkJSWYgV0IuVG9wPS0xIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlMb2NhbCBJbnRlZ2VyIHgNCgkJUGluKFdCLkNTKT0wDQoJCQl4PVNQSSgmYW1wO2gzNSkNCgkJCVdCLlN0YXQyUkQ9U1BJKDApDQoJCVBpbihXQi5DUyk9MQ0KCUVuZCBGdW5jdGlvbg0KDQoJRnVuY3Rpb24gV0IuU3RhdDNSRCgpIEFzIEludGVnZXINCgkJSWYgV0IuVG9wPS0xIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlMb2NhbCBJbnRlZ2VyIHgNCgkJUGluKFdCLkNTKT0wDQoJCQl4PVNQSSgmYW1wO2gxNSkNCgkJCVdCLlN0YXQzUkQ9U1BJKDApDQoJCVBpbihXQi5DUyk9MQ0KCUVuZCBGdW5jdGlvbg0KDQonc2VuZCBhIDMgYnl0ZSBhZGRyZXNzIHRvIEZsYXNoDQoJU3ViIFdCLkFkZHIoYSBBcyBJbnRlZ2VyKQ0KCQlMb2NhbCBJbnRlZ2VyIHgNCgkJeD1TUEkoKGEmZ3Q7Jmd0OzE2KSBBbmQgMjU1KQ0KCQl4PVNQSSgoYSZndDsmZ3Q7OCkgQW5kIDI1NSkNCgkJeD1TUEkoYSBBbmQgMjU1KQ0KCUVuZCBTdWINCg0KJ3NldCB0aGUgYWRkcmVzcyBmb3IgcGFnZSB3cml0aW5nDQoJU3ViIFdCLlNldFBhZ2UNCgkJTG9jYWwgSW50ZWdlciB4DQoJCVBpbihXQi5DUyk9MQ0KCQlXQi5XYWl0QnVzeQ0KCQlXQi5XUkVuYWJsZSAxDQoJCVdCLldhaXRCdXN5DQoJCVBpbihXQi5DUyk9MA0KCQl4PVNQSSgyKQ0KCQlXQi5BZGRyIFdCLldScHRyJ3NldHVwIHRoZSBhZGRyZXNzDQoJRW5kIFN1Yg0KDQonZXJhc2UgdGhlIGVudGlyZSBjaGlwIC0gQ0FVVElPTiB0YWtlcyBhIGxvbmcgdGltZQ0KCVN1YiBXQi5Gb3JtYXQoKQ0KCQlJZiBXQi5Ub3A9LTEgVGhlbiBFeGl0IFN1Yg0KCQlMb2NhbCBJbnRlZ2VyIHgNCgkJV0IuV1JFbmFibGUgMQ0KCQlXQi5XYWl0QnVzeQ0KCQlQaW4oV0IuQ1MpPTANCgkJCXg9U1BJKCZhbXA7aDYwKSdzdGFydCB0aGUgZXJhc2UgLSB3aWxsIHRha2Ugc29tZSB0aW1lDQoJCVBpbihXQi5DUyk9MQ0KCQlXQi5XYWl0QnVzeQ0KCQl4PVdCLkluaXQoKQ0KCUVuZCBTdWINCg0KJwlQZWVrIGFueSBhZGRyZXNzIGluIEZsYXNoDQoJRnVuY3Rpb24gV0IuUGVlayhhIEFzIEludGVnZXIpIEFzIEludGVnZXINCgkJSWYgV0IuVG9wPS0xIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlMb2NhbCBJbnRlZ2VyIHgNCgkJUGluKFdCLkNTKT0wDQoJCQl4PVNQSSgzKSdyZWFkIGF0IHRoZSBnaXZlbiBhZGRyZXNzDQoJCQlXQi5BZGRyIGENCgkJCVdCLlBlZWs9U1BJKDApJ2dyYWIgb25lIGJ5dGUNCgkJUGluKFdCLkNTKT0xDQoJRW5kIEZ1bmN0aW9uDQoNCidSZWFkIGEgc3RyaW5nIGZyb20gdGhlIFJlYWQgQWRkcmVzcyB1c2luZyB0aGUgZ2xvYmFsIFdCLlJEcHRyIHZhcmlhYmxlDQoJRnVuY3Rpb24gV0IuUmVhZFN0ciQoKQ0KCQlJZiBXQi5Ub3A9LTEgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCUxvY2FsIEludGVnZXIgeCx6DQoJCUxvY2FsIGEkDQoJCVdCLldhaXRCdXN5J3dhaXQgZm9yIHRoZSBGbGFzaCB0byBiZSBpZGxlDQoJCVBpbihXQi5DUyk9MA0KCQl4PVNQSSgzKQ0KCQlXQi5BZGRyIFdCLlJEcHRyDQoJCUZvciB6PTEgdG8gMjU2J3N0cmVhbSB0aGUgZGF0YSBmcm9tIEZsYXNoIGludG8gYSQsIDI1NiBjb3ZlcnMgbWF4IGxlbmd0aCtjaHIkKDApLCB3ZSBiYWlsIGVhcmx5IGlmIG5lZWRlZA0KCQkJeD1TUEkoMCknZ2V0IHRoZSBjaGFyYWN0ZXINCgkJCVNlbGVjdCBjYXNlIHgNCgkJCQlDYXNlIDAgJ2JyZWFrIG91dCBvbiB0aGUgZGVsaW1pdGVyDQoJCQkJCVBva2UgVmFyIGEkLDAsei0xDQoJCQkJCVdCLlJEcHRyPVdCLlJEcHRyK0xlbihhJCkrMSdidW1wIHRoZSBhZGRyZXNzIGFsb25nIGJ5IHRoZSBudW1iZXIgb2YgYnl0ZXMgd2UgcmVhZCArMSBmb3IgdGhlIGRlbGltaXRlcg0KCQkJCQlFeGl0IEZvcg0KCQkJCUNhc2UgMjU1ICdicmVhayBvdXQgb24gRU9GDQoJCQkJCVdCLlJEcHRyPVdCLlJEcHRyK0xlbihhJCknc2hvdWxkIG5ldmVyIGhhcHBlbg0KCQkJCQlhJD1DaHIkKHgpJ3NpbmdsZSBjaGFyPw0KCQkJCQlFeGl0IEZvcg0KCQkJCUNhc2UgRWxzZQ0KCQkJCQlQb2tlIFZhciBhJCx6LHgNCgkJCUVuZCBzZWxlY3QNCgkJTmV4dA0KCQlQaW4oV0IuQ1MpPTENCgkJV0IuUmVhZFN0ciQ9YSQNCglFbmQgRnVuY3Rpb24NCg0KJ3dyaXRlIGEgc3RyaW5nIHRvIHRoZSBuZXh0IGF2YWlsYWJsZSBwb3NpdGlvbi4gUmV0dXJuIDAgaWYgc3VjY2Vzc2Z1bA0KCUZ1bmN0aW9uIFdCLldyaXRlU3RyKGEkKSBBcyBJbnRlZ2VyDQoJCUlmIFdCLlRvcD0tMSBUaGVuIFdCLldyaXRlU3RyPTEmIzU4O0V4aXQgRnVuY3Rpb24NCgkJTG9jYWwgSW50ZWdlciBuLHgNCgkJbj1MZW4oYSQpKzENCgkJSWYgV0IuV1JwdHIrbiZndDtXQi5Ub3AgVGhlbiBXQi5Xcml0ZVN0cj0xJiM1ODtFeGl0IEZ1bmN0aW9uDQoJCXg9MjU2LShXQi5XUlB0ciBNb2QgMjU2KScgcmVtYWluaW5nIHNwYWNlIGluIHRoaXMgcGFnZQ0KCQlXQi5TZXRQYWdlDQoJCUlmIG4mbHQ7PXggVGhlbiAnd2lsbCBmaXQgaW4gY3VycmVudCBwYWdlDQoJCQlTUEkgV3JpdGUgbi0xLGEkDQoJCQl4PVNQSSgwKQ0KCQkJUGluKFdCLkNTKT0xDQoJCQlXQi5XclB0cj1XQi5XclB0cituDQoJCUVsc2UgJ2hhdmUgdG8gc3BsaXQgYWNyb3NzIHBhZ2VzDQoJCQknZmlyc3QgaGFsZg0KCQkJTG9jYWwgbCQNCgkJCWwkPUxlZnQkKGEkLHgpDQoJCQlTUEkgV3JpdGUgbGVuKGwkKSxsJA0KCQkJUGluKFdCLkNTKT0xDQoJCQlXQi5XclB0cj1XQi5XclB0cit4DQoJCQknc2Vjb25kIGhhbGYNCgkJCWwkPU1pZCQoYSQseCsxKStDaHIkKDApDQoJCQl4PUxlbihsJCkNCgkJCVdCLlNldFBhZ2UNCgkJCVNQSSBXcml0ZSB4LGwkDQoJCQlQaW4oV0IuQ1MpPTENCgkJCVdCLldyUHRyPVdCLldyUHRyK3gNCgkJRW5kSWYNCglFbmQgRnVuY3Rpb24NCicmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7JiM0MjsmIzQyOyYjNDI7DQo8L3ByZT48YnIgLz48YnIgLz5kZJgbcMTbcqPpXKW9Hc0uTLAW46Us" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="2068001F" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWIQLgp6XeDAK9z4TRAwK9z4DRAwK9z7zRAwK9z7jRAwK9z7TRAwKlz/TSAwKqz/TSAwK7z/TSAwK4z/TSAwK5z/TSAwK+z/TSAwK/z/TSAwK8z/TSAwK9z/TSAwKiz/TSAwK3j57gBwLC5qa8BQLC5qK8BQLC5p68BQLC5pq8BQLC5pa8BQLa5ta/BQLV5ta/BQLE5ta/BQLH5ta/BQLG5ta/BQLB5ta/BQLA5ta/BQLD5ta/BQLC5ta/BQLd5ta/BQL9yYWiCUn6NyCitjRX6BuveemKlc24s8JN" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login4777.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fHistory.aspx%3fNS%3dMMBasic%26Page%3dMMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories%26Revision%3d14" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <h1 class="pagetitlesystem">Page History: MMBasic code-pack to Read and Write Winbond Flash Memories</h1>
    <p>Compare Page Revisions</p> 
    <select name="ctl00$CphMaster$lstRev1" id="ctl00_CphMaster_lstRev1">
	<option value="14">14</option>
	<option value="13">13</option>
	<option value="12">12</option>
	<option value="11">11</option>
	<option value="10">10</option>
	<option value="9">9</option>
	<option value="8">8</option>
	<option value="7">7</option>
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <select name="ctl00$CphMaster$lstRev2" id="ctl00_CphMaster_lstRev2">
	<option value="Current">Current</option>
	<option value="14">14</option>
	<option value="13">13</option>
	<option value="12">12</option>
	<option value="11">11</option>
	<option value="10">10</option>
	<option value="9">9</option>
	<option value="8">8</option>
	<option value="7">7</option>
	<option value="6">6</option>
	<option value="5">5</option>
	<option value="4">4</option>
	<option value="3">3</option>
	<option value="2">2</option>
	<option value="1">1</option>
	<option value="0">0</option>

</select>
    <input type="submit" name="ctl00$CphMaster$btnCompare" value="Compare" id="ctl00_CphMaster_btnCompare" />
    <br /><br />
    
    <table class="box" cellpadding="0" cellspacing="0"><tr><td><p style="text-align: center;"><b><a href="MMBasic.History9f13.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Revision=00013">&laquo; Older Revision</a> - <a href="MMBasic.History75a6.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories">Back to Page History</a> - <a href="MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories.html">Current Revision</a></b></p></td></tr></table><br /><h3 class="separator">Page Revision: 2020/08/07 09:43</h3><br />Winbond flash memories provide an excellent method of storing up to 16MB of data in a tiny SPI driven chip. At around $0.50 each (varies) these offer an amazing storage/price density and are used in many devices to store configuration and firmware. Throwing out an old DSL router? Check the board - there is likely a Flash memory that can be recovered and re-used.<br /><br />SPI is very much faster and easier to drive than I<sup>2</sup>C. The routines here work flawlessly at 20MHz and were inspired by work MatherP published on the BackShed here <a class="externallink" href="https://www.thebackshed.com/forum/ViewTopic.php?TID=8492" title="https://www.thebackshed.com/forum/ViewTopic.php?TID=8492" target="_blank">https://www.thebackshed.com/forum/ViewTopic.php?TID=8492</a><br /><br />That work used CSubs to access the Flash and whereas they are very quick, they exclude users of the bigger 'Mite platforms - the MMX and ST's Arm base processors - the H7/F4 platforms. The routines below are a purely MMBasic solution and so can be used on any MMBasic platform supporting the SPI bus.<br /><br />The approach with the code here is comparable to a sequential file. Data is written using one function and read back with another. When data is exhausted a marker, CHR$(255), is reached. This is analagous with the EOF character of disk filing systems. This code provides a simple logging system of strings in, strings out. It handles this - you decide what you want to do with them. Using a structured logging method e.g. <a class="pagelink" href="MMBasic.Ultra-Compact-Logging-with-Flash-Storage-on-small-MicroMites.html" title="Ultra-Compact Logging with Flash Storage on small MicroMites">Ultra-Compact Logging with Flash Storage on small MicroMites</a> it would be possible to log continuously at one second intervals for eight days straight on a 4MB chip. With arbitrary strings of average length 50 bytes, in excess of 83,000 lines could be stored.<br /><br /><a href="Login12f0.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=0" class="editsectionlink"></a><h1 class="separator">Organisation of Strings in Memory<a class="headeranchor" id="Organisation_of_Strings_in_Memory_0" href="#Organisation_of_Strings_in_Memory_0" title="Link to this Section">&#0182;</a></h1>The Flash technology provides continuous reading starting from a single 24 bit address. Once latched, the address increments with each read and so the entire memory could be rapidly read out with only a single address setup - at 20MHz this could be little more than 400nS per <u>byte</u>! Writing the devices is more involved. The memory is arranged into Pages of 256 bytes and the address latched, although 24 bits, only works within the selected page. The routines take care of this and reading/writing is transparent to the user. You can see from the grab below that a string crosses the boundary with no problem; the two bytes in the yellow boxes are the last and fist bytes in different pages (00FFh & 0100h) but it's all handled by the write function.<br /><br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="wbpages1046.png?File=/MMBasic/wbpages.png" alt="Image" /><br /><br />You can see from the above the method used to store strings in the Flash memory. In the below diagram, each cell represents a byte in Flash - here the string "IIIII"<br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="flash_stringstore03d8.png?File=/flash_stringstore.png" alt="Image" /><br />It can be seen from this that strings are limited to the characters 1 to 254 - i.e. your string cannot contain CHR$(0) or CHR$(255) and that is the only limitation.<br />0 is used as the string delimiter in memory and 255 is the blank memory byte.<br /><br />The initialization routine performs several useful and vital functions:<br /><ul><br /><li> It identifies the type of Flash attached (if any) and sets the maximum address variable WB.Top to the last available memory location.</li><br /><li> It rapidly determines the first unused byte in the memory (more on this later) and sets the WB.WRptr variable so as not to trample on previously stored data</li><br /></ul><br /><br /><a href="Login15e1.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=1" class="editsectionlink"></a><h1 class="separator">Method<a class="headeranchor" id="Method_1" href="#Method_1" title="Link to this Section">&#0182;</a></h1>There are two address pointers, one for read and another for write - this gives an easy access method and they don't clash. In normal use, they are of no concern and any program will simply use the WB.WRstr() and WB.RDstr$() routines.<br /><br /><br />Writing:<br />An erased Flash has all locations set to 255 so it follows the lowest such byte is the first place we can write data without over-writing earlier data (now it is clear why CHR$(255) is prohibited in strings). NOTE: New Flash chips are not necessarily in an erased state. New chips should be formatted before use. <br /><br />WB.WRptr points to the first such memory location i.e. the position new data can be reliably stored. Flash memories retain data for up to 20 years and with such large capacities, it is highly likely that data will be aggregated over power-cycles. At initialization, the first FFh byte is ascertained by a rapid successive approximation algorithm that will return the first such byte in around 80mS on a 4MB chip with 48MHz MicroMite. This address is not stored internally to the Flash - it is determined with each call to WB.Init, the entire memory is available for use. <br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="flashpointers1857e.png?File=/flashpointers1.png" alt="Image" /><br /><br />Reading:<br />Each byte is read from memory and built up in a string until a 0 is read whence the string is returned (the 0 does not form part of that string). WB.RDptr is incremented to keep track of where reading occurs and will be left pointing at the start of the next string. If an attempt to read past any data is made, CHR$(255) is returned and the read pointer is not incremented. When additional data is written, the next read will return the new data and so on... Thus, the read pointer will happily trot along behind the write pointer but never pass it.<br /><a class="unknownlink" href="MMBasic..html" title="MMBasic."></a><img src="flashpointers210f7.png?File=/flashpointers2.png" alt="Image" /><br /><br /><a href="Login9413.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=2" class="editsectionlink"></a><h1 class="separator">Global Variables<a class="headeranchor" id="Global_Variables_2" href="#Global_Variables_2" title="Link to this Section">&#0182;</a></h1>The pointer for the next read string operation<br />Integer <b>WB.RDptr</b><br /><br />The pointer for the next write string operation<br />Integer <b>WB.WRptr</b><br /><br />The JEDEC identifier of the Flash including the manufacturer and then the 2 byte device ID<br />Integer <b>WB.ID</b><br /><br />A human friendly version of the ID e.g. W25Q32 etc.<br />String <b>WB$</b><br /><br />The top-most available memory location<br />Integer <b>WB.Top</b><br /><br /><br /><a href="Login1cae.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=3" class="editsectionlink"></a><h1 class="separator">The Routines<a class="headeranchor" id="The_Routines_3" href="#The_Routines_3" title="Link to this Section">&#0182;</a></h1>Discover what type of Flash and Initialise the internal pointers<br /><b>WB.Init</b><br /><br />Read the three status registers<br /><b>=WB.Stat1RD()</b><br /><b>=WB.Stat2RD()</b><br /><b>=WB.Stat3RD()</b><br /><br />Wait for the Flash to become idle - you may need to put a WATCHDOG in here so your code doesn't restart on long waits<br /><b>WB.WaitBusy</b><br /><br />check if the Flash is busy without waiting<br /><b>=WB.TestBusy()</b><br /><br />Peek a byte at the given address in Flash. Flash is erased to FF so when we peek the next address<br />after a string we can tell if we are at EOF<br /><b>=WB.Peek(address)</b><br /><br />Read a string from the current read pointer and increment the pointer<br />returns Chr$(255) if we are at the end of the data<br /><b>=WB.ReadStr$()</b><br /><br />Write a string to the current write pointer and increment the pointer<br />returns a zero if successful and 1 if the write would exceed Flash storage<br /><b>=WB.WriteStr(a$)</b><br /><br />Erase the entire Flash; sets all memory locations to contain 0FFh - does an initialization afterwards to reset all the pointers. New Flash chips should be formatted before use as they may contain random data that will confuse WB.Init and return dubious  usage figures.<br /><b>WB.Format</b><br /><br />Support routines - unlikely to be useful in your code:<br /><br />latch a three byte address in the Flash<br /><b>WB.Addr(address)</b><br /><br />Enable/Disable write function<br /><b>WB.WREnable(0|1)</b><br /><br />Set up the page address during a write<br /><b>WB.SetPage</b><br /><br /><br /><a href="Login3af4.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=4" class="editsectionlink"></a><h1 class="separator">Example<a class="headeranchor" id="Example_4" href="#Example_4" title="Link to this Section">&#0182;</a></h1><pre>
'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;
' your setup code goes  here
'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;
Init&#58;
	CPU 48
	'Option Autorun On
	'Option Baudrate 9600
	Option Explicit
	Option Base 0

	Const Ver$="0.20 of 24-NOV-2019"

'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
'The only config you should need to do&#58;
'change the following to the CS pin for the Flash memory
	Const WB.CS=23
'change the following to the SPI channel where your Flash chip is (it's usually OK to leave it open
'so long as nothing else is competing and closes it after use - e.g. LCD panels)
	SPI Open 20000000,0,8'20MHz, mode 0, 8 bits... seems happy at 20MHz but drop this down if you get probs
'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-


'mandatory variables in your program&#58;
'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
	Dim Integer WB.RDptr,WB.WRptr,WB.Top,WB.ID,x,n
	Dim WB$
'&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-

	




'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;
' your program goes  here
'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;


'A little demonstration code...

	x=WB.Init()	'single function id's the device, sets mem size and finds first usable address
			'your code should check WB.Top after this call. if no Flash found or couldn't be identified, WB.Top=-1
	If x&lt;&gt;0 Then
		Print"Flash chip not recognized&#58; ";Hex$(x,6)
		End
	EndIf

	Dim y$
	Dim Integer m

	Print"Found ";WB$;" (";Hex$(WB.ID,6);")"
	Print"memory size is";(WB.Top+1)/1024;"KB (0-"+Hex$(WB.Top)+")"
	Print"First blank address is ";Hex$(WB.WRptr);"h"

	Input"Format before testing (Y/N)?",y$
	If y$="y" then
		Print "Formatting..."
		WB.Format
		Print"First blank address is ";Hex$(WB.WRptr);"h"
	EndIf

	Randomize Timer ' delete this line on MMX/Arm etc

'write some random strings to Flash with timings
	Print
	Print"","WR Time"
	Print"&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;"

	For n=1 To 10
		Print n,
		Timer=0&#58;x=WB.WriteStr(Date$+" "+Time$+" "+String$(65,48+Rnd&#42;70))&#58;Print Timer;"mS"
	Next

'read back the strings - demonstrates chr$(255) if attempting to read
	Print&#58;Print"Reading back all strings..."
	Print"Addr","Time","Data"
	Print"&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;"
	Do
		Print Hex$(WB.RDptr,4);"h",
		Timer=0&#58;y$=WB.ReadStr$()&#58;Print Timer,y$
	Loop While y$&lt;&gt;Chr$(255)

	For n=0 To 1023 Step 16
		y$=""
		Print Hex$(n,4);"  ";
		For m=0 To 15
			x=WB.Peek(n+m)
			Print Hex$(x,2);"  ";
			If x&lt;32 Or x&gt;126 Then x=&amp;h2e
			y$=y$+Chr$(x)
		Next
		Print y$
	Next

	Input"Format the Flash (Y/N)?",y$
	y$=UCase$(y$)
	If y$="Y" Then
		Print"wait a moment"
		timer=0&#58;WB.Format&#58;Print timer;"mS"
	EndIf

	End
</pre><br />The routines are fairly brisk and numerous testing/adjustment phases have resulted in some tricks to make them as fast as possible. The Write function was a bottle-neck and has been re-written. It is now very quick and because of the SPI Bulk Write methods available, paradoxically, writes substantially out-perform reads by about a factor of 3 worst case (255 character strings) at ~20mS Vs ~70mS. With 3 character strings, Reads take around 5mS and Writes are still around the 20mS mark.<br /><br />Here are some timings for sequential reads & writes on a 48MHz '170 with 24MHz SPI bus.<br /><br />Random 254 char strings (worst case)<br /><code><br />new write method:<br /><hr><br /> 1       11mS<br /> 2       19mS<br /> 3       19mS<br /> 4       19mS<br /> 5       20mS<br /> 6       19mS<br /> 7       19mS<br /> 8       19mS<br /> 9       19mS<br /> 10      20mS<br /><br /><br />old write method:<br /><hr><br /> 1       89mS<br /> 2       97mS<br /> 3       97mS<br /> 4       96mS<br /> 5       97mS<br /> 6       96mS<br /> 7       96mS<br /> 8       97mS<br /> 9       96mS<br /> 10      97mS<br /></code><br /><br />Read 254 character string<br /><code><br /><hr><br />    73mS    <br />    72mS     <br />    72mS     <br />    71mS     <br />    72mS     <br />    72mS     <br />    72mS     <br />    72mS<br /></code><br />Read 3 character string<br /><code><br /><hr>  <br />    5mS      <br />    5mS      <br />    4mS      <br />    5mS      <br />    5mS      <br />    5mS      <br />    5mS      <br />    4mS      <br />    5mS      <br /></code><br /><br /><a href="Login8d5b.html?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&amp;Section=5" class="editsectionlink"></a><h1 class="separator">The Code<a class="headeranchor" id="The_Code_5" href="#The_Code_5" title="Link to this Section">&#0182;</a></h1><pre>
'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;
'Flash Subs &amp; Functions
'all abort WB.Top=-1
'Only tested with 4 and 8 MB devices - be careful if stepping out of this.

'Discover the attached flash memory and initialize all the pointers and stuff
'sets up the CS pin and opens the SPI channel
'returns 0 if the chip is IDed with all the variables correctly set up.
'else returns the ID read from the chip = &amp;FFFFFF is open bus (no chip)
	Function WB.Init() As Integer
		Local Integer n
		WB.Top=-1&#58;WB.WRptr=-1
		'identify the Flash ram by reading the JEDEC ID and setting some key values
		Pin(WB.CS)=0
			x=SPI(&amp;h9F)
			WB.ID=65536&#42;SPI(0)+256&#42;SPI(0)+SPI(0)
		Pin(WB.CS)=1
		'if your device is not listed or comes up unknown, you'll have to determine the correct ID
		'from the device PDF and add it below. Good news is, it looks like all the Winbond W25&#42; are
		'4KB sectors and 256B page size so the code &#42;should&#42; work without any changes - no guarantees
		'only known problem is the code assumes a 24 bit address which breaks for &gt;16MB devices and maybe
		'others which might only provide a 16 bit address - haven't looked at the PDF.
		'The Winbond product selector shows these chips but I couldn't find PDFs for them&#58;
		'W25Q02JV	256MB
		'W25Q01JV	128MB

		Select Case WB.ID
			'&#42;&#42;&#42; Tested
			Case &amp;hEF4018&#58;WB.Top=16384&#58;WB$="W25Q128"'16MB
			Case &amp;hEF4017&#58;WB.Top=8192&#58;WB$="W25Q64"'8MB
			Case &amp;hEF4016&#58;WB.Top=4096&#58;WB$="W25Q32"'4MB
			Case &amp;hEF4015&#58;WB.Top=2048&#58;WB$="W25Q16"'2MB
			Case &amp;hEF4014&#58;WB.Top=1024&#58;WB$="W25Q80"'1MB
			'&#42;&#42;&#42; UnTested
			Case &amp;hEF4020&#58;WB.Top=65536&#58;WB$="W25Q512"'64MB - probably won't work with this code as &gt;24bit address
			Case &amp;hEF4019&#58;WB.Top=32768&#58;WB$="W25Q256"'32MB - probably won't work with this code as &gt;24bit address
			Case &amp;hEF4013&#58;WB.Top=512&#58;WB$="W25Q40"'512KB
			Case &amp;hEF5012&#58;WB.Top=256&#58;WB$="W25Q20"'256KB
			Case &amp;hEF6011&#58;WB.Top=128&#58;WB$="W25Q10"'128KB
			Case &amp;hEF3010&#58;WB.Top=64&#58;WB$="W25X05"'64KB
			'Case &amp;hBF2642&#58;WB.Top=4096&#58;WB$="SST26VF032"'Microchip 4MB pin and code compatible - needs work on global enable
			Case Else
				SPI Close&#58;WB.Top=-1&#58;WB.Init=WB.ID&#58;Exit Function'can't identify
		End Select

		WB.Top=(WB.Top&#42;1024)-1'set the top memory location

'find the first (=lowest address with) FF byte
		If WB.Peek(0)=255 Then WB.WRptr=0&#58;WB.RDptr=0&#58;Exit Function'blank Flash; early bath
'otherwise find by successive approximation - very fast, searches 4MB is 80mS
		WB.WRptr=(WB.Top+1)\2&#58;n=WB.WRptr\2'start at the middle and go in smaller and smaller halves
		Do
			If WB.Peek(WB.WRptr)=255 Then
				WB.WRptr=WB.WRptr-n'still in void so go down by half the remainder
			Else
				WB.WRptr=WB.WRptr+n'we are in the strings so go up by half the remainder
			EndIf
			If n&lt;&gt;1 Then n=n\2'smaller and smaller halves
		Loop Until WB.Peek(WB.WRptr)=255 And WB.Peek(WB.WRptr-1)&lt;&gt;255'is the byte before the FF !FF? is so, we are done
	End Function

'set or clear flash write enable flag
	Sub WB.WREnable(a As Integer)
		If WB.Top=-1 Then Exit Sub
		Local Integer x
		Pin(WB.CS)=0
			If a=0 Then
				x=SPI(4)
			Else
				x=SPI(6)
			EndIf
		Pin(WB.CS)=1
		WB.WaitBusy
	End Sub

'wait while Flash is busy
	Sub WB.WaitBusy
		If WB.Top=-1 Then Exit Sub
		Do While WB.TestBusy()
		'you might want to put a WATCHDOG here. Long operations could break your program
		Loop
	End Sub

'test BUSY flag in STAT1
	Function WB.TestBusy() As Integer
		If WB.Top=-1 Then Exit Function
		WB.TestBusy=(WB.Stat1RD() And 1)
	End Function

	Function WB.Stat1RD() As Integer
		If WB.Top=-1 Then Exit Function
		Local Integer x
		Pin(WB.CS)=0
			x=SPI(5)
			WB.Stat1RD=SPI(0)
		Pin(WB.CS)=1
	End Function

	Function WB.Stat2RD() As Integer
		If WB.Top=-1 Then Exit Function
		Local Integer x
		Pin(WB.CS)=0
			x=SPI(&amp;h35)
			WB.Stat2RD=SPI(0)
		Pin(WB.CS)=1
	End Function

	Function WB.Stat3RD() As Integer
		If WB.Top=-1 Then Exit Function
		Local Integer x
		Pin(WB.CS)=0
			x=SPI(&amp;h15)
			WB.Stat3RD=SPI(0)
		Pin(WB.CS)=1
	End Function

'send a 3 byte address to Flash
	Sub WB.Addr(a As Integer)
		Local Integer x
		x=SPI((a&gt;&gt;16) And 255)
		x=SPI((a&gt;&gt;8) And 255)
		x=SPI(a And 255)
	End Sub

'set the address for page writing
	Sub WB.SetPage
		Local Integer x
		Pin(WB.CS)=1
		WB.WaitBusy
		WB.WREnable 1
		WB.WaitBusy
		Pin(WB.CS)=0
		x=SPI(2)
		WB.Addr WB.WRptr'setup the address
	End Sub

'erase the entire chip - CAUTION takes a long time
	Sub WB.Format()
		If WB.Top=-1 Then Exit Sub
		Local Integer x
		WB.WREnable 1
		WB.WaitBusy
		Pin(WB.CS)=0
			x=SPI(&amp;h60)'start the erase - will take some time
		Pin(WB.CS)=1
		WB.WaitBusy
		x=WB.Init()
	End Sub

'	Peek any address in Flash
	Function WB.Peek(a As Integer) As Integer
		If WB.Top=-1 Then Exit Function
		Local Integer x
		Pin(WB.CS)=0
			x=SPI(3)'read at the given address
			WB.Addr a
			WB.Peek=SPI(0)'grab one byte
		Pin(WB.CS)=1
	End Function

'Read a string from the Read Address using the global WB.RDptr variable
	Function WB.ReadStr$()
		If WB.Top=-1 Then Exit Function
		Local Integer x,z
		Local a$
		WB.WaitBusy'wait for the Flash to be idle
		Pin(WB.CS)=0
		x=SPI(3)
		WB.Addr WB.RDptr
		For z=1 to 256'stream the data from Flash into a$, 256 covers max length+chr$(0), we bail early if needed
			x=SPI(0)'get the character
			Select case x
				Case 0 'break out on the delimiter
					Poke Var a$,0,z-1
					WB.RDptr=WB.RDptr+Len(a$)+1'bump the address along by the number of bytes we read +1 for the delimiter
					Exit For
				Case 255 'break out on EOF
					WB.RDptr=WB.RDptr+Len(a$)'should never happen
					a$=Chr$(x)'single char?
					Exit For
				Case Else
					Poke Var a$,z,x
			End select
		Next
		Pin(WB.CS)=1
		WB.ReadStr$=a$
	End Function

'write a string to the next available position. Return 0 if successful
	Function WB.WriteStr(a$) As Integer
		If WB.Top=-1 Then WB.WriteStr=1&#58;Exit Function
		Local Integer n,x
		n=Len(a$)+1
		If WB.WRptr+n&gt;WB.Top Then WB.WriteStr=1&#58;Exit Function
		x=256-(WB.WRPtr Mod 256)' remaining space in this page
		WB.SetPage
		If n&lt;=x Then 'will fit in current page
			SPI Write n-1,a$
			x=SPI(0)
			Pin(WB.CS)=1
			WB.WrPtr=WB.WrPtr+n
		Else 'have to split across pages
			'first half
			Local l$
			l$=Left$(a$,x)
			SPI Write len(l$),l$
			Pin(WB.CS)=1
			WB.WrPtr=WB.WrPtr+x
			'second half
			l$=Mid$(a$,x+1)+Chr$(0)
			x=Len(l$)
			WB.SetPage
			SPI Write x,l$
			Pin(WB.CS)=1
			WB.WrPtr=WB.WrPtr+x
		EndIf
	End Function
'&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;
</pre><br /><br />
    
    


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.History.aspx?Page=MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories&Revision=14 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:50:47 GMT -->
</html>
