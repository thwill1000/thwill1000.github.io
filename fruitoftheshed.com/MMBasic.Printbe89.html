

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Magic-Switchboard-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:19:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Magic Switchboard - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Magic-Switchboard-part-of-the-original-MMBasic-library" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFzkc8aDEgY2xhc3M9InBhZ2V0aXRsZSI+TWFnaWMgU3dpdGNoYm9hcmQ8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDE2LzEyLzIzIDIzOjM0IGJ5IEFkbWluaXN0cmF0b3IgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogRWxlY3Ryb25pY3MsIE1hdGhzLCBfTElCIE9yaWdpbmFsIE1NQmFzaWM8L3NtYWxsPjxiciAvPjxiciAvPjxoMiBjbGFzcz0ic2VwYXJhdG9yIj5UaGlzIG1vZHVsZSBpcyBwYXJ0IG9mIHRoZSBvcmlnaW5hbCBNTUJhc2ljIGxpYnJhcnkuIEl0IGlzIHJlcHJvZHVjZWQgaGVyZSB3aXRoIGtpbmQgcGVybWlzc2lvbiBvZiBIdWdoIEJ1Y2tsZSBhbmQgR2VvZmYgR3JhaGFtLiBCZSBhd2FyZSBpdCBtYXkgcmVmZXJlbmNlIGZ1bmN0aW9uYWxpdHkgd2hpY2ggaGFzIGNoYW5nZWQgb3IgaXMgZGVwcmVjYXRlZCBpbiB0aGUgbGF0ZXN0IHZlcnNpb25zIG9mIE1NQmFzaWMuPGEgY2xhc3M9ImhlYWRlcmFuY2hvciIgaWQ9IlRoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgaHJlZj0iI1RoaXNfbW9kdWxlX2lzX3BhcnRfb2ZfdGhlX29yaWdpbmFsX01NQmFzaWNfbGlicmFyeV9JdF9pc19yZXByb2R1Y2VkX2hlcmVfd2l0aF9raW5kX3Blcm1pc3Npb25fb2ZfSHVnaF9CdWNrbGVfYW5kX0dlb2ZmX0dyYWhhbV9CZV9hd2FyZV9pdF9tYXlfcmVmZXJlbmNlX2Z1bmN0aW9uYWxpdHlfd2hpY2hfaGFzX2NoYW5nZWRfb3JfaXNfZGVwcmVjYXRlZF9pbl90aGVfbGF0ZXN0X3ZlcnNpb25zX29mX01NQmFzaWNfMCIgdGl0bGU9IkxpbmsgdG8gdGhpcyBTZWN0aW9uIj4mIzAxODI7PC9hPjwvaDI+PGI+Tm90ZTwvYj46IEFueSByZXF1aXJlZCBmaWxlKHMpIGFyZSBhdmFpbGFibGUgaW4gdGhlIGF0dGFjaG1lbnRzIHRhYiAodG9wIHJpZ2h0KS48YnIgLz48YnIgLz5NYWdpYyBTd2l0Y2hib2FyZDxiciAvPjxiciAvPlRoaXMgaXMgcmV3cml0ZSBvZiB0aGUgbWFnaWMgc3dpdGNoYm9hcmQgcHJvZ3JhbSB0byBzdWl0IE1NYmFzaWMuICBUaGUgb3JpZ2luYWwgd2FzIHdyaXR0ZW4gYnkgUGljYXhlIHRlY2huaWNhbCBmb3IgdGhlIHBpY2F4ZSAxOHguPGJyIC8+PGJyIC8+VGhpcyBwcm9ncmFtIHVzZXMgZm91ciBpbnB1dCBzd2l0Y2hlcyBjb25uZWN0ZWQgdG8gcGlucyAxMSwgMTIsIDEzIGFuZCAxNCBhbmQgdGhlIG91dHB1dCAoZWl0aGVyIHdoaXRlIExFRHMgd2l0aCBjb2xvdXIgdG9wcyBvciA2ViBjb2xvdXJlZCBsYW1wcykgY29ubmVjdGVkIHRvIFBpbnMgMTUsMTYsMTcgYW5kIDE4LiAgVGhlIGxhbXBzIHJlcXVpcmUgZHJpdmVyIHRyYW5zaXN0b3JzLiBUaGUgc2NoZW1hdGljIG9mIHRoZSBNYWdpYyBTd2l0Y2hib2FyZCBpcyBpbiB0aGUgYXR0YWNoZWQgZmlsZSBhbmQgeW91IGNhbiBzZWUgYSBkZW1vbnN0cmF0aW9uIG9mIGl0IGF0IDxhIGNsYXNzPSJleHRlcm5hbGxpbmsiIGhyZWY9Imh0dHA6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0wbEdQOG5RTEFOVSIgdGl0bGU9Ind3dy55b3V0dWJlLmNvbS93YXRjaD92PTBsR1A4blFMQU5VIiB0YXJnZXQ9Il9ibGFuayI+d3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9MGxHUDhuUUxBTlU8L2E+LiBJdCBpcyB0cnVseSBhbWF6aW5nLjxiciAvPjxiciAvPlJlZ2FyZHMgQmlsbCBCcm93bjxiciAvPjxiciAvPjxwcmU+DQoNCicgTWFnaWMgU3dpdGNoYm9hcmQgLSBvcmlnaW5hbCBzb3VyY2UgYnkgIlRlY2huaWNhbCIgZnJvbSBQaWNBeGUgRm9ydW0NCicgICAgICAgICAgICAgICAgICAgICBNb2RpZmllZCBmb3IgUGljQXhlIDE4eCBieSBXYXluZSBUaG9tYXNvbiBvZiBBZGRpc29uLCBUWCBVU0ENCicgICAgICAgICAgICAgICAgICAgICA3LzE1LzIwMDkNCicgICAgICAgICAgICAgICAgICAgTW9kaWZpZWQgZm9yIE1heGltaXRlIE1NQmFzaWMgYnkgQmlsbCBCcm93biAgYmlsbC5iDQonICAgICAgICAgICAgICAgICAgICAgMTkvMDEvMjAxMg0KJw0KJyAgICAgICAgICAgICAgICAgICAgICBtb2RzJiM1ODsgMS4gTm93IGlzIGVhc2lseSBjb25maWd1cmFibGUgdmlhIHN3aXRjaD8gYW5kIGJ1bGI/IHZhcmlhYmxlcw0KJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAyLiAidGltZW91dCIgZnVuY3Rpb25zIGV2ZW4gd2l0aG91dCBsZWFybmluZyBhbGwgNCBzd2l0Y2hlcw0KJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAzLiBzdGFydGluZyBwb2ludCBhbmQgc2VxdWVuY2UgZGlyZWN0aW9uIGRlcGVuZGVudCBvbiBsYXN0IHN3aXRjaCB0dXJuZWQgb2ZmDQonICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQuIE5vdyBoYXMgQXVkaWVuY2VfbG9ja2Rvd24gZmVhdHVyZS4gIElmIHBvd2VyIGlzIHR1cm5lZCBvbiB3aGlsZSBzd2l0Y2gtNA0KJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBzZXQsIGVhY2ggbGlnaHQgd2lsbCByZXNwb25kIG9ubHkgdG8gY29ycmVzcG9uZGluZyBzd2l0Y2ggcG9zaXRpb24NCicgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW50aWwgY2lyY3VpdCBpcyByZXNldC4NCicNCicgQXNzdW1wdGlvbnMNCicgMS4gVGltZXMgb3V0IGFmdGVyIDEwIHNlY29uZHMgb2YgYWxsIHN3aXRjaGVzIGluIHRoZSBvZmYgcG9zaXRpb24NCicgICAgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIGFsbCBzd2l0Y2hlcyBhcmUgbGVhcm5lZCB5ZXQNCicgMi4gQWxsIHN3aXRjaGVzIG11c3QgYmUgb2ZmIGF0IHN0YXJ0DQonICAgIChJZiBzd2l0Y2ggNCBvbiB3aGVuIHN0YXJ0ZWQsIGl0IHN0YXJ0cyB1cCBpbiBhdWRpZW5jZS1tb2RlLikNCicgMy4gQWxsIDQgc3dpdGNoZXMgbXVzdCBiZSBzd2l0Y2hlZCBvbiBiZWZvcmUgdGhhdCBzZXF1ZW5jZSBpcyBsZWFybmVkDQonIDQuIFNldCBidWxiL0xFRCBvdXRwdXRzIHVzaW5nIGJ1bGIxLCBidWxiMiwgYnVsYjMgJmFtcDsgYnVsYjQNCicgNS4gU2V0IHN3aXRjaCBpbnB1dHMgdXNpbmcgc3dpdGNoMSwgc3dpdGNoMiwgc3dpdGNoMyBhbmQgc3dpdGNoNA0KJyA2LiBmaXJzdCBwYXR0ZXJuIGlzIGxlZnQgdG8gcmlnaHQsIGJ1bGJzIDEsIDIsIDMsIDQNCicgNy4gc3Vic2VxdWVudCBwYXR0ZXJucyBhcmUgZGV0ZXJtaW5lZCBieSBsYXN0IFNXSVRDSCB0dXJuZWQgb2ZmJiM1ODsNCicgICAgICAgU3dpdGNoIDEgPSAxMjM0IG9yZGVyIChidWxiIDEgZmlyc3QsIHRoZW4gcmlnaHQgaW4gc2VxdWVuY2UpDQonICAgICAgIFN3aXRjaCAyID0gMjE0MyBvcmRlciAoYnVsYiAyIGZpcnN0LCB0aGVuIGxlZnQgaW4gc2VxdWVuY2UsIHdyYXBwaW5nIGFmdGVyIGZpcnN0KQ0KJyAgICAgICBTd2l0Y2ggMyA9IDM0MTIgb3JkZXIgKGJ1bGIgMyBmaXJzdCwgdGhlbiByaWdodCBpbiBzZXF1ZW5jZSwgd3JhcHBpbmcgYWZ0ZXIgbGFzdCkNCicgICAgICAgU3dpdGNoIDQgPSA0MzIxIG9yZGVyIChidWxiIDQgZmlyc3QsIHRoZW4gbGVmdCBpbiBzZXF1ZW5jZSkNCnRpbWVvdXQgPSA3NTAgICAgICdsb29wIHJlc2V0IHRpbWUgYXBwcm94IDEwIHNlY29uZHMNCnRpbWVvdXRfY291bnRlciA9IDANClNldFBpbiAxMSwyDQpTZXRQaW4gMTIsMg0KU2V0UGluIDEzLDINClNldFBpbiAxNCwyDQpTZXRQaW4gMTUsOA0KU2V0UGluIDE2LDgNClNldFBpbiAxNyw4DQpTZXRQaW4gMTgsOA0KUGluKDE1KSA9IDAmIzU4O1BpbigxNik9MCYjNTg7UGluKDE3KT0wJiM1ODtQaW4oMTgpPTANCklmIFBpbigxNCkgPSAxIFRoZW4gR29UbyBBdWRpZW5jZV9Mb2NrZG93bg0Kc3RhcnRpbmdfbGl0ZSA9IDENCg0KJyBTdGFydCBvZiBwcm9ncmFtDQoNCmRvX3Jlc2V0JiM1ODsgICAgICAnIHJlc2V0IHBvc2l0aW9uIGNvdW50ZXINCg0KSWYgc3RhcnRpbmdfbGl0ZSA9IDEgVGhlbg0KICAgICAgIHBvc2l0aW9uID0gMCAgICAnIGlmIHN0YXJ0aW5nIHdpdGggYnVsYiAxLCBwb3NpdGlvbiByZXNldCB0byAwLg0KRW5kSWYNCklmIHN0YXJ0aW5nX2xpdGUgPSAyIFRoZW4NCiAgICAgICBwb3NpdGlvbiA9IDEgICAgJyBpZiBzdGFydGluZyB3aXRoIGJ1bGIgMiwgcG9zaXRpb24gcmVzZXQgdG8gMS4NCkVuZElmDQpJZiBzdGFydGluZ19saXRlID0gMyBUaGVuDQogICAgICAgcG9zaXRpb24gPSAyICAgICcgaWYgc3RhcnRpbmcgd2l0aCBidWxiIDMsIHBvc2l0aW9uIHJlc2V0IHRvIDIuDQpFbmRJZg0KSWYgc3RhcnRpbmdfbGl0ZSA9IDQgVGhlbg0KICAgICAgIHBvc2l0aW9uID0gMyAgICAnIGlmIHN0YXJ0aW5nIHdpdGggYnVsYiA0LCBwb3NpdGlvbiByZXNldCB0byAzLg0KRW5kSWYNCmZsYWcwID0gMCAmIzU4OyBmbGFnMSA9IDAgJiM1ODtmbGFnMiA9IDAmIzU4O2ZsYWczID0gMA0KDQonIExlYXJuaW5nIGxvb3ANCg0Kd2FpdGluZ190b19sZWFybl9sb29wJiM1ODsNCg0KSWYgKFBpbigxMSkgPSAxKSBBbmQgKGZsYWcwID0gMCkgVGhlbiBHb1RvIGxlYXJuMA0KSWYgKFBpbigxMikgPSAxKSBBbmQgKGZsYWcxID0gMCkgVGhlbiBHb1RvIGxlYXJuMQ0KSWYgKFBpbigxMykgPSAxKSBBbmQgKGZsYWcyID0gMCkgVGhlbiBHb1RvIGxlYXJuMg0KSWYgKFBpbigxNCkgPSAxKSBBbmQgKGZsYWczID0gMCkgVGhlbiBHb1RvIGxlYXJuMw0KDQogJyB3ZSBoYXZlIGxlYXJudCB0aGF0IHN3aXRjaCBzbyBsaWdodCBvdXRwdXQgYWNjb3JkaW5nbHkNCg0KSWYgZmxhZzAgPSAxIFRoZW4NCiAgICAgICBJZiBQaW4oMTEpID0gMSBUaGVuDQogICAgICAgICAgICAgIFBpbihsaWdodDApID0gMQ0KICAgICAgIEVsc2UNCiAgICAgICAgICAgICAgUGluKGxpZ2h0MCkgPSAwDQogICAgICAgRW5kSWYNCkVuZElmDQpJZiBmbGFnMSA9IDEgVGhlbg0KICAgICAgIElmIFBpbigxMikgPSAxIFRoZW4NCiAgICAgICAgICAgICBQaW4obGlnaHQxKSA9IDENCiAgICAgICBFbHNlDQogICAgICAgICAgICAgIFBpbihsaWdodDEpID0gMA0KICAgICAgIEVuZElmDQpFbmRJZg0KSWYgZmxhZzIgPSAxIFRoZW4NCiAgICAgICBJZiBQaW4oMTMpID0gMSBUaGVuDQogICAgICAgICAgICAgIFBpbihsaWdodDIpID0gMQ0KICAgICAgIEVsc2UNCiAgICAgICAgICAgICAgUGluKGxpZ2h0MikgPSAwDQogICAgICAgRW5kSWYNCkVuZElmDQpJZiBmbGFnMyA9IDEgVGhlbg0KICAgICAgIElmIFBpbigxNCkgPSAxIFRoZW4NCiAgICAgICAgICAgICBQaW4obGlnaHQzKSA9IDENCiAgICAgICBFbHNlDQogICAgICAgICAgICAgIFBpbihsaWdodDMpID0gMA0KICAgICAgIEVuZElmDQpFbmRJZg0KDQpJZiAoUGluKDExKSA9IDApIEFuZCAoUGluKDEyKSA9IDApIEFuZCAoUGluKDEzKSA9IDApIEFuZCAoUGluKDE0KSA9IDApIFRoZW4NCiAgICAgICBQYXVzZSAxMA0KICAgICAgIHRpbWVvdXRfY291bnRlciA9IHRpbWVvdXRfY291bnRlciArIDENCiAgICAgICBJZiB0aW1lb3V0X2NvdW50ZXIgJmd0OyB0aW1lb3V0IFRoZW4NCiAgICAgICAgICAgICAgdGltZW91dF9jb3VudGVyID0gMA0KICAgICAgICAgICAgICBHb1RvIGRvX3Jlc2V0DQogICAgICAgRW5kSWYNCkVsc2UNCiAgICAgICB0aW1lb3V0X2NvdW50ZXIgPSAwDQpFbmRJZg0KR29UbyB3YWl0aW5nX3RvX2xlYXJuX2xvb3ANCg0KJyBMZWFybiBhIGxpZ2h0IHBvc2l0aW9uIGFuZCBzZXQgZmxhZyBzbyB3ZSBrbm93IHRoYXQgc3dpdGNoIGlzIGRvbmUNCg0KbGVhcm4wJiM1ODsNCg0KR29TdWIgYnVsYnNldA0KZmxhZzAgPSAxDQpsaWdodDAgPSBidWxiDQpHb1RvIGxlYXJuX2VuZA0KDQpsZWFybjEmIzU4Ow0KDQpHb1N1YiBidWxic2V0DQpmbGFnMSA9IDENCmxpZ2h0MSA9IGJ1bGINCkdvVG8gbGVhcm5fZW5kDQoNCmxlYXJuMiYjNTg7DQoNCkdvU3ViIGJ1bGJzZXQNCmZsYWcyID0gMQ0KbGlnaHQyID0gYnVsYg0KR29UbyBsZWFybl9lbmQNCg0KbGVhcm4zJiM1ODsNCg0KR29TdWIgYnVsYnNldA0KZmxhZzMgPSAxDQpsaWdodDMgPSBidWxiDQpHb1RvIGxlYXJuX2VuZA0KDQpsZWFybl9lbmQmIzU4Ow0KDQpJZiBzdGFydGluZ19saXRlID0gMSBUaGVuICAgICAgJ2lmIHN0YXJ0aW5nIHdpdGggMXN0IGxhbXAsIHNlcXVlbmNlID0gMS0yLTMtNA0KICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gKyAxDQogICAgICAgSWYgcG9zaXRpb24gJmd0OyAzIFRoZW4gR29UbyBoYXZlX2xlYXJudF9hbGwNCiAgICAgICBHb1RvIHdhaXRpbmdfdG9fbGVhcm5fbG9vcA0KRW5kSWYNCklmIHN0YXJ0aW5nX2xpdGUgPSAyIFRoZW4gICAgICAnaWYgc3RhcnRpbmcgd2l0aCAybmQgbGFtcCwgc2VxdWVuY2UgPSAyLTEtNC0zDQogICAgICAgSWYgcG9zaXRpb24gJmd0OyAwIFRoZW4gICAgJ2Rvbid0IGRlYyBpZiBwb3NpdGlvbj0wLCB3aWxsIGNhdXNlIGVycm9yDQogICAgICAgICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gLSAxDQogICAgICAgRWxzZQ0KICAgICAgICAgICAgICBwb3NpdGlvbiA9IDMNCiAgICAgICBFbmRJZg0KICAgICAgIElmIHBvc2l0aW9uID0gMSBUaGVuIEdvVG8gaGF2ZV9sZWFybnRfYWxsDQogICAgICAgR29UbyB3YWl0aW5nX3RvX2xlYXJuX2xvb3ANCkVuZElmDQpJZiBzdGFydGluZ19saXRlID0gMyBUaGVuICAgICAgJ2lmIHN0YXJ0aW5nIHdpdGggM3JkIGxhbXAsIHNlcXVlbmNlID0gMy00LTEtMg0KICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gKyAxDQogICAgICAgSWYgcG9zaXRpb24gJmd0OyAzIFRoZW4NCiAgICAgICAgICAgICAgcG9zaXRpb24gPSAwDQogICAgICAgRW5kSWYNCiAgICAgICBJZiBwb3NpdGlvbiA9IDIgVGhlbiBHb1RvIGhhdmVfbGVhcm50X2FsbA0KICAgICAgIEdvVG8gd2FpdGluZ190b19sZWFybl9sb29wDQpFbmRJZg0KSWYgc3RhcnRpbmdfbGl0ZSA9IDQgVGhlbiAgICAgICdpZiBzdGFydGluZyB3aXRoIDR0aCBsYW1wLCBzZXF1ZW5jZSA9IDQtMy0yLTENCiAgICAgICBJZiBwb3NpdGlvbiAmZ3Q7IDAgVGhlbg0KICAgICAgICAgICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIC0gMQ0KICAgICAgIEVsc2UNCiAgICAgICAgICAgICAgR29UbyBoYXZlX2xlYXJudF9hbGwNCiAgICAgICBFbmRJZg0KICAgICAgIEdvVG8gd2FpdGluZ190b19sZWFybl9sb29wDQpFbmRJZg0KDQonIG5vdyBzaW1wbHkgbG9vcCByZWFjdGluZyB0byB0aGUgc3dpdGNoZXMNCicgdGltZW91dF9jb3VudGVyIHZhbHVlIHdpbGwgaW5jcmVtZW50IGV2ZXJ5IDEwbXMNCicgaG93ZXZlciBpZiBhbnkgbGlnaHQgaXMgb24gdGhlIHRpbWVvdXRfY291bnRlciBpcyByZXNldA0KJyBzbyB0aGlzIG1lYW5zIHRoZSB0aW1lb3V0IHdpbGwgb25seQ0KJyBvY2N1ciBhZnRlciAxMCBzZWNvb25kcyBvZiBhbGwgc3dpdGNoZXMgb2ZmDQoNCmhhdmVfbGVhcm50X2FsbCYjNTg7DQoNCklmIFBpbigxMSkgPSAxIFRoZW4NCiAgICAgICBQaW4obGlnaHQwKSA9IDENCiAgICAgICB0aW1lb3V0X2NvdW50ZXIgPSAwDQpFbHNlDQogICAgICAgUGluKGxpZ2h0MCkgPSAwDQpFbmRJZg0KSWYgUGluKDEyKSA9IDEgVGhlbg0KICAgICAgIFBpbihsaWdodDEpID0gMQ0KICAgICAgIHRpbWVvdXRfY291bnRlciA9IDANCkVsc2UNCiAgICAgICBQaW4obGlnaHQxKSA9IDANCkVuZElmDQpJZiBQaW4oMTMpID0gMSBUaGVuDQogICAgICAgUGluKGxpZ2h0MikgPSAxDQogICAgICAgdGltZW91dF9jb3VudGVyID0gMA0KRWxzZQ0KICAgICAgIFBpbihsaWdodDIpID0gMA0KRW5kSWYNCklmIFBpbigxNCkgPSAxIFRoZW4NCiAgICAgICBQaW4obGlnaHQzKSA9IDENCiAgICAgICB0aW1lb3V0X2NvdW50ZXIgPSAwDQpFbHNlDQogICAgICAgUGluKGxpZ2h0MykgPSAwDQpFbmRJZg0KDQpJZiAoZmxhZzA9MSkgQW5kIChmbGFnMT0xKSBBbmQgKGZsYWcyPTEpIEFuZCAoZmxhZzM9MSkgVGhlbg0KICAgICAgIGFsbF9mbGFncyA9IDENCkVuZElmDQpJZiAoYWxsX2ZsYWdzPTEpIEFuZCAoUGluKDExKT0xKSBBbmQgKFBpbigxMik9MCkgQW5kIChQaW4oMTMpPTApIEFuZCBQaW4oMTQpPTApIFRoZW4NCiAgICAgICBzdGFydGluZ19saXRlID0gMQ0KRW5kSWYNCklmIChhbGxfZmxhZ3M9MSkgQW5kIChQaW4oMTEpPTApIEFuZCAoUGluKDEyKT0xKSBBbmQgKFBpbigxMyk9MCkgQW5kIFBpbigxNCk9MCkgVGhlbg0KICAgICAgIHN0YXJ0aW5nX2xpdGUgPSAyDQpFbmRJZg0KSWYgKGFsbF9mbGFncz0xKSBBbmQgKFBpbigxMSk9MCkgQW5kIChQaW4oMTIpPTApIEFuZCAoUGluKDEzKT0xKSBBbmQgUGluKDE0KT0wKSBUaGVuDQogICAgICAgc3RhcnRpbmdfbGl0ZSA9IDMNCkVuZElmDQpJZiAoYWxsX2ZsYWdzPTEpIEFuZCAoUGluKDExKT0wKSBBbmQgKFBpbigxMik9MCkgQW5kIChQaW4oMTMpPTApIEFuZCBQaW4oMTQpPTEpIFRoZW4NCiAgICAgICBzdGFydGluZ19saXRlID0gNA0KRW5kSWYNClJlbSBQcmludCBzdGFydGluZ19saXRlO2FsbF9mbGFncw0KUGF1c2UgMTANCnRpbWVvdXRfY291bnRlciA9IHRpbWVvdXRfY291bnRlciArIDENCklmIHRpbWVvdXRfY291bnRlciAmZ3Q7IHRpbWVvdXQgVGhlbiBHb1RvIGRvX3Jlc2V0DQpHb1RvIGhhdmVfbGVhcm50X2FsbA0KDQpidWxic2V0JiM1ODsNCklmIHBvc2l0aW9uID0gMCBUaGVuDQogICAgICAgYnVsYiA9IDE1DQpFbmRJZg0KSWYgcG9zaXRpb24gPSAxIFRoZW4NCiAgICAgICBidWxiID0gMTYNCkVuZElmDQpJZiBwb3NpdGlvbiA9IDIgVGhlbg0KICAgICAgIGJ1bGIgPSAxNw0KRW5kSWYNCklmIHBvc2l0aW9uID0gMyBUaGVuDQogICAgICAgYnVsYiA9IDE4DQpFbmRJZg0KUmVtIFByaW50IHBvc2l0aW9uO2J1bGINClJldHVybg0KDQphdWRpZW5jZV9sb2NrZG93biYjNTg7DQpJZiBQaW4oMTEpID0gMSBUaGVuDQogICAgICAgUGluKDE1KSA9IDENCkVsc2UNCiAgICAgICBQaW4oMTUpID0gMA0KRW5kSWYNCklmIFBpbigxMikgPSAxIFRoZW4NCiAgICAgICBQaW4oMTYpID0gMQ0KRWxzZQ0KICAgICAgIFBpbigxNikgPSAwDQpFbmRJZg0KSWYgUGluKDEzKSA9IDEgVGhlbg0KICAgICAgIFBpbigxNykgPSAxDQpFbHNlDQogICAgICAgUGluKDE3KSA9IDANCkVuZElmDQpJZiBQaW4oMTQpID0gMSBUaGVuDQogICAgICAgUGluKDE4KSA9IDENCkVsc2UNCiAgICAgICBQaW4oMTgpID0gMA0KRW5kSWYNCkdvVG8gYXVkaWVuY2VfbG9ja2Rvd24NCg0KPC9wcmU+ZGQMgvDWEYaspJU0jQldV6eb1bQSgg==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Magic Switchboard</h1><small>Modified on 2016/12/23 23:34 by Administrator &mdash; Categorized as: Electronics, Maths, _LIB Original MMBasic</small><br /><br /><h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br />Magic Switchboard<br /><br />This is rewrite of the magic switchboard program to suit MMbasic.  The original was written by Picaxe technical for the picaxe 18x.<br /><br />This program uses four input switches connected to pins 11, 12, 13 and 14 and the output (either white LEDs with colour tops or 6V coloured lamps) connected to Pins 15,16,17 and 18.  The lamps require driver transistors. The schematic of the Magic Switchboard is in the attached file and you can see a demonstration of it at <a class="externallink" href="http://www.youtube.com/watch?v=0lGP8nQLANU" title="www.youtube.com/watch?v=0lGP8nQLANU" target="_blank">www.youtube.com/watch?v=0lGP8nQLANU</a>. It is truly amazing.<br /><br />Regards Bill Brown<br /><br /><pre>

' Magic Switchboard - original source by "Technical" from PicAxe Forum
'                     Modified for PicAxe 18x by Wayne Thomason of Addison, TX USA
'                     7/15/2009
'                   Modified for Maximite MMBasic by Bill Brown  bill.b
'                     19/01/2012
'
'                      mods&#58; 1. Now is easily configurable via switch? and bulb? variables
'                            2. "timeout" functions even without learning all 4 switches
'                            3. starting point and sequence direction dependent on last switch turned off
'                            4. Now has Audience_lockdown feature.  If power is turned on while switch-4
'                               is set, each light will respond only to corresponding switch position
'                               until circuit is reset.
'
' Assumptions
' 1. Times out after 10 seconds of all switches in the off position
'    regardless of whether all switches are learned yet
' 2. All switches must be off at start
'    (If switch 4 on when started, it starts up in audience-mode.)
' 3. All 4 switches must be switched on before that sequence is learned
' 4. Set bulb/LED outputs using bulb1, bulb2, bulb3 &amp; bulb4
' 5. Set switch inputs using switch1, switch2, switch3 and switch4
' 6. first pattern is left to right, bulbs 1, 2, 3, 4
' 7. subsequent patterns are determined by last SWITCH turned off&#58;
'       Switch 1 = 1234 order (bulb 1 first, then right in sequence)
'       Switch 2 = 2143 order (bulb 2 first, then left in sequence, wrapping after first)
'       Switch 3 = 3412 order (bulb 3 first, then right in sequence, wrapping after last)
'       Switch 4 = 4321 order (bulb 4 first, then left in sequence)
timeout = 750     'loop reset time approx 10 seconds
timeout_counter = 0
SetPin 11,2
SetPin 12,2
SetPin 13,2
SetPin 14,2
SetPin 15,8
SetPin 16,8
SetPin 17,8
SetPin 18,8
Pin(15) = 0&#58;Pin(16)=0&#58;Pin(17)=0&#58;Pin(18)=0
If Pin(14) = 1 Then GoTo Audience_Lockdown
starting_lite = 1

' Start of program

do_reset&#58;      ' reset position counter

If starting_lite = 1 Then
       position = 0    ' if starting with bulb 1, position reset to 0.
EndIf
If starting_lite = 2 Then
       position = 1    ' if starting with bulb 2, position reset to 1.
EndIf
If starting_lite = 3 Then
       position = 2    ' if starting with bulb 3, position reset to 2.
EndIf
If starting_lite = 4 Then
       position = 3    ' if starting with bulb 4, position reset to 3.
EndIf
flag0 = 0 &#58; flag1 = 0 &#58;flag2 = 0&#58;flag3 = 0

' Learning loop

waiting_to_learn_loop&#58;

If (Pin(11) = 1) And (flag0 = 0) Then GoTo learn0
If (Pin(12) = 1) And (flag1 = 0) Then GoTo learn1
If (Pin(13) = 1) And (flag2 = 0) Then GoTo learn2
If (Pin(14) = 1) And (flag3 = 0) Then GoTo learn3

 ' we have learnt that switch so light output accordingly

If flag0 = 1 Then
       If Pin(11) = 1 Then
              Pin(light0) = 1
       Else
              Pin(light0) = 0
       EndIf
EndIf
If flag1 = 1 Then
       If Pin(12) = 1 Then
             Pin(light1) = 1
       Else
              Pin(light1) = 0
       EndIf
EndIf
If flag2 = 1 Then
       If Pin(13) = 1 Then
              Pin(light2) = 1
       Else
              Pin(light2) = 0
       EndIf
EndIf
If flag3 = 1 Then
       If Pin(14) = 1 Then
             Pin(light3) = 1
       Else
              Pin(light3) = 0
       EndIf
EndIf

If (Pin(11) = 0) And (Pin(12) = 0) And (Pin(13) = 0) And (Pin(14) = 0) Then
       Pause 10
       timeout_counter = timeout_counter + 1
       If timeout_counter &gt; timeout Then
              timeout_counter = 0
              GoTo do_reset
       EndIf
Else
       timeout_counter = 0
EndIf
GoTo waiting_to_learn_loop

' Learn a light position and set flag so we know that switch is done

learn0&#58;

GoSub bulbset
flag0 = 1
light0 = bulb
GoTo learn_end

learn1&#58;

GoSub bulbset
flag1 = 1
light1 = bulb
GoTo learn_end

learn2&#58;

GoSub bulbset
flag2 = 1
light2 = bulb
GoTo learn_end

learn3&#58;

GoSub bulbset
flag3 = 1
light3 = bulb
GoTo learn_end

learn_end&#58;

If starting_lite = 1 Then      'if starting with 1st lamp, sequence = 1-2-3-4
       position = position + 1
       If position &gt; 3 Then GoTo have_learnt_all
       GoTo waiting_to_learn_loop
EndIf
If starting_lite = 2 Then      'if starting with 2nd lamp, sequence = 2-1-4-3
       If position &gt; 0 Then    'don't dec if position=0, will cause error
              position = position - 1
       Else
              position = 3
       EndIf
       If position = 1 Then GoTo have_learnt_all
       GoTo waiting_to_learn_loop
EndIf
If starting_lite = 3 Then      'if starting with 3rd lamp, sequence = 3-4-1-2
       position = position + 1
       If position &gt; 3 Then
              position = 0
       EndIf
       If position = 2 Then GoTo have_learnt_all
       GoTo waiting_to_learn_loop
EndIf
If starting_lite = 4 Then      'if starting with 4th lamp, sequence = 4-3-2-1
       If position &gt; 0 Then
              position = position - 1
       Else
              GoTo have_learnt_all
       EndIf
       GoTo waiting_to_learn_loop
EndIf

' now simply loop reacting to the switches
' timeout_counter value will increment every 10ms
' however if any light is on the timeout_counter is reset
' so this means the timeout will only
' occur after 10 secoonds of all switches off

have_learnt_all&#58;

If Pin(11) = 1 Then
       Pin(light0) = 1
       timeout_counter = 0
Else
       Pin(light0) = 0
EndIf
If Pin(12) = 1 Then
       Pin(light1) = 1
       timeout_counter = 0
Else
       Pin(light1) = 0
EndIf
If Pin(13) = 1 Then
       Pin(light2) = 1
       timeout_counter = 0
Else
       Pin(light2) = 0
EndIf
If Pin(14) = 1 Then
       Pin(light3) = 1
       timeout_counter = 0
Else
       Pin(light3) = 0
EndIf

If (flag0=1) And (flag1=1) And (flag2=1) And (flag3=1) Then
       all_flags = 1
EndIf
If (all_flags=1) And (Pin(11)=1) And (Pin(12)=0) And (Pin(13)=0) And Pin(14)=0) Then
       starting_lite = 1
EndIf
If (all_flags=1) And (Pin(11)=0) And (Pin(12)=1) And (Pin(13)=0) And Pin(14)=0) Then
       starting_lite = 2
EndIf
If (all_flags=1) And (Pin(11)=0) And (Pin(12)=0) And (Pin(13)=1) And Pin(14)=0) Then
       starting_lite = 3
EndIf
If (all_flags=1) And (Pin(11)=0) And (Pin(12)=0) And (Pin(13)=0) And Pin(14)=1) Then
       starting_lite = 4
EndIf
Rem Print starting_lite;all_flags
Pause 10
timeout_counter = timeout_counter + 1
If timeout_counter &gt; timeout Then GoTo do_reset
GoTo have_learnt_all

bulbset&#58;
If position = 0 Then
       bulb = 15
EndIf
If position = 1 Then
       bulb = 16
EndIf
If position = 2 Then
       bulb = 17
EndIf
If position = 3 Then
       bulb = 18
EndIf
Rem Print position;bulb
Return

audience_lockdown&#58;
If Pin(11) = 1 Then
       Pin(15) = 1
Else
       Pin(15) = 0
EndIf
If Pin(12) = 1 Then
       Pin(16) = 1
Else
       Pin(16) = 0
EndIf
If Pin(13) = 1 Then
       Pin(17) = 1
Else
       Pin(17) = 0
EndIf
If Pin(14) = 1 Then
       Pin(18) = 1
Else
       Pin(18) = 0
EndIf
GoTo audience_lockdown

</pre>
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Magic-Switchboard-part-of-the-original-MMBasic-library by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:19:48 GMT -->
</html>
