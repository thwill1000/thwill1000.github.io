

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:54:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine - Fruit Of The Shed
</title><meta name="keywords" content="console, screen, cursor, positioning, keyboard, editing" /><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc&amp;NS=MMBasic&amp;NoRedirect=1" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPDxYCHgdWaXNpYmxlaGQWAmYPFgIeC18hSXRlbUNvdW50ZmRkL9X+pH8J+jB1IIJZx71WjgOrjyw=" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login5f21.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dSimple-screen-Control-for-ANSI-based-Consoles-VT100-etc%26NS%3dMMBasic%26NoRedirect%3d1" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.History693b.html?Page=MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc">History</a>
			
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Print693b.html?Page=MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2021/11/14 08:37
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.Userb2ec.html?Username=hendy">CaptainBoing</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPagese444.html?Cat=MMBasic.Console" title="Console">Console</a>, <a href="MMBasic.AllPagese076.html?Cat=MMBasic.Control" title="Control">Control</a>, <a href="MMBasic.AllPageseb16.html?Cat=MMBasic.Graphics" title="Graphics">Graphics</a>, <a href="MMBasic.AllPages39e4.html?Cat=MMBasic.LCD%20Panels" title="LCD Panels">LCD Panels</a>, <a href="MMBasic.AllPages6c47.html?Cat=MMBasic.Program%20Flow" title="Program Flow">Program Flow</a>, <a href="MMBasic.AllPagesff34.html?Cat=MMBasic.Strings" title="Strings">Strings</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="ffdfb9114-85c5-4a14-8036-0e0cf4d4ab2a" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('ffdfb9114-85c5-4a14-8036-0e0cf4d4ab2a');"><a href="MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions.html" title="LTrim and RTrim Functions (VB work-a-like)">LTrim and RTrim Functions (VB work-a-like)</a><a href="MMBasic.LTrim-RTrim-cFunctions.html" title="LTrim RTrim CFunctions">LTrim RTrim CFunctions</a><a href="MMBasic.String-editing-on-screen-for-VT-compatible-Terminals.html" title="String editing on-screen for VT compatible Terminals">String editing on-screen for VT compatible Terminals</a></div><div id="f5916d463-a081-4a53-a81f-b5d7368f1f9f" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f5916d463-a081-4a53-a81f-b5d7368f1f9f');"></div><div id="fb2451ffa-6ec1-47b6-9091-0ff1bcc1985a" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fb2451ffa-6ec1-47b6-9091-0ff1bcc1985a');"><a href="MMBasic.Now-Function-VB-work-a-like.html" title="Now() Function (VB work-a-like) ">Now() Function (VB work-a-like) </a><a href="MMBasic.HumanTime-Function-to-return-a-human-readable-date-and-time-from-a-unixtime-number.html" title="HumanTime() Function to return a human readable date and time from a unixtime number">HumanTime() Function to return a human readable date and time from a unixtime number</a><a href="MMBasic.VB%20Work-a-like%20SPLIT%20Function.html" title="SPLIT Function (VB work-a-like)">SPLIT Function (VB work-a-like)</a><a href="MMBasic.IsLeapYear-Function-to-determine-if-the-given-year-is-a-Leap-Year-on-the-Gregorian-western-calendar.html" title="IsLeapYear Function to determine if the given year is a Leap Year on the Gregorian (western) calendar">IsLeapYear Function to determine if the given year is a Leap Year on the Gregorian (western) calendar</a><a href="MMBasic.IsDate-and-IsTime-functions-VB-Work-A-Like.html" title="IsDate and IsTime functions (VB Work-A-Like)">IsDate and IsTime functions (VB Work-A-Like)</a></div><div id="fb5ec0f1b-de49-409c-a5fd-5b615f7106e8" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fb5ec0f1b-de49-409c-a5fd-5b615f7106e8');"><a href="MMBasic.MMBasic-code-pack-to-Read-and-Write-Winbond-Flash-Memories.html" title="MMBasic code-pack to Read and Write Winbond Flash Memories">MMBasic code-pack to Read and Write Winbond Flash Memories</a><a href="MMBasic.UnixTime-or-Epoch-Time.html" title="UnixTime or Epoch Time">UnixTime or Epoch Time</a><a href="MMBasic.HumanTime-Function-to-return-a-human-readable-date-and-time-from-a-unixtime-number.html" title="HumanTime() Function to return a human readable date and time from a unixtime number">HumanTime() Function to return a human readable date and time from a unixtime number</a><a href="MMBasic.Now-Function-VB-work-a-like.html" title="Now() Function (VB work-a-like) ">Now() Function (VB work-a-like) </a><a href="MMBasic.Sign-Extend-an-Integer.html" title="Sign Extend an Integer">Sign Extend an Integer</a></div><div id="s5ac7c1b9-5bc1-47d1-910c-9e6d12af077a" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s5ac7c1b9-5bc1-47d1-910c-9e6d12af077a');"><a href="MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions.html" title="LTrim and RTrim Functions (VB work-a-like)">LTrim and RTrim Functions (VB work-a-like)</a><a href="MMBasic.LTrim-RTrim-cFunctions.html" title="LTrim RTrim CFunctions">LTrim RTrim CFunctions</a><a href="MMBasic.String-editing-on-screen-for-VT-compatible-Terminals.html" title="String editing on-screen for VT compatible Terminals">String editing on-screen for VT compatible Terminals</a></div><div id="s51b133a5-aa5d-420d-90f0-3375e45cfd44" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('s51b133a5-aa5d-420d-90f0-3375e45cfd44');"></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.Vehicle-Reversing-Assistant.html" title="Vehicle Reversing Assistant (MMBasic)">Vehicle Reversing Assistant (MMBasic)</a> &raquo; <a href="MMBasic.vmndlbrot-bas-part-of-the-original-MMBasic-library.html" title="vmndlbrot.bas (MMBasic)">vmndlbrot.bas (MMBasic)</a> &raquo; <b><a href="MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc.html" title="VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 's5ac7c1b9-5bc1-47d1-910c-9e6d12af077a', this);" id="lnks5ac7c1b9-5bc1-47d1-910c-9e6d12af077a" onmouseout="javascript:return __HideDropDown('s5ac7c1b9-5bc1-47d1-910c-9e6d12af077a');">VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="MMBasic.Twinkle-demonstrates-Maximite-control-of-individual-pixels-part-of-the-original-MMBasic-library.html" title="Twinkle demonstrates Maximite control of individual pixels (MMBasic)">Twinkle demonstrates Maximite control of individual pixels (MMBasic)</a> &raquo; <a href="MMBasic.UBOUND-Upper-boundary-of-an-Array.html" title="UBOUND Upper boundary of an Array. A work-around (MMBasic)">UBOUND Upper boundary of an Array. A work-around (MMBasic)</a> &raquo; <a href="MMBasic.uFormat-and-StrE-provide-flexible-formatting-of-numeric-values.html" title="uFormat$() and StrE$() provide flexible formatting of numeric values (MMBasic)">uFormat$() and StrE$() provide flexible formatting of numeric values (MMBasic)</a> &raquo; <a href="MMBasic.Ultra-Compact-Logging-with-Flash-Storage-on-small-MicroMites.html" title="Ultra-Compact Logging with Flash Storage on small MicroMites (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'fb5ec0f1b-de49-409c-a5fd-5b615f7106e8', this);" id="lnkfb5ec0f1b-de49-409c-a5fd-5b615f7106e8" onmouseout="javascript:return __HideDropDown('fb5ec0f1b-de49-409c-a5fd-5b615f7106e8');">Ultra-Compact Logging with Flash Storage on small MicroMites (MMBasic)</a> &raquo; <a href="MMBasic.UnixTime-or-Epoch-Time.html" title="UnixTime or Epoch Time (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'fb2451ffa-6ec1-47b6-9091-0ff1bcc1985a', this);" id="lnkfb2451ffa-6ec1-47b6-9091-0ff1bcc1985a" onmouseout="javascript:return __HideDropDown('fb2451ffa-6ec1-47b6-9091-0ff1bcc1985a');">UnixTime or Epoch Time (MMBasic)</a> &raquo; <a href="MMBasic.URL-DECODE-Function.html" title="URL DECODE Function	 (MMBasic)">URL DECODE Function	 (MMBasic)</a> &raquo; <a href="MMBasic.URL-ENCODE-Function.html" title="URL ENCODE Function (MMBasic)">URL ENCODE Function (MMBasic)</a> &raquo; <a href="MMBasic.Vehicle-Reversing-Assistant.html" title="Vehicle Reversing Assistant (MMBasic)">Vehicle Reversing Assistant (MMBasic)</a> &raquo; <a href="MMBasic.vmndlbrot-bas-part-of-the-original-MMBasic-library.html" title="vmndlbrot.bas (MMBasic)">vmndlbrot.bas (MMBasic)</a> &raquo; <b><a href="MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc.html" title="VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'ffdfb9114-85c5-4a14-8036-0e0cf4d4ab2a', this);" id="lnkffdfb9114-85c5-4a14-8036-0e0cf4d4ab2a" onmouseout="javascript:return __HideDropDown('ffdfb9114-85c5-4a14-8036-0e0cf4d4ab2a');">VT Console Pack. Screen Positioning, Sane Key Scanning And a String Editing Routine (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		Not all projects require an LCD panel but a simple console connection can often benefit from a bit more than a dumb scrolling display.<br /><br />The following Subs and Functions provide functionality similar to that found on personal computers prevalent in the 80s. Console displays can be made quite pleasant with this output and hark back to the character based screens of early PCs. <br /><br />At() - Screen positioning uses the "At" function for cursor positioning. It uses less program space and is arguably more intuitive than a stand-alone LOCATE command. Note that because it produces a string, strictly a ; or + should be used when printing following output, but because of a quirk in how lines are parsed when printing, it can be omitted resulting in the pleasing.<pre>Print At(10,10) "fred"</pre><br />VTKey$() - Key Scanning for non-ASCII keys (Function keys, Home, PageUp etc.) is a real pain in the neck. The Function VTKey$() can be used to replace Inkey$ and will return either the ASCII value of the key pressed or a predictable three-letter token for any of the special keys. <br /><br />Your console emulator must support ANSI screen/keyboard codes - usually defined as VT52, VT100 etc. emulation. Personally I use PuTTY.<br /><br /><b>Dependancies</b><br /><ul><br /><li>Option Base 0</li><br /><li>Requires the <a class="pagelink" href="MMBasic.VB-Work-a-like-LTrim-and-RTRIM-Functions.html" title="LTrim and RTrim Functions (VB work-a-like)">LTrim and RTRIM Functions (VB work-a-like)</a> or the equivalent <a class="pagelink" href="MMBasic.LTrim-RTrim-cFunctions.html" title="LTrim RTrim CFunctions">LTrim RTrim CFunctions</a> (note this latter does not treat TABs as white-space and so are not trimmed).</li><br /></ul><br /><b>Example Usage</b><br /><pre>
	Option Base 0
	InitVTKeys
	
Main&#58;' just something to demonstrate usage

	Clr ' clear the screen

	For n=1 To 25 ' print out a diagonal line of numbers
		Print At(n,n);Str$(n)
	Next

	Window 6,10 ' define  window
	For n=1 To 25 ' demonstrate the contained area of the screen
		Print n
	Next
	
	Window 1,25
	
	Clr
	
	a$=StrEdit$("Fred",10,10,60)
	
	? At(1,1);a$
</pre><br /><b>The Code</b><br /><pre>

	Function At(v As Integer,h As Integer) As String
		At=Chr$(27)+"&#91;"+Str$(v)+";"+Str$(h)+"H"
	End Function

	Sub Clr
		Window 1,25' redefine the whole screen
		Print Chr$(27)+"&#91;2J";
	End Sub

	Sub Window(Pt As Integer, Pb As Integer)
	'defines a window from line t to line b and positions the cursor in the start of it
	'Clr and At still work on the whole screen. Only when scrolling (or CRLF) enteres the
	'window does it capture the cursor. Note 0&lt;Pt&lt;Pb is enforced by the console emulator
		Print Chr$(27)+"&#91;"+Str$(Pt)+";"+Str$(Pb)+"r"+At(Pt,1);
	End Sub
	
	Function VTKey$() ' replaces Inkey$ and will return the character pressed or the special token _xx
		Local a$
		VTKey$=Inkey$
		Pause 25 ' give the remaining sequence (if any) time to arrive. Any less than 25 can give mis-reads of expanded tokens
		Do
			a$=Inkey$&#58;If a$="" Then Exit Do ' jump out when we are scanning ""
			VTKey$=VTKey$+a$ ' build up the character codes
		Loop		
		If Len(VTKey$)&gt;1 Then VTKey$=ExpandKey(VTKey$)
	End Function
	
	Function ExpandKey(c$) As String' called from VTKey$
		Local n
		For n=0 To Kct
			If KCode$(n)=c$ Then ExpandKey=KTkn$(n)&#58;Exit Function
		Next
		ExpandKey=""
	End Function

	Sub InitVTKeys
		Dim Integer Kct
		Local x$
		Local Integer q
KeyData&#58;
		' &lt;esc&gt; &#91;
		Data 27,91,68,0,"_LT"
		Data 27,91,67,0,"_RT"
		Data 27,91,65,0,"_UP"
		Data 27,91,66,0,"_DN"
		Data 27,91,49,126,0,"_HM"
		Data 27,91,50,126,0,"_IN"
		Data 27,91,51,126,0,"_DL"
		Data 27,91,52,126,0,"_ED"
		Data 27,91,53,126,0,"_PU"
		Data 27,91,54,126,0,"_PD"
		Data 27,91,55,126,0,"_HM"
		Data 27,91,56,126,0,"_ED"
		Data 27,91,49,49,126,0,"_F1"
		Data 27,91,49,50,126,0,"_F2"
		Data 27,91,49,51,126,0,"_F3"
		Data 27,91,49,52,126,0,"_F4"
		Data 27,91,49,53,126,0,"_F5"
		Data 27,91,49,55,126,0,"_F6"
		Data 27,91,49,56,126,0,"_F7"
		Data 27,91,49,57,126,0,"_F8"
		Data 27,91,50,48,126,0,"_F9"
		Data 27,91,50,49,126,0,"_FA"
		Data 27,91,50,51,126,0,"_FB"
		Data 27,91,50,52,126,0,"_FC"
		Data 255		

		Restore KeyData 'determine size of the key table
		Do
			Read q
			If q=255 Then Exit Do
			If q=0 Then Kct=Kct+1&#58;Read x$
		Loop

		Dim KCode$(Kct-1) Length 5
		Dim KTkn$(Kct-1) Length 3

		Restore KeyData
		Kct=0
		Do
			Read q
			If q=255 Then Kct=Kct-1&#58;Exit Do ' adjust Kct to point at top of key array
			If q=0 Then
				Read KTkn$(Kct)
				Kct=Kct+1
			Else
				KCode$(Kct)=KCode$(Kct)+Chr$(q)
			EndIf
		Loop

		'Here KCode$(n) is the key sequences we get from the keypress
		'     KTkn$(n)  is the shorthand code name _xx
	End Sub
</pre><br /><b>See Also</b>:<br /><a class="pagelink" href="MMBasic.String-editing-on-screen-for-VT-compatible-Terminals.html" title="String editing on-screen for VT compatible Terminals">String editing on-screen for VT compatible Terminals</a>
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		
    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Simple-screen-Control-for-ANSI-based-Consoles-VT100-etc.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:54:53 GMT -->
</html>
