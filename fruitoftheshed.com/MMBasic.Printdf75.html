

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.True-Random-Generator-companion-code-for-circuit by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:25:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	True Random Generator (companion code for circuit) - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.True-Random-Generator-companion-code-for-circuit" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQFkhI8aDEgY2xhc3M9InBhZ2V0aXRsZSI+VHJ1ZSBSYW5kb20gR2VuZXJhdG9yIChjb21wYW5pb24gY29kZSBmb3IgY2lyY3VpdCk8L2gxPjxzbWFsbD5Nb2RpZmllZCBvbiAyMDE4LzEyLzE3IDEyOjU1IGJ5IENhcHRhaW5Cb2luZyAmbWRhc2g7IENhdGVnb3JpemVkIGFzOiBFbGVjdHJvbmljcywgTWF0aHM8L3NtYWxsPjxiciAvPjxiciAvPlRoaXMgZnVuY3Rpb24gd2lsbCBnZW5lcmF0ZSBhIHRydWUgcmFuZG9tIG51bWJlciBmcm9tIHRoZSA8YSBjbGFzcz0icGFnZWxpbmsiIGhyZWY9IkNpcmN1aXQlMjBJZGVhcy5SYW5kb20tQml0LUdlbmVyYXRvci1mb3ItY3J5cHRvZ3JhcGhpYy1zdHJlbmd0aC1yYW5kb20tbnVtYmVycy5hc2h4IiB0aXRsZT0iUmFuZG9tIEJpdCBHZW5lcmF0b3IgZm9yIGNyeXB0b2dyYXBoaWMgc3RyZW5ndGggcmFuZG9tIG51bWJlcnMiPlJhbmRvbSBCaXQgR2VuZXJhdG9yIGZvciBjcnlwdG9ncmFwaGljIHN0cmVuZ3RoIHJhbmRvbSBudW1iZXJzPC9hPiBjaXJjdWl0LjxiciAvPjxiciAvPkFuIHVwcGVyIGxpbWl0IGFuZCByZXNvbHV0aW9uIG11c3QgYmUgc3BlY2lmaWVkLiBUaGUgaGlnaGVyIHRoZSByZXNvbHV0aW9uIHRoZSBsb25nZXIgdGltZSByZXF1aXJlZCB0byByZXR1cm4gYSB2YWx1ZSBidXQgdGhlIGxlc3MgImNvdXJzZSIgdGhlIGFuc3dlci4gZS5nLiBpZiB5b3Ugc3BlY2lmeSBhIG1heGltdW0gb2YgMTAwIHdpdGggYSByZXNvbHV0aW9uIG9mIDQgYml0cyAoMl40PTE2KSwgdGhlIHNtYWxsZXN0IHZhbHVlIHRoYXQgY2FuIGJlIHJldHVybmVkIGlzIDYuMjUgKDEwMC8xNiksIHdoZXJlYXMgYSByZXNvbHV0aW9uIG9mIDE2ICgyXjE2PTY1NTM2KSB3aWxsIHJldHVybiBhIG1pbmltdW0gcmVzb2x1dGlvbiBvZiAwLjAwMTUyNTkgKDEwMC82NTUzNikuIENob29zZSBhIHZhbHVlIHdoaWNoIGlzIGEgZ29vZCBjb21wcm9taXNlIG9mIHJlc29sdXRpb24gdmVyc3VzIHNwZWVkLiA8YnIgLz48YnIgLz48Yj5TeW50YXg8L2I+OjxiciAvPlRSbmQhKFVwcGVyX0xpbWl0LFJlc29sdXRpb24pPGJyIC8+PGJyIC8+UmVzb2x1dGlvbiBpcyAgPGNvZGU+MSA8IHggPCA2NDwvY29kZT4gYml0czxiciAvPlJldHVybiBpcyAgPGNvZGU+MCA8PSB4IDwgVXBwZXJfTGltaXQ8L2NvZGU+PGJyIC8+PGJyIC8+PGI+RXhhbXBsZTwvYj46PGJyIC8+dCE9VFJuZCEoMTAwLDE2KTxiciAvPjxiciAvPjxiPk1hdGhzIENvbnNpZGVyYXRpb25zOjwvYj48YnIgLz5XaXRoIHRoZSBkZWZhdWx0IHNpbmdsZSBwcmVjaXNpb24gZmxvYXRpbmcgcG9pbnQgb2YgdGhlIE1pY3JvTWl0ZSwgYSBwcmFjdGljYWwgbGltaXQgb2YgMTggYml0cyBzaG91bGQgYmUgb2JzZXJ2ZWQuIE1vcmUgdGhhbiB0aGlzIHJlc3VsdHMgaW4gdGhlIHJvdW5kaW5nIGVycm9ycyBvZiB0aGUgbWF0aHMgcGFjayBiZWNvbWluZyBhIHNpZ25pZmljYW50IGNvbnRyaWJ1dG9yIHRvIHRoZSByZXR1cm5lZCB2YWx1ZS4gZS5nLiBieSBob2xkaW5nIHRoZSBpbnB1dCBwaW4gaGlnaCAodG8gZm9yY2UgYSBtYXhpbXVtIGNvdW50KTxiciAvPjxjb2RlPlRSbmQhKDIsMTgpPC9jb2RlPjxiciAvPnJldHVybnMgPGJyIC8+PGNvZGU+MS45OTk5OTwvY29kZT48YnIgLz48YnIgLz5CdXQgPGJyIC8+PGNvZGU+VFJuZCEoMiwxOSk8L2NvZGU+PGJyIC8+cmV0dXJucyA8YnIgLz48Y29kZT4yPC9jb2RlPjxiciAvPndoaWNoIGNsZWFybHkgYnJlYWtzIHRoZSBydWxlIG9mIHggPCBVcHBlcl9MaW1pdDxiciAvPjxiciAvPlRoZSBkb3VibGUgcHJlY2lzaW9uIG9mIE1NWCBNTUJhc2ljIHdpbGwgcHVzaCB0aGlzIGxpbWl0IG91dCBmdXJ0aGVyIGJ1dCBpcyBtb290IGFzIHRoZSBSTkQoKSBmdW5jdGlvbiB1c2VzIHRoZSBUUk5HIGdlbmVyYXRvciBvZiB0aGUgUElDMzJNWi48YnIgLz48YnIgLz48YnIgLz48Yj5Bc3N1bXB0aW9uczwvYj46PGJyIC8+PHByZT4NCiAgIFNFVFBJTiAxLERJTg0KPC9wcmU+PGJyIC8+PGI+Q29kZTwvYj46PGJyIC8+PHByZT4NCiAgICBGVU5DVElPTiBUUm5kISh4IEFTIEZMT0FULGJpdHMgQVMgSU5URUdFUikNCiAgICAgIExPQ0FMIElOVEVHRVIgbix0LGINCiAgICAgIGI9TWF4KE1pbihiaXRzLDYzKSwxKSAnIGNvbnN0cmFpbiBiaXRzIHRvIDEtNjMNCg0KICAgICAgRk9SIG49MSBUTyBiDQogICAgICAgIHQ9KHQmbHQ7Jmx0OzEpICsgUElOKDEpDQogICAgICBORVhUDQoNCiAgICAgIFRSbmQhPSgxLygyXmIpJiM0Mjt0KSYjNDI7eCAgICcgdGhlIHJldHVybmVkIHZhbHVlIGNhbiBuZXZlciBiZSB4IGJ1dCBtaWdodCBiZSB2ZXJ5IGNsb3NlDQoNCiAgICBFTkQgRlVOQ1RJT04gDQo8L3ByZT48YnIgLz5kZKwXGBsznkdzFmh7Hl2hYj3MY6AL" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">True Random Generator (companion code for circuit)</h1><small>Modified on 2018/12/17 12:55 by CaptainBoing &mdash; Categorized as: Electronics, Maths</small><br /><br />This function will generate a true random number from the <a class="pagelink" href="Circuit%20Ideas.Random-Bit-Generator-for-cryptographic-strength-random-numbers.html" title="Random Bit Generator for cryptographic strength random numbers">Random Bit Generator for cryptographic strength random numbers</a> circuit.<br /><br />An upper limit and resolution must be specified. The higher the resolution the longer time required to return a value but the less "course" the answer. e.g. if you specify a maximum of 100 with a resolution of 4 bits (2^4=16), the smallest value that can be returned is 6.25 (100/16), whereas a resolution of 16 (2^16=65536) will return a minimum resolution of 0.0015259 (100/65536). Choose a value which is a good compromise of resolution versus speed. <br /><br /><b>Syntax</b>:<br />TRnd!(Upper_Limit,Resolution)<br /><br />Resolution is  <code>1 < x < 64</code> bits<br />Return is  <code>0 <= x < Upper_Limit</code><br /><br /><b>Example</b>:<br />t!=TRnd!(100,16)<br /><br /><b>Maths Considerations:</b><br />With the default single precision floating point of the MicroMite, a practical limit of 18 bits should be observed. More than this results in the rounding errors of the maths pack becoming a significant contributor to the returned value. e.g. by holding the input pin high (to force a maximum count)<br /><code>TRnd!(2,18)</code><br />returns <br /><code>1.99999</code><br /><br />But <br /><code>TRnd!(2,19)</code><br />returns <br /><code>2</code><br />which clearly breaks the rule of x < Upper_Limit<br /><br />The double precision of MMX MMBasic will push this limit out further but is moot as the RND() function uses the TRNG generator of the PIC32MZ.<br /><br /><br /><b>Assumptions</b>:<br /><pre>
   SETPIN 1,DIN
</pre><br /><b>Code</b>:<br /><pre>
    FUNCTION TRnd!(x AS FLOAT,bits AS INTEGER)
      LOCAL INTEGER n,t,b
      b=Max(Min(bits,63),1) ' constrain bits to 1-63

      FOR n=1 TO b
        t=(t&lt;&lt;1) + PIN(1)
      NEXT

      TRnd!=(1/(2^b)&#42;t)&#42;x   ' the returned value can never be x but might be very close

    END FUNCTION 
</pre><br />
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.True-Random-Generator-companion-code-for-circuit by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:25:11 GMT -->
</html>
