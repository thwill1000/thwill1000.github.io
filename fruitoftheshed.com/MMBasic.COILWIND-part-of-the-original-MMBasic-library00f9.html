

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.COILWIND-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:43:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	COILWIND - Fruit Of The Shed
</title><meta name="keywords" content="coil, winder" /><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=COILWIND-part-of-the-original-MMBasic-library&amp;NS=MMBasic&amp;NoRedirect=1" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPZBYCZg8WAh4LXyFJdGVtQ291bnQCARYCAgEPZBYCZg8VBNMBR2V0RmlsZS5hc3B4P0ZpbGU9SSUyMGJ1aWx0JTIwYSUyMGNvaWwlMjB3aW5kZXIucGRmJmFtcDtBc1N0cmVhbUF0dGFjaG1lbnQ9MSZhbXA7UHJvdmlkZXI9U2NyZXdUdXJuLldpa2kuRmlsZXNTdG9yYWdlUHJvdmlkZXImYW1wO0lzUGFnZUF0dGFjaG1lbnQ9MSZhbXA7UGFnZT1NTUJhc2ljLkNPSUxXSU5ELXBhcnQtb2YtdGhlLW9yaWdpbmFsLU1NQmFzaWMtbGlicmFyeQhEb3dubG9hZBlJIGJ1aWx0IGEgY29pbCB3aW5kZXIucGRmCTE5Ni40OCBLQmRk2PnMWRwuvAAwhljmdDIe1gIUIZI=" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login9b5d.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dCOILWIND-part-of-the-original-MMBasic-library%26NS%3dMMBasic%26NoRedirect%3d1" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.COILWIND-part-of-the-original-MMBasic-library266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.Historycf70.html?Page=MMBasic.COILWIND-part-of-the-original-MMBasic-library">History</a>
			<a id="PageAttachmentsLink" title="Attachments" href="#" onclick="javascript:return __ToggleAttachmentsMenu(event.clientX, event.clientY);">Attachments</a>
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			COILWIND
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Printcf70.html?Page=MMBasic.COILWIND-part-of-the-original-MMBasic-library" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2016/12/23 23:24
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.User6a4a.html?Username=admin">Administrator</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPagese076.html?Cat=MMBasic.Control" title="Control">Control</a>, <a href="MMBasic.AllPages5ce5.html?Cat=MMBasic.Electronics" title="Electronics">Electronics</a>, <a href="MMBasic.AllPages0f85.html?Cat=MMBasic._LIB%20Original%20MMBasic" title="_LIB Original MMBasic">_LIB Original MMBasic</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="fdda29818-dd6a-4ac5-8e71-c6bc2cdede8e" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fdda29818-dd6a-4ac5-8e71-c6bc2cdede8e');"></div><div id="fbd8f3092-feea-40cb-a76f-7b80685261dc" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fbd8f3092-feea-40cb-a76f-7b80685261dc');"></div><div id="fc0cc02fc-71a2-4af7-88c8-19a064d93fae" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fc0cc02fc-71a2-4af7-88c8-19a064d93fae');"><a href="MMBasic.Sort-algorithms-A-comparison.html" title="Sort algorithms - A comparison">Sort algorithms - A comparison</a></div><div id="sd88aa91e-ebb1-461c-bf5c-afa84536883c" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('sd88aa91e-ebb1-461c-bf5c-afa84536883c');"></div><div id="sbb831ecd-92a2-4a48-820a-40c172062e0a" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('sbb831ecd-92a2-4a48-820a-40c172062e0a');"></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.Clock-frequency-trimming-om-Micromite-II-uses-precision-1MHz-output.html" title="Clock frequency trimming on Micromite II uses 1MHz output (MMBasic)">Clock frequency trimming on Micromite II uses 1MHz output (MMBasic)</a> &raquo; <a href="MMBasic.Clock-frequency-trimming-on-Micromite-II-uses-precision-32-768KHz-output-from-DS3231-Real-Time-Clock.html" title="Clock frequency trimming on Micromite II uses precision 32.768KHz output from DS3231 Real Time Clock (MMBasic)">Clock frequency trimming on Micromite II uses precision 32.768KHz output from DS3231 Real Time Clock (MMBasic)</a> &raquo; <b><a href="MMBasic.COILWIND-part-of-the-original-MMBasic-library.html" title="COILWIND (MMBasic)">COILWIND (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="MMBasic.BIN8-BAS-part-of-the-original-MMBasic-library.html" title="BIN8.BAS (MMBasic)">BIN8.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Bit-Manipulation-Functions.html" title="Bit Manipulation Functions (MMBasic)">Bit Manipulation Functions (MMBasic)</a> &raquo; <a href="MMBasic.BLITDEMO-BAS-part-of-the-original-MMBasic-library.html" title="BLITDEMO.BAS (MMBasic)">BLITDEMO.BAS (MMBasic)</a> &raquo; <a href="MMBasic.BMPSHOW-BAS-part-of-the-original-MMBasic-library.html" title="BMPSHOW.BAS (MMBasic)">BMPSHOW.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Bubble-Sort-part-of-the-original-MMBasic-library.html" title="Bubble Sort (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'fc0cc02fc-71a2-4af7-88c8-19a064d93fae', this);" id="lnkfc0cc02fc-71a2-4af7-88c8-19a064d93fae" onmouseout="javascript:return __HideDropDown('fc0cc02fc-71a2-4af7-88c8-19a064d93fae');">Bubble Sort (MMBasic)</a> &raquo; <a href="MMBasic.ByREF-ByVAL-VB-work-a-like.html" title="ByREF & ByVAL - (VB work-a-like) (MMBasic)">ByREF & ByVAL - (VB work-a-like) (MMBasic)</a> &raquo; <a href="MMBasic.CHECKER-BAS-part-of-the-original-MMBasic-library.html" title="CHECKER.BAS (MMBasic)">CHECKER.BAS (MMBasic)</a> &raquo; <a href="MMBasic.Clock-frequency-trimming-om-Micromite-II-uses-precision-1MHz-output.html" title="Clock frequency trimming on Micromite II uses 1MHz output (MMBasic)">Clock frequency trimming on Micromite II uses 1MHz output (MMBasic)</a> &raquo; <a href="MMBasic.Clock-frequency-trimming-on-Micromite-II-uses-precision-32-768KHz-output-from-DS3231-Real-Time-Clock.html" title="Clock frequency trimming on Micromite II uses precision 32.768KHz output from DS3231 Real Time Clock (MMBasic)">Clock frequency trimming on Micromite II uses precision 32.768KHz output from DS3231 Real Time Clock (MMBasic)</a> &raquo; <b><a href="MMBasic.COILWIND-part-of-the-original-MMBasic-library.html" title="COILWIND (MMBasic)">COILWIND (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		<h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: The required file(s) are available in the attachments tab (top right).<br /><br />Coil Winder<br />by Ron Pugh<br />ronee@telus.net<br /><br /><b>Please read the attached PDF for a detailed explanation of this project.</b><br /><br />The coil winder created by Ron uses a Maximite for computer control<br />in conjunction with a pulse width modulation circuit to control bobin motor speed<br />and a Sparkfun stepper motor controller.<br /><br />The current video is available at <a class="externallink" href="http://youtu.be/lXV4aA0fCws" title="http://youtu.be/lXV4aA0fCws" target="_blank">http://youtu.be/lXV4aA0fCws</a><br /><br /><b>Count1.bas</b>:<br /><pre>
10 ' Count Demo, Mick Gulovsen, Ron Pugh
20 '
30 Setpin 11,5
40 A=pin(11)
50 Print A
60 B=pin(11)
70 IF B&gt;A then A=B&#58; goto 50
80 goto 60
</pre><br /><br /><b>PWM1.bas</b>:<br /><pre>
10 ' PWM1.bas using Sound output pin
20 ' Keith Williams, Ron Pugh
30 Cls
40 Line(100, 100) - (300, 150), 1, B ' draws a box
50 Font &#35;2 ' big print
60 Duty = 30 ' init to 30/70 PWM
70           ' 200 Hz duration about 33 minutes 50 % duty
80 '
90 GoSub 200
100 I$=Inkey$ &#58; If I$="" Then GoTo 100 ' Test for keyboard input until key press
110 If I$="z" Then Duty = 15
120 If I$="x" Then Duty = 25
130 If I$="c" Then Duty = 40
140 If I$="v" Then Duty = 50
150 If I$="b" Then Duty = 60
160 If I$="n" Then Duty = 75
170 If I$="m" Then Duty = 100
180 GoTo 80
190 '
200 ' Subroutine to sound and print the duty cycle
210 Sound 200, 2000000, Duty
220 Print @(125,120) "Speed ";Duty;"% "
230 Return

</pre><br /><br /><b>PWM2a.bas</b>:<br /><pre>
10 ' PWM2ac.bas using Sound output pin
12 ' Plus nuber of turns (total count)
15 ' Mick Gulovsen, Ron Pugh
20 CLS
30 Line(100, 100) - (250, 150), 1, B1
40 Font 2 &#58; Print@(120, 120) "Speed %"
50 Line(300, 100) - (400, 150), 1, B2
60 Line(100, 250) - (250, 300), 1, B3
70 Font 2 &#58; Print@(105, 270) "Turns Count"
80 Line(300, 250) - (400, 300), 1, B4
90 Setpin 11,5
100 Duty = 30 ' init to 30/70 PWM
110 Sound 200, 200000, Duty ' 200 Hz duration about 33 minutes 30 % duty
130 FONT &#35;2 ' big print
140 I$=Inkey$ &#58; if I$="" then goto 270 'Test for keyboard input until key press
150 If I$="z" Then Duty = 15 &#58; Print @(320, 120) " 15" &#58; GoTo 230
160 If I$="x" Then Duty = 25 &#58; Print @(320, 120) " 25" &#58; GoTo 230
170 If I$="c" Then Duty = 40 &#58; Print @(320, 120) " 40" &#58; GoTo 230
180 If I$="v" Then Duty = 50 &#58; Print @(320, 120) " 50" &#58; GoTo 230
190 If I$="b" Then Duty = 60 &#58; Print @(320, 120) " 60" &#58; GoTo 230 
200 If I$="n" Then Duty = 75 &#58; Print @(320, 120) " 75" &#58; GoTo 230
210 If I$="m" Then Duty = 100 &#58; Print @(320, 120) "100" &#58; GoTo 230
220 GoTo 140
230 Sound 200, 200000, Duty 
250 GoTo 130
260 A=pin(11)
270 if pin(11) &lt;&gt;A then A=Pin(11)&#58; Font 2 &#58; Print @(320, 270) A
280 goto 140 ' go back to check for key press
</pre><br /><br /><b>PWM2ac.bas</b>:<br /><pre>
    ' PWM2ac.bas using Sound output pin
    ' Plus number of turns (total count)
    ' Mick Gulovsen, Ron Pugh
    ' This is the same as PWM2A.BAS but without line numbers and
    ' in a more structured programming form.

    Cls
    Line(100, 100) - (300, 150), 1, B ' draws a box
    Font 2 &#58; Print@(120, 120) "Speed %"
    Line(300, 100) - (400, 150), 1, B
    Line(100, 250) - (250, 300), 1, B
    Font 2 &#58; Print@(105, 270) "Turns Count"
    Line(300, 250) - (400, 300), 1, B

    SetPin 11,5

    Font 2    ' big print
    Soundit 30 ' init to 30/70 PWM
               ' 200 Hz duration about 33 minutes 50 % duty

    Do    ' loop for ever

       Do  ' Print count while waiting for change of Duty
         If Pin(11) &lt;&gt; A Then
           A=Pin(11)
           Font 2
           Print @(320,270) A
         EndIf
         I$=Inkey$
       Loop Until I$&lt;&gt;""

       If     I$="z" Then
         Soundit 15
       ElseIf I$="x" Then
         Soundit 20
       ElseIf I$="x" Then
         Soundit 25
       ElseIf I$="c" Then
         Soundit 40
       ElseIf I$="v" Then
         Soundit 50
       ElseIf I$="b" Then
         Soundit 60
       ElseIf I$="n" Then
         Soundit 75
       ElseIf I$="m" Then
         Soundit 100
       EndIf

    Loop

Sub Soundit Duty
    Sound 200, 2000000, Duty
    Print @(320,120) Duty;" "
End Sub

</pre><br /><br /><b>PWMs.bas</b>:<br /><pre>
10  '&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
20 ' Coil Winder by Ron Pugh
30 ' Version 2  2012
40 ' With programming assistance from
50 ' Mick Gulovsen and Hugh Buckle
60 '&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
70 ' PWMs.bas using Sound output pin
80 ' Plus number of turns (total count)
90 Cls
100 Font &#35;2
110 Input"Enter Wire Dia (in Thou)";dia
120 Input"Enter Bobbin Length (in Thou)";bobbin
130 ' steps per wire thickness calculation
140 ' assumptions
150 ' 200 pulses per rotation on stepper
160 ' 10 rotations per inch stepped
170 ' Direction starts with 0 then goes to 1
180 No_Puls=Cint(dia&#42;2/10) ' No of Pulses per 1/10th rotation
190 Puls_Fr = dia&#42;2/10 - No_Puls ' saves the fractional part of an extra rotation
200 Max_puls=bobbin&#42;2 &#58; Puls_Cnt=0
210 SetPin 1,8 &#58; Pin(1)=0' set pin 1 for Stepper pulses and init as LOW
220 SetPin 2,8 &#58; Pin(2)=0 &#58; Dir_stat=0 ' set pin 2 for Direction and init as 0
230 Cls
240 Line(100, 100) - (250, 150), 1, B1
250 Font 2 &#58; Print@(120, 120) "Speed %"
260 Line(300, 100) - (400, 150), 1, B2
270 Line(100, 250) - (250, 300), 1, B3
280 Font 2 &#58; Print@(105, 270) "Turns Count"
290 Line(300, 250) - (400, 300), 1, B4
300 GoSub 810
310 SetPin 11,5
320 Duty = 30 ' init to 30/70 PWM
330 Sound 200, 2000000, Duty ' 200 Hz duration about 33 minutes 30 % duty
340 Font &#35;2 ' big print
350 I$=Inkey$ &#58; If I$="" Then GoTo 470 'Test for keyboard input until key press
360 If I$="z" Then Duty = 20 &#58; Print @(320, 120) " 20" &#58; GoTo 440
370 If I$="x" Then Duty = 30 &#58; Print @(320, 120) " 30" &#58; GoTo 440
380 If I$="c" Then Duty = 40 &#58; Print @(320, 120) " 40" &#58; GoTo 440
390 If I$="v" Then Duty = 50 &#58; Print @(320, 120) " 50" &#58; GoTo 440
400 If I$="b" Then Duty = 60 &#58; Print @(320, 120) " 60" &#58; GoTo 440
410 If I$="n" Then Duty = 75 &#58; Print @(320, 120) " 75" &#58; GoTo 440
420 If I$="m" Then Duty = 100 &#58; Print @(320, 120) "100" &#58; GoTo 440
430 GoTo 350
440 Sound 200, 2000000, Duty
450 GoTo 340
460 'A=PIN(11)
470 If Pin(11)=A Then
480    GoTo 350
490 Else
500 ' As the calc Cint(dia&#42;2/10) will usually result in a remainder,
510 ' here we accumulate the error and add an extra turn when the
520 ' accumulated error is greater than or equal to 1
530    Accum_Puls_Fr = Accum_Puls_Fr + Puls_Fr
540    If Accum_Puls_Fr &gt;= 1 Then
550       Pulses = No_Puls + 1
560       Accum_Puls_Fr = Accum_Puls_Fr - 1
570    Else
580       Pulses = No_Puls
590    EndIf
600    For X=1 To Pulses
610      Pin(1)=1
620      Pause .2
630      Pin(1)=0
640      Pause .7
650      GoSub 720
660    Next x
670    A=Pin(11)
680 EndIf
690 Font 2
700 Print @(320,270)Int(A/10)
710 GoTo 350 ' go back to check for key press
720 '
730 puls_Cnt=Puls_Cnt+1
740 If Puls_Cnt&gt;Max_Puls Then
750    Dir_stat=Not(Dir_stat)
760    Pin(2)=Dir_stat
770    GoSub 810
780    Puls_cnt=Puls_cnt-Max_puls
790 EndIf
800 Return
810 '
820 Print@(150, 375) " ";
830 If Dir_stat=0 Then Print "RIGHT &#45;&#45;&#45;&#45;&#45;&#45;-&gt;"; Else Print"&lt;&#45;&#45;&#45;&#45;&#45;&#45;- LEFT ";
840 Return

</pre><br /><br /><br /><br /><br />
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		<div id="Anthem_ctl00_CphMaster_attachmentViewer_rptItems__">
		<table id="AttachmentViewerTable" class="generic" cellpadding="0" cellspacing="0">
			<thead>
			<tr class="tableheader">
				<th>&nbsp;</th>
				<th>Name</th>
				<th>Size</th>
			</tr>
			</thead>
			<tbody>
	
		<tr class="tablerow">
			<td><img src="Images/File.png" alt="-" /></td>
			<td><a href='I%20built%20a%20coil%20winder21e9.pdf?File=I%20built%20a%20coil%20winder.pdf&amp;AsStreamAttachment=1&amp;Provider=ScrewTurn.Wiki.FilesStorageProvider&amp;IsPageAttachment=1&amp;Page=MMBasic.COILWIND-part-of-the-original-MMBasic-library' title="Download">I built a coil winder.pdf</a></td>
			<td>196.48 KB</td>
		</tr>
	
		</tbody>
		</table>
	</div>

    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.COILWIND-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:43:37 GMT -->
</html>
