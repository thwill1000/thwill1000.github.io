

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from fruitoftheshed.com/MMBasic.Astrofix-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:40:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8" /><title>
	Astrofix - Fruit Of The Shed
</title><script type="text/javascript" src="JS/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="JS/Scripts.js"></script>
<script type="text/javascript" src="JS/SearchHighlight.js"></script>
<link rel="stylesheet" media="print" href="Themes/Default/Print_Styles.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles%20-%20Copy.css" type="text/css" />
<link rel="stylesheet" media="screen" href="Themes/Default/Screen_Styles.css" type="text/css" />
<link rel="stylesheet" href="Themes/Editor.css" type="text/css" />
<link rel="search" href="searchf7b1.xml?OpenSearch=1" type="application/opensearchdescription+xml" title="Fruit Of The Shed - Search" /><script src="Themes/Default/Scripts.js" type="text/javascript"></script>
<link rel="shortcut icon" href="Themes/Default/Icon.ico" type="image/x-icon" />
</head>
<body>
    <form name="aspnetForm" method="post" action="http://fruitoftheshed.com/Default.aspx?Page=Astrofix-part-of-the-original-MMBasic-library&amp;NS=MMBasic&amp;NoRedirect=1" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTQ3NjA4MDI2D2QWAmYPZBYCAgEPZBYCAgkPZBYEAhsPDxYCHg1BbnRoZW1WaXNpYmxlaGRkAicPDxYCHgdWaXNpYmxlaGQWAmYPFgIeC18hSXRlbUNvdW50ZmRkL9X+pH8J+jB1IIJZx71WjgOrjyw=" />
</div>

<script type="text/javascript">
//<![CDATA[
var Anthem_FormID = "aspnetForm";
//]]>
</script>
<script src="WebResource3c0c.axd?d=wu8PDPV1hmKciPrhUAi9NEjQUBbOefrIXCaRPwGH8Q5jrvPZFuGbKmycL3GXDKGD1_JZ083oQl1Kpd_P7rg1V93MtYOS3Vb-0Eztmu5VDCWQxc7l0&amp;t=636158881040000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
</div>
		<script type="text/javascript">
<!--
__BaseName = "ctl00_CphMaster_";
__ConfirmMessage = "Are you sure you want to proceed?";
// -->
</script>
		<script type="text/javascript">
		<!--
			function __GetServerElementById(id) {
				return document.getElementById(__BaseName + id);
			}
			function __RequestConfirm() {
				return confirm(__ConfirmMessage);
			}
		// -->
		</script>
    
        <div id="HeaderDiv">
            <div style="float: right;">Welcome <a href="MMBasic.Language.html" class="systemlink" title="Select your language">Guest</a>, you are in: <select class="namespacedropdown" onchange="javascript:var sel = this.value; document.location = (sel != '' ? (sel + '.') : '') + 'Default.aspx';"><option value="">&lt;root&gt;</option><option value="Circuit Ideas">Circuit Ideas</option><option value="Colour MaxiMite 2 (CMM2)">Colour MaxiMite 2 (CMM2)</option><option value="GCB">GCB</option><option value="MicroMite ArmMite and MMX Hardware">MicroMite ArmMite and MMX Hardware</option><option selected="selected" value="MMBasic">MMBasic</option><option value="PIC ASM">PIC ASM</option><option value="Platform Agnostic">Platform Agnostic</option></select> &bull; <a href="MMBasic.Login5824.html?Redirect=http%3a%2f%2ffruitoftheshed.com%2fDefault.aspx%3fPage%3dAstrofix-part-of-the-original-MMBasic-library%26NS%3dMMBasic%26NoRedirect%3d1" class="systemlink" title="Login">Login</a></div><h1>Fruit Of The Shed</h1>
        </div>
                   
        <div id="ContainerDiv">
                 
            <div id="SidebarDiv">
                <div id="SidebarHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="SidebarContentDiv">
                    <div style="float: right;"> </div><h3 class="separator">Navigation (MMBasic)<a class="headeranchor" id="Navigation_NAMESPACE_0" href="#Navigation_NAMESPACE_0" title="Link to this Section">&#0182;</a></h3><ul><li><b><a class="pagelink" href="MMBasic.MainPage.html" title="_MMBasic Code Library">Main Page</a></b></li><li><a class="pagelink" href="MainPage.html" title="Home Page">Main Page (root)</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.EggDrop-part-of-the-original-MMBasic-libraryc674.html" title="Random Page">Random Page</a></li><li><a class="systemlink" href="MMBasic.AllPages.html" title="All Pages">All Pages</a><br /> </li><li><a class="systemlink" href="Logina75d.html" title="Create a new Page">Create a new Page</a><br /></li></ul><br /><ul><li><a class="systemlink" href="Logine894.html" title="Administration">Administration</a></li><li><a class="systemlink" href="MMBasic.Upload.html" title="File Management">File Management</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="My Account">My Account</a><br /></li></ul><br /><ul><li><a class="systemlink" href="MMBasic.Register.html" title="Create Account">Create Account</a><br /></li></ul><br /><small><b>Search the wiki</b></small><br /><br /><script type="text/javascript"><!--
function _DoSearch_SBf63524b4df3e46d58daced6fab3b588b() { document.location = 'MMBasic.Search.aspx?AllNamespaces=1&FilesAndAttachments=1&Query=' + encodeURI(document.getElementById('SBf63524b4df3e46d58daced6fab3b588b').value); }
// -->
</script><input class="txtsearchbox" type="text" id="SBf63524b4df3e46d58daced6fab3b588b" onkeydown="javascript:var keycode; if(window.event) keycode = event.keyCode; else keycode = event.which; if(keycode == 10 || keycode == 13) { _DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false; }" /> <big><a href="#" onclick="javascript:_DoSearch_SBf63524b4df3e46d58daced6fab3b588b(); return false;">&raquo;</a></big><br /><br /><br />
                </div>
                <div id="SidebarFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>
            <div id="MainDiv">
                <div id="MainHeaderDiv">
                    <!-- Used for layout purposes only -->
                </div>
                <div id="PageInternalHeaderDiv"></div>
                

    <script type="text/javascript">
    <!--
        function __ShowAllTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "none";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "";
                __SetStatus("1");
            }
            catch(ex) { }
            return false;
        }
        function __HideTrail() {
            try {
                document.getElementById("BreadcrumbsDivMin").style["display"] = "";
                document.getElementById("BreadcrumbsDivAll").style["display"] = "none";
                __SetStatus("0");
            }
            catch(ex) { }
            return false;
        }
        
        function __SetStatus(open) {
            __CreateCookie("ScrewTurnWikiBCT", open, 365);
        }
        function __GetStatus() {
            var value = __ReadCookie("ScrewTurnWikiBCT");
            if(value) return value;
            else return "0";
        }

        function __InitBCT() {
        	if(__GetStatus() == "1") {
        		__ShowAllTrail();
        	}
        }

        var __attachmentsMenuJustShown = false;
        var __adminToolsMenuJustShown = false;
        var __ie7Mode = false;

        function __ToggleAttachmentsMenu(cx, cy) {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("PageAttachmentsLink"), element);
        			}
        			__attachmentsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAttachmentsMenu() {
        	var element = document.getElementById("PageAttachmentsDiv");
        	if(element && !__attachmentsMenuJustShown) {
        		element.style["display"] = "none";
        		if (__ie7Mode) element.style["left"] = "10000px";
        	}
        	__attachmentsMenuJustShown = false;
        	return true; // Needed to enabled next clicks' action (file download)
        }

        function __ToggleAdminToolsMenu(cx, cy) {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element) {
        		if(element.style["display"] == "none") {
        			element.style["display"] = "";
        			var pos = __AbsolutePosition(element);
        			if(pos.left - cx > 0) {
        				__ie7Mode = true;
        				element.style["position"] = "absolute";
        				element.style["top"] = cy + "px";
        				element.style["left"] = (cx - pos.width) + "px";
        			}
        			else {
        				__RepositionDiv(document.getElementById("AdminToolsLink"), element);
        			}
        			__adminToolsMenuJustShown = true;
        		}
        	}
        	return false;
        }
        function __HideAdminToolsMenu() {
        	var element = document.getElementById("AdminToolsDiv");
        	if(element && !__adminToolsMenuJustShown) {
        		element.style["display"] = "none";
        		if(__ie7Mode) element.style["left"] = "10000px";
        	}
        	__adminToolsMenuJustShown = false;
        	return true; // Needed to enable next clicks' action (admin tools)
        }

        function __HideAllMenus() {
        	__HideAttachmentsMenu();
        	__HideAdminToolsMenu();
        }

        document.body.onclick = __HideAllMenus;

        function __AbsolutePosition(obj) {
        	var pos = null;
        	if(obj != null) {
        		pos = new Object();
        		pos.top = obj.offsetTop;
        		pos.left = obj.offsetLeft;
        		pos.width = obj.offsetWidth;
        		pos.height = obj.offsetHeight;

        		obj = obj.offsetParent;
        		while(obj != null) {
        			pos.top += obj.offsetTop;
        			pos.left += obj.offsetLeft;
        			obj = obj.offsetParent;
        		}
        	}
        	return pos;
        }

        var __showTimer = null;
        var __hideTimer = null;

        function __ShowDropDown(e, divId, parent) {
           	// Set a timer
        	// On mouse out, cancel the timer and start a 2nd timer that hides the menu
        	// When the 1st timer elapses
        	//   show the drop-down
        	//   on menu mouseover, cancel the 2nd timer
        	//   on menu mouse out, hide the menu
        	__showTimer = setTimeout('__ShowDropDownForReal(' + e.clientX + ', ' + e.clientY + ', "' + divId + '", "' + parent.id + '");', 200);
        }

        function __ShowDropDownForReal(cx, cy, divId, parentId) {
        	var pos = __AbsolutePosition(document.getElementById(parentId));
        	var menu = document.getElementById(divId);

			// This is needed to trick IE7 which, for some reason,
			// does not position the drop-down correctly with the new Default theme
        	if(pos.left - cx > 30) {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = cy + "px";
        		menu.style["left"] = (cx - 10) + "px";
        	}
        	else {
        		menu.style["display"] = "";
        		menu.style["position"] = "absolute";
        		menu.style["top"] = (pos.top + pos.height) + "px";
        		menu.style["left"] = pos.left + "px";
        	}
        	__showTimer = null;
        }

        function __HideDropDown(divId) {
        	if(__showTimer) clearTimeout(__showTimer);
        	__hideTimer = setTimeout('__HideDropDownForReal("' + divId + '");', 200);
        }

        function __HideDropDownForReal(divId) {
        	document.getElementById(divId).style["display"] = "none";
        	__hideTimer = null;
        }

        function __CancelHideTimer() {
        	if(__hideTimer) clearTimeout(__hideTimer);
        }
        
    // -->
    </script>

	<a id="PageTop"></a>
	
	<div id="PageHeaderDiv">
	
		<!-- Change this to PageToolbarDiv -->
		<div id="EditHistoryLinkDiv">
			<a id="DiscussLink" title="Discuss" href="MMBasic.Astrofix-part-of-the-original-MMBasic-library266d.html?Discuss=1">Discuss (0)</a>
			
			
			<a id="HistoryLink" title="View Page edit history" href="MMBasic.History7041.html?Page=MMBasic.Astrofix-part-of-the-original-MMBasic-library">History</a>
			
			
			
			
			
		</div>
		
		<h1 class="pagetitle">
			
			Astrofix
			
		</h1>
		
		<div id="PrintLinkDiv">
			<a id="PrintLink" href="MMBasic.Print7041.html?Page=MMBasic.Astrofix-part-of-the-original-MMBasic-library" title="Printer friendly version" target="_blank">Print</a>
		</div>
		
		<div id="RssLinkDiv">
			
		</div>
		
		<div id="EmailNotificationDiv">
			<span id="Anthem_ctl00_CphMaster_btnEmailNotification__"></span>
		</div>
		
		<div id="ctl00_CphMaster_pnlPageInfo">
	
			<div id="PageInfoDiv">
				<span id="ModificationSpan">
					Modified on 
					2016/12/23 23:17
				</span>
				<span id="AuthorSpan">
					 by 
					<a href="MMBasic.User6a4a.html?Username=admin">Administrator</a>
				</span>
				<span id="NavPathsSpan">
					
				</span>
				<span id="CategoriesSpan">
					Categorized as 
					<a href="MMBasic.AllPages362f.html?Cat=MMBasic.Astronomy" title="Astronomy">Astronomy</a>, <a href="MMBasic.AllPagesdb1b.html?Cat=MMBasic.Dates%2c%20Time%20and%20Clocks" title="Dates, Time and Clocks">Dates, Time and Clocks</a>, <a href="MMBasic.AllPages5f42.html?Cat=MMBasic.GPS" title="GPS">GPS</a>, <a href="MMBasic.AllPages0f85.html?Cat=MMBasic._LIB%20Original%20MMBasic" title="_LIB Original MMBasic">_LIB Original MMBasic</a>
				</span>
				
				<span id="PageDiscussionSpan">
					
					
				</span>
			</div>
		
</div>
		
		<div id="fafe9979b-8573-4edb-8f10-12cf6fe12ead" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('fafe9979b-8573-4edb-8f10-12cf6fe12ead');"></div><div id="f5be62186-0682-4f0e-8d3a-391624288576" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f5be62186-0682-4f0e-8d3a-391624288576');"></div><div id="f1e40baa0-6447-4328-9544-be00b633e698" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('f1e40baa0-6447-4328-9544-be00b633e698');"><a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.Armmite-F4-Hardware.html" title="Armmite F4 Hardware">Armmite F4 Hardware</a></div><div id="sf9f2bd63-c6b6-46c9-ae06-0bcad10b89a4" style="display: none;" class="pageoutgoinglinksmenu" onmouseover="javascript:return __CancelHideTimer();" onmouseout="javascript:return __HideDropDown('sf9f2bd63-c6b6-46c9-ae06-0bcad10b89a4');"></div><div id="BreadcrumbsDiv"><div id="BreadcrumbsDivMin"><a href="#" onclick="javascript:return __ShowAllTrail();" title="Click here to view the complete Breadcrumbs Trail">(10)</a> &raquo; <a href="MMBasic.ARMMite-Pin-Aliases.html" title="ARMMite H7 Pin Aliases (MMBasic)">ARMMite H7 Pin Aliases (MMBasic)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.PicoMite.html" title="PicoMite (MicroMite ArmMite and MMX Hardware)">PicoMite (MicroMite ArmMite and MMX Hardware)</a> &raquo; <b><a href="MMBasic.Astrofix-part-of-the-original-MMBasic-library.html" title="Astrofix (MMBasic)">Astrofix (MMBasic)</a></b> </div><div id="BreadcrumbsDivAll" style="display: none;"><a href="#" onclick="javascript:return __HideTrail();" title="Click here to hide the Breadcrumbs Trail">[X]</a> &raquo; <a href="Platform%20Agnostic.A-Brief-Introduction-to-State-Machine-Methodology.html" title="A Brief Introduction to State Machine Methodology... (Platform Agnostic)">A Brief Introduction to State Machine Methodology... (Platform Agnostic)</a> &raquo; <a href="MMBasic.ALPHA-COUNT-part-of-the-original-MMBasic-library.html" title="Alpha Count (MMBasic)">Alpha Count (MMBasic)</a> &raquo; <a href="MMBasic.Analog-Clock-part-of-the-original-MMBasic-library.html" title="Analog Clock (MMBasic)">Analog Clock (MMBasic)</a> &raquo; <a href="MMBasic.Armmite-F4-User-Manual-and-Firmware.html" title="Armmite F4 User Manual and Firmware (MMBasic)" onmouseover="javascript:return __ShowDropDown(event, 'f1e40baa0-6447-4328-9544-be00b633e698', this);" id="lnkf1e40baa0-6447-4328-9544-be00b633e698" onmouseout="javascript:return __HideDropDown('f1e40baa0-6447-4328-9544-be00b633e698');">Armmite F4 User Manual and Firmware (MMBasic)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.MainPage.html" title="Main Page (MicroMite ArmMite and MMX Hardware)">Main Page (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.Armmite-F4-Hardware.html" title="Armmite F4 Hardware (MicroMite ArmMite and MMX Hardware)">Armmite F4 Hardware (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.37-Sensor-45-sensor-kits.html" title="37 Sensor, 45 sensor kits (MicroMite ArmMite and MMX Hardware)">37 Sensor, 45 sensor kits (MicroMite ArmMite and MMX Hardware)</a> &raquo; <a href="MMBasic.ARMMite-Pin-Aliases.html" title="ARMMite H7 Pin Aliases (MMBasic)">ARMMite H7 Pin Aliases (MMBasic)</a> &raquo; <a href="MicroMite%20ArmMite%20and%20MMX%20Hardware.PicoMite.html" title="PicoMite (MicroMite ArmMite and MMX Hardware)">PicoMite (MicroMite ArmMite and MMX Hardware)</a> &raquo; <b><a href="MMBasic.Astrofix-part-of-the-original-MMBasic-library.html" title="Astrofix (MMBasic)">Astrofix (MMBasic)</a></b> </div></div>
		
		
	
	</div>
	
	<div id="PageContentDiv">
		<h2 class="separator">This module is part of the original MMBasic library. It is reproduced here with kind permission of Hugh Buckle and Geoff Graham. Be aware it may reference functionality which has changed or is deprecated in the latest versions of MMBasic.<a class="headeranchor" id="This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" href="#This_module_is_part_of_the_original_MMBasic_library_It_is_reproduced_here_with_kind_permission_of_Hugh_Buckle_and_Geoff_Graham_Be_aware_it_may_reference_functionality_which_has_changed_or_is_deprecated_in_the_latest_versions_of_MMBasic_0" title="Link to this Section">&#0182;</a></h2><b>Note</b>: Any required file(s) are available in the attachments tab (top right).<br /><br />Here is a program that may be of use to the budding astronomer or others who might be interested.<br /><br />It uses the EM408 GPS module with a 47K resistor between module pin1(enable) and pin2(Gnd).<br /> <br />Connection to the Maximite are..<br />        <br /><pre>
  EM408           Maximite
&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;
  pin1(enable)    Pin19
  pin2(Gnd)       GND
  pin3(Rx)        Pin16 (This connection is not essential)
  pin4(Tx)        Pin15
  pin5(+3.3V)     +3.3V
</pre><br />When you run the program it will ask for your time zone, just hit enter for default UTC+10 (Sydney/Melb. no allowance for daylight saving). Once the time zone is set the program will wait for the module to get a satellite lock. When a lock is achieved the program will commence calculating local solar and local sidereal time. It allows the equatorial co-ordinates of a celestial object to be entered, it will then track its position in the sky. Sorry no graphics, just sidereal hours east or west of the local meridian and the angle of arc north or south from zenith. It will also indicate the object's visibility in the night sky, as some objects may never be visible, while others may always be visible. The accuracy appears to be within a second or two, which should be adequate for the casual observer. Originally written with MMBasic 4.3A; works on 4.5 colour or mono.<br /><br />Ray Alger<br /><br /><b>ASTROFIX.BAS</b>:<br /><pre>
'Program to use GPS Module for Astronomical Fix
'Written by Ray Alger Sept 2014
GoTo START
INVTZ&#58;
Cls
Print "Invalid Time Zone!"
Pause 1000
START&#58;
TZV = 0
GoSub TITLE
Print@(1,420)"GMT +/- offset(default +10)"
Print@(1,400)"Local Time Zone";
Input LTZ$
If LTZ$ = "" Then LTZ$ = "+10"
LTZ = Val(LTZ$)
If LTZ&gt;13 Or LTZ&lt;-12 Then GoTo INVTZ
If LTZ&gt;0 Then LTZ$ = "+"+Str$(LTZ) Else LTZ$ = Str$(LTZ)
TZV = 1
GoSub TITLE
Print@(1,240)"Please wait a minute, getting satelite fix!   "
Dim M(12) 'accumulated days for each month
Dim Para$(10) 'GPS parameters
M(1) = 0&#58;M(2) = 31&#58;M(3) = 59&#58;M(4) = 90&#58;M(5) = 120&#58;M(6) = 151
M(7) = 181&#58;M(8) = 212&#58;M(9) = 243&#58;M(10) = 273&#58;M(11) = 304&#58;M(12) = 334
NYL = -57.2907 'Normal year loss seconds
LYG = 179.2646 'Leap year gain seconds
REF = 23992.27 'Greenwich mean sidereal seconds @ 00hr 1 Jan 2000
CF = 1.0027379 'Conversion factor solar to sidereal
Pin(19) = 1
SetPin 19,8
Open "COM1&#58;4800,100,HANDL1" As &#35;1 'interupt if character received
GoSub INIT 'Initialize variables
SO = 0 'supress object info display
BEGIN&#58;
K$=Inkey$
If K$ = "~" Then GoTo SHUTDN 'Exit Code
Pause 200
If K$ = "c" Then GoTo KEYACT1 'Hot Key = Action
If K$ = "C" Then GoTo KEYACT1
'Additional action Keys
'can be added here
GoTo BEGIN
TITLE&#58;
Cls
Print "        &#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42; Maximite GPS Astrofix  V1.1 &#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;     ";
If TZV = 0 Then Return
Print "Time Zone(";LTZ$;")"
Print@(1,420)"Press &#91;C&#93; to enter stellar co-ordinates, Press &#91;~&#93; to Exit"
Return
SHUTDN&#58;
Close &#35;1 'stop com port
Pin(19) = 0 'disable GPS module
End

KEYACT1&#58;
Close &#35;1 'stop com port
Print@(1,240) "Enter co-ordinates for celestial object"
Print "Right Ascension?"
Input"Hours";A1
Input"Minutes";B1
Input"Seconds";C1
ORA = A1&#42;3600+B1&#42;60+C1 'Object RA seconds
Print "Declination? ";
Input"+ or -";X$ 'north or south of celestial equator
If X$ = "+" Then X = 1
If X$ = "-" Then X = -1
Input"Degrees";A2
Input"Minutes";B2
Input"Seconds";C2
ODE = (A2+B2/60+C2/3600)&#42;X 'Object Declination in degrees
SO = 1 'Allow object info display
GoSub TITLE
Open "Com1&#58;4800,100,HANDL1" As &#35;1 'start com port
GoTo BEGIN

INIT&#58;
For I = 1 To 10 'Clear parameter array strings
Para$(I) = ""
Next I
J = 1 'initial parameter counter
CT = 0 'initial collect trigger
MO = 0 'month
Return

HANDL1&#58;
C$ = Input$(1,&#35;1)
If CT = 1 Then GoTo COLL '1 = Collect Chars.
If C$ = "$" Then CT = 1 ' Collect trigger
GoTo ERT 'exit
COLL&#58;
If C$ = "," Then GoTo NPAR ' inc J for next parameter
If C$ = "&#42;" Then GoTo ESTR 'End of string go check
Para$(J) = Para$(J) + C$
GoTo ERT 'exit
NPAR&#58;
J = J + 1
If J = 11 Then GoTo ESTR 'enough go check Para string
GoTo ERT 'exit
ESTR&#58;
If Para$(1) ="GPRMC" Then GoTo RMC
If Para$(1) ="GPGGA" Then GoTo GGA
If Para$(1) ="GPGSV" Then GoTo GSV
IERT&#58; GoSub INIT 'initial
ERT&#58; IReturn

'Process RMC string - calculate Mean Sidereal Time
'example string..
'$GPRMC,114041.000,A,3750.5790,S,14510.0725,E,0.24,31.06,260814,,&#42;2F
RMC&#58;
If Para$(3)&lt;&gt;"A" Then GoTo IERT 'initial and exit
Print@(1,240)"                                                  "
YR = Val(Right$(Para$(10),2)) 'get date and time
MO = Val(Mid$(Para$(10),3,2))
DY = Val(Left$(Para$(10),2))
HR = Val(Left$(Para$(2),2))
MN = Val(Mid$(Para$(2),3,2))
SE = Val(Mid$(Para$(2),5,2))
'Code to manipulate co-ordinates
If Para$(7) = "E" Then TZA = 1 'Time zone adjust
If Para$(7) = "W" Then TZA = -1
LLG = Val(Left$(Para$(6),3)) + Val(Mid$(Para$(6),4,7))/60
LLG = LLG &#42; TZA 'Local Longitude
ADJL = 86400 &#42; LLG/360 'Seconds adjust for local longitude
If Para$(5) = "N" Then DEC = 1
If Para$(5) = "S" Then DEC = -1
LLT = Val(Left$(Para$(4),2)) + Val(Mid$(Para$(4),3,7))/60
LLT = LLT &#42; DEC 'Local Latitude
'Code to calculate local Solar and Sidereal time
LYR = Int(YR/4) + 1 'leap years
NYR = YR - LYR 'normal years
LORG = NYR&#42;NYL + LYR&#42;LYG 'calc sidsecs lost or gained since 00hr 1 Jan 2000
NREF = LORG + REF 'new reference for 00hr 1 Jan current year
DYS = M(MO) + DY -1 ' add days to date up to 00hrs
If Int(YR/4) = YR/4 And MO&gt;2 Then DYS = DYS + 1 'Allow for Leap day
GMTS = HR&#42;3600 + MN&#42;60 + SE 'Greenwich Mean Time Seconds
T = GMTS + LTZ&#42;3600 'Local Mean Solar Time Seconds
GoSub S2HMS
S$ = Format$(S,"%02.0f")
Print@(1,20)"   Local Solar Time = ";H$;"&#58;";M$;"&#58;";S$
SSEL = GMTS &#42; CF 'Sidsecs elapsed since 00hr today
SSEL = SSEL + ADJL 'adjust for longitude
SSEA = DYS &#42; 236.5554 'sid secs advanced from 00hr Jan 1
T = NREF + SSEA + SSEL 'starting point plus elapsed
GoSub S2HMS
Print@(1,40)"Local Sidereal Time =";H;" Hrs";M;" Mins ";S$;" Secs  "
Print@(1,60);
LLT$ = Format$(Abs(LLT),"%2.3f")
Print"Local Position = ";LLT$;" Deg ";Para$(5);" ";LLG;" Deg ";Para$(7);"  "
Print
If SO = 0 Then GoTo IERT
LRA = H&#42;3600+M&#42;60+S 'local RA secs
OML = ORA-LRA 'object RA minus local RA
T = Abs(OML)
GoSub S2HMS
If OML&gt;0 Then Y$ = "East" Else Y$ = "West"
Print@(1,100)"Object Co-ordinates-"
Print
Print "RA = ";A1;" Hrs";B1;" Mins";C1;" Secs"
Print "DEC = ";A2;" Degs";B2;" Mins";C2;" Secs"
Print@(1,160)"Object is-"
Print
Print H$;" Hrs ";M$;" Mins ";S$;" Secs ";Y$;" of local meridian  "
ANG = ODE-LLT
POM = ODE&#42;LLT 'plus or minus
If ANG &lt; 0 Then Z$ = "South" Else Z$ = "North"
DOA = Abs(ANG) 'Degrees of angle
MOA = (DOA - Int(DOA))&#42;60 'Minutes of angle
SOA = (MOA - Int(MOA))&#42;60 'Seconds of angle
DOA = Int(DOA)
MOA = Int(MOA)
SOA = Cint(SOA&#42;10)/10
Print "On arc )";DOA;" Degs";MOA;" Mins";SOA;" Secs ";Z$;" of zenith"
If ANG &gt;= 90 Or ANG &lt;= -90 Then GoTo OBNR 'object never rises
ELA = 90-Abs(ANG) 'object elevation at local meridian
WAD = 90-Abs(ODE) 'working angle degs
WAR = Rad(WAD) 'radians
LLR = Rad(Abs(LLT)) 'local latitude radians
HYP = Sin(WAR) 'some trigonometry
ADJ = Cos(WAR)
ADJ = ADJ&#42;Tan(LLR)
If ADJ&gt;HYP Then GoTo OBNS 'object never sets
OPP = Sqr(HYP^2-ADJ^2) 'Pythagoras
If ADJ = 0 Then GoTo EQUA 'Dec or Lat = 0 degs.
VAR = Atn(OPP/ADJ) '+/- visible hour angle radians
VAD = Deg(VAR) 'degs.
If POM &gt;= 0 Then VAD = 180-VAD 'angle &gt; 90
GoTo RESULT
OBNR&#58;
Print "Object never rises, not visible from this location."
GoTo REND
OBNS&#58;
Print "Object never sets, always visible in night sky."
GoTo REND
RESULT&#58;
RAS = VAD/15&#42;3600 'RA secs
DIF = Abs(OML)-RAS 'difference in RA secs
If DIF&gt;0 Then GoTo OBNV 'not visible
If OML &gt; 0 Then T = Abs(OML) + RAS Else T = Abs(DIF)
GoSub S2HMS
Print "Visible in night sky, setting in ";H$;" Hrs ";M$;" Mins ";S$;" Secs"
GoTo REND
OBNV&#58;
If OML&gt;0 Then GoTo OYTR 'object yet to rise
Print "Not currently visible, already set.        "
GoTo REND
OYTR&#58;
T = Abs(DIF)
GoSub S2HMS
Print "Not visible, rising in ";H$;" Hrs ";M$;" Mins ";S$;" Secs  "
'Code required for bearing and elevation
REND&#58;
'allow add code before routine end
GoTo IERT

S2HMS&#58;
H = T/3600
M = (H-Int(H))&#42;60
S = (M-Int(M))&#42;60
H = Int(H)
H = (H/24 - Int(H/24)) &#42; 24 'Modulus 24
M = Int(M)
S = Cint(S&#42;10)/10
H$ = Format$(H,"%02.0f")
M$ = Format$(M,"%02.0f")
S$ = Format$(S,"%02.1f")
Return

GSV&#58;
Print@(1,380)"Satilites available ";Para$(4)", "
GoTo IERT

GGA&#58;
Print@(150,380)"Using ";Para$(8);"  "
GoTo IERT


</pre>
	</div>
	
	
	
	<div id="PageAttachmentsDiv" style="position: absolute; left: 10000px;">
		
    </div>
    
    <div id="AdminToolsDiv" style="position: absolute; left: 10000px;">
		
		
		
    </div>
    
    <script type="text/javascript">
    <!--
    	function __RepositionDiv(link, element) {
    		var absPos = __AbsolutePosition(link);
    		var elemAbsPos = __AbsolutePosition(element);

    		element.style["top"] = (absPos.top + absPos.height) + "px";
    		element.style["left"] = (absPos.left - (elemAbsPos.width - absPos.width)) + "px";
    		element.style["position"] = "absolute";
    	}

		// Hide attachments and admin tools divs
    	// This is needed because __RepositionDiv cannot calculate the width of the element when it's hidden
    	var __elem = document.getElementById("PageAttachmentsDiv");
    	if(document.getElementById("PageAttachmentsLink")) {
    		__RepositionDiv(document.getElementById("PageAttachmentsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__elem = document.getElementById("AdminToolsDiv");
    	if(document.getElementById("AdminToolsLink")) {
    		__RepositionDiv(document.getElementById("AdminToolsLink"), __elem);
    	}
    	__elem.style["display"] = "none";

    	__InitBCT();
    // -->
    </script>


                <div id="PageInternalFooterDiv"></div>
                <div id="MainFooterDiv">
                    <!-- Used for layout purposes only -->
                </div>
            </div>

        </div>
            
        <div id="FooterDiv">
             
        </div>

    </form>  
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Astrofix-part-of-the-original-MMBasic-library.ashx?NoRedirect=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:40:36 GMT -->
</html>
