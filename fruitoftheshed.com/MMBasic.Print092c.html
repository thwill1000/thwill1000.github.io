

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Program-Step-A-Fast-Flexible-Debugging-Aid by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>
	Program Step - A Fast, Flexible Debugging Aid - Fruit Of The Shed
</title><link rel="stylesheet" type="text/css" href="Themes/Print.css" /></head>
<body>
    <form name="frmPrint" method="post" action="http://fruitoftheshed.com/Print.aspx?NS=MMBasic&amp;Page=MMBasic.Program-Step-A-Fast-Flexible-Debugging-Aid" id="frmPrint">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMDg4Njc4MjcPZBYCAgEPZBYCAgEPFgIeBFRleHQF2x48aDEgY2xhc3M9InBhZ2V0aXRsZSI+UHJvZ3JhbSBTdGVwIC0gQSBGYXN0LCBGbGV4aWJsZSBEZWJ1Z2dpbmcgQWlkPC9oMT48c21hbGw+TW9kaWZpZWQgb24gMjAxOC8wMS8wNCAxODo0MiBieSBDYXB0YWluQm9pbmcgJm1kYXNoOyBDYXRlZ29yaXplZCBhczogRGVidWcsIFByb2dyYW0gRmxvdzwvc21hbGw+PGJyIC8+PGJyIC8+TW9kZXJuIGxhbmd1YWdlcyBoYXZlIHJlbGVhc2VkIGRldmVsb3BlcnMgZnJvbSBhIGxvdCBvZiB0aGUgc2hhY2tsZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBmaXJzdCBhbmQgc2Vjb25kIGdlbmVyYXRpb24gcHJvZ3JhbW1pbmcgbGFuZ3VhZ2VzLCBidXQgc29tZSByZWFsbHkgdXNlZnVsIHRoaW5ncyBoYXZlIGZhbGxlbiBieSB0aGUgd2F5LXNpZGUgaW4gdGhlIHByb2Nlc3MuPGJyIC8+PGJyIC8+Tm90IG1hbnkgd2lsbCBtb3VybiB0aGUgcGFzc2luZyBvZiBtYW5kYXRvcnkgbGluZSBudW1iZXJzIGluIGNvZGUgYnV0IGl0IGlzIGluZGlzcHV0YWJsZSB0aGF0IHRoZXkgY291bGQgbWFrZSBsaWZlIHJlYWxseSBlYXN5IGZvciB0cmFjaW5nIGJ1Z3MuIE1NQmFzaWMgZG9lcyBtYWludGFpbiB0aGUgcG9wdWxhciBUUk9OL1RST0ZGIChhbHRob3VnaCBpdHMgZnV0dXJlIGlzIG5vdCBjZXJ0YWluKSBidXQgVFJPTiBpcyBpbmRpc2NyaW1pbmF0ZSBhbmQgdXN1YWxseSBpbnZvbHZlcyBzY3JlZW4gY2FwdHVyZSBhbmQgdGhlbiBnb2luZyB0aHJvdWdoIHRoZSBsaW5lcyB3aXRoIHlvdXIgZWRpdG9yIHRvIGV2ZW4gaWRlbnRpZnkgdGhlIHNlY3Rpb24gb2YgY29kZSAtIGl0IGlzbid0IGEgbmljZSBleHBlcmllbmNlIHJlbGF0aW5nIG1vdW50YWlucyBvZiAxMDAgMTAxIDM3MyAzNzQuLi4gZXRjLiB0byB5b3VyIG5pY2VseSBmb3JtYXR0ZWQgY29kZSBpbiB0aGUgZWRpdG9yIGFuZCB0aGUgbnVtYmVycyB3aWxsIGNoYW5nZSBhcyB5b3UgYWRkL3JlbW92ZSBsaW5lcyBlYWNoIHJ1bi4gQW5vdGhlciBvcHRpb24gbWlnaHQgYmUgdG8gdXNlIGFuIElERSB3aGljaCBjYW4gYmUgdmVyeSBkZXRhaWxlZCBidXQgb2Z0ZW4gYSBtYXNzaXZlIG92ZXIta2lsbCBmb3Igc2ltcGx5IHRyYWNpbmcgYW4gYW5ub3lpbmcgYnVnIC0gaGF2ZSB5b3UgcGxheWVkIHdpdGggdGhlIHRlc3QgaGFybmVzcyBpbiAuTkVUPyB1Z2ghPGJyIC8+PGJyIC8+QmVsb3cgaXMgYSBtZXRob2QgZm9yIGEgdHJhY2luZyB1bmRlciBjb250cm9sIG9mIHRoZSBwcm9ncmFtbWVyL3Byb2dyYW0gYXQgcnVuIHRpbWUuIFlvdSBzaW1wbHkgdHVybiBkZWJ1Z2dpbmcgb24gYXQgdGhlIHBvaW50IHlvdSByZXF1aXJlIGFuZCBhZGQgIlBTdGVwcyIgYXQga2V5IHBvaW50cywgbm8gbG9uZ2VyIGRvIHlvdSBnZXQgYSB0cmFjZSBmb3IgZXZlcnkgbGluZSAoZXZlbiBibGFua3MpLiBZb3Ugb25seSBnZXQgb3V0cHV0IHdoZW4geW91IHdhbnQgaXQsIGFuZCB0aGUgUFN0ZXAgd2lsbCBiZSB0aGUgc2FtZSBlYWNoIHRpbWUuIEZhbWlsaWFyaXR5IHdpdGggdGhlIG51bWJlcnMgYmVjb21lcyBtZWFuaW5nZnVsIHdoaWxzdCBkZWJ1Z2dpbmcsIHdoZXJlYXMgd2l0aCBUUk9OIGl0IGlzIGxhcmdlbHkgbWVhbmluZ2xlc3MgYW5kIHlvdSBlbmQgdXAgc3RhcnRpbmcgZnJvbSBzY3JhdGNoIGVhY2ggdGltZSB5b3UgZGVidWcgeW91ciBjb2RlLjxiciAvPjxiciAvPkEgc2ltcGxlIGZsYWcgaXMgc3dpdGNoZWQgdG8gZGV0ZXJtaW5lIGlmIGRlYnVnZ2luZyBpcyByZXF1aXJlZCBvciBub3QgLSBob3cgeW91IGRvIHRoaXMgaXMgZG93biB0byB5b3UgYnV0IGl0IHNob3VsZCBiZSBzaW1wbGUgdG8gbWFrZSBpdCBmYXN0LiBOZXh0IGEgU1VCIHNob3VsZCBiZSBkZWZpbmVkIHRvIHByb3ZpZGUgdGhlIGRlYnVnZ2VyIG91dHB1dCBpbiB3aGF0ZXZlciBmb3JtYXQgeW91IGxpa2UuIEFnYWluLCB0aGUgU1VCIHNob3VsZCBiZSBzaW1wbGUgYW5kIG9wdGltaXplZCBmb3Igc3BlZWQuPGJyIC8+PGJyIC8+VGhlIFNVQiBjYW4gbm93IGJlIGNhbGxlZCBhdCBwb2ludHMgaW4gdGhlIHByb2dyYW0gd2hpY2ggcHJvdmlkZXMgY3J1Y2lhbCBpbmZvcm1hdGlvbiBmb3IgdGhlIHBvaW50IGluIHRoZSBjb2RlIGN1cnJlbnRseSBleGVjdXRpbmcgLSB3aGVuIHRoYXQgZXJyb3Igb2NjdXJzLCB5b3UgaGF2ZSBwaW4tcG9pbnRlZCB0aGUgc2VjdGlvbnMgb2YgY29kZSBpbnZvbHZlZCB3aXRoIHRoZSBsZXZlbCBvZiBkZXRhaWwgeW91IHdhbnQuPGJyIC8+PGJyIC8+VGhlIGZvbGxvd2luZyBwcm92aWRlcyBtaWNyby1jb250cm9sIG9mIGZsZXhpYmxlIGRlYnVnZ2luZyB0ZWxsLXRhbGVzIGFuZCBpdCdzIHNtYWxsIGFuZCBmYXN0IGVub3VnaCB0aGF0IHlvdSBjYW4gc2ltcGx5IGxlYXZlIGl0IGluIHlvdXIgY29kZSB3aGVuIHlvdSBhcmUgZG9uZTxiciAvPjxiciAvPjxwcmU+IA0KDQogIERpbSBkZWJ1ZyBhcyBJbnRlZ2VyJyBzZWVtcyBhIHdhc3RlIGZvciBhIHNpbXBsZSBmbGFnIGJ1dCBpdCdzIGZhc3Rlcg0KCQkNCiAgZGVidWc9MSAnIHN3aXRjaCBkZWJ1Z2dpbmcgb24gDQoNCiAgdGltZXI9MA0KICBQc3RlcCAxMDAwJyBjYWxsIHRoZSBkZWJ1Z2dlciB3aXRoIGEgdW5pcXVlICBwcm9ncmFtIHN0ZXAgaWRlbnRpZmllcg0KDQogIEZvciBuPTEgdG8gMTANCiAgICAgUFN0ZXAgMjAwMA0KICBOZXh0IGogJyBkZWxpYmVyYXRlIGVycm9yLCB0YWtlIG91dCB0aGUgaiB0byB0ZXN0IHN1Y2Nlc3MNCg0KICBQc3RlcCAzMDAwDQoNCiAgUHJpbnQgdGltZXIgJyBob3cgbG9uZyBkaWQgdGhhdCB0YWtlPw0KCQkNCgkNCg0KCQ0KCQkNCiAgU3ViIFBTdGVwKHggQXMgSW50ZWdlcikgJyB0aGUgZGVidWdnZXIgcm91dGluZQ0KICAgIElmIGRlYnVnIFRoZW4gUHJpbnQgIlBTdGVwICI7eCAnIG9wdGltaXplZCBmb3Igc3BlZWQgLSBjaGFuZ2UgdGhpcyBiaXQgdG8gZG8gd2hhdGV2ZXIgeW91IHdhbnQgYXMgcGFydCBvZiB0aGUgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgdGVsbC10YWxlIHByb2NlZHVyZSBidXQgaXQgbWlnaHQgZ2V0IGNhbGxlZCBhIGxvdCBzbyBrZWVwIHRoYXQgaW4gbWluZA0KICBFbmQgU3ViDQoNCjwvcHJlPjxiciAvPjxiciAvPlRoZSBkZWJ1Z2dlciBpcyBjYWxsZWQgZWFjaCB0aW1lIGJ1dCBpZiB0aGUgZGVidWcgZmxhZyBpcyBvZmYsIGl0IHJhcGlkbHkgZXhpdHMgd2l0aG91dCBkb2luZyBhbnl0aGluZyAtIHRoZSBvdmVyaGVhZCBpcyBxdWl0ZSBzbWFsbC4gWW91IG1pZ2h0IHdhbnQgdG8gb3V0cHV0IFN0cmluZ3MgaW5zdGVhZCBvZiBudW1iZXJzIHdoaWNoIHdpbGwgYWRkIGEgcmVhbGx5IG5pY2UgZGltZW5zaW9uIHRvIHlvdXIgZGVidWdnaW5nIGJ1dCBiZXdhcmU7IHN0cmluZyBoYW5kbGluZyBpcyB0aW1lIGNvbnN1bWluZyBhbmQgd2lsbCBlYXQgdGhyb3VnaCB5b3VyIHByb2dyYW0gc3BhY2UgcXVpdGUgcXVpY2tseSBzbyBrZWVwIGl0IHBhcmVkIGJhY2sgdG8gdGhlIG5lY2Vzc2FyeSBtaW5pbXVtLjxiciAvPjxiciAvPk5vdyB5b3UgY2FuIHN3aXRjaCBkZWJ1Z2dpbmcgb24gYW5kIG9mZiBhdCB0aGUgcmVsZXZhbnQgcG9pbnRzIGluIHlvdXIgY29kZSBhbmQgdXNlIHN0ZXBzIHRoYXQgbWVhbiBzb21ldGhpbmcgdG8geW91IC0gdHJ5IHRvIG1ha2UgdGhlIG51bWJlcnMgdXNlZCAic3RydWN0dXJlZCIgc28sIDEwMDAwKyBhcmUgZnVuY3Rpb25zLCAyMDAwMCsgYXJlIFN1YnMgYW5kIGFueXRoaW5nIGJlbG93IGlzIG1haW4gcHJvZ3JhbSBldGMuLi48YnIgLz48YnIgLz5UaGUgY29kZSBpcyBsaWdodCBhbmQgY2FuIGJlIGxlZnQgaW4gd2hlbiB5b3VyIHByb2plY3QgaXMgZmluaXNoZWQgd2l0aCBvbmx5IGEgdGlueSBvdmVyaGVhZC4gSWYgeW91IGFyZSBwdXNoZWQgZm9yIHByb2dyYW0gc3BhY2UgY2hhbmdlIHRoZSBuYW1lcyB0byBzb21ldGhpbmcgc2hvcnRlciB0byBzYXZlIGEgZmV3IGJ5dGVzIHBlciBjYWxsZGQtqMn75xP6iJaDkXC8k7apjZ6PEA==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="03CF0AB7" />
</div>
        <h1 class="pagetitle">Program Step - A Fast, Flexible Debugging Aid</h1><small>Modified on 2018/01/04 18:42 by CaptainBoing &mdash; Categorized as: Debug, Program Flow</small><br /><br />Modern languages have released developers from a lot of the shackles associated with the first and second generation programming languages, but some really useful things have fallen by the way-side in the process.<br /><br />Not many will mourn the passing of mandatory line numbers in code but it is indisputable that they could make life really easy for tracing bugs. MMBasic does maintain the popular TRON/TROFF (although its future is not certain) but TRON is indiscriminate and usually involves screen capture and then going through the lines with your editor to even identify the section of code - it isn't a nice experience relating mountains of 100 101 373 374... etc. to your nicely formatted code in the editor and the numbers will change as you add/remove lines each run. Another option might be to use an IDE which can be very detailed but often a massive over-kill for simply tracing an annoying bug - have you played with the test harness in .NET? ugh!<br /><br />Below is a method for a tracing under control of the programmer/program at run time. You simply turn debugging on at the point you require and add "PSteps" at key points, no longer do you get a trace for every line (even blanks). You only get output when you want it, and the PStep will be the same each time. Familiarity with the numbers becomes meaningful whilst debugging, whereas with TRON it is largely meaningless and you end up starting from scratch each time you debug your code.<br /><br />A simple flag is switched to determine if debugging is required or not - how you do this is down to you but it should be simple to make it fast. Next a SUB should be defined to provide the debugger output in whatever format you like. Again, the SUB should be simple and optimized for speed.<br /><br />The SUB can now be called at points in the program which provides crucial information for the point in the code currently executing - when that error occurs, you have pin-pointed the sections of code involved with the level of detail you want.<br /><br />The following provides micro-control of flexible debugging tell-tales and it's small and fast enough that you can simply leave it in your code when you are done<br /><br /><pre> 

  Dim debug as Integer' seems a waste for a simple flag but it's faster
		
  debug=1 ' switch debugging on 

  timer=0
  Pstep 1000' call the debugger with a unique  program step identifier

  For n=1 to 10
     PStep 2000
  Next j ' deliberate error, take out the j to test success

  Pstep 3000

  Print timer ' how long did that take?
		
	

	
		
  Sub PStep(x As Integer) ' the debugger routine
    If debug Then Print "PStep ";x ' optimized for speed - change this bit to do whatever you want as part of the 
                                   ' tell-tale procedure but it might get called a lot so keep that in mind
  End Sub

</pre><br /><br />The debugger is called each time but if the debug flag is off, it rapidly exits without doing anything - the overhead is quite small. You might want to output Strings instead of numbers which will add a really nice dimension to your debugging but beware; string handling is time consuming and will eat through your program space quite quickly so keep it pared back to the necessary minimum.<br /><br />Now you can switch debugging on and off at the relevant points in your code and use steps that mean something to you - try to make the numbers used "structured" so, 10000+ are functions, 20000+ are Subs and anything below is main program etc...<br /><br />The code is light and can be left in when your project is finished with only a tiny overhead. If you are pushed for program space change the names to something shorter to save a few bytes per call
    </form>
</body>

<!-- Mirrored from fruitoftheshed.com/MMBasic.Print.aspx?Page=MMBasic.Program-Step-A-Fast-Flexible-Debugging-Aid by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 09 Feb 2022 12:22:29 GMT -->
</html>
